define("canvax/animation/AnimationFrame",["canvax/animation/Tween","canvax/core/Base"],function(a,b){function c(b){return b?(j.push(b),k||(k=requestAnimationFrame(function(){l&&a.update();var b=j;for(j=[],k=null;b.length>0;)b.shift().task()})),k):void 0}function d(a){for(var b=!1,c=0,d=j.length;d>c;c++)j[c].id===a.id&&(b=!0,j.splice(c,1),c--,d--);return 0==j.length&&(cancelAnimationFrame(k),k=null),b}function e(e){function f(){h&&h.animate&&c({id:i,task:f})}var g=_.extend({from:null,to:null,duration:500,onUpdate:function(){},onComplete:function(){},repeat:0,delay:0,easing:null},e),h={};if(g.from&&g.to){h=new a.Tween(g.from).to(g.to,g.duration).onUpdate(g.onUpdate),g.repeat&&h.repeat(g.repeat),g.delay&&h.delay(g.delay),g.easing&&h.easing(a.Easing[g.easing.split(".")[0]][g.easing.split(".")[1]]);var i="tween_"+b.getUID();h.onComplete(function(){l--,d({task:f,id:i}),h.animate=null,h=null;var a=this;setTimeout(function(){g.onComplete(a)},10)}),h.start(),l++,h.animate=f,h.id=i,f()}return h}function f(a){a.stop(),d({task:a.animate,id:a.id})&&l--,a.animate=null,a=null}window.Tween=a;for(var g=0,h=["ms","moz","webkit","o"],i=0;i<h.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[h[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[h[i]+"CancelAnimationFrame"]||window[h[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a,b){var c=(new Date).getTime(),d=Math.max(0,16-(c-g)),e=window.setTimeout(function(){a(c+d)},d);return g=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});var j=[],k=null,l=0;return{registFrame:c,destroyFrame:d,registTween:e,destroyTween:f}});
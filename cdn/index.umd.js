"use strict";var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function unwrapExports(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}var interopRequireDefault=createCommonjsModule(function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.__esModule=!0,t.exports.default=t.exports});function unwrapExports$1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function createCommonjsModule$1(t,e){return t(e={exports:{}},e.exports),e.exports}unwrapExports(interopRequireDefault);var classCallCheck=createCommonjsModule$1(function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0}),_classCallCheck=unwrapExports$1(classCallCheck),createClass=createCommonjsModule$1(function(t){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t},t.exports.default=t.exports,t.exports.__esModule=!0}),_createClass=unwrapExports$1(createClass),assertThisInitialized=createCommonjsModule$1(function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.default=t.exports,t.exports.__esModule=!0}),_assertThisInitialized=unwrapExports$1(assertThisInitialized),setPrototypeOf=createCommonjsModule$1(function(n){function i(t,e){return n.exports=i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n.exports.default=n.exports,n.exports.__esModule=!0,i(t,e)}n.exports=i,n.exports.default=n.exports,n.exports.__esModule=!0}),inherits=(unwrapExports$1(setPrototypeOf),createCommonjsModule$1(function(t){t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&setPrototypeOf(t,e)},t.exports.default=t.exports,t.exports.__esModule=!0})),_inherits=unwrapExports$1(inherits),_typeof_1=createCommonjsModule$1(function(e){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(t){return typeof t}:e.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e.exports.default=e.exports,e.exports.__esModule=!0,n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0}),_typeof=unwrapExports$1(_typeof_1),possibleConstructorReturn=createCommonjsModule$1(function(t){var n=_typeof_1.default;t.exports=function(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?assertThisInitialized(t):e},t.exports.default=t.exports,t.exports.__esModule=!0}),_possibleConstructorReturn=unwrapExports$1(possibleConstructorReturn),getPrototypeOf=createCommonjsModule$1(function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},e.exports.default=e.exports,e.exports.__esModule=!0,n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0}),_getPrototypeOf=unwrapExports$1(getPrototypeOf),_={},breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,shallowProperty=function(e){return function(t){return null==t?void 0:t[e]}},MAX_ARRAY_INDEX=Math.pow(2,53)-1,getLength=shallowProperty("length"),isArrayLike=function(t){t=getLength(t);return"number"==typeof t&&0<=t&&t<=MAX_ARRAY_INDEX},each=(_.values=function(t){for(var e=_.keys(t),n=e.length,i=new Array(n),a=0;a<n;a++)i[a]=t[e[a]];return i},_.keys=nativeKeys||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e,n=[];for(e in t)_.has(t,e)&&n.push(e);return n},_.has=function(t,e){return hasOwnProperty.call(t,e)},_.each=_.forEach=function(t,e,n){if(null!=t)if(nativeForEach&&t.forEach===nativeForEach)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,a=t.length;i<a;i++)if(e.call(n,t[i],i,t)===breaker)return}else for(var r=_.keys(t),i=0,a=r.length;i<a;i++)if(e.call(n,t[r[i]],r[i],t)===breaker)return}),flatten=(_.compact=function(t){return _.filter(t,_.identity)},_.filter=_.select=function(t,i,a){var r=[];if(null!=t){if(nativeFilter&&t.filter===nativeFilter)return t.filter(i,a);each(t,function(t,e,n){i.call(a,t,e,n)&&r.push(t)})}return r},each(["Arguments","Function","String","Number","Date","RegExp"],function(e){_["is"+e]=function(t){return toString.call(t)=="[object "+e+"]"}}),_.isArguments=function(t){return!(!t||!_.has(t,"callee"))},"function"!=typeof/./&&(_.isFunction=function(t){return"function"==typeof t}),_.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&t!=+t},_.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==toString.call(t)},_.isNull=function(t){return null===t},_.isEmpty=function(t){if(null!=t){if(_.isArray(t)||_.isString(t))return 0===t.length;for(var e in t)if(_.has(t,e))return!1}return!0},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=nativeIsArray||function(t){return"[object Array]"==toString.call(t)},_.isObject=function(t){return t===Object(t)},_.identity=function(t){return t},_.indexOf=function(t,e,n){if(null!=t){var i=0,a=t.length;if(n){if("number"!=typeof n)return t[i=_.sortedIndex(t,e)]===e?i:-1;i=n<0?Math.max(0,a+n):n}if(nativeIndexOf&&t.indexOf===nativeIndexOf)return t.indexOf(e,n);for(;i<a;i++)if(t[i]===e)return i}return-1},_.isWindow=function(t){return null!=t&&t==t.window},function e(t,n,i){return n&&_.every(t,_.isArray)?concat.apply(i,t):(each(t,function(t){_.isArray(t)||_.isArguments(t)?n?push.apply(i,t):e(t,n,i):i.push(t)}),i)}),any=(_.flatten=function(t,e){return flatten(t,e,[])},_.every=_.all=function(t,i,a){i=i||_.identity;var r=!0;return null==t?r:nativeEvery&&t.every===nativeEvery?t.every(i,a):(each(t,function(t,e,n){if(!(r=r&&i.call(a,t,e,n)))return breaker}),!!r)},_.min=function(t,i,a){if(!i&&_.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!i&&_.isEmpty(t))return 1/0;var r={computed:1/0,value:1/0};return each(t,function(t,e,n){e=i?i.call(a,t,e,n):t;e<r.computed&&(r={value:t,computed:e})}),r.value},_.max=function(t,i,a){if(!i&&_.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!i&&_.isEmpty(t))return-1/0;var r={computed:-1/0,value:-1/0};return each(t,function(t,e,n){e=i?i.call(a,t,e,n):t;e>r.computed&&(r={value:t,computed:e})}),r.value},_.find=_.detect=function(t,i,a){var r;return any(t,function(t,e,n){if(i.call(a,t,e,n))return r=t,!0}),r},_.some=_.any=function(t,i,a){i=i||_.identity;var r=!1;return null==t?r:nativeSome&&t.some===nativeSome?t.some(i,a):(each(t,function(t,e,n){if(r=r||i.call(a,t,e,n))return breaker}),!!r)}),Settings=(_.without=function(t){return _.difference(t,slice.call(arguments,1))},_.difference=function(t){var e=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(t,function(t){return!_.contains(e,t)})},_.uniq=_.unique=function(n,i,t,e){_.isFunction(i)&&(e=t,t=i,i=!1);var t=t?_.map(n,t,e):n,a=[],r=[];return each(t,function(t,e){(i?e&&r[r.length-1]===t:_.contains(r,t))||(r.push(t),a.push(n[e]))}),a},_.map=_.collect=function(t,i,a){var r=[];if(null!=t){if(nativeMap&&t.map===nativeMap)return t.map(i,a);each(t,function(t,e,n){r.push(i.call(a,t,e,n))})}return r},_.contains=_.include=function(t,e){return null!=t&&(nativeIndexOf&&t.indexOf===nativeIndexOf?-1!=t.indexOf(e):any(t,function(t){return t===e}))},_.pluck=function(t,e){return _.map(t,function(t){return t[e]})},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.shuffle=function(t){return _.sample(t,1/0)},_.sample=function(t,e,n){if(null==e||n)return(t=isArrayLike(t)?t:_.values(t))[_.random(t.length-1)];for(var i=isArrayLike(t)?_.clone(t):_.values(t),n=getLength(i),a=(e=Math.max(Math.min(e,n),0),n-1),r=0;r<e;r++){var o=_.random(r,a),l=i[r];i[r]=i[o],i[o]=l}return i.slice(0,e)},_.extend=function(){var t,e,n,i,a=arguments[0]||{},r=1,o=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[1]||{},r=2),"object"===_typeof(a)||_.isFunction(a)||(a={}),o===r&&(a=this,--r);r<o;r++)if(null!=(t=arguments[r]))for(e in t)n=a[e],a!==(i=t[e])&&void 0!==i&&(l&&i&&_.isObject(i)&&i.constructor===Object?a[e]=_.extend(l,n,i):a[e]=i);return a},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend(!0,{},t):t},_.euclideanModulo=function(t,e){return(t%e+e)%e},_.DEG2RAD=Math.PI/180,_.RAD2DEG=180/Math.PI,_.degToRad=function(t){return t*_.DEG2RAD},{RESOLUTION:1,TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,FILTER_RESOLUTION:1,SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@(.+)x/,RENDER_OPTIONS:{view:null,antialias:!0,forceFXAA:!(_.radToDeg=function(t){return t*_.RAD2DEG}),autoResize:!1,transparent:!0,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION:"mediump"}),addOrRmoveEventHand=function(r,o){if(document)return document[r]?function t(e,n,i){if(e.length)for(var a=0;a<e.length;a++)t(e[a],n,i);else e[r](n,i,!1)}:function t(e,n,i){if(e.length)for(var a=0;a<e.length;a++)t(e[a],n,i);else e[o]("on"+n,function(){return i.call(e,window.event)})}},$={query:function(t){if(t)return _.isString(t)?document.getElementById(t):1==t.nodeType?t:t.length?t[0]:null},offset:function(t){if(!t)return{top:0,left:0};var e,n=t.getBoundingClientRect(),t=t.ownerDocument,i=t.body,t=t.documentElement,a=t.clientTop||i.clientTop||0,r=t.clientLeft||i.clientLeft||0,o=1;return 1<(o=i.getBoundingClientRect?((e=i.getBoundingClientRect()).right-e.left)/i.clientWidth:o)&&(r=a=0),{top:n.top/o+(window.pageYOffset||t&&t.scrollTop/o||i.scrollTop/o)-a,left:n.left/o+(window.pageXOffset||t&&t.scrollLeft/o||i.scrollLeft/o)-r}},addEvent:addOrRmoveEventHand("addEventListener","attachEvent"),removeEvent:addOrRmoveEventHand("removeEventListener","detachEvent"),pageX:function(t){return t.pageX||(t.clientX?t.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft):null)},pageY:function(t){return t.pageY||(t.clientY?t.clientY+(document.documentElement.scrollTop||document.body.scrollTop):null)},createCanvas:function(t,e,n){var i;if(document)return i=document.createElement("canvas"),i.style.position="absolute",i.style.width=t+"px",i.style.height=e+"px",i.style.left=0,i.style.top=0,i.setAttribute("width",t*Settings.RESOLUTION),i.setAttribute("height",e*Settings.RESOLUTION),i.setAttribute("id",n),i},createView:function(t,e,n){var i=document.createElement("div"),a=(i.className="canvax-view",i.style.cssText+="position:relative;width:100%;height:100%;",document.createElement("div")),r=(a.style.cssText+="position:absolute;width:"+t+"px;height:"+e+"px;",document.createElement("div"));return r.style.cssText+="position:absolute;width:"+t+"px;height:"+e+"px;",i.appendChild(a),i.appendChild(r),{view:i,stageView:a,domView:r}}},Utils={mainFrameRate:60,now:0,_pixelCtx:null,__emptyFunc:function(){},_UID:0,getUID:function(){return this._UID++},createId:function(t){var e=t.charCodeAt(t.length-1);return 48<=e&&e<=57&&(t+="_"),t+Utils.getUID()},canvasSupport:function(){return!!document.createElement("canvas").getContext},initElement:function(t){if(window)return window.FlashCanvas&&FlashCanvas.initElement&&FlashCanvas.initElement(t),t},getCssOrderArr:function(t){var e,n,i,a;return"number"==typeof t?e=n=i=a=t:t instanceof Array?1===t.length?e=n=i=a=t[0]:2===t.length?(e=i=t[0],n=a=t[1]):3===t.length?(e=t[0],n=a=t[1],i=t[2]):(e=t[0],n=t[1],i=t[2],a=t[3]):e=n=i=a=0,[e,n,i,a]},isWebGLSupported:function(){var t={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);return!(!n||!n.getContextAttributes().stencil)}catch(t){return!1}},checkOpt:function(t){return t?t.context||(t.context={}):t={context:{}},t}},_canvas=Utils.initElement($.createCanvas(1,1,"_pixelCanvas")),Event=(Utils._pixelCtx=_canvas&&_canvas.getContext("2d"),function(t){var e="CanvaxEvent",n=(_.isString(t)&&(e=t),_.isObject(t)&&t.type&&(e=t.type,_.extend(this,t)),this.target=null,this.currentTarget=null,this.type=e,this.point=null,this);this._stopPropagation=!1,this.stopPropagation=function(){n._stopPropagation=!0,_.isObject(t)&&(t._stopPropagation=!0)},this._preventDefault=!1,this.preventDefault=function(){n._preventDefault=!0,_.isObject(t)&&(t._preventDefault=!0)}}),_mouseEvents="mousedown mouseup mouseover mousemove mouseout click dblclick wheel keydown keypress keyup",types={_types:_mouseEvents.split(/,| /),register:function(t){t&&(_.isString(t)&&(t=t.split(/,| /)),this._types=_mouseEvents.split(/,| /).concat(t))},get:function(){return this._types}},Manager=function(){this._eventMap={}};function _createSuper(n){var i=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}Manager.prototype={_setEventEnable:function(){if(!this.children){var t,e=!1;for(t in this._eventMap)-1<_.indexOf(types.get(),t)&&(e=!0);this._eventEnabled=e}},_addEventListener:function(t,n){if("function"!=typeof n)return!1;var i=!0,a=this,e=t;return _.isString(t)&&(e=t.split(/,| /)),_.each(e,function(t){var e=a._eventMap[t];return e?-1==_.indexOf(e,n)?(e.push(n),a._setEventEnable(),!0):void(i=!1):((e=a._eventMap[t]=[]).push(n),a._setEventEnable(),!0)}),i},_removeEventListener:function(t,e){if(1==arguments.length)return this.removeEventListenerByType(t);var n=this._eventMap[t];if(n)for(var i=0;i<n.length;i++)if(n[i]===e)return n.splice(i,1),0==n.length&&(delete this._eventMap[t],this._setEventEnable()),!0;return!1},_removeEventListenerByType:function(t){return!this._eventMap[t]&&(delete this._eventMap[t],this._setEventEnable(),!0)},_removeAllEventListeners:function(){this._eventMap={},this._eventEnabled=!1},_dispatchEvent:function(t){if(e=this._eventMap[t.type]){t.target||(t.target=this),t.currentTarget||(t.currentTarget=this);for(var e=e.slice(),n=0;n<e.length;n++){var i=e[n];"function"==typeof i&&i.call(this,t)}}return t._stopPropagation||this.parent&&(t.currentTarget=this.parent,this.parent._dispatchEvent(t)),!0},_hasEventListener:function(t){t=this._eventMap[t];return null!=t&&0<t.length}};var Dispatcher=function(){_inherits(e,Manager);var t=_createSuper(e);function e(){return _classCallCheck(this,e),t.call(this)}return _createClass(e,[{key:"on",value:function(t,e){return this._addEventListener(t,e),this}},{key:"addEventListener",value:function(t,e){return this._addEventListener(t,e),this}},{key:"un",value:function(t,e){return this._removeEventListener(t,e),this}},{key:"removeEventListener",value:function(t,e){return this._removeEventListener(t,e),this}},{key:"removeEventListenerByType",value:function(t){return this._removeEventListenerByType(t),this}},{key:"removeAllEventListeners",value:function(){return this._removeAllEventListeners(),this}},{key:"fire",value:function(t,e){var n=new Event(t);if(e)for(var i in e)"type"!=i&&(n[i]=e[i]);var a=this;return _.each(t.split(" "),function(t){(n.currentTarget=a).dispatchEvent(n)}),this}},{key:"dispatchEvent",value:function(t){var e,n,i;if(this.children&&t.point)(e=this.getObjectsUnderPoint(t.point,1)[0])&&e.dispatchEvent(t);else{if(!this.context||"mouseover"!=t.type)return this._dispatchEvent(t),this.context&&"mouseout"==t.type&&this._hoverClass&&this.hoverClone&&(i=this.getStage().parent,this._hoverClass=!1,i._bufferStage.removeChildById(this.id),this._globalAlpha&&(this.context.globalAlpha=this._globalAlpha,delete this._globalAlpha)),this;e=this._heartBeatNum,n=this.context.$model.globalAlpha,this._dispatchEvent(t),e!=this._heartBeatNum&&(this._hoverClass=!0,this.hoverClone&&(i=this.getStage().parent,(t=this.clone(!0))._transform=this.getConcatenatedMatrix(),i._bufferStage.addChildAt(t,0),this._globalAlpha=n,this.context.globalAlpha=0))}}},{key:"hasEvent",value:function(t){return this._hasEventListener(t)}},{key:"hasEventListener",value:function(t){return this._hasEventListener(t)}},{key:"hover",value:function(t,e){return this.on("mouseover",t),this.on("mouseout",e),this}},{key:"once",value:function(e,n){var i=this;return this.on(e,function t(){n.apply(i,arguments),this.un(e,t)}),this}}]),e}(),Handler=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.canvax=t,this.curPoints=[{x:0,y:0}],this.curPointsTarget=[],this._touching=!1,this._draging=!1,this._cursor="default",this.target=this.canvax.view,this.drag={start:"panstart",move:"panmove",end:"panend"},this._opt=e,_.extend(!0,this,e)},contains=document&&document.compareDocumentPosition?function(t,e){return!!e&&!!(16&t.compareDocumentPosition(e))}:function(t,e){return!!e&&(e!=e&&(!t.contains||t.contains(e)))},event=(Handler.prototype={init:function(){var e=this;this._opt.events&&types.register(this._opt.events),e.target&&(e.target.nodeType,$.addEvent(e.target,"contextmenu",function(t){t&&t.preventDefault?t.preventDefault():window.event.returnValue=!1}),_.each(types.get(),function(t){1==e.target.nodeType?$.addEvent(e.target,t,function(t){e.__mouseHandler(t)}):e.target.on(t,function(t){e.__libHandler(t)})}))},bindEventHandle:function(t,e){("mouse"==e?this.__mouseHandler:this.__libHandler).apply(this,[t])},__mouseHandler:function(t){var e,n=this,i=n.canvax,a=(i.updateViewOffset(),n.curPoints=[{x:$.pageX(t)-i.viewOffset.left,y:$.pageY(t)-i.viewOffset.top}],n.curPoints[0]),r=n.curPointsTarget[0];-1<_.indexOf(["mousedown","mouseover","click"],t.type)&&!r&&(r||(e=i.getObjectsUnderPoint(a,1)[0])&&(n.curPointsTarget=[e]),r=n.curPointsTarget[0]),"mousedown"==t.type&&r&&r.dragEnabled&&(n._touching=!0),"mouseup"!=t.type&&("mouseout"!=t.type||contains(i.view,t.toElement||t.relatedTarget))||(1==n._draging&&(n._dragEnd(t,r,0),r.fire("dragend")),n._draging=!1,n._touching=!1),"mouseout"==t.type?contains(i.view,t.toElement||t.relatedTarget)||n.__getcurPointsTarget(t,a,!0):"mousemove"==t.type?n._touching&&"mousemove"==t.type&&r?(n._draging?n._dragIngHander(t,r,0):(r.fire("dragstart"),r._globalAlpha||(r._globalAlpha=r.context.$model.globalAlpha),r.context.globalAlpha=0,n._clone2hoverStage(r,0).context.globalAlpha=r._globalAlpha),n._draging=!0):n.__getcurPointsTarget(t,a):(e=(e=r)||i,n.__dispatchEventInChilds(t,[e]),n._cursorHander(e)),(i.preventDefault||t._preventDefault)&&(t&&t.preventDefault?t.preventDefault():window.event.returnValue=!1)},__getcurPointsTarget:function(t,e,n){var i=this,a=i.canvax,r=i.curPointsTarget[0];r&&!r.context&&(r=null),"mousemove"==(t=new Event(t)).type&&r&&r._hoverClass&&r.hoverClone&&r.pointChkPriority&&r.getChildInPoint(e)?(t.target=t.currentTarget=r,t.point=r.globalToLocal(e),r.dispatchEvent(t)):(n=n?null:a.getObjectsUnderPoint(e,1)[0],(r&&r!=n||"mouseout"==t.type)&&r&&r.context&&(i.curPointsTarget[0]=null,t.type="mouseout",t.toTarget=n,t.target=t.currentTarget=r,t.point=r.globalToLocal(e),r.dispatchEvent(t)),n&&r!=n&&(i.curPointsTarget[0]=n,t.type="mouseover",t.fromTarget=r,t.target=t.currentTarget=n,t.point=n.globalToLocal(e),n.dispatchEvent(t)),"mousemove"==t.type&&n&&(t.target=t.currentTarget=r,t.point=r.globalToLocal(e),r.dispatchEvent(t)),i._cursorHander(n,r))},_cursorHander:function(t,e){t||e||this._setCursor("default"),t&&e!=t&&t.context&&this._setCursor(t.context.$model.cursor)},_setCursor:function(t){this._cursor!=t&&(this.canvax.view.style.cursor=t,this._cursor=t)},__libHandler:function(n){var i=this,t=i.canvax;t.updateViewOffset(),i.curPoints=i.__getCanvaxPointInTouchs(n),i._draging||(i.curPointsTarget=i.__getChildInTouchs(i.curPoints)),0<i.curPointsTarget.length?(-1<i.drag.start.indexOf(n.type)&&_.each(i.curPointsTarget,function(t,e){if(t&&t.dragEnabled)return i._draging=!0,t._globalAlpha||(t._globalAlpha=t.context.$model.globalAlpha),i._clone2hoverStage(t,e),t.context.globalAlpha=0,t.fire("dragstart"),!1}),-1<i.drag.move.indexOf(n.type)&&i._draging&&_.each(i.curPointsTarget,function(t,e){t&&t.dragEnabled&&i._dragIngHander(n,t,e)}),-1<i.drag.end.indexOf(n.type)&&i._draging&&(_.each(i.curPointsTarget,function(t,e){t&&t.dragEnabled&&(i._dragEnd(n,t,0),t.fire("dragend"))}),i._draging=!1),i.__dispatchEventInChilds(n,i.curPointsTarget)):i.__dispatchEventInChilds(n,[t])},__getCanvaxPointInTouchs:function(t){var e=this.canvax,n=[];return _.each(t.point||t.touches,function(t){n.push({x:"x"in t?t.x:$.pageX(t)-e.viewOffset.left,y:"y"in t?t.y:$.pageY(t)-e.viewOffset.top})}),n},__getChildInTouchs:function(t){var e=this.canvax,n=[];return _.each(t,function(t){n.push(e.getObjectsUnderPoint(t,1)[0])}),n},__dispatchEventInChilds:function(i,t){if(!(t||"length"in t))return!1;var a=this;_.each(t,function(t,e){var n;t&&((n=new Event(i)).stagePoint=a.curPoints[e],n.point=t.globalToLocal(n.stagePoint),t.dispatchEvent(n))})},_clone2hoverStage:function(t,e){var n=this.canvax,i=n._bufferStage.getChildById(t.id);return i||((i=t.clone(!0))._transform=t.getConcatenatedMatrix(),n._bufferStage.addChildAt(i,0)),i.context.globalAlpha=t._globalAlpha,t._dragPoint=t.globalToLocal(this.curPoints[e]),i},_dragIngHander:function(t,e,n){var i=this.canvax,n=e.globalToLocal(this.curPoints[n]),a=(e._noHeart=!0,e.moveing),n=(e.moveing=!0,e.context.x+=n.x-e._dragPoint.x,e.context.y+=n.y-e._dragPoint.y,e.fire("draging"),e.moveing=a,e._noHeart=!1,i._bufferStage.getChildById(e.id));n._transform=e.getConcatenatedMatrix(),n.worldTransform=null,n.heartBeat()},_dragEnd:function(t,e,n){var i=this.canvax._bufferStage.getChildById(e.id);i&&i.destroy(),e.context.globalAlpha=e._globalAlpha}},{Event:Event,Dispatcher:Dispatcher,Handler:Handler,Manager:Manager,types:types}),Matrix=function(t,e,n,i,a,r){this.a=null!=t?t:1,this.b=null!=e?e:0,this.c=null!=n?n:0,this.d=null!=i?i:1,this.tx=null!=a?a:0,this.ty=null!=r?r:0,this.array=null},Point=(Matrix.prototype={concat:function(t){var e=this.a,n=this.c,i=this.tx;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d,this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this},concatTransform:function(t,e,n,i,a){var r=1,o=0;return a%360&&(a=a*Math.PI/180,r=Math.cos(a),o=Math.sin(a)),this.concat(new Matrix(r*n,o*n,-o*i,r*i,t,e)),this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,a=this.c,r=this.tx;return 0<t?(this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=a*e-this.d*n,this.d=a*n+this.d*e,this.tx=r*e-this.ty*n,this.ty=r*n+this.ty*e):(n=Math.sin(Math.abs(t)),e=Math.cos(Math.abs(t)),this.a=i*e+this.b*n,this.b=-i*n+this.b*e,this.c=a*e+this.d*n,this.d=-a*n+e*this.d,this.tx=e*r+n*this.ty,this.ty=e*this.ty-n*r),this},scale:function(t,e){return this.a*=t,this.d*=e,this.tx*=t,this.ty*=e,this},translate:function(t,e){return this.tx+=t,this.ty+=e,this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},invert:function(){var t=this.a,e=this.b,n=this.c,i=this.d,a=this.tx,r=t*i-e*n;return this.a=i/r,this.b=-e/r,this.c=-n/r,this.d=t/r,this.tx=(n*this.ty-i*a)/r,this.ty=-(t*this.ty-e*a)/r,this},clone:function(){return new Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty)},toArray:function(t,e){if(0==arguments.length)return isNaN(this.a)||isNaN(this.b)||isNaN(this.c)||isNaN(this.d)||isNaN(this.tx)||isNaN(this.ty)?null:[this.a,this.b,this.c,this.d,this.tx,this.ty];this.array||(this.array=new Float32Array(9));e=e||this.array;return t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0),e[8]=1,e},mulVector:function(t){var e=this.a,n=this.c,i=this.tx,a=this.b,r=this.d,o=this.ty,l=[0,0];return l[0]=t[0]*e+t[1]*n+i,l[1]=t[0]*a+t[1]*r+o,l}},function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(_classCallCheck(this,r),1==arguments.length&&"object"==_typeof(arguments[0])){var n=arguments[0];if("x"in n&&"y"in n)this.x=+n.x,this.y=+n.y;else{var i,a=0;for(i in n){if(0!=a){this.y=+n[i];break}this.x=+n[i],a++}}}else this.x=+t,this.y=+e}return _createClass(r,[{key:"toArray",value:function(){return[this.x,this.y]}}]),r}()),Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},Bounce:{In:function(t){return 1-Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*Easing.Bounce.In(2*t):.5*Easing.Bounce.Out(2*t-1)+.5}}},now="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},now$1=now,Group=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,e){void 0===t&&(t=now$1()),void 0===e&&(e=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;0<n.length;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var a=this._tweens[n[i]];a&&!1===a.update(t,!e)&&!e&&delete this._tweens[n[i]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),Interpolation={Linear:function(t,e){var n=t.length-1,i=n*e,a=Math.floor(i),r=Interpolation.Utils.Linear;return e<0?r(t[0],t[1],i):1<e?r(t[n],t[n-1],n-i):r(t[a],t[n<a+1?n:a+1],i-a)},Bezier:function(t,e){for(var n=0,i=t.length-1,a=Math.pow,r=Interpolation.Utils.Bernstein,o=0;o<=i;o++)n+=a(1-e,i-o)*a(e,o)*t[o]*r(i,o);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,a=Math.floor(i),r=Interpolation.Utils.CatmullRom;return t[0]===t[n]?r(t[((a=e<0?Math.floor(i=n*(1+e)):a)-1+n)%n],t[a],t[(a+1)%n],t[(a+2)%n],i-a):e<0?t[0]-(r(t[0],t[0],t[1],t[1],-i)-t[0]):1<e?t[n]-(r(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):r(t[a?a-1:0],t[a],t[n<a+1?n:a+1],t[n<a+2?n:a+2],i-a)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var i=[1];return function(t){var e=1;if(i[t])return i[t];for(var n=t;1<n;n--)e*=n;return i[t]=e}}(),CatmullRom:function(t,e,n,i,a){var t=.5*(n-t),i=.5*(i-e),r=a*a;return(2*e-2*n+t+i)*(a*r)+(-3*e+3*n-2*t-i)*r+t*a+e}}},Sequence=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),mainGroup=new Group,Tween=function(){function t(t,e){void 0===e&&(e=mainGroup),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Easing.Linear.None,this._interpolationFunction=Interpolation.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=Sequence.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},t.prototype.duration=function(t){return this._duration=t,this},t.prototype.start=function(t){if(!this._isPlaying){if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==t?"string"==typeof t?now$1()+parseFloat(t):t:now$1(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat)}return this},t.prototype._setupProperties=function(t,e,n,i){for(var a in n){var r=t[a],o=Array.isArray(r),l=o?"array":typeof r,s=!o&&Array.isArray(n[a]);if("undefined"!=l&&"function"!=l){if(s){var u=n[a];if(0===u.length)continue;u=u.map(this._handleRelativeValue.bind(this,r)),n[a]=[r].concat(u)}if("object"!=l&&!o||!r||s)void 0===e[a]&&(e[a]=r),o||(e[a]*=1),i[a]=s?n[a].slice().reverse():e[a]||0;else{for(var d in e[a]=o?[]:{},r)e[a][d]=r[d];i[a]=o?[]:{},this._setupProperties(r,e[a],n[a],i[a])}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying&&(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object)),this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(t){return void 0===t&&(t=now$1()),!this._isPaused&&this._isPlaying&&(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},t.prototype.resume=function(t){return void 0===t&&(t=now$1()),this._isPaused&&this._isPlaying&&(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this)),this},t.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},t.prototype.group=function(t){return this._group=t,this},t.prototype.delay=function(t){return this._delayTime=t,this},t.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},t.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},t.prototype.yoyo=function(t){return this._yoyo=t,this},t.prototype.easing=function(t){return this._easingFunction=t,this},t.prototype.interpolation=function(t){return this._interpolationFunction=t,this},t.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},t.prototype.onStart=function(t){return this._onStartCallback=t,this},t.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},t.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},t.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},t.prototype.onStop=function(t){return this._onStopCallback=t,this},t.prototype.update=function(t,e){if(void 0===t&&(t=now$1()),void 0===e&&(e=!0),this._isPaused)return!0;var n,i=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(i<t)return!1;e&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(t-this._startTime)/this._duration;i=0===this._duration||1<i?1:i,e=this._easingFunction(i);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,e),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1!==i)return!0;if(0<this._repeat){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,r=this._chainedTweens.length;a<r;a++)this._chainedTweens[a].start(this._startTime+this._duration);return this._isPlaying=!1},t.prototype._updateProperties=function(t,e,n,i){for(var a in n){var r,o,l,s;void 0!==e[a]&&(r=e[a]||0,o=n[a],l=Array.isArray(t[a]),s=Array.isArray(o),!l&&s?t[a]=this._interpolationFunction(o,i):"object"==typeof o&&o?this._updateProperties(t[a],r,o,i):"number"==typeof(o=this._handleRelativeValue(r,o))&&(t[a]=r+(o-r)*i))}},t.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},t.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],n=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof n?this._valuesStartRepeat[t]+parseFloat(n):this._valuesEnd[t],this._valuesEnd[t]=e},t}(),VERSION="18.6.4",nextId=Sequence.nextId,TWEEN=mainGroup,getAll=TWEEN.getAll.bind(TWEEN),removeAll=TWEEN.removeAll.bind(TWEEN),add=TWEEN.add.bind(TWEEN),remove=TWEEN.remove.bind(TWEEN),update=TWEEN.update.bind(TWEEN),exports$1={Easing:Easing,Group:Group,Interpolation:Interpolation,now:now$1,Sequence:Sequence,nextId:nextId,Tween:Tween,VERSION:VERSION,getAll:getAll,removeAll:removeAll,add:add,remove:remove,update:update},lastTime=0,_globalAnimationEnabled=!0;if("undefined"!=typeof window)for(var requestAnimationFrame=window.requestAnimationFrame,cancelAnimationFrame=window.cancelAnimationFrame,vendors=["ms","moz","webkit","o"],x=0;x<vendors.length&&!window.requestAnimationFrame;++x)requestAnimationFrame=window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"],cancelAnimationFrame=window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"];requestAnimationFrame=requestAnimationFrame||function(t,e){var n=(new Date).getTime(),i=Math.max(0,16-(n-lastTime)),a=setTimeout(function(){t(n+i)},i);return lastTime=n+i,a},cancelAnimationFrame=cancelAnimationFrame||function(t){clearTimeout(t)};var _taskList=[],_requestAid=null;function enabledAnimationFrame(){return _requestAid=_requestAid||requestAnimationFrame(function(){exports$1.update();var t=_taskList;for(_taskList=[],_requestAid=null;0<t.length;)t.shift().task()})}function registFrame(t){if(t)return _taskList.push(t),enabledAnimationFrame()}function destroyFrame(t){for(var e=!1,n=0,i=_taskList.length;n<i;n++)_taskList[n].id===t.id&&(e=!0,_taskList.splice(n,1),n--,i--);return 0==_taskList.length&&(cancelAnimationFrame(_requestAid),_requestAid=null),e}function registTween(t){var e=_.extend({from:null,to:null,duration:500,onStart:function(){},onUpdate:function(){},onComplete:function(){},onStop:function(){},repeat:0,delay:0,easing:"Linear.None",desc:""},t),n=(getAnimationEnabled()||(e.duration=0,e.delay=0),{}),i="tween_"+Utils.getUID();return e.id&&(i=i+"_"+e.id),e.from&&e.to&&(t=function t(){n._isCompleteed||n._isStoped?n=null:registFrame({id:i,task:t,desc:e.desc,tween:n})},(n=new exports$1.Tween(e.from).to(e.to,e.duration).onStart(function(){e.onStart(e.from)}).onUpdate(function(){e.onUpdate(e.from)}).onComplete(function(){destroyFrame({id:i}),n._isCompleteed=!0,e.onComplete(e.from)}).onStop(function(){destroyFrame({id:i}),n._isStoped=!0,e.onStop(e.from)}).repeat(e.repeat).delay(e.delay).easing(exports$1.Easing[e.easing.split(".")[0]][e.easing.split(".")[1]])).id=i,n.start(),t()),n}function destroyTween(t,e){t.stop()}function setAnimationEnabled(t){_globalAnimationEnabled=t}function getAnimationEnabled(){return _globalAnimationEnabled}var AnimationFrame={setAnimationEnabled:setAnimationEnabled,getAnimationEnabled:getAnimationEnabled,registFrame:registFrame,destroyFrame:destroyFrame,registTween:registTween,destroyTween:destroyTween,Tween:exports$1,taskList:_taskList};function Observe(e){var t,l=!0,s={},n={},i=["$watch","$model"],u={},a=i;for(t in e)!function(r,t){-1===_.indexOf(i,r)&&(u[r]=t);var o=_typeof(t);-1<_.indexOf(a,r)||("function"===o?a.push(r):n[r]={set:t=function(t){var e,n=u[r],i=n;if(!arguments.length)return!n||"object"!==o||n instanceof Array||n.$model||n.addColorStop||((n=Observe(n)).$watch=s.$watch,u[r]=n),n;var a=_typeof(t);l||n!==t&&(!t||"object"!==a||t instanceof Array||t.addColorStop?n=t:e=(n=t.$model?t:Observe(t)).$model,u[r]=e||n,o!=a&&(o=a),s.$watch&&s.$watch.call(s,r,n,i))},get:t,enumerable:!0})}(t,e[t]);return s=defineProperties(s,n,a),_.forEach(a,function(t){e[t]&&("function"==typeof e[t]?s[t]=function(){e[t].apply(this,arguments)}:s[t]=e[t])}),s.$model=u,s.hasOwnProperty=function(t){return t in s.$model},l=!1,s}var defineProperty=Object.defineProperty;try{defineProperty({},"_",{value:"x"});var defineProperties=Object.defineProperties}catch(t){"__defineGetter__"in Object&&(defineProperty=function(t,e,n){return"value"in n&&(t[e]=n.value),"get"in n&&t.__defineGetter__(e,n.get),"set"in n&&t.__defineSetter__(e,n.set),t},defineProperties=function(t,e){for(var n in e)e.hasOwnProperty(n)&&defineProperty(t,n,e[n]);return t})}var RENDERER_TYPE={UNKNOWN:0,WEBGL:1,CANVAS:2},SHAPES={POLY:0,RECT:1,CIRC:2,ELIP:3},TRANSFORM_PROPS=["x","y","scaleX","scaleY","rotation","scaleOrigin","rotateOrigin"],STYLE_PROPS=["lineWidth","strokeAlpha","strokeStyle","fillStyle","fillAlpha","globalAlpha","shadowOffsetX","shadowOffsetY","shadowColor","shadowBlur"],_isInsideLine=function(t,e,n,i){var a=t[0],r=t[1],o=t[2],t=t[3],i=Math.max(i,3),l=0,s=a;return!(r+i<n&&t+i<n||n<r-i&&n<t-i||a+i<e&&o+i<e||e<a-i&&e<o-i)&&(a===o?Math.abs(e-a)<=i/2:((l=(r-t)/(a-o))*e-n+(s=(a*t-o*r)/(a-o)))*(l*e-n+s)/(l*l+1)<=i/2*i/2)};function insideLine(t,e,n,i){for(var a=t.shape.points,r=t.lineWidth,o=!1,l=0;l<a.length&&!(o=_isInsideLine(a.slice(l,l+4),e,n,r));++l)l+=1;return o}function _createSuper$1(n){var i=_isNativeReflectConstruct$1();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$1(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var DisplayObject=function(t){_inherits(a,t);var i=_createSuper$1(a);function a(t){_classCallCheck(this,a),(e=i.call(this,t))._transform=null,e.worldTransform=null,e._transformChange=!1,e._heartBeatNum=0,e.stage=null,e.parent=null,e.xyToInt=!("xyToInt"in t)||t.xyToInt,e.moveing=!1,e.clip=null,e.context=e._createContext(t),e.type=t.type||"DisplayObject",e.id=t.id||Utils.createId(e.type),e._trackList=[],e.init.apply(_assertThisInitialized(e),arguments),e._updateTransform(),e._tweens=[];var e,n=_assertThisInitialized(e);return e.on("destroy",function(){n.cleanAnimates()}),e}return _createClass(a,[{key:"init",value:function(){}},{key:"clipTo",value:function(t){(this.clip=t).isClip=!0}},{key:"_createContext",value:function(t){var a=this,e=t.context||{},e={width:e.width||0,height:e.height||0,x:e.x||0,y:e.y||0,scaleX:e.scaleX||1,scaleY:e.scaleY||1,scaleOrigin:e.scaleOrigin||{x:0,y:0},rotation:e.rotation||0,rotateOrigin:e.rotateOrigin||{x:0,y:0},visible:e.visible||!0,globalAlpha:e.globalAlpha||1};return _.extend(!0,e,t.context),a._notWatch=!1,a._noHeart=!1,e.$watch=function(t,e,n){var i=a;i.context&&("globalGalpha"==t&&(i._globalAlphaChange=!0),-1<_.indexOf(TRANSFORM_PROPS,t)&&(i._updateTransform(),i._transformChange=!0),i._notWatch||(i.$watch&&(i._notWatch=!0,i.$watch(t,e,n),i._notWatch=!1),i._noHeart||i.heartBeat({convertType:"context",shape:i,name:t,value:e,preValue:n})))},Observe(e)}},{key:"track",value:function(t){-1==_.indexOf(this._trackList,t)&&this._trackList.push(t)}},{key:"untrack",value:function(t){t=_.indexOf(this._trackList,t);-1<t&&this._trackList.splice(t,1)}},{key:"clone",value:function(t){var e={id:this.id,context:_.clone(this.context.$model),isClone:!0},n="text"==this.type?new this.constructor(this.text,e):new this.constructor(e);return n.id=e.id,this.children&&(n.children=this.children),this.graphics&&(n.graphics=this.graphics.clone()),t||(n.id=Utils.createId(n.type)),n}},{key:"heartBeat",value:function(t){var e=this.getStage();e&&(this._heartBeatNum++,e.heartBeat&&e.heartBeat(t))}},{key:"getCurrentWidth",value:function(){return Math.abs(this.context.$model.width*this.context.$model.scaleX)}},{key:"getCurrentHeight",value:function(){return Math.abs(this.context.$model.height*this.context.$model.scaleY)}},{key:"getStage",value:function(){if(this.stage)return this.stage;var t=this;if("stage"!=t.type){for(;t.parent&&"stage"!=(t=t.parent).type;);if("stage"!==t.type)return!1}return this.stage=t}},{key:"localToGlobal",value:function(t,e){t=t||new Point(0,0);e=this.getConcatenatedMatrix(e);if(null==e)return Point(0,0);t=new Matrix(1,0,0,1,t.x,t.y);return t.concat(e),new Point(t.tx,t.ty)}},{key:"globalToLocal",value:function(t,e){if(t=t||new Point(0,0),"stage"==this.type)return t;e=this.getConcatenatedMatrix(e);if(null==e)return new Point(0,0);e.invert();t=new Matrix(1,0,0,1,t.x,t.y);return t.concat(e),new Point(t.tx,t.ty)}},{key:"localToTarget",value:function(t,e){t=localToGlobal(t);return e.globalToLocal(t)}},{key:"getConcatenatedMatrix",value:function(t){for(var e=new Matrix,n=this;null!=n;n=n.parent)if(e.concat(n._transform),!n.parent||t&&n.parent&&n.parent==t||n.parent&&"stage"==n.parent.type)return e;return e}},{key:"setEventEnable",value:function(t){return!!_.isBoolean(t)&&(this._eventEnabled=t,!0)}},{key:"getIndex",value:function(){if(this.parent)return _.indexOf(this.parent.children,this)}},{key:"toBack",value:function(t){if(this.parent){var e=this.getIndex(),n=0;if(_.isNumber(t)){if(0==t)return;n=e-t}t=this.parent.children.splice(e,1)[0];this.parent.addChildAt(t,n=n<0?0:n)}}},{key:"toFront",value:function(t){if(this.parent){var e=this.getIndex(),n=this.parent.children.length,i=n;if(_.isNumber(t)){if(0==t)return;i=e+t+1}t=this.parent.children.splice(e,1)[0];this.parent.addChildAt(t,(i=n<i?n:i)-1)}}},{key:"_updateTransform",value:function(){var t,e,n,i=new Matrix,a=(i.identity(),this.context),r=(1===a.scaleX&&1===a.scaleY||(t=new Point(a.scaleOrigin),i.translate(-t.x,-t.y),i.scale(a.scaleX,a.scaleY),i.translate(t.x,t.y)),a.rotation);return r&&(t=new Point(a.rotateOrigin),i.translate(-t.x,-t.y),i.rotate(r%360*Math.PI/180),i.translate(t.x,t.y)),this.xyToInt&&!this.moveing?(e=parseInt(a.x),n=parseInt(a.y),parseInt(a.lineWidth,10)%2==1&&a.strokeStyle&&(e+=.5,n+=.5)):(e=a.x,n=a.y),0==e&&0==n||i.translate(e,n),this._transform=i}},{key:"setWorldTransform",value:function(){var t=new Matrix;return t.concat(this._transform),this.parent&&t.concat(this.parent.worldTransform),this.worldTransform=t,this.worldTransform}},{key:"getChildInPoint",value:function(t){var e,n,i=!1,a=t.x,t=t.y;return this.worldTransform&&(n=this.worldTransform.clone().invert(),e=[a*Settings.RESOLUTION,t*Settings.RESOLUTION],a=(e=n.mulVector(e))[0],t=e[1]),this.graphics&&(i=this.containsPoint({x:a,y:t})),"text"==this.type?!(!(n=this.getRect()).width||!n.height)&&(a>=n.x&&a<=n.x+n.width&&(0<=n.height&&t>=n.y&&t<=n.y+n.height||n.height<0&&t<=n.y&&t>=n.y+n.height)):i}},{key:"containsPoint",value:function(t){for(var e=!1,n=0;n<this.graphics.graphicsData.length;++n){var i=this.graphics.graphicsData[n];if(i.shape){if(i.hasFill()&&i.shape.contains(t.x,t.y)&&(e=!0))break;if(i.hasLine()&&i.shape.points&&(e=insideLine(i,t.x,t.y)))break}}return e}},{key:"animate",value:function(t,e,n){if(n=n||this.context){var i,a,r,o,l,s=t,u=null;for(i in s)_.isObject(s[i])?this.animate(s[i],_.extend({},e),n[i]):isNaN(s[i])&&""!==s[i]&&null!==s[i]?(n[i]=s[i],delete s[i]):(u=u||{})[i]=n[i];if(u)return(e=e||{}).from=u,e.to=s,a=this,r=function(){},e.onUpdate&&(r=e.onUpdate),e.onUpdate=function(t){if(!n&&o)AnimationFrame.destroyTween(o),o=null;else{for(var e in t)n[e]=t[e];r.apply(a,[t])}},l=function(){},e.onComplete&&(l=e.onComplete),e.onComplete=function(t){l.apply(a,arguments),a._removeTween(o)},e.onStop=function(){a._removeTween(o)},e.desc="tweenType:DisplayObject.animate__id:"+this.id+"__objectType:"+this.type,o=AnimationFrame.registTween(e),this._tweens.push(o),o}}},{key:"_removeTween",value:function(t){for(var e=0;e<this._tweens.length;e++)if(t==this._tweens[e]){this._tweens.splice(e,1);break}}},{key:"removeAnimate",value:function(t){t.stop(),this._removeTween(t)}},{key:"cleanAnimates",value:function(){this._cleanAnimates()}},{key:"_cleanAnimates",value:function(){for(;this._tweens.length;)this._tweens.shift().stop()}},{key:"remove",value:function(){this.parent&&(this.parent.removeChild(this),this.parent=null)}},{key:"destroy",value:function(){this._destroy()}},{key:"_destroy",value:function(){this.remove(),this.fire("destroy"),this.context=null,delete this.context}}]),a}(event.Dispatcher);function _createSuper$2(n){var i=_isNativeReflectConstruct$2();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$2(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var DisplayObjectContainer=function(){_inherits(o,DisplayObject);var e=_createSuper$2(o);function o(t){return _classCallCheck(this,o),(t=e.call(this,t)).children=[],t._eventEnabled=!0,t}return _createClass(o,[{key:"addChild",value:function(t,e){if(t)return-1!=this.getChildIndex(t)?t.parent=this:(t.parent&&t.parent.removeChild(t),void 0===e&&(e=this.children.length),this.children.splice(e,0,t),(t.parent=this).heartBeat&&this.heartBeat({convertType:"children",target:t,src:this}),this._afterAddChild&&this._afterAddChild(t)),t}},{key:"addChildAt",value:function(t,e){return this.addChild(t,e)}},{key:"removeChild",value:function(t){return this.removeChildAt(_.indexOf(this.children,t))}},{key:"removeChildAt",value:function(t){if(t<0||t>this.children.length-1)return!1;var e=this.children[t];return null!=e&&(e.parent=null),this.children.splice(t,1),this.heartBeat&&this.heartBeat({convertType:"children",target:e,src:this}),this._afterDelChild&&this._afterDelChild(e,t),e}},{key:"removeChildById",value:function(t){for(var e=0,n=this.children.length;e<n;e++)if(this.children[e].id==t)return this.removeChildAt(e);return!1}},{key:"removeAllChildren",value:function(){for(;0<this.children.length;)this.removeChildAt(0)}},{key:"destroy",value:function(){for(var t=0,e=this.children.length;t<e;t++)this.getChildAt(t).destroy(),t--,e--;this._destroy()}},{key:"cleanAnimates",value:function(){for(var t=0,e=this.children.length;t<e;t++)this.getChildAt(t).cleanAnimates();this._cleanAnimates()}},{key:"getChildById",value:function(t,e){if(!e)for(var n=0,i=this.children.length;n<i;n++)if(this.children[n].id==t)return this.children[n];return null}},{key:"getChildAt",value:function(t){return t<0||t>this.children.length-1?null:this.children[t]}},{key:"getChildIndex",value:function(t){return _.indexOf(this.children,t)}},{key:"setChildIndex",value:function(t,e){var n;t.parent==this&&e!=(n=_.indexOf(this.children,t))&&(this.children.splice(n,1),this.children.splice(e,0,t))}},{key:"getNumChildren",value:function(){return this.children.length}},{key:"getObjectsUnderPoint",value:function(t,e){for(var n=[],i=this.children.length-1;0<=i;i--){var a,r=this.children[i];if(null!=r&&r.context.$model.visible)if(r instanceof o)r._eventEnabled&&0<r.getNumChildren()&&(0<(a=r.getObjectsUnderPoint(t)).length&&(n=n.concat(a)));else if((r._eventEnabled||r.dragEnabled)&&r.getChildInPoint(t)&&(n.push(r),null!=e&&!isNaN(e)&&n.length==e))return n}return n}}]),o}();function _createSuper$3(n){var i=_isNativeReflectConstruct$3();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$3(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Stage=function(){_inherits(i,DisplayObjectContainer);var n=_createSuper$3(i);function i(t){var e;return _classCallCheck(this,i),t.type="stage",(e=n.call(this,t)).canvas=null,e.ctx=t.ctx||null,e.stageRending=!1,e._isReady=!1,e}return _createClass(i,[{key:"initStage",value:function(t,e,n){this.canvas=t;t=this.context;t.width=e,t.height=n,t.scaleX=Settings.RESOLUTION,t.scaleY=Settings.RESOLUTION,this._isReady=!0}},{key:"heartBeat",value:function(t){this._isReady&&((t=t||{}).stage=this).parent&&this.parent.heartBeat(t)}}]),i}(),SystemRenderer=function(){function a(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:RENDERER_TYPE.UNKNOWN,e=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0;if(_classCallCheck(this,a),this.type=t,this.app=e,n)for(var i in Settings.RENDER_OPTIONS)void 0===n[i]&&(n[i]=Settings.RENDER_OPTIONS[i]);else n=Settings.RENDER_OPTIONS;this.options=n,this.requestAid=null,this._heartBeat=!1,this._preRenderTime=0}return _createClass(a,[{key:"startEnter",value:function(){var t=this;t.requestAid||(t.requestAid=AnimationFrame.registFrame({id:"enterFrame",task:function(){t.enterFrame.apply(t)}}))}},{key:"enterFrame",value:function(){var t=this;t.requestAid=null,Utils.now=(new Date).getTime(),t._heartBeat&&(this.app.children.length&&t.render(this.app),t._heartBeat=!1,t._preRenderTime=(new Date).getTime())}},{key:"_convertCanvax",value:function(e){_.each(this.app.children,function(t){t.context[e.name]=e.value})}},{key:"heartBeat",value:function(t){var n=this;if(t){if("context"==t.convertType){var e=t.stage,i=t.shape;t.name,t.value,t.preValue;if("canvax"==i.type)n._convertCanvax(t);else if(n.app.convertStages[e.id]||(n.app.convertStages[e.id]={stage:e,convertShapes:{}}),i){if(n.app.convertStages[e.id].convertShapes[i.id])return;n.app.convertStages[e.id].convertShapes[i.id]={shape:i,convertType:t.convertType}}}"children"==t.convertType&&(i=t.target,!(e=t.src.getStage())&&"stage"!=i.type||n.app.convertStages[(e=e||i).id]||(n.app.convertStages[e.id]={stage:e,convertShapes:{}})),t.convertType||(e=t.stage,n.app.convertStages[e.id]||(n.app.convertStages[e.id]={stage:e,convertShapes:{}}))}else _.each(n.app.children,function(t,e){n.app.convertStages[t.id]={stage:t,convertShapes:{}}});n._heartBeat?n._heartBeat=!0:(n._heartBeat=!0,n.startEnter())}}]),a}(),arrayLikeToArray=createCommonjsModule$1(function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.default=t.exports,t.exports.__esModule=!0}),arrayWithoutHoles=(unwrapExports$1(arrayLikeToArray),createCommonjsModule$1(function(t){t.exports=function(t){if(Array.isArray(t))return arrayLikeToArray(t)},t.exports.default=t.exports,t.exports.__esModule=!0})),iterableToArray=(unwrapExports$1(arrayWithoutHoles),createCommonjsModule$1(function(t){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)},t.exports.default=t.exports,t.exports.__esModule=!0})),unsupportedIterableToArray=(unwrapExports$1(iterableToArray),createCommonjsModule$1(function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?arrayLikeToArray(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0})),nonIterableSpread=(unwrapExports$1(unsupportedIterableToArray),createCommonjsModule$1(function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0})),toConsumableArray=(unwrapExports$1(nonIterableSpread),createCommonjsModule$1(function(t){t.exports=function(t){return arrayWithoutHoles(t)||iterableToArray(t)||unsupportedIterableToArray(t)||nonIterableSpread()},t.exports.default=t.exports,t.exports.__esModule=!0})),_toConsumableArray=unwrapExports$1(toConsumableArray),CanvasGraphicsRenderer=function(){function e(t){_classCallCheck(this,e),this.renderer=t}return _createClass(e,[{key:"render",value:function(t,e,n,i){this.renderer;for(var a=t.graphics.graphicsData,r=e.ctx,o=0;o<a.length;o++){var l,s,u,d,h,c,f,p,g,y=a[o],_=y.shape,v=y.fillStyle,x=(v&&"object"==_typeof(v)&&(l=v.linearGradient||v.lineargradient)&&v.points&&function(){var e=r.createLinearGradient.apply(r,_toConsumableArray(v.points));l.forEach(function(t){e.addColorStop(t.position,t.color)}),v=e}(),y.strokeStyle),m=(x&&"object"==_typeof(x)&&(s=x.linearGradient||x.lineargradient)&&x.points&&function(){var e=r.createLinearGradient.apply(r,_toConsumableArray(x.points));s.forEach(function(t){e.addColorStop(t.position,t.color)}),x=e}(),y.hasFill()&&y.fillAlpha&&!i),b=y.hasLine()&&y.strokeAlpha&&!i;r.lineWidth=y.lineWidth,r.shadowColor=y.shadowColor,r.shadowBlur=y.shadowBlur,r.shadowOffsetX=y.shadowOffsetX,r.shadowOffsetY=y.shadowOffsetY,r.lineCap=y.lineCap,r.lineJoin=y.lineJoin,"miter"==r.lineJoin&&(r.miterLimit=y.miterLimit),y.type===SHAPES.POLY?(r.beginPath(),this.renderPolygon(_.points,_.closed,r,i),m&&(r.globalAlpha=y.fillAlpha*n,r.fillStyle=v,r.fill()),b&&(r.globalAlpha=y.strokeAlpha*n,r.strokeStyle=x,m&&y.shadowBlur&&(r.shadowBlur=0),r.stroke())):y.type===SHAPES.RECT?(i&&r.rect(_.x,_.y,_.width,_.height),m&&(r.globalAlpha=y.fillAlpha*n,r.fillStyle=v,r.fillRect(_.x,_.y,_.width,_.height)),b&&(r.globalAlpha=y.strokeAlpha*n,r.strokeStyle=x,m&&y.shadowBlur&&(r.shadowBlur=0),r.strokeRect(_.x,_.y,_.width,_.height))):y.type===SHAPES.CIRC?(r.beginPath(),r.arc(_.x,_.y,_.radius,0,2*Math.PI),r.closePath(),m&&(r.globalAlpha=y.fillAlpha*n,r.fillStyle=v,r.fill()),b&&(r.globalAlpha=y.strokeAlpha*n,r.strokeStyle=x,m&&y.shadowBlur&&(r.shadowBlur=0),r.stroke())):y.type===SHAPES.ELIP&&(p=2*_.width,g=2*_.height,u=_.x-p/2,_=_.y-g/2,r.beginPath(),d=p/2*.5522848,h=g/2*.5522848,c=u+p,f=_+g,p=u+p/2,r.moveTo(u,g=_+g/2),r.bezierCurveTo(u,g-h,p-d,_,p,_),r.bezierCurveTo(p+d,_,c,g-h,c,g),r.bezierCurveTo(c,g+h,p+d,f,p,f),r.bezierCurveTo(p-d,f,u,g+h,u,g),r.closePath(),m&&(r.globalAlpha=y.fillAlpha*n,r.fillStyle=v,r.fill()),b&&(r.globalAlpha=y.strokeAlpha*n,r.strokeStyle=x,m&&y.shadowBlur&&(r.shadowBlur=0),r.stroke()))}}},{key:"renderPolygon",value:function(t,e,n,i){n.moveTo(t[0],t[1]);for(var a=1;a<t.length/2;++a)n.lineTo(t[2*a],t[2*a+1]);(e||i)&&n.closePath()}}]),e}();function _createSuper$4(n){var i=_isNativeReflectConstruct$4();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$4(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var CanvasRenderer=function(){_inherits(i,SystemRenderer);var n=_createSuper$4(i);function i(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,i),(t=n.call(this,RENDERER_TYPE.CANVAS,t,e)).renderType="canvas",t.CGR=new CanvasGraphicsRenderer(_assertThisInitialized(t)),t}return _createClass(i,[{key:"render",value:function(t){var e=this;e.app=t,_.each(_.values(t.convertStages),function(t){e.renderStage(t.stage)}),t.convertStages={}}},{key:"renderStage",value:function(t){t.ctx||(t.ctx=t.canvas.getContext("2d")),t.stageRending=!0,t.setWorldTransform(),this._clear(t),this._render(t,t,t.context.globalAlpha),t.stageRending=!1}},{key:"_render",value:function(t,e,n){var i=t.ctx;if(i){var a=e.context.$model;if(e.worldTransform||e.fire("render"),(!e.worldTransform||e._transformChange||e.parent&&e.parent._transformChange)&&(e.setWorldTransform(),e.fire("transform"),e._transformChange=!0),n*=a.globalAlpha,a.visible&&!e.isClip){var r=e.worldTransform.toArray();if(r){i.setTransform.apply(i,r);var o,r=!1;if(e.clip&&e.clip.graphics&&(o=e.clip,i.save(),i.beginPath(),r=!0,o.worldTransform&&!o._transformChange&&!o.parent._transformChange||(o.setWorldTransform(),o._transformChange=!0),i.setTransform.apply(i,o.worldTransform.toArray()),o.graphics.graphicsData.length||o._draw(o.graphics),this.CGR.render(o,t,n,r),o._transformChange=!1,i.clip()),e.graphics&&(e.graphics.graphicsData.length||e._draw(e.graphics),n&&(i.setLineDash([]),a.lineType&&"solid"!=a.lineType&&i.setLineDash(a.lineDash),this.CGR.render(e,t,n))),"text"==e.type&&e.render(i,n),e.children)for(var l=0,s=e.children.length;l<s;l++)this._render(t,e.children[l],n);e._transformChange=!1,r&&(i.closePath(),i.restore()),i.draw&&i.draw(!0)}}}}},{key:"_clear",value:function(t){var e=t.ctx;e.setTransform.apply(e,t.worldTransform.toArray()),e.clearRect(0,0,this.app.width,this.app.height)}}]),i}();function _createSuper$5(n){var i=_isNativeReflectConstruct$5();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$5(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var AlipayMiniRenderer=function(){_inherits(i,CanvasRenderer);var n=_createSuper$5(i);function i(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,i),(t=n.call(this,t,e)).renderType="alipayMini",t}return i}();function autoRenderer(t,e){t=new("alipayMini"==e.renderer?AlipayMiniRenderer:CanvasRenderer)(t,e);return t}function _createSuper$6(n){var i=_isNativeReflectConstruct$6();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$6(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Application=function(){_inherits(a,DisplayObjectContainer);var i=_createSuper$6(a);function a(t){var e,n;return _classCallCheck(this,a),t.type="canvax",(e=i.call(this,t)).uid=t.uid||(new Date).getTime()+"_"+Math.floor(100*Math.random()),Settings.RESOLUTION=t.devicePixelRatio||("undefined"!=typeof window?window.devicePixelRatio:1),e.el=$.query(t.el),e.width=t.width||parseInt("width"in t||e.el.offsetWidth,10),e.height=t.height||parseInt("height"in t||e.el.offsetHeight,10),e.el&&(n=$.createView(e.width,e.height,e.uid),e.view=n.view,e.stageView=n.stageView,e.domView=n.domView,e.el.innerHTML="",e.el.appendChild(e.view)),e.viewOffset=t.viewOffset||$.offset(e.view),e.lastGetRO=0,e.renderer=autoRenderer(_assertThisInitialized(e),t),e.event=null,e.convertStages={},e.context.$model.width=e.width,e.context.$model.height=e.height,e._bufferStage=e._creatHoverStage(t),e.worldTransform=(new Matrix).identity(),e}return _createClass(a,[{key:"registEvent",value:function(t){return this.event=new event.Handler(this,t),this.event.init(),this.event}},{key:"destroy",value:function(){for(var t=0,e=this.children.length;t<e;t++){var n=this.children[t];n.destroy(),n.canvas=null,n.ctx=null,n=null,t--,e--}try{this.view.removeChild(this.stageView),this.view.removeChild(this.domView),this.el.removeChild(this.view)}catch(t){}this.el&&(this.el.innerHTML=""),this.event=null,this._bufferStage=null}},{key:"resize",value:function(t){this.width=parseInt(t&&"width"in t||this.el.offsetWidth,10),this.height=parseInt(t&&"height"in t||this.el.offsetHeight,10),this.view&&(this.viewOffset=$.offset(this.view)),this.context.$model.width=this.width,this.context.$model.height=this.height;var n=this;_.each(this.children,function(t,e){t.context.$model.width=n.width,t.context.$model.height=n.height,(t=t.canvas).style.width=n.width+"px",t.style.height=n.height+"px",t.setAttribute("width",n.width*Settings.RESOLUTION),t.setAttribute("height",n.height*Settings.RESOLUTION)}),this.stageView.style.width=this.width+"px",this.stageView.style.height=this.height+"px",this.domView.style.width=this.width+"px",this.domView.style.height=this.height+"px",this.heartBeat()}},{key:"getHoverStage",value:function(){return this._bufferStage}},{key:"_creatHoverStage",value:function(t){return this._bufferStage=new Stage({id:"activCanvas"+(new Date).getTime(),ctx:t.activCanvas||null}),this._bufferStage._eventEnabled=!1,this.addChild(this._bufferStage),this._bufferStage}},{key:"updateViewOffset",value:function(t){var e=(new Date).getTime();1e3<e-this.lastGetRO&&(this.viewOffset=t||$.offset(this.view),this.lastGetRO=e)}},{key:"_afterAddChild",value:function(t,e){var n=t.canvas||$.createCanvas(this.context.$model.width,this.context.$model.height,t.id);this.stageView&&(1==this.children.length?this.stageView.appendChild(n):1<this.children.length&&(void 0===e?this.stageView.insertBefore(n,this._bufferStage.canvas):e>=this.children.length-1?this.stageView.appendChild(n):this.stageView.insertBefore(n,this.children[e].canvas))),Utils.initElement(n),t.initStage(n,this.context.$model.width,this.context.$model.height)}},{key:"_afterDelChild",value:function(t){try{this.stageView&&t.canvas&&this.stageView.removeChild(t.canvas)}catch(t){}}},{key:"heartBeat",value:function(t){0<this.children.length&&this.renderer.heartBeat(t)}},{key:"toDataURL",value:function(){var t=$.createCanvas(this.width,this.height,"curr_base64_canvas"),e=t.getContext("2d");return _.each(this.children,function(t){e.drawImage(t.canvas,0,0)}),t.toDataURL()}},{key:"setPixelCtx",value:function(t){Utils._pixelCtx=t}}]),a}();function _createSuper$7(n){var i=_isNativeReflectConstruct$7();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$7(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Sprite=function(){_inherits(n,DisplayObjectContainer);var e=_createSuper$7(n);function n(t){return _classCallCheck(this,n),(t=Utils.checkOpt(t)).type="sprite",e.call(this,t)}return n}(),GraphicsData=function(){function f(t,e,n,i,a,r,o,l,s,u,d,h,c){_classCallCheck(this,f),this.lineWidth=t,this.strokeStyle=e,this.strokeAlpha=n,this.fillStyle=i,this.fillAlpha=a,this.shadowOffsetX=r,this.shadowOffsetY=o,this.shadowBlur=l,this.shadowColor=s,this.lineCap=u,this.lineJoin=d,this.miterLimit=h,this.shape=c,this.type=c.type,this.holes=[],this.fill=!0,this.line=!0}return _createClass(f,[{key:"clone",value:function(){var t=new f(this.lineWidth,this.strokeStyle,this.strokeAlpha,this.fillStyle,this.fillAlpha,this.shadowOffsetX,this.shadowOffsetY,this.shadowBlur,this.shadowColor,this.lineCap,this.lineJoin,this.miterLimit,this.shape);return t.fill=this.fill,t.line=this.line,t}},{key:"addHole",value:function(t){this.holes.push(t)}},{key:"synsStyle",value:function(t){this.line&&(this.lineWidth=t.lineWidth,this.strokeStyle=t.strokeStyle,this.strokeAlpha=t.strokeAlpha),this.fill&&(this.fillStyle=t.fillStyle,this.fillAlpha=t.fillAlpha),this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor,this.lineCap=t.lineCap,this.lineJoin=t.lineJoin,this.miterLimit=t.miterLimit}},{key:"hasFill",value:function(){return this.fillStyle&&this.fill&&void 0!==this.shape.closed&&this.shape.closed}},{key:"hasLine",value:function(){return this.strokeStyle&&this.lineWidth&&this.line}},{key:"destroy",value:function(){this.shape=null,this.holes=null}}]),f}(),arcToSegmentsCache={},segmentToBezierCache={},boundsOfCurveCache={},_join=Array.prototype.join;function arcToSegments(t,e,n,i,a,r,o){var l=_join.call(arguments);if(arcToSegmentsCache[l])return arcToSegmentsCache[l];for(var s=Math.PI,o=o*s/180,u=Math.sin(o),d=Math.cos(o),h=0,c=0,o=-d*t*.5-u*e*.5,f=-d*e*.5+u*t*.5,p=(n=Math.abs(n))*n,g=(i=Math.abs(i))*i,y=f*f,_=o*o,v=p*g-p*y-g*_,x=0,m=(v<0?(n*=m=Math.sqrt(1-v/(p*g)),i*=m):x=(a===r?-1:1)*Math.sqrt(v/(p*y+g*_)),x*n*f/i),a=-x*i*o/n,b=d*m-u*a+.5*t,w=u*m+d*a+.5*e,k=calcVectorAngle(1,0,(o-m)/n,(f-a)/i),v=calcVectorAngle((o-m)/n,(f-a)/i,(-o-m)/n,(-f-a)/i),C=(0===r&&0<v?v-=2*s:1===r&&v<0&&(v+=2*s),Math.ceil(Math.abs(v/s*2))),S=[],A=v/C,P=8/3*Math.sin(A/4)*Math.sin(A/4)/Math.sin(A/2),R=k+A,D=0;D<C;D++)S[D]=segmentToBezier(k,R,d,u,n,i,b,w,P,h,c),h=S[D][4],c=S[D][5],k=R,R+=A;return arcToSegmentsCache[l]=S}function segmentToBezier(t,e,n,i,a,r,o,l,s,u,d){var h,c,f=_join.call(arguments);return segmentToBezierCache[f]||(h=Math.cos(t),t=Math.sin(t),c=Math.cos(e),e=Math.sin(e),segmentToBezierCache[f]=[u+s*(-n*a*t-i*r*h),d+s*(-i*a*t+n*r*h),(u=n*a*c-i*r*e+o)+s*(n*a*e+i*r*c),(d=i*a*c+n*r*e+l)+s*(i*a*e-n*r*c),u,d]),segmentToBezierCache[f]}function calcVectorAngle(t,e,n,i){e=Math.atan2(e,t),t=Math.atan2(i,n);return e<=t?t-e:2*Math.PI-(e-t)}var drawArc=function(t,e,n,i){for(var a=i[0],r=i[1],o=i[2],l=i[3],s=i[4],u=[[],[],[],[]],d=arcToSegments(i[5]-e,i[6]-n,a,r,l,s,o),h=0,c=d.length;h<c;h++)u[h][0]=d[h][0]+e,u[h][1]=d[h][1]+n,u[h][2]=d[h][2]+e,u[h][3]=d[h][3]+n,u[h][4]=d[h][4]+e,u[h][5]=d[h][5]+n,t.bezierCurveTo.apply(t,u[h])},getBoundsOfArc=function(t,e,n,i,a,r,o,l,s){for(var u,d=0,h=0,c=[],f=arcToSegments(l-t,s-e,n,i,r,o,a),p=0,g=f.length;p<g;p++)u=getBoundsOfCurve(d,h,f[p][0],f[p][1],f[p][2],f[p][3],f[p][4],f[p][5]),c.push({x:u[0].x+t,y:u[0].y+e}),c.push({x:u[1].x+t,y:u[1].y+e}),d=f[p][4],h=f[p][5];return c};function getBoundsOfCurve(t,e,n,i,a,r,o,l){var s=_join.call(arguments);if(boundsOfCurveCache[s])return boundsOfCurveCache[s];for(var u,d,h,c=Math.sqrt,f=Math.min,p=Math.max,g=Math.abs,y=[],_=[[],[]],v=6*t-12*n+6*a,x=-3*t+9*n-9*a+3*o,m=3*n-3*t,b=0;b<2;++b)0<b&&(v=6*e-12*i+6*r,x=-3*e+9*i-9*r+3*l,m=3*i-3*e),g(x)<1e-12?g(v)<1e-12||0<(u=-m/v)&&u<1&&y.push(u):(h=v*v-4*m*x)<0||(0<(d=(-v+(h=c(h)))/(2*x))&&d<1&&y.push(d),0<(d=(-v-h)/(2*x))&&d<1&&y.push(d));for(var w,k=y.length,C=k;k--;)u=y[k],_[0][k]=(w=1-u)*w*w*t+3*w*w*u*n+3*w*u*u*a+u*u*u*o,_[1][k]=w*w*w*e+3*w*w*u*i+3*w*u*u*r+u*u*u*l;_[0][C]=t,_[1][C]=e,_[0][C+1]=o,_[1][C+1]=l;C=[{x:f.apply(null,_[0]),y:f.apply(null,_[1])},{x:p.apply(null,_[0]),y:p.apply(null,_[1])}];return boundsOfCurveCache[s]=C}var Arc={drawArc:drawArc,getBoundsOfCurve:getBoundsOfCurve,getBoundsOfArc:getBoundsOfArc},Rectangle=function(){function a(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,a),this.x=t,this.y=e,this.width=n,this.height=i,this.type=SHAPES.RECT,this.closed=!0}return _createClass(a,[{key:"clone",value:function(){return new a(this.x,this.y,this.width,this.height)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}},{key:"contains",value:function(t,e){return!(this.height*e<0||this.width*t<0)&&(t>=this.x&&t<=this.x+this.width&&(0<=this.height&&e>=this.y&&e<=this.y+this.height||this.height<0&&e<=this.y&&e>=this.y+this.height))}}]),a}(),Circle=function(){function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,i),this.x=t,this.y=e,this.radius=n,this.type=SHAPES.CIRC,this.closed=!0}return _createClass(i,[{key:"clone",value:function(){return new i(this.x,this.y,this.radius)}},{key:"contains",value:function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,t=this.x-t,e=this.y-e;return(t*=t)+(e*=e)<=n}},{key:"getBounds",value:function(){return new Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}]),i}(),Ellipse=function(){function a(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,a),this.x=t,this.y=e,this.width=n,this.height=i,this.type=SHAPES.ELIP,this.closed=!0}return _createClass(a,[{key:"clone",value:function(){return new a(this.x,this.y,this.width,this.height)}},{key:"contains",value:function(t,e){if(this.width<=0||this.height<=0)return!1;t=(t-this.x)/this.width,e=(e-this.y)/this.height;return(t*=t)+(e*=e)<=1}},{key:"getBounds",value:function(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)}}]),a}(),Polygon=function(){function l(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];_classCallCheck(this,l);var i=e[0];if(Array.isArray(i)&&(e=i),i&&"x"in i&&"y"in i){for(var a=[],r=0,o=e.length;r<o;r++)a.push(e[r].x,e[r].y);e=a}this.closed=!0,this.points=e,this.type=SHAPES.POLY}return _createClass(l,[{key:"clone",value:function(){return new l(this.points.slice())}},{key:"close",value:function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1]),this.closed=!0}},{key:"contains",value:function(t,e){return this._isInsidePolygon_WindingNumber(t,e)}},{key:"_isInsidePolygon_WindingNumber",value:function(t,e){for(var n,i=this.points,a=0,r=i[1]>e,o=3;o<i.length;o+=2)(n=r)!=(r=i[o]>e)&&0<(n=(n?1:0)-(r?1:0))*((i[o-3]-t)*(i[+o]-e)-(i[o-2]-e)*(i[o-1]-t))&&(a+=n);return a}}]),l}();function bezierCurveTo(t,e,n,i,a,r,o,l){var s,u,d,h,c,f=8<arguments.length&&void 0!==arguments[8]?arguments[8]:[];f.push(t,e);for(var p,g=1;g<=20;++g)f.push((d=(u=(s=1-(p=g/20))*s)*s)*t+3*u*p*n+3*s*(h=p*p)*a+(c=h*p)*o,d*e+3*u*p*i+3*s*h*r+c*l);return f}var Graphics=function(){function n(t){_classCallCheck(this,n),this.lineWidth=1,this.strokeStyle=null,this.strokeAlpha=1,this.fillStyle=null,this.fillAlpha=1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0,this.shadowColor="black",this.lineCap="round",this.lineJoin="round",this.miterLimit=null,this.graphicsData=[],this.currentPath=null,this.dirty=0,this.clearDirty=0,this._webGL={},this.worldAlpha=1,this.tint=16777215,this.Bound={x:0,y:0,width:0,height:0}}return _createClass(n,[{key:"setStyle",value:function(t){var t=t.$model,n=(this.lineWidth=t.lineWidth,this.strokeStyle=t.strokeStyle,this.strokeAlpha=t.strokeAlpha*t.globalAlpha,this.fillStyle=t.fillStyle,this.fillAlpha=t.fillAlpha*t.globalAlpha,this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor,this.lineCap=t.lineCap,this.lineJoin=t.lineJoin,this.miterLimit=t.miterLimit,this);this.graphicsData.length&&_.each(this.graphicsData,function(t,e){t.synsStyle(n)})}},{key:"clone",value:function(){for(var t,e=(t=new n).dirty=0;e<this.graphicsData.length;++e)t.graphicsData.push(this.graphicsData[e].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t}},{key:"moveTo",value:function(t,e){t=new Polygon([t,e]);return t.closed=!1,this.drawShape(t),this}},{key:"lineTo",value:function(t,e){return this.currentPath?(this.currentPath.shape.points.push(t,e),this.dirty++):this.moveTo(0,0),this}},{key:"quadraticCurveTo",value:function(t,e,n,i){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var a=this.currentPath.shape.points,r=(0===a.length&&this.moveTo(0,0),a[a.length-2]),o=a[a.length-1],l=1;l<=20;++l){var s,u=l/20;a.push((s=r+(t-r)*u)+(t+(n-t)*u-s)*u,(s=o+(e-o)*u)+(e+(i-e)*u-s)*u)}return this.dirty++,this}},{key:"bezierCurveTo",value:function(t,e,n,i,a,r){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var o=this.currentPath.shape.points,l=o[o.length-2],s=o[o.length-1];return o.length-=2,bezierCurveTo(l,s,t,e,n,i,a,r,o),this.dirty++,this}},{key:"arcTo",value:function(t,e,n,i,a){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var r,o,l,s,u,d=this.currentPath.shape.points,h=d[d.length-2],c=d[d.length-1]-e,h=h-t,i=i-e,n=n-t,f=Math.abs(c*n-h*i);return f<1e-8||0===a?d[d.length-2]===t&&d[d.length-1]===e||d.push(t,e):(d=c*c+h*h,l=i*i+n*n,u=c*i+h*n,d=(s=a*Math.sqrt(d)/f)*u/d,r=s*n+(f=a*Math.sqrt(l)/f)*h,o=s*i+f*c,l=n*(s+(u=f*u/l)),s=i*(s+u),u=Math.atan2(c*(f+d)-o,h*(f+d)-r),f=Math.atan2(s-o,l-r),this.arc(r+t,o+e,a,u,f,n*c<h*i)),this.dirty++,this}},{key:"arc",value:function(t,e,n,i,a){var r=5<arguments.length&&void 0!==arguments[5]&&arguments[5];if(i!==a){!r&&a<=i?a+=2*Math.PI:r&&i<=a&&(i+=2*Math.PI);r=a-i,a=48*Math.ceil(Math.abs(r)/(2*Math.PI));if(0!=r){for(var o=t+Math.cos(i)*n,l=e+Math.sin(i)*n,s=this.currentPath?this.currentPath.shape.points:null,u=(s?s[s.length-2]===o&&s[s.length-1]===l||s.push(o,l):(this.moveTo(o,l),s=this.currentPath.shape.points),r/(2*a)),d=2*u,h=Math.cos(u),c=Math.sin(u),f=a-1,p=f%1/f,g=0;g<=f;++g){var y=u+i+d*(g+p*g),_=Math.cos(y),y=-Math.sin(y);s.push((h*_+c*y)*n+t,(h*-y+c*_)*n+e)}this.dirty++}}return this}},{key:"drawRect",value:function(t,e,n,i){return this.drawShape(new Rectangle(t,e,n,i)),this}},{key:"drawCircle",value:function(t,e,n){return this.drawShape(new Circle(t,e,n)),this}},{key:"drawEllipse",value:function(t,e,n,i){return this.drawShape(new Ellipse(t,e,n,i)),this}},{key:"drawPolygon",value:function(t){var e=!0;if((n=t)instanceof Polygon&&(e=n.closed,n=n.points),!Array.isArray(n))for(var n=new Array(arguments.length),i=0;i<n.length;++i)n[i]=arguments[i];t=new Polygon(n);return t.closed=e,this.drawShape(t),this}},{key:"clear",value:function(){return 0<this.graphicsData.length&&(this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this}},{key:"drawShape",value:function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.beginPath();t=new GraphicsData(this.lineWidth,this.strokeStyle,this.strokeAlpha,this.fillStyle,this.fillAlpha,this.shadowOffsetX,this.shadowOffsetY,this.shadowBlur,this.shadowColor,this.lineCap,this.lineJoin,this.miterLimit,t);return this.graphicsData.push(t),t.type===SHAPES.POLY&&(t.shape.closed=t.shape.closed,this.currentPath=t),this.dirty++,t}},{key:"beginPath",value:function(){this.currentPath=null}},{key:"closePath",value:function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this}},{key:"updateLocalBounds",value:function(){var t=1/0,e=-1/0,n=1/0,i=-1/0;if(this.graphicsData.length)for(var a=0,r=0,o=0,l=0,s=0;s<this.graphicsData.length;s++){var u=this.graphicsData[s],d=u.type,h=u.lineWidth,u=u.shape;if(d===SHAPES.RECT||d===SHAPES.RREC)a=u.x-h/2,r=u.y-h/2,t=a<t?a:t,e=e<a+(o=u.width+h)?a+o:e,n=r<n?r:n,i=i<r+(l=u.height+h)?r+l:i;else if(d===SHAPES.CIRC)a=u.x,r=u.y,t=a-(o=u.radius+h/2)<t?a-o:t,e=e<a+o?a+o:e,n=r-(l=u.radius+h/2)<n?r-l:n,i=i<r+l?r+l:i;else if(d===SHAPES.ELIP)a=u.x,r=u.y,t=a-(o=u.width+h/2)<t?a-o:t,e=e<a+o?a+o:e,n=r-(l=u.height+h/2)<n?r-l:n,i=i<r+l?r+l:i;else for(var c,f,p,g,y,_=u.points,v=0;v+2<_.length;v+=2)a=_[v],r=_[v+1],y=_[v+2],c=_[v+3],f=Math.abs(y-a),p=Math.abs(c-r),l=h,(o=Math.sqrt(f*f+p*p))<1e-9||(t=(y=(y+a)/2)-(g=(l/o*p+f)/2)<t?y-g:t,e=e<y+g?y+g:e,n=(y=(c+r)/2)-(g=(l/o*f+p)/2)<n?y-g:n,i=i<y+g?y+g:i)}else i=n=e=t=0;return this.Bound={x:t,y:n,width:e-t,height:i-n},this}},{key:"getBound",value:function(){return this.updateLocalBounds().Bound}},{key:"destroy",value:function(t){for(var e,n=0;n<this.graphicsData.length;++n)this.graphicsData[n].destroy();for(e in this._webGL)for(var i=0;i<this._webGL[e].data.length;++i)this._webGL[e].data[i].destroy();this.graphicsData=null,this.currentPath=null,this._webGL=null}}]),n}();function _createSuper$8(n){var i=_isNativeReflectConstruct$8();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$8(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Shape=function(){_inherits(i,DisplayObject);var n=_createSuper$8(i);function i(t){_classCallCheck(this,i);var e={cursor:(t=Utils.checkOpt(t)).context.cursor||"default",fillAlpha:t.context.fillAlpha||1,fillStyle:t.context.fillStyle||null,lineCap:t.context.lineCap||"round",lineJoin:t.context.lineJoin||"round",miterLimit:t.context.miterLimit||null,strokeAlpha:t.context.strokeAlpha||1,strokeStyle:t.context.strokeStyle||null,lineType:t.context.lineType||"solid",lineDash:t.context.lineDash||[5,2],lineWidth:t.context.lineWidth||null,shadowOffsetX:t.context.shadowOffsetX||0,shadowOffsetY:t.context.shadowOffsetY||0,shadowBlur:t.context.shadowBlur||0,shadowColor:t.context.shadowColor||"#000000"},e=_.extend(!0,e,t.context);return t.context=e,void 0===t.id&&void 0!==t.type&&(t.id=Utils.createId(t.type)),(e=n.call(this,t))._hoverClass=!1,e.hoverClone=!0,e.pointChkPriority=!0,e._eventEnabled=!1,e.dragEnabled=t.dragEnabled||!1,e._dragDuplicate=null,e.type=e.type||"shape",e.initCompProperty(t),e.isClone?e.graphics=null:(e.graphics=new Graphics,e._draw(e.graphics)),e}return _createClass(i,[{key:"_draw",value:function(t){0==t.graphicsData.length&&(t.setStyle(this.context),this.draw(t))}},{key:"draw",value:function(){}},{key:"clearGraphicsData",value:function(){this.graphics.clear()}},{key:"$watch",value:function(t,e,n){-1<_.indexOf(STYLE_PROPS,t)&&this.graphics.setStyle(this.context),this.watch(t,e,n)}},{key:"initCompProperty",value:function(t){for(var e in t)"id"!=e&&"context"!=e&&(this[e]=t[e])}},{key:"getBound",value:function(){return this.graphics.updateLocalBounds().Bound}}]),i}();function _createSuper$9(n){var i=_isNativeReflectConstruct$9();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$9(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Text=function(){_inherits(i,DisplayObject);var n=_createSuper$9(i);function i(t,e){return _classCallCheck(this,i),e.type="text",null==t&&(t=""),e.context=_.extend({font:"",fontSize:13,fontWeight:"normal",fontFamily:"微软雅黑,sans-serif",textBaseline:"top",textAlign:"left",textDecoration:null,fillStyle:"blank",strokeStyle:null,lineWidth:0,lineHeight:1.2,backgroundColor:null,textBackgroundColor:null},e.context),(e=n.call(this,e))._reNewline=/\r?\n/,e.fontProperts=["fontStyle","fontVariant","fontWeight","fontSize","fontFamily"],e.context.font=e._getFontDeclaration(),e.text=t.toString(),e.context.width=e.getTextWidth(),e.context.height=e.getTextHeight(),e}return _createClass(i,[{key:"$watch",value:function(t,e,n){0<=_.indexOf(this.fontProperts,t)&&(this.context[t]=e,this.context.font=this._getFontDeclaration(),this.context.width=this.getTextWidth(),this.context.height=this.getTextHeight())}},{key:"_setContextStyle",value:function(t,e,n){for(var i in e)"textBaseline"!=i&&i in t&&(e[i]||_.isNumber(e[i]))&&("globalAlpha"==i?t.globalAlpha=n:t[i]=e[i])}},{key:"render",value:function(t,e){this._renderText(t,this._getTextLines(),e)}},{key:"resetText",value:function(t){this.text=t.toString(),this.heartBeat()}},{key:"getTextWidth",value:function(){var t=0;return Utils._pixelCtx&&(Utils._pixelCtx.save(),Utils._pixelCtx.font=this.context.$model.font,t=this._getTextWidth(Utils._pixelCtx,this._getTextLines()),Utils._pixelCtx.restore()),t}},{key:"getTextHeight",value:function(){return this._getTextHeight(this._getTextLines())}},{key:"_getTextLines",value:function(){return this.text.split(this._reNewline)}},{key:"_renderText",value:function(t,e,n){t&&(t.save(),this._setContextStyle(t,this.context.$model,n),this._renderTextStroke(t,e),this._renderTextFill(t,e),t.restore())}},{key:"_getFontDeclaration",value:function(){var n=this,i=[];return _.each(this.fontProperts,function(t){var e=n.context[t];(e="fontSize"==t?parseFloat(e)+"px":e)&&i.push(e)}),i.join(" ")}},{key:"_renderTextFill",value:function(t,e){if(this.context.$model.fillStyle){this._boundaries=[];for(var n=0,i=0,a=e.length;i<a;i++)n+=this._getHeightOfLine(t,i,e),this._renderTextLine("fillText",t,e[i],0,this._getTopOffset()+n,i)}}},{key:"_renderTextStroke",value:function(t,e){if(t&&this.context.$model.strokeStyle&&this.context.$model.lineWidth){var n=0;t.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),supportsLineDash&&t.setLineDash(this.strokeDashArray)),t.beginPath();for(var i=0,a=e.length;i<a;i++)n+=this._getHeightOfLine(t,i,e),this._renderTextLine("strokeText",t,e[i],0,this._getTopOffset()+n,i);t.closePath(),t.restore()}}},{key:"_renderTextLine",value:function(t,e,n,i,a,r){if(a-=this._getHeightOfLine()/4,"justify"!==this.context.$model.textAlign)this._renderChars(t,e,n,i,a,r);else{var o=e.measureText(n).width,l=this.context.$model.width;if(o<l)for(var s=n.split(/\s+/),u=(l-e.measureText(n.replace(/\s+/g,"")).width)/(s.length-1),d=0,h=0,c=s.length;h<c;h++)this._renderChars(t,e,s[h],i+d,a,r),d+=e.measureText(s[h]).width+u;else this._renderChars(t,e,n,i,a,r)}}},{key:"_renderChars",value:function(t,e,n,i,a){e[t](n,0,a)}},{key:"_getHeightOfLine",value:function(){return this.context.$model.fontSize*this.context.$model.lineHeight}},{key:"_getTextWidth",value:function(t,e){for(var n=t.measureText(e[0]||"|").width,i=1,a=e.length;i<a;i++){var r=t.measureText(e[i]).width;n<r&&(n=r)}return n}},{key:"_getTextHeight",value:function(t){return this.context.$model.fontSize*t.length*this.context.$model.lineHeight}},{key:"_getTopOffset",value:function(){var t=0;switch(this.context.$model.textBaseline){case"top":t=0;break;case"middle":t=-this.context.$model.height/2;break;case"bottom":t=-this.context.$model.height}return t}},{key:"getRect",value:function(){var t=this.context,e=0,n=0;return"center"==t.textAlign&&(e=-t.width/2),"right"==t.textAlign&&(e=-t.width),"middle"==t.textBaseline&&(n=-t.height/2),{x:e,y:n="bottom"==t.textBaseline?-t.height:n,width:t.width,height:t.height}}}]),i}();function Vector(t,e){var n=0,i=0;1==arguments.length&&_.isObject(t)&&(_.isArray(t=t)?(n=t[0],i=t[1]):t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&(n=t.x,i=t.y)),this._axes=[n,i]}function interpolate(t,e,n,i,a,r,o,l){t=(n-t)*(l=!isNaN(l)&&null!=l?l:.25),i=(i-e)*l;return(2*(e-n)+t+i)*o+(-3*(e-n)-2*t-i)*r+t*a+e}function SmoothSpline(t){var e=t.points,n=t.isLoop,i=t.smoothFilter,a=t.curvature,r=e.length;if(1==r)return e;for(var o=[],l=0,s=new Vector(e[0]),u=null,d=1;d<r;d++)u=new Vector(e[d]),l+=s.distance(u),s=u;for(var s=null,u=null,h=(h=l/6)<r?r:h,d=0;d<h;d++){var c,f,p=d/(h-1)*(n?r:r-1),g=Math.floor(p),p=p-g,y=e[g%r],g=n?(c=e[(g-1+r)%r],f=e[(g+1)%r],e[(g+2)%r]):(c=e[0===g?g:g-1],f=e[r-2<g?r-1:g+1],e[r-3<g?r-1:g+2]),v=p*p,x=p*v,y=[interpolate(c[0],y[0],f[0],g[0],p,v,x,a),interpolate(c[1],y[1],f[1],g[1],p,v,x,a)];_.isFunction(i)&&i(y),o.push(y)}return o}Vector.prototype={distance:function(t){var e=this._axes[0]-t._axes[0],t=this._axes[1]-t._axes[1];return Math.sqrt(e*e+t*t)}};var _cache={sin:{},cos:{}},_radians=Math.PI/180;function sin(t,e){return t=(e?t*_radians:t).toFixed(4),void 0===_cache.sin[t]&&(_cache.sin[t]=Math.sin(t)),_cache.sin[t]}function cos(t,e){return t=(e?t*_radians:t).toFixed(4),void 0===_cache.cos[t]&&(_cache.cos[t]=Math.cos(t)),_cache.cos[t]}function degreeToRadian(t){return t*_radians}function radianToDegree(t){return t/_radians}function degreeTo360(t){var e=(360+t%360)%360;return e=0==e&&0!==t?360:e}function getIsgonPointList(t,e){for(var n=[],i=2*Math.PI/t,a=-Math.PI/2,r=0,o=t;r<o;r++)n.push([e*Math.cos(a),e*Math.sin(a)]),a+=i;return n}function getSmoothPointList(t,n,i){var a=[],r=t.length,o=[];return _.each(t,function(t,e){isNotValibPoint(t)?(o.length&&(a=a.concat(_getSmoothGroupPointList(o,n,i)),o=[]),a.push(t)):o.push(t),e==r-1&&o.length&&(a=a.concat(_getSmoothGroupPointList(o,n,i)),o=[])}),a}function _getSmoothGroupPointList(t,e,n){n={points:t,curvature:n},_.isFunction(e)&&(n.smoothFilter=e),e=SmoothSpline(n);return t&&0<t.length&&e.push(t[t.length-1]),e}function isNotValibPoint(t){return!t||_.isArray(t)&&2<=t.length&&(!_.isNumber(t[0])||!_.isNumber(t[1]))||"x"in t&&!_.isNumber(t.x)||"y"in t&&!_.isNumber(t.y)}function isValibPoint(t){return!isNotValibPoint(t)}var myMath={PI:Math.PI,sin:sin,cos:cos,degreeToRadian:degreeToRadian,radianToDegree:radianToDegree,degreeTo360:degreeTo360,getIsgonPointList:getIsgonPointList,getSmoothPointList:getSmoothPointList,isNotValibPoint:isNotValibPoint,isValibPoint:isValibPoint};function _createSuper$a(n){var i=_isNativeReflectConstruct$a();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var mathMin=Math.min,mathMax=Math.max,BrokenLine=function(){_inherits(i,Shape);var n=_createSuper$a(i);function i(t){_classCallCheck(this,i),t=Utils.checkOpt(t);var e=_.extend(!0,{lineType:null,smooth:!1,smoothMonotone:"none",pointList:[]},t.context);return!0!==e.smooth&&"true"!==e.smooth||(e.smooth=.5),t.context=e,t.type="brokenline",n.call(this,t)}return _createClass(i,[{key:"watch",value:function(t,e,n){-1<["pointList","smooth","lineType","smoothMonotone"].indexOf(t)&&(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.pointList;return this.drawGraphics(t,e,this.context.smooth,this.context.smoothMonotone),this}},{key:"drawGraphics",value:function(t){for(var e,n,i,a,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.5,l=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=r.length,u=0,d=!1,h=0;h<s;h++){var c=r[u];if(myMath.isValibPoint(c)){var f=c[0],p=c[1];if(d){var c=f-e,g=p-n;if(c*c+g*g<.5){u+=1;continue}if(0<o){for(var y=u+1,_=r[y],v=_?_[0]:null,x=_?_[1]:null;v===f&&x===p&&h<s;)h++,u+=1,v=(_=r[y+=1])?_[0]:null,x=_?_[1]:null,f=r[u][0],p=r[u][1];var m,b,w,k,C,S,A,P,R,c=0,g=0,D=void 0,T=void 0;s<=h+1||!myMath.isValibPoint({x:v,y:x})?(A=f,P=p):(c=v-e,g=x-n,m=f-e,b=v-f,w=p-n,k=x-p,S=C=void 0,T="x"===l?(A=f-(R=0<c?1:-1)*(C=Math.abs(m))*o,P=p,D=f+R*(S=Math.abs(b))*o,p):"y"===l?(P=p-(R=0<g?1:-1)*(C=Math.abs(w))*o,D=A=f,p+R*(S=Math.abs(k))*o):(C=Math.sqrt(m*m+w*w),A=f-c*o*(1-(m=(S=Math.sqrt(b*b+k*k))/(S+C))),P=p-g*o*(1-m),T=p+g*o*m,D=mathMin(D=f+c*o*m,mathMax(v,f)),T=mathMin(T,mathMax(x,p)),D=mathMax(D,mathMin(v,f)),P=p-(g=(T=mathMax(T,mathMin(x,p)))-p)*C/S,A=mathMin(A=f-(c=D-f)*C/S,mathMax(e,f)),P=mathMin(P,mathMax(n,p)),D=f+(c=f-(A=mathMax(A,mathMin(e,f))))*S/C,p+(g=p-(P=mathMax(P,mathMin(n,p))))*S/C)),t.bezierCurveTo(i,a,A,P,f,p),i=D,a=T}else t.lineTo(f,p)}else t.moveTo(f,p),i=f,a=p;e=f,n=p,u+=1,d=!0}else u+=1,d=!1}return h}}]),i}();function _createSuper$b(n){var i=_isNativeReflectConstruct$b();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Circle$1=function(){_inherits(n,Shape);var e=_createSuper$b(n);function n(t){return _classCallCheck(this,n),t=_.extend(!0,{type:"circle",xyToInt:!1,context:{r:0}},Utils.checkOpt(t)),e.call(this,t)}return _createClass(n,[{key:"watch",value:function(t,e,n){"r"==t&&(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.$model.r;t.drawCircle(0,0,e=e<0?0:e)}}]),n}();function _createSuper$c(n){var i=_isNativeReflectConstruct$c();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Path=function(){_inherits(i,Shape);var n=_createSuper$c(i);function i(t){_classCallCheck(this,i);var e=_.extend(!0,{pointList:[],path:""},t.context);return t.context=e,t.__parsePathData=null,t.type="path",n.call(this,t)}return _createClass(i,[{key:"watch",value:function(t,e,n){"path"==t&&(this.graphics.clear(),this.draw(this.graphics))}},{key:"_parsePathData",value:function(t){if(!this.__parsePathData){if(!t)return[];this.__parsePathData=[];var t=_.compact(t.replace(/[Mm]/g,"\\r$&").split("\\r")),e=this;_.each(t,function(t){e.__parsePathData.push(e._parseChildPathData(t))})}return this.__parsePathData}},{key:"_parseChildPathData",value:function(t){var e=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];for(e=(e=(e=(e=e.replace(/  /g," ")).replace(/ /g,",")).replace(/(\d)-/g,"$1,-")).replace(/,,/g,","),l=0;l<n.length;l++)e=e.replace(new RegExp(n[l],"g"),"|"+n[l]);for(var i=e.split("|"),a=[],r=0,o=0,l=1;l<i.length;l++){var s=i[l],u=s.charAt(0),d=(s=(s=s.slice(1)).replace(new RegExp("e,-","g"),"e-")).split(",");0<d.length&&""===d[0]&&d.shift();for(var h=0;h<d.length;h++)d[h]=parseFloat(d[h]);for(;0<d.length&&!isNaN(d[0]);){var c,f,p,g=null,y=[],_=r,v=o;switch(u){case"l":r+=d.shift(),o+=d.shift(),g="L",y.push(r,o);break;case"L":r=d.shift(),o=d.shift(),y.push(r,o);break;case"m":r+=d.shift(),o+=d.shift(),g="M",y.push(r,o),u="l";break;case"M":r=d.shift(),o=d.shift(),g="M",y.push(r,o),u="L";break;case"h":r+=d.shift(),g="L",y.push(r,o);break;case"H":r=d.shift(),g="L",y.push(r,o);break;case"v":o+=d.shift(),g="L",y.push(r,o);break;case"V":o=d.shift(),g="L",y.push(r,o);break;case"C":y.push(d.shift(),d.shift(),d.shift(),d.shift()),r=d.shift(),o=d.shift(),y.push(r,o);break;case"c":y.push(r+d.shift(),o+d.shift(),r+d.shift(),o+d.shift()),r+=d.shift(),o+=d.shift(),g="C",y.push(r,o);break;case"S":c=r,f=o,"C"===(p=a[a.length-1]).command&&(c=r+(r-p.points[2]),f=o+(o-p.points[3])),y.push(c,f,d.shift(),d.shift()),r=d.shift(),o=d.shift(),g="C",y.push(r,o);break;case"s":c=r,f=o,"C"===(p=a[a.length-1]).command&&(c=r+(r-p.points[2]),f=o+(o-p.points[3])),y.push(c,f,r+d.shift(),o+d.shift()),r+=d.shift(),o+=d.shift(),g="C",y.push(r,o);break;case"Q":y.push(d.shift(),d.shift()),r=d.shift(),o=d.shift(),y.push(r,o);break;case"q":y.push(r+d.shift(),o+d.shift()),r+=d.shift(),o+=d.shift(),g="Q",y.push(r,o);break;case"T":c=r,f=o,"Q"===(p=a[a.length-1]).command&&(c=r+(r-p.points[0]),f=o+(o-p.points[1])),r=d.shift(),o=d.shift(),g="Q",y.push(c,f,r,o);break;case"t":c=r,f=o,"Q"===(p=a[a.length-1]).command&&(c=r+(r-p.points[0]),f=o+(o-p.points[1])),r+=d.shift(),o+=d.shift(),g="Q",y.push(c,f,r,o);break;case"A":_=r,v=o,g="A",y=[d.shift(),d.shift(),d.shift(),d.shift(),d.shift(),r=d.shift(),o=d.shift(),_,v];break;case"a":_=r,v=o,g="A",y=[d.shift(),d.shift(),d.shift(),d.shift(),d.shift(),r+=d.shift(),o+=d.shift(),_,v]}a.push({command:g||u,points:y})}"z"!==u&&"Z"!==u||a.push({command:"z",points:[]})}return a}},{key:"draw",value:function(t){this.__parsePathData=null,this.context.$model.pointList=[];for(var e=this._parsePathData(this.context.$model.path),n=0,i=e.length;n<i;n++)for(var a=0,r=e[n].length;a<r;a++){var o=e[n][a].command,l=e[n][a].points;switch(o){case"L":t.lineTo(l[0],l[1]);break;case"M":t.moveTo(l[0],l[1]);break;case"C":t.bezierCurveTo(l[0],l[1],l[2],l[3],l[4],l[5]);break;case"Q":t.quadraticCurveTo(l[0],l[1],l[2],l[3]);break;case"A":Arc.drawArc(t,l[7],l[8],l);break;case"z":t.closePath()}}return this}}]),i}();function _createSuper$d(n){var i=_isNativeReflectConstruct$d();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Droplet=function(){_inherits(n,Path);var e=_createSuper$d(n);function n(t){_classCallCheck(this,n),t=_.extend(!0,{type:"droplet",context:{hr:0,vr:0}},Utils.checkOpt(t)),t=e.call(this,t);return t.context.$model.path=t.createPath(),t}return _createClass(n,[{key:"watch",value:function(t,e,n){"hr"!=t&&"vr"!=t||(this.context.$model.path=this.createPath())}},{key:"createPath",value:function(){var t=this.context.$model,e="M 0 "+t.hr+" C "+t.hr+" "+t.hr+" "+3*t.hr/2+" "+-t.hr/3+" 0 "+-t.vr;return e+=" C "+3*-t.hr/2+" "+-t.hr/3+" "+-t.hr+" "+t.hr+" 0 "+t.hr+"z"}}]),n}();function _createSuper$e(n){var i=_isNativeReflectConstruct$e();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$e(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Ellipse$1=function(){_inherits(n,Shape);var e=_createSuper$e(n);function n(t){return _classCallCheck(this,n),t=_.extend(!0,{type:"ellipse",context:{hr:0,vr:0}},Utils.checkOpt(t)),e.call(this,t)}return _createClass(n,[{key:"watch",value:function(t,e,n){"hr"!=t&&"vr"!=t||(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){t.drawEllipse(0,0,2*this.context.$model.hr,2*this.context.$model.vr)}}]),n}();function _createSuper$f(n){var i=_isNativeReflectConstruct$f();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Polygon$1=function(){_inherits(a,Shape);var i=_createSuper$f(a);function a(t){_classCallCheck(this,a);var e,n=_.extend(!0,{lineType:null,smooth:!1,pointList:[],smoothFilter:Utils.__emptyFunc},t.context);return t.isClone||(n.pointList[0],e=n.pointList.slice(-1)[0],n.smooth&&(n.pointList.unshift(e),n.pointList=myMath.getSmoothPointList(n.pointList))),t.context=n,t.type="polygon",i.call(this,t)}return _createClass(a,[{key:"watch",value:function(t,e,n){"pointList"!=t&&"smooth"!=t&&"lineType"!=t||(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.pointList;if(!(e.length<2)){t.moveTo(e[0][0],e[0][1]);for(var n=1,i=e.length;n<i;n++)t.lineTo(e[n][0],e[n][1]);t.closePath()}}}]),a}();function _createSuper$g(n){var i=_isNativeReflectConstruct$g();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Isogon=function(){_inherits(i,Polygon$1);var n=_createSuper$g(i);function i(t){_classCallCheck(this,i);var e=_.extend(!0,{pointList:[],r:0,n:0},t.context);return e.pointList=myMath.getIsgonPointList(e.n,e.r),t.context=e,t.type="isogon",n.call(this,t)}return _createClass(i,[{key:"watch",value:function(t,e,n){"r"!=t&&"n"!=t||(this.context.$model.pointList=myMath.getIsgonPointList(this.context.$model.n,this.context.$model.r)),"pointList"!=t&&"smooth"!=t&&"lineType"!=t||this.graphics.clear()}}]),i}();function _createSuper$h(n){var i=_isNativeReflectConstruct$h();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Line=function(){_inherits(i,Shape);var n=_createSuper$h(i);function i(t){_classCallCheck(this,i);var e=_.extend(!0,{start:{x:0,y:0},end:{x:0,y:0}},t.context);return t.context=e,t.type="line",n.call(this,t)}return _createClass(i,[{key:"watch",value:function(t,e,n){"x"!=t&&"y"!=t||(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.$model;return t.moveTo(e.start.x,e.start.y),t.lineTo(e.end.x,e.end.y),this}}]),i}();function _createSuper$i(n){var i=_isNativeReflectConstruct$i();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Rect=function(){_inherits(i,Shape);var n=_createSuper$i(i);function i(t){_classCallCheck(this,i);var e=_.extend(!0,{width:0,height:0,radius:[]},t.context);return t.context=e,t.type="rect",n.call(this,t)}return _createClass(i,[{key:"watch",value:function(t,e,n){"width"!=t&&"height"!=t&&"radius"!=t||(this.graphics.clear(),this.draw(this.graphics))}},{key:"_buildRadiusPath",value:function(t){var e=this.context.$model,n=e.width,i=e.height,e=Utils.getCssOrderArr(e.radius),a=0<=i?-1:1;t.moveTo(parseInt(0+e[0]),parseInt(i)),t.lineTo(parseInt(0+n-e[1]),parseInt(i)),0!==e[1]&&t.quadraticCurveTo(0+n,i,parseInt(0+n),parseInt(i+e[1]*a)),t.lineTo(parseInt(0+n),parseInt(0-e[2]*a)),0!==e[2]&&t.quadraticCurveTo(0+n,0,parseInt(0+n-e[2]),parseInt(0)),t.lineTo(parseInt(0+e[3]),parseInt(0)),0!==e[3]&&t.quadraticCurveTo(0,0,parseInt(0),parseInt(0-e[3]*a)),t.lineTo(parseInt(0),parseInt(0+i+e[0]*a)),0!==e[0]&&t.quadraticCurveTo(0,0+i,parseInt(0+e[0]),parseInt(0+i))}},{key:"draw",value:function(t){var e=this.context.$model;e.radius.length?this._buildRadiusPath(t):t.drawRect(0,0,e.width,e.height),t.closePath()}}]),i}();function _createSuper$j(n){var i=_isNativeReflectConstruct$j();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Sector=function(){_inherits(i,Shape);var n=_createSuper$j(i);function i(t){_classCallCheck(this,i);var e=_.extend(!0,{pointList:[],r0:0,r:0,startAngle:0,endAngle:0,clockwise:!1},t.context);return t.context=e,t.regAngle=[],t.isRing=!1,t.type="sector",n.call(this,t)}return _createClass(i,[{key:"watch",value:function(t,e,n){"r0"!=t&&"r"!=t&&"startAngle"!=t&&"endAngle"!=t&&"clockwise"!=t||(this.isRing=!1,this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.$model,n=void 0===e.r0?0:e.r0,i=e.r,a=myMath.degreeTo360(e.startAngle),r=myMath.degreeTo360(e.endAngle);e.startAngle!=e.endAngle&&Math.abs(e.startAngle-e.endAngle)%360==0&&(this.isRing=!0,a=0,r=360),a=myMath.degreeToRadian(a),r=myMath.degreeToRadian(r);this.isRing?0==e.r0?t.drawCircle(0,0,e.r):(e.fillStyle&&e.fillAlpha&&(t.beginPath(),t.arc(0,0,i,a,r,e.clockwise),0==e.r0?t.lineTo(0,0):t.arc(0,0,n,r,a,!e.clockwise),t.closePath(),t.currentPath.lineWidth=0,t.currentPath.strokeStyle=null,t.currentPath.strokeAlpha=0,t.currentPath.line=!1),e.lineWidth&&e.strokeStyle&&e.strokeAlpha&&(t.beginPath(),t.arc(0,0,i,a,r,e.clockwise),t.closePath(),t.currentPath.fillStyle=null,t.currentPath.fill=!1,t.beginPath(),t.arc(0,0,n,r,a,!e.clockwise),t.closePath(),t.currentPath.fillStyle=null,t.currentPath.fill=!1)):(t.beginPath(),t.arc(0,0,i,a,r,e.clockwise),0==e.r0?t.lineTo(0,0):t.arc(0,0,n,r,a,!e.clockwise),t.closePath())}}]),i}();function _createSuper$k(n){var i=_isNativeReflectConstruct$k();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$k(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Arrow=function(){_inherits(i,Shape);var n=_createSuper$k(i);function i(t){_classCallCheck(this,i);var e=_.extend(!0,{control:{x:0,y:0},point:{x:0,y:0},angle:null,theta:30,headlen:6,lineWidth:1,strokeStyle:"#666",fillStyle:null},t.context);return t.context=e,t.type="arrow",n.call(this,t)}return _createClass(i,[{key:"watch",value:function(t,e,n){"x"!=t&&"y"!=t&&"theta"!=t&&"headlen"!=t&&"angle"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model,n=e.control.x,i=e.control.y,a=e.point.x,r=e.point.y,i=null!=e.angle?e.angle-180:180*Math.atan2(i-r,n-a)/Math.PI,n=(i+e.theta)*Math.PI/180,i=(i-e.theta)*Math.PI/180,o=e.headlen*Math.cos(n),n=e.headlen*Math.sin(n),l=e.headlen*Math.cos(i),i=e.headlen*Math.sin(i),o=a+o,n=r+n;return t.moveTo(o,n),t.lineTo(a,r),t.lineTo(a+l,r+i),e.fillStyle&&(t.lineTo(o,n),t.closePath()),this}}]),i}();function _createSuper$l(n){var i=_isNativeReflectConstruct$l();return function(){var t,e=_getPrototypeOf(n);return t=i?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),_possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct$l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}var Diamond=function(){_inherits(i,Shape);var n=_createSuper$l(i);function i(t){_classCallCheck(this,i);var e=_.extend(!0,{innerRect:{width:0,height:0},includedAngle:60},t.context);return t.context=e,t.type="diamond",n.call(this,t)}return _createClass(i,[{key:"watch",value:function(t,e,n){-1<["includedAngle"].indexOf(t)&&(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.$model,n=e.innerRect,e=e.includedAngle/2*Math.PI/180,i=n.height/Math.tan(e),e=n.width*Math.tan(e),i=n.width+i,n=n.height+e;return t.moveTo(0,n/2),t.lineTo(i/2,0),t.lineTo(0,-n/2),t.lineTo(-i/2,0),t.lineTo(0,n/2),t.closePath(),this}}]),i}(),Canvax={version:"2.0.86",_:_,$:$,event:event,App:Application},parse=(Canvax.Display={DisplayObject:DisplayObject,DisplayObjectContainer:DisplayObjectContainer,Stage:Stage,Sprite:Sprite,Shape:Shape,Point:Point,Text:Text},Canvax.Shapes={BrokenLine:BrokenLine,Circle:Circle$1,Droplet:Droplet,Ellipse:Ellipse$1,Isogon:Isogon,Line:Line,Path:Path,Polygon:Polygon$1,Rect:Rect,Sector:Sector,Arrow:Arrow,Diamond:Diamond},Canvax.AnimationFrame=AnimationFrame,Canvax.utils=Utils,createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default={_eval:function(t,e,n,i){return n?new Function(n,t+"; return ".concat(e,";"))(i):new Function(t+"; return ".concat(e,";"))()},parse:function(t,e,n,i){try{if(!(e&&e.length&&2===e.length&&e[1]>e[0]))return this._eval(t,"options");var a=this._eval(t,"variables"),r=("function"==typeof a&&(a=a(n)||{}),{}),o=(void 0!==i&&(r="function"==typeof i?i(n):i),r=Canvax._.extend(!0,{},a,r),t.slice(0,e[0])+t.slice(e[1]));return this._eval(o,"options","variables",r)}catch(t){return{}}}}})),setting=(unwrapExports(parse),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={padding:20}})),global$1=(unwrapExports(setting),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=interopRequireDefault(Canvax),a=interopRequireDefault(parse),i=interopRequireDefault(setting),u=n.default._,d=n.default.$,r=n.default.AnimationFrame,o=["#ff8533","#73ace6","#82d982","#e673ac","#cd6bed","#8282d9","#c0e650","#e6ac73","#6bcded","#73e6ac","#ed6bcd","#9966cc"],l={},n={chartxVersion:"1.1.153",create:function(t,e,n){function i(){o.instances[r.id]=null,delete o.instances[r.id]}var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},r=null,o=this,l=t.id||d.query(t).getAttribute("chart_id"),s=(null!=l&&((s=o.instances[l])&&(s.destroy(),s.off&&s.off("destroy",i)),delete o.instances[l]),o._getComponentModules()),l=o._getComponentModule("chart");return(r=new l(t,e,this._optionsHandle(n),s,a))&&(r.draw(),(o.instances[r.id]=r).on("destroy",i)),r},setGlobalTheme:function(t){o=t},getGlobalTheme:function(){return o},parse:a.default,instances:{},getChart:function(t){return this.instances[t]},resize:function(){for(var t in this.instances)this.instances[t].resize()},getOptionsOld:function(t){var n={prefix:"[[JSON_FUN_PREFIX_",suffix:"_JSON_FUN_SUFFIX]]"};return t=decodeURIComponent(this.options[t]||"%7B%7D"),JSON.parse(t,function(t,e){return"string"==typeof e&&0<e.indexOf(n.suffix)&&0==e.indexOf(n.prefix)?new Function("return "+e.replace(n.prefix,"").replace(n.suffix,""))():e})||{}},getOptionsNew:function(t,e,n){var t=this.options[t],i=decodeURIComponent(t.code),t=t.range;return a.default.parse(i,t,e,n)},getOptions:function(t,e,n,i){if(!this.options[t])return e||{};t="string"==typeof this.options[t]?this.getOptionsOld(t):this.getOptionsNew(t,n||[],i||{});return e&&(t=u.extend(!0,t,e)),this._optionsHandle(t)},_optionsHandle:function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};for(t in e){var n=e[t];if(Array.isArray(n)){for(var i=0,a=n.length;i<a;i++)n[i]||(n.splice(i,1),i--,a--);n.length||delete e[t]}else n||delete e[t]}return e},calculateOptions:function(t,e,n){return this.getOptions(t,void 0,e,n)},_getComponentModules:function(){var n=l;return n.modules||(n.modules={}),n.get||(n.get=function(t,e){e=e||"empty",t=t.toLowerCase(),e=e.toLowerCase();t=n.modules[t];if(t&&t[e])return t[e]}),n},registerComponent:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"empty",i=this._getComponentModules().modules,a=(e=e.toLowerCase(),n=n.toLowerCase(),i[e]);return(a=a||(i[e]={}))[n]||(a[n]=t),i},_getComponentModule:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"empty",t=(t=t.toLowerCase(),e=e.toLowerCase(),this._getComponentModules().modules[t]);return t?t[e]:void 0},setAnimationEnabled:function(t){return r.setAnimationEnabled(t)},getAnimationEnabled:function(t){return r.getAnimationEnabled()},layout:{},registerLayout:function(t,e){this.layout[t]=e},props:{},getProps:function(){function t(n){if("chart"==n)return"continue";l[n]={detail:n,propertys:{}};var t,e,i=void 0,a=("graphs"==n&&(i=u.map(s.graphs,function(t,e){return e}),l.graphs.documentation="可选的graphs类型有：\n"+i.join("\n")),{}),r=null;for(t in s[n]){if(r)break;r=s[n][t].prototype}function o(t){var e=s[n][t];!function i(a){if(a._props){var r,o=u.isArray(a._props);for(r in a._props){o||(a[r]={detail:r,propertys:{}});var l=a._props[r];l.defaultProps&&!function(){function e(t){t.__proto__.__proto__&&e(t.__proto__),t.defaultProps&&u.isFunction(t.defaultProps)&&((t=t.defaultProps())._props&&i(t),t&&u.extend(n,t))}var t=l.defaultProps(),n={};e(l.__proto__),t=u.extend(n,t),o?u.extend(a,t):(a[r].propertys=t,i(a[r].propertys))}()}}}(e=e.defaultProps?e.defaultProps():{}),e=u.extend({},a,e),a.type?(l[n].typeMap||(l[n].typeMap={}),"graphs"==n&&(e.type.values=i,e.type.documentation="可选的graphs类型有：\n"+i.join("\n")),l[n].typeMap[t]=e):u.extend(l[n].propertys,e)}for(e in!function t(e){e=e.constructor.__proto__;e._isComponentRoot||t(e.prototype),e.defaultProps&&u.isFunction(e.defaultProps)&&(e=e.defaultProps(),u.extend(a,e))}(r),l[n].propertys=u.extend(a,l[n].propertys),s[n])o(e)}var e,l={},s=this._getComponentModules().modules;for(e in s)t(e);return this.props=l,this.props},setPadding:function(t){i.default.padding=t},canvax:n.default};e.default=n})),classCallCheck$1=(unwrapExports(global$1),createCommonjsModule(function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports})),createClass$1=(unwrapExports(classCallCheck$1),createCommonjsModule(function(t){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports})),setPrototypeOf$1=(unwrapExports(createClass$1),createCommonjsModule(function(n){function i(t,e){return n.exports=i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},n.exports.__esModule=!0,n.exports.default=n.exports,i(t,e)}n.exports=i,n.exports.__esModule=!0,n.exports.default=n.exports})),inherits$1=(unwrapExports(setPrototypeOf$1),createCommonjsModule(function(t){t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&setPrototypeOf$1(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports})),_typeof_1$1=(unwrapExports(inherits$1),createCommonjsModule(function(e){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})),assertThisInitialized$1=(unwrapExports(_typeof_1$1),createCommonjsModule(function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports})),possibleConstructorReturn$1=(unwrapExports(assertThisInitialized$1),createCommonjsModule(function(t){var n=_typeof_1$1.default;t.exports=function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return assertThisInitialized$1(t)},t.exports.__esModule=!0,t.exports.default=t.exports})),getPrototypeOf$1=(unwrapExports(possibleConstructorReturn$1),createCommonjsModule(function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})),dataFrame=(unwrapExports(getPrototypeOf$1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,l){var s={length:0,org:[],jsonOrg:[],data:[],getRowDataAt:o,getRowDataOf:function(i){var t,a=[],r=0;for(t in i=i||{})r++;if(r)for(var e=s.range.start;e<=s.range.end;e++)!function(e){var n=0;Canvax._.each(s.data,function(t){t.field in i&&t.data[e]==i[t.field]&&n++}),n==r&&a.push(o(e))}(e);return a},getFieldData:function(e){var t=[],n=Canvax._.find(s.data,function(t){return t.field==e});return t=n?n.data:t},getDataOrg:function t(e,i,n,a){a=a||0;var r=n||f();if(!r)return;i=i||function(t){return t};function o(t){for(var e=0,n=t.length;e<n;e++)t[e]=i(t[e]);return t}Canvax._.isArray(e)||(e=[e]);var l=[];for(var s=0,u=e.length;s<u;s++)if(Canvax._.isArray(e[s]))l.push(t(e[s],i,n,a+1));else{var d=l;a||(d=[]);for(var h=0,c=r.length;h<c;h++)if(e[s]==r[h].field){d.push(o(r[h].data));break}a||l.push(d)}return l},resetData:function(t){{var e,n;t?(s.org=[],s.jsonOrg=[],s.fields=[],s.data=[],e=Canvax._.extend(!0,{},s.range),n=s.length,i(t),s.data=f(),0!==n&&l&&l.dataZoom&&l.dataZoom.range&&(Canvax._.extend(!0,s.range,e),s.range.end>s.length-1&&(s.range.end=s.length-1),(s.range.start>s.length-1||s.range.start>s.range.end)&&(s.range.start=0))):s.data=f()}},fields:[],range:{start:0,end:0},filters:{}};function i(t){if((t=Array.isArray(t)?t:[t])&&0!=t.length){var e;if(0<t.length&&!Canvax._.isArray(t[0])?(t=function(t){null==t&&(t=[]);{if(0<t.length&&!Canvax._.isArray(t[0])){for(var e=[],n=[],i=0,a=0,r=t.length;a<r;a++){var o=t[a];if(0==a){for(var l in o)n.push(l);e.push(n),i=n.length}for(var s=[],u=0;u<i;u++)s.push(o[n[u]]);e.push(s)}return e}return t}}(s.jsonOrg=t),s.org=t):(s.org=t,s.jsonOrg=function(t){var e=t;if(0<t.length&&Canvax._.isArray(t[0])){e=[];for(var n=t[0],i=n.length,a=1,r=t.length;a<r;a++){for(var o={},l=0;l<i;l++)o[n[l]]=t[a][l];e.push(o)}return e}}(t)),s.range.end=t.length-1-1,!l||(e=l.dataZoom||l.datazoom)&&e.range&&Canvax._.extend(s.range,e.range),t.length&&t[0].length&&!~t[0].indexOf("__index__"))for(var n=0,i=t.length;n<i;n++)n?(t[n].push(n-1),s.jsonOrg[n-1].__index__=n-1):t[0].push("__index__");s.fields=t[0]||[]}}function f(){for(var a=[],t=0,e=s.fields.length;t<e;t++){var n={};n.field=s.fields[t],n.index=t,n.data=[],a.push(n)}i=function(i){Canvax._.each(s.fields,function(e){var t=i[e],n=(l&&l.coord&&(l.coord.xAxis&&e==l.coord.xAxis.field&&"proportion"!=l.coord.xAxis.layoutType||l.coord.aAxis&&e==l.coord.aAxis.field)||isNaN(t)||""===t||null===t||(t=Number(t)),Canvax._.find(a,function(t){return t.field==e}));n&&n.data.push(t)})},r=[],Canvax._.each(s.jsonOrg.slice(s.range.start,s.range.end+1),function(e){var n=!0;Canvax._.keys(s.filters).length&&Canvax._.each(s.filters,function(t){if(Canvax._.isFunction(t)&&!t(e))return n=!1}),n&&(i&&i(e),r.push(e))});var i,r,o=r;return s.length=o.length,a}function o(t){for(var e={},n=s.data,i=0;i<n.length;i++)e[n[i].field]=n[i].data[t];return e}return i(t),s.data=f(),s}})),defineProperty$1=(unwrapExports(dataFrame),createCommonjsModule(function(t){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports})),tools=(unwrapExports(defineProperty$1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaultProps=function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};for(var i in e)i.indexOf("_")&&(e[i]&&e[i].propertys?(n[i]={},t(e[i].propertys,n[i])):!Canvax._.isObject(e[i])||Canvax._.isFunction(e[i])||Canvax._.isArray(e[i])?n[i]=e[i]:n[i]=e[i].default);return n},e.getDisMinATArr=function(t,e){for(var n=0,i=Math.abs(t-e[0]),a=1,r=e.length;a<r;a++)i>Math.abs(t-e[a])&&(i=Math.abs(t-e[a]),n=a);return n}})),tools_1=(unwrapExports(tools),tools.getDefaultProps),tools_2=tools.getDisMinATArr,component=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),u=interopRequireDefault(global$1),d=interopRequireDefault(Canvax);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var i=d.default.event,c=d.default._,i=function(t){(0,l.default)(a,t);var i=h(a);function a(t,e){var n;return(0,r.default)(this,a),n=i.call(this,t,e),c.extend(!0,(0,o.default)(n),(0,tools.getDefaultProps)(a.defaultProps()),t),n.name="component",n.type=null,n._opt=t,n.app=e,n.width=0,n.height=0,n.pos={x:0,y:0},n.margin={top:0,right:0,bottom:0,left:0},n.__cid=d.default.utils.createId("comp_"),n.ctx=e.stage.ctx||e.stage.canvas.getContext("2d"),n}return(0,n.default)(a,[{key:"init",value:function(t,e){}},{key:"draw",value:function(){}},{key:"destroy",value:function(){}},{key:"reset",value:function(){}},{key:"setPosition",value:function(t){(t=t||this.pos).x&&(this.sprite.context.x=t.x),t.y&&(this.sprite.context.y=t.y)}},{key:"layout",value:function(){}}],[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启该组件",default:!1}}}},{key:"registerComponent",value:function(t,e,n){return u.default.registerComponent(t,e,n)}},{key:"_isComponentRoot",value:function(){return!0}},{key:"polyfill",value:function(t){return t}}]),a}(i.Dispatcher);e.default=i}),numeral=(unwrapExports(component),createCommonjsModule(function(t){var e,n;e=commonjsGlobal,n=function(){var y,r,s,u,t,l={},_={},e={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},d={currentLocale:e.currentLocale,zeroFormat:e.zeroFormat,nullFormat:e.nullFormat,defaultFormat:e.defaultFormat,scalePercentBy100:e.scalePercentBy100};function o(t,e){this._input=t,this._value=e}return(y=function(t){var e,n,i,a;if(y.isNumeral(t))e=t.value();else if(0===t||void 0===t)e=0;else if(null===t||r.isNaN(t))e=null;else if("string"==typeof t)if(d.zeroFormat&&t===d.zeroFormat)e=0;else if(d.nullFormat&&t===d.nullFormat||!t.replace(/[^0-9]+/g,"").length)e=null;else{for(n in l)if((a="function"==typeof l[n].regexps.unformat?l[n].regexps.unformat():l[n].regexps.unformat)&&t.match(a)){i=l[n].unformat;break}e=(i=i||y._.stringToNumber)(t)}else e=Number(t)||null;return new o(t,e)}).version="2.0.6",y.isNumeral=function(t){return t instanceof o},y._=r={numberToFormat:function(t,e,n){var i,a,r,o,l,s,u=_[y.options.currentLocale],d=!1,h=!1,c="",f="",p=!1;if(t=t||0,s=Math.abs(t),y._.includes(e,"(")?(d=!0,e=e.replace(/[\(|\)]/g,"")):(y._.includes(e,"+")||y._.includes(e,"-"))&&(o=y._.includes(e,"+")?e.indexOf("+"):t<0?e.indexOf("-"):-1,e=e.replace(/[\+|\-]/g,"")),y._.includes(e,"a")&&(a=!!(a=e.match(/a(k|m|b|t)?/))&&a[1],y._.includes(e," a")&&(c=" "),e=e.replace(new RegExp(c+"a[kmbt]?"),""),1e12<=s&&!a||"t"===a?(c+=u.abbreviations.trillion,t/=1e12):s<1e12&&1e9<=s&&!a||"b"===a?(c+=u.abbreviations.billion,t/=1e9):s<1e9&&1e6<=s&&!a||"m"===a?(c+=u.abbreviations.million,t/=1e6):(s<1e6&&1e3<=s&&!a||"k"===a)&&(c+=u.abbreviations.thousand,t/=1e3)),y._.includes(e,"[.]")&&(h=!0,e=e.replace("[.]",".")),r=t.toString().split(".")[0],s=e.split(".")[1],l=e.indexOf(","),i=(e.split(".")[0].split(",")[0].match(/0/g)||[]).length,s?(r=(f=y._.includes(s,"[")?(s=(s=s.replace("]","")).split("["),y._.toFixed(t,s[0].length+s[1].length,n,s[1].length)):y._.toFixed(t,s.length,n)).split(".")[0],f=y._.includes(f,".")?u.delimiters.decimal+f.split(".")[1]:"",h&&0===Number(f.slice(1))&&(f="")):r=y._.toFixed(t,0,n),c&&!a&&1e3<=Number(r)&&c!==u.abbreviations.trillion)switch(r=String(Number(r)/1e3),c){case u.abbreviations.thousand:c=u.abbreviations.million;break;case u.abbreviations.million:c=u.abbreviations.billion;break;case u.abbreviations.billion:c=u.abbreviations.trillion}if(y._.includes(r,"-")&&(r=r.slice(1),p=!0),r.length<i)for(var g=i-r.length;0<g;g--)r="0"+r;return-1<l&&(r=r.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+u.delimiters.thousands)),s=(r=0===e.indexOf(".")?"":r)+f+(c||""),d?s=(d&&p?"(":"")+s+(d&&p?")":""):0<=o?s=0===o?(p?"-":"+")+s:s+(p?"-":"+"):p&&(s="-"+s),s},stringToNumber:function(t){var e,n,i,a=_[d.currentLocale],r=t,o={thousand:3,million:6,billion:9,trillion:12};if(d.zeroFormat&&t===d.zeroFormat)n=0;else if(d.nullFormat&&t===d.nullFormat||!t.replace(/[^0-9]+/g,"").length)n=null;else{for(e in n=1,"."!==a.delimiters.decimal&&(t=t.replace(/\./g,"").replace(a.delimiters.decimal,".")),o)if(i=new RegExp("[^a-zA-Z]"+a.abbreviations[e]+"(?:\\)|(\\"+a.currency.symbol+")?(?:\\))?)?$"),r.match(i)){n*=Math.pow(10,o[e]);break}n*=(t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1,t=t.replace(/[^0-9\.]+/g,""),n*=Number(t)}return n},isNaN:function(t){return"number"==typeof t&&isNaN(t)},includes:function(t,e){return-1!==t.indexOf(e)},insert:function(t,e,n){return t.slice(0,n)+e+t.slice(n)},reduce:function(t,e){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,i=Object(t),a=i.length>>>0,r=0;if(3===arguments.length)n=arguments[2];else{for(;r<a&&!(r in i);)r++;if(a<=r)throw new TypeError("Reduce of empty array with no initial value");n=i[r++]}for(;r<a;r++)r in i&&(n=e(n,i[r],r,i));return n},multiplier:function(t){t=t.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)},correctionFactor:function(){return Array.prototype.slice.call(arguments).reduce(function(t,e){e=r.multiplier(e);return e<t?t:e},1)},toFixed:function(t,e,n,i){var a=t.toString().split("."),r=e-(i||0),a=2===a.length?Math.min(Math.max(a[1].length,r),e):r,r=Math.pow(10,a),n=(n(t+"e+"+a)/r).toFixed(a);return e-a<i&&(t=new RegExp("\\.?0{1,"+(i-(e-a))+"}$"),n=n.replace(t,"")),n}},y.options=d,y.formats=l,y.locales=_,y.locale=function(t){return t&&(d.currentLocale=t.toLowerCase()),d.currentLocale},y.localeData=function(t){if(!t)return _[d.currentLocale];if(t=t.toLowerCase(),_[t])return _[t];throw new Error("Unknown locale : "+t)},y.reset=function(){for(var t in e)d[t]=e[t]},y.zeroFormat=function(t){d.zeroFormat="string"==typeof t?t:null},y.nullFormat=function(t){d.nullFormat="string"==typeof t?t:null},y.defaultFormat=function(t){d.defaultFormat="string"==typeof t?t:"0.0"},y.register=function(t,e,n){if(e=e.toLowerCase(),this[t+"s"][e])throw new TypeError(e+" "+t+" already registered.");return this[t+"s"][e]=n},y.validate=function(t,e){var n,i,a,r;if("string"!=typeof t&&(t+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",t)),(t=t.trim()).match(/^\d+$/))return!0;if(""===t)return!1;try{a=y.localeData(e)}catch(t){a=y.localeData(y.locale())}return e=a.currency.symbol,i=a.abbreviations,n=a.delimiters.decimal,a="."===a.delimiters.thousands?"\\.":a.delimiters.thousands,(null===(r=t.match(/^[^\d]+/))||(t=t.substr(1),r[0]===e))&&((null===(r=t.match(/[^\d]+$/))||(t=t.slice(0,-1),r[0]===i.thousand||r[0]===i.million||r[0]===i.billion||r[0]===i.trillion))&&(e=new RegExp(a+"{2}"),!t.match(/[^\d.,]/g)&&(!(2<(r=t.split(n)).length)&&(r.length<2?!!r[0].match(/^\d+.*\d$/)&&!r[0].match(e):1===r[0].length?!!r[0].match(/^\d+$/)&&!r[0].match(e)&&!!r[1].match(/^\d+$/):!!r[0].match(/^\d+.*\d$/)&&!r[0].match(e)&&!!r[1].match(/^\d+$/)))))},y.fn=o.prototype={clone:function(){return y(this)},format:function(t,e){var n,i,a,r=this._value,o=t||d.defaultFormat;if(e=e||Math.round,0===r&&null!==d.zeroFormat)i=d.zeroFormat;else if(null===r&&null!==d.nullFormat)i=d.nullFormat;else{for(n in l)if(o.match(l[n].regexps.format)){a=l[n].format;break}i=(a=a||y._.numberToFormat)(r,o,e)}return i},value:function(){return this._value},input:function(){return this._input},set:function(t){return this._value=Number(t),this},add:function(t){var a=r.correctionFactor.call(null,this._value,t);return this._value=r.reduce([this._value,t],function(t,e,n,i){return t+Math.round(a*e)},0)/a,this},subtract:function(t){var a=r.correctionFactor.call(null,this._value,t);return this._value=r.reduce([t],function(t,e,n,i){return t-Math.round(a*e)},Math.round(this._value*a))/a,this},multiply:function(t){return this._value=r.reduce([this._value,t],function(t,e,n,i){var a=r.correctionFactor(t,e);return Math.round(t*a)*Math.round(e*a)/Math.round(a*a)},1),this},divide:function(t){return this._value=r.reduce([this._value,t],function(t,e,n,i){var a=r.correctionFactor(t,e);return Math.round(t*a)/Math.round(e*a)}),this},difference:function(t){return Math.abs(y(this._value).subtract(t).value())}},y.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1==e?"st":2==e?"nd":3==e?"rd":"th"},currency:{symbol:"$"}}),y.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(t,e,n){var i=y._.includes(e," BPS")?" ":"";return t*=1e4,e=e.replace(/\s?BPS/,""),t=y._.numberToFormat(t,e,n),t=y._.includes(t,")")?((t=t.split("")).splice(-1,0,i+"BPS"),t.join("")):t+i+"BPS"},unformat:function(t){return+(1e-4*y._.stringToNumber(t)).toFixed(15)}}),u={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},t="("+(t=(s={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}).suffixes.concat(u.suffixes.filter(function(t){return s.suffixes.indexOf(t)<0})).join("|")).replace("B","B(?!PS)")+")",y.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(t)},format:function(t,e,n){var i,a,r,o=y._.includes(e,"ib")?u:s,l=y._.includes(e," b")||y._.includes(e," ib")?" ":"";for(e=e.replace(/\s?i?b/,""),i=0;i<=o.suffixes.length;i++)if(a=Math.pow(o.base,i),r=Math.pow(o.base,i+1),null===t||0===t||a<=t&&t<r){l+=o.suffixes[i],0<a&&(t/=a);break}return y._.numberToFormat(t,e,n)+l},unformat:function(t){var e,n,i=y._.stringToNumber(t);if(i){for(e=s.suffixes.length-1;0<=e;e--){if(y._.includes(t,s.suffixes[e])){n=Math.pow(s.base,e);break}if(y._.includes(t,u.suffixes[e])){n=Math.pow(u.base,e);break}}i*=n||1}return i}}),y.register("format","currency",{regexps:{format:/(\$)/},format:function(t,e,n){var i,a,r=y.locales[y.options.currentLocale],o={before:e.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:e.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(e=e.replace(/\s?\$\s?/,""),i=y._.numberToFormat(t,e,n),0<=t?(o.before=o.before.replace(/[\-\(]/,""),o.after=o.after.replace(/[\-\)]/,"")):t<0&&!y._.includes(o.before,"-")&&!y._.includes(o.before,"(")&&(o.before="-"+o.before),a=0;a<o.before.length;a++)switch(o.before[a]){case"$":i=y._.insert(i,r.currency.symbol,a);break;case" ":i=y._.insert(i," ",a+r.currency.symbol.length-1)}for(a=o.after.length-1;0<=a;a--)switch(o.after[a]){case"$":i=a===o.after.length-1?i+r.currency.symbol:y._.insert(i,r.currency.symbol,-(o.after.length-(1+a)));break;case" ":i=a===o.after.length-1?i+" ":y._.insert(i," ",-(o.after.length-(1+a)+r.currency.symbol.length-1))}return i}}),y.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(t,e,n){t=("number"!=typeof t||y._.isNaN(t)?"0e+0":t.toExponential()).split("e");return e=e.replace(/e[\+|\-]{1}0/,""),y._.numberToFormat(Number(t[0]),e,n)+"e"+t[1]},unformat:function(t){var e=y._.includes(t,"e+")?t.split("e+"):t.split("e-"),n=Number(e[0]),e=Number(e[1]);return e=y._.includes(t,"e-")?-1*e:e,y._.reduce([n,Math.pow(10,e)],function(t,e,n,i){var a=y._.correctionFactor(t,e);return t*a*(e*a)/(a*a)},1)}}),y.register("format","ordinal",{regexps:{format:/(o)/},format:function(t,e,n){var i=y.locales[y.options.currentLocale],a=y._.includes(e," o")?" ":"";return e=e.replace(/\s?o/,""),a+=i.ordinal(t),y._.numberToFormat(t,e,n)+a}}),y.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(t,e,n){var i=y._.includes(e," %")?" ":"";return y.options.scalePercentBy100&&(t*=100),e=e.replace(/\s?\%/,""),t=y._.numberToFormat(t,e,n),t=y._.includes(t,")")?((t=t.split("")).splice(-1,0,i+"%"),t.join("")):t+i+"%"},unformat:function(t){t=y._.stringToNumber(t);return y.options.scalePercentBy100?.01*t:t}}),y.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(t,e,n){var i=Math.floor(t/60/60),a=Math.floor((t-60*i*60)/60),t=Math.round(t-60*i*60-60*a);return i+":"+(a<10?"0"+a:a)+":"+(t<10?"0"+t:t)},unformat:function(t){var t=t.split(":"),e=0;return 3===t.length?e=(e=(e+=60*Number(t[0])*60)+60*Number(t[1]))+Number(t[2]):2===t.length&&(e=(e+=60*Number(t[0]))+Number(t[1])),Number(e)}}),y},t.exports?t.exports=n():e.numeral=n()})),coord=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=interopRequireDefault(_typeof_1$1),g=interopRequireDefault(defineProperty$1),r=interopRequireDefault(classCallCheck$1),o=interopRequireDefault(createClass$1),l=interopRequireDefault(assertThisInitialized$1),s=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),i=interopRequireDefault(component),d=interopRequireDefault(Canvax),h=interopRequireDefault(numeral);function y(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function c(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var _=d.default._,f=function(t){(0,s.default)(a,t);var i=c(a);function a(t,e){var n;return(0,r.default)(this,a),n=i.call(this,t,e),_.extend(!0,(0,l.default)(n),(0,tools.getDefaultProps)(a.defaultProps())),n.name="coord",n._opt=t,n.app=e,n.dataFrame=n.app.dataFrame,n.sprite=new d.default.Display.Sprite({name:"coord_"+t.type}),n.app.coordSprite.addChild(n.sprite),n.graphsFieldsMap=null,n.induce=null,n._axiss=[],n}return(0,o.default)(a,[{key:"init",value:function(){this.graphsFieldsMap=this.setGraphsFieldsMap()}},{key:"draw",value:function(){var t=this.app.padding;this.width=this.app.width-t.left-t.right,this.height=this.app.height-t.top-t.bottom,this.origin.x=t.left,this.origin.y=t.top}},{key:"setGraphsFieldsMap",value:function(h){var c=this,f=0,n=[],p=(h&&_.each(this.getAxiss(h),function(t){t.field&&(n=n.concat(t.field))}),this.app._opt.graphs?_.flatten([this.app._opt.graphs]):[]);return p.forEach(function(t){var e;t.field&&(e=_.flatten([t.field])).length&&-1==_.flatten(n).indexOf(e[0])&&(n=n.concat(t.field))}),function t(e){_.isString(e)&&(e=[e]);for(var s=_.clone(e),u=0,n=e.length;u<n;u++){var d=e[u];_.isString(d)&&!function(){for(var t=c.app.getTheme(f),e=void 0,n=void 0,i=void 0,a=0,r=p.length;a<r;a++)if(e=p[a],-1<(n=_.flatten([e.field]).indexOf(d))){i=e.color;break}i&&("string"==typeof i&&(t=i),Array.isArray(i)&&(t=i[n]),"function"==typeof i&&(t=i.apply(c.app,[e])));var o=c.fieldsConfig[d],l=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){(0,g.default)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({field:d,name:d,type:e.type,enabled:!0,color:t,ind:f++},c.fieldsConfig[d]||{});l.getFormatValue=function(t){return c.getFormatValue(t,o,l)},(t=h?h.type||"yAxis":null)&&(l[t]=c.getAxis({type:t,field:d})),s[u]=l}(),_.isArray(d)&&(s[u]=t(d))}return s}(n)}},{key:"getFormatValue",value:function(t,e){return e&&e.format?("string"==typeof e.format&&(t=(0,h.default)(t).format(e.format)),"function"==typeof e.format&&(t=e.format.apply(this,arguments))):"object"==(0,n.default)(t)?t=JSON.stringify(t):isNaN(t)||""===t||null===t||(e=t.toString().split("."),t=(0,h.default)(e[0]).format("0,0"),1<e.length&&(t+="."+e[1])),t}},{key:"setFieldEnabled",value:function(n){!function e(t){_.each(t,function(t){_.isArray(t)?e(t):t.field&&t.field==n&&(t.enabled=!t.enabled)})}(this.graphsFieldsMap)}},{key:"getFieldConfig",value:function(n){var e,i=this,a=null;return function e(t){_.each(t,function(t){if(_.isArray(t))e(t);else if(t.field&&t.field==n)return a=t,!1})}(i.graphsFieldsMap),a||(e=(this._opt.fieldsConfig||{})[n])&&(e.getFormatValue=function(t){return i.getFormatValue(t,e,e)},a=e),a}},{key:"getEnabledFieldsOf",value:function(n){var i=[],a=n?n.type:"yAxis";return _.each(this.graphsFieldsMap,function(t){var e;_.isArray(t)?(e=[],_.each(t,function(t){t[a]===n&&t.field&&t.enabled&&e.push(t.field)}),e.length&&i.push(e)):t[a]===n&&t.field&&t.enabled&&i.push(t.field)}),i}},{key:"filterEnabledFields",value:function(t){var n=this,i=[];return _.isArray(t)||(t=[t]),_.each(t,function(t){var e;_.isArray(t)?(e=[],_.each(t,function(t){n.getFieldConfig(t).enabled&&e.push(t)}),e.length&&i.push(e)):n.getFieldConfig(t).enabled&&i.push(t)}),i}},{key:"getAxisDataFrame",value:function(t){return{field:t,org:this.dataFrame.getDataOrg(t,function(t){return null==t||""==t||isNaN(Number(t))?t:Number(t)})}}},{key:"getTipsInfoHandler",value:function(t){var e={nodes:[]};return t.eventInfo&&_.extend(!0,e,t.eventInfo),e}},{key:"hide",value:function(t){this.changeFieldEnabled(t)}},{key:"show",value:function(t){this.changeFieldEnabled(t)}},{key:"getSizeAndOrigin",value:function(){return{width:this.width,height:this.height,origin:this.origin}}},{key:"getPoint",value:function(){}},{key:"getAxisOriginPoint",value:function(){}},{key:"getOriginPos",value:function(){}},{key:"resetData",value:function(){}},{key:"getAxis",value:function(t){return this.getAxiss(t)[0]}},{key:"getAxiss",value:function(o){var t=[],e=Object.keys(o).length;return _.each(this._axiss,function(i){var a,r=0;for(a in o)"field"==a?function(){var e=_.flatten([i[a]]),t=_.flatten([o[a]]),n=!0;_.each(t,function(t){-1==_.indexOf(e,t)&&(n=!1)}),n&&r++}():JSON.stringify(i[a])==JSON.stringify(o[a])&&r++;e==r&&t.push(i)}),t}},{key:"resetGraphsOfAxis",value:function(t){this.app.getGraphs()}}],[{key:"defaultProps",value:function(){return{type:{detail:"坐标系组件",documentation:"坐标系组件，可选值有'rect'（二维直角坐标系）,'polar'（二维极坐标系）,'box'（三维直角坐标系） ",insertText:"type: ",default:"",values:["rect","polar","box","polar3d"]},width:{detail:"坐标系width",default:0},height:{detail:"坐标系height",default:0},origin:{detail:"坐标系原点",propertys:{x:{detail:"原点x位置",default:0},y:{detail:"原点x位置",default:0}}},fieldsConfig:{detail:'字段的配置信息({uv:{name:"",format:""}})，包括中文名称和格式化单位，内部使用numeral做格式化',default:{}}}}}]),a}(i.default);i.default.registerComponent(f,"coord"),e.default=f}),chart=(unwrapExports(coord),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),i=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),r=interopRequireDefault(getPrototypeOf$1),u=interopRequireDefault(global$1),d=interopRequireDefault(Canvax),h=interopRequireDefault(dataFrame),c=interopRequireDefault(setting),f=interopRequireDefault(coord);function p(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,r.default)(n);return t=i?(t=(0,r.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var g=d.default._,y=d.default.$,_=d.default.event,o=(_.types.register("contextmenu"),function(t){(0,i.default)(l,t);var o=p(l);function l(t,e,n,i,a){var r;return(0,s.default)(this,l),(r=o.call(this)).otherOptions=a,r.componentModules=i,r._node=t,e=e||[],r.otherOptions.noDataClone||(e=JSON.parse(JSON.stringify(e,function(t,e){return void 0===e?null:e}))),r._data=e,r._opt=r.polyfill(n),r.dataFrame=r._initDataFrame(r._data,r._opt),r.padding=null,r.el=y.query(t),r.width=t.width||parseInt(r.el.offsetWidth),r.height=t.height||parseInt(r.el.offsetHeight),t.canvax?(r.canvax=t.canvax,r.stage=t.stage):(r.canvax=new d.default.App({el:r.el,webGL:!1}),r.canvax.registEvent(),r.id="chartx_"+r.canvax.id,r.el.setAttribute("chart_id",r.id),r.stage=new d.default.Display.Stage({id:"main-chart-stage"}),r.canvax.addChild(r.stage)),r.setCoord_Graphs_Sp(),r.__highModules=["theme","coord","graphs"],r.components=[],r.inited=!1,r.init(),r}return(0,n.default)(l,[{key:"polyfill",value:function(t){var e,i=this;for(e in t)!function(n){g.flatten([t[n]]).forEach(function(t){var e=i.componentModules.get(n,t.type);e&&e.polyfill(t)})}(e);return t}},{key:"init",value:function(){var t,e,i=this,a=this,n=this._opt;this.padding=this._getPadding(),this._initPadding=JSON.parse(JSON.stringify(this.padding)),n.coord||((t=new f.default({},a)).init(),a.components.push(t)),g.each(this.__highModules,function(i){var t;n[i]&&(t=g.flatten([n[i]]),g.each(t="theme"==i?[t]:t,function(e){var t,n;"graphs"==i&&(!(e.field||e.keyField||e.adcode||e.geoJson||e.geoJsonUrl)||"enabled"in e&&!e.enabled)||(n=a.componentModules.get(i,e.type))&&(t=(a._preComponents||[]).find(function(t){return t.type==e.type&&t.field==e.field}),n=new n(e,a,t||{}),"coord"!=i||e.type||n.init(),a.components.push(n))}))});for(e in this._opt)!function(n){var t;-1==g.indexOf(i.__highModules,n)&&(t=i._opt[n],g.isArray(t)||(t=[t]),g.each(t,function(t){var e=a.componentModules.get(n,t.type);!e||"enabled"in t&&!t.enabled||(e=new e(t,a),a.components.push(e))}))}(e)}},{key:"draw",value:function(t){var n=this,i=Object.assign({},t||{}),t=this.getComponent({name:"coord"}),e=(t&&t.horizontal&&this._drawBeginHorizontal(),this.width-this.padding.left-this.padding.right),a=this.height-this.padding.top-this.padding.bottom,r={x:this.padding.left,y:this.padding.top},o=(t&&(t.draw(i),e=t.width,a=t.height,r=t.origin),this.getComponents({name:"graphs"})),l=o.length,s=0,i=g.extend(i,{width:e,height:a,origin:r});0<this.dataFrame.length&&g.each(o,function(e){e.on("complete",function(t){++s==l&&n.fire("complete"),e.inited=!0}),e.draw(i)});for(var u=0,d=this.components.length;u<d;u++){var h=this.components[u];-1==g.indexOf(this.__highModules,h.name)&&h.draw(i)}this._bindEvent(),t&&t.horizontal&&this._drawEndHorizontal()}},{key:"_drawBeginHorizontal",value:function(){var t=this.padding,e=t.top;t.top=t.right,t.right=t.bottom,t.bottom=t.left,t.left=e}},{key:"_drawEndHorizontal",value:function(){var t=this.graphsSprite.context;t.x+=(this.width-this.height)/2,t.y+=(this.height-this.width)/2,t.rotation=90,t.rotateOrigin={x:this.height/2,y:this.width/2},this._horizontalGraphsText()}},{key:"_horizontalGraphsText",value:function(){g.each(this.getComponents({name:"graphs"}),function(t){!function e(t){var n;t.children&&g.each(t.children,function(t){e(t)}),"text"!=t.type||t.__horizontal||((n=t.context).rotation=n.rotation-90,t.__horizontal=!0)}(t.sprite)})}},{key:"_getPadding",value:function(){var t=c.default.padding,t=(this._opt.coord&&"padding"in this._opt.coord&&(g.isObject(this._opt.coord.padding)||(t=this._opt.coord.padding)),{top:t,right:t,bottom:t,left:t});return t=this._opt.coord&&"padding"in this._opt.coord&&g.isObject(this._opt.coord.padding)?g.extend(t,this._opt.coord.padding):t}},{key:"getTheme",value:function(t){var e=u.default.getGlobalTheme(),n=this.getComponent({name:"theme"});return n&&(e=n.get()),null!=t?e[t%e.length]||"#ccc":e}},{key:"setCoord_Graphs_Sp",value:function(){this.coordSprite=new d.default.Display.Sprite({id:"coordSprite"}),this.stage.addChild(this.coordSprite),this.graphsSprite=new d.default.Display.Sprite({id:"graphsSprite"}),this.stage.addChild(this.graphsSprite)}},{key:"destroy",value:function(){this.clean(),this.el&&(this.el.removeAttribute("chart_id"),this.el.removeAttribute("chartx_version"),this.canvax.destroy(),this.el=null),this._destroy&&this._destroy(),this.fire("destroy")}},{key:"clean",value:function(){for(var t=0,e=this.canvax.children.length;t<e;t++)for(var n=this.canvax.getChildAt(t),i=0,a=n.children.length;i<a;i++)n.getChildAt(i).destroy(),i--,a--;this.setCoord_Graphs_Sp(),this._preComponents=this.components,this.components=[],this.canvax.domView&&(this.canvax.domView.innerHTML=""),this.canvax.event&&(this.canvax.event.curPointsTarget=[]),this.padding=this._initPadding}},{key:"resize",value:function(){var t=parseInt(this.el.offsetWidth),e=parseInt(this.el.offsetHeight);t==this.width&&e==this.height||(this.width=t,this.height=e,this.canvax.resize(),this.inited=!1,this.clean(),this.init(),this.draw({resize:!0}),this.inited=!0)}},{key:"reset",value:function(t,e){(t=u.default._optionsHandle(t))&&(this._opt=this.polyfill(t)),e=1==arguments.length?this._data:e||[],this.otherOptions.noDataClone||(e=JSON.parse(JSON.stringify(e,function(t,e){return void 0===e?null:e}))),this._data=e,this.dataFrame=this._initDataFrame(this._data,this._opt),this.clean(),this.init(),this.draw()}},{key:"resetData",value:function(t,e){var n,i,a,r=this,o=this.dataFrame.org.length,t=(e&&e.comp?this.dataFrame.resetData():(t=t||[],this.otherOptions.noDataClone||(t=JSON.parse(JSON.stringify(t,function(t,e){return void 0===e?null:e}))),this._data=t,this.dataFrame.resetData(this._data)),this.getComponents({name:"graphs"})),l=!0;g.each(t,function(t){if(!t.resetData&&l)return l=!1}),o&&l?(o=this.getComponent({name:"coord"}),n=o.width,i=o.height,a=o.origin,o&&o.resetData(this.dataFrame,e),g.each(t,function(t){t.resetData(r.dataFrame,e,{origin:a,width:n,height:i})}),this.componentsReset(e,a),o&&o.horizontal&&this._horizontalGraphsText()):(this.clean(),this.init(),this.draw(this._opt)),this.fire("resetData")}},{key:"_initDataFrame",value:function(){return h.default.apply(this,arguments)}},{key:"componentsReset",value:function(n){var i=this;g.each(this.components,function(t,e){-1!=g.indexOf(i.__highModules,t.name)||n&&n.comp&&n.comp.__cid==t.__cid||t.reset&&t.reset(i[t.type]||{},i.dataFrame)})}},{key:"getComponentById",value:function(e){var n;return g.each(this.components,function(t){if(t.id&&t.id==e)return n=t,!1}),n}},{key:"getComponent",value:function(t){return this.getComponents(t)[0]}},{key:"getComponents",value:function(i,t){var e,a=[],r=0;for(e in t=t||this.components,i)r++;return r?(g.each(t,function(t){var e,n=0;for(e in i)JSON.stringify(t[e])==JSON.stringify(i[e])&&n++;r==n&&a.push(t)}),a):t}},{key:"getGraph",value:function(t){return this.getGraphs(t)[0]}},{key:"getGraphs",value:function(t){return this.getComponents(t,this.getComponents({name:"graphs"}))}},{key:"getGraphById",value:function(e){var n;return g.each(this.getComponents({name:"graphs"}),function(t){if(t.id==e)return n=t,!1}),n}},{key:"getCoord",value:function(t){return this.getComponent(g.extend(!0,{name:"coord"},t))}},{key:"getLegendData",value:function(){var t,i=this,a=[];return g.each(this.getComponents({name:"graphs"}),function(t){g.each(t.getLegendData(),function(e){var t;g.find(a,function(t){return t.name==e.name})||((t=g.extend(!0,{enabled:!0},e)).color=e.fillStyle||e.color||e.style,a.push(t))})}),a.length||(t=i.getComponent({name:"coord"}),g.each(g.flatten(t.graphsFieldsMap),function(e,t){var n=!1;g.each(i._opt.graphs,function(t){if(-1<g.indexOf(g.flatten([t.field]),e.field))return!(n=!0)}),n&&a.push({enabled:e.enabled,name:e.name||e.field,field:e.field,ind:e.ind,color:e.color,type:e.type,yAxis:e.yAxis})})),a}},{key:"show",value:function(e,n){var t=this.getComponent({name:"coord"});t&&t.show(e,n),g.each(this.getComponents({name:"graphs"}),function(t){t.show(e,n)}),this.componentsReset(n)}},{key:"hide",value:function(e,n){var t=this.getComponent({name:"coord"});t&&t.hide(e,n),g.each(this.getComponents({name:"graphs"}),function(t){t.hide(e,n)}),this.componentsReset(n)}},{key:"triggerEvent",value:function(e){e.eventInfo&&this.getGraphs().forEach(function(t){t.triggerEvent(e)});var t=this.getComponent({name:"tips"}),n=this.getComponent({name:"coord"}),n=(t&&(this._setGraphsTipsInfo.apply(this,[e]),-1<"mouseover,mousedown,tap,longTap".indexOf(e.type)&&(t.show(e),this._tipsPointerAtAllGraphs(e)),-1<"mousemove,touchMove".indexOf(e.type)&&(t.move(e),this._tipsPointerAtAllGraphs(e)),-1<"mouseout".indexOf(e.type)&&!(e.toTarget&&n&&n.induce&&n.induce.containsPoint(n.induce.globalToLocal(e.target.localToGlobal(e.point))))&&(t.hide(e),this._tipsPointerHideAtAllGraphs(e))),this.getComponent({name:"contextmenu"}));n&&(-1<"mousedown,click".indexOf(e.type)&&n.hide(e),"contextmenu"==e.type&&n.show(e))}},{key:"_bindEvent",value:function(){var a=this;this.__bindEvented||(this.on(_.types.get(),function(t){a.triggerEvent(t);var e=a.getComponent({name:"tips"});if(e&&e.linkageName)for(var n in u.default.instances){var i,n=u.default.instances[n];n!=a&&((i=n.getComponent({name:"tips"}))&&i.linkageName&&i.linkageName==e.linkageName&&(t.eventInfo&&t.eventInfo.nodes&&(t.eventInfo.nodes=[]),t.eventInfo.isLinkageTrigger=!0,n.triggerEvent.apply(n,[t])))}}),this.__bindEvented=!0)}},{key:"_setGraphsTipsInfo",value:function(e){e.eventInfo||(e.eventInfo={});var n,i,t=this.getComponent({name:"coord"});t&&(e.eventInfo=t.getTipsInfoHandler(e)),"tipsEnabled"in e.eventInfo||(e.eventInfo.tipsEnabled=!0),e.eventInfo.nodes&&e.eventInfo.nodes.length||(n=[],i=e.eventInfo.iNode,g.each(this.getComponents({name:"graphs"}),function(t){t.getNodesAt&&void 0!==i&&(t=t.getNodesAt(i,e))&&t.length&&(Array.isArray(t)||(t=[t]),n=n.concat(t))}),e.eventInfo.nodes=n)}},{key:"_tipsPointerAtAllGraphs",value:function(e){g.each(this.getComponents({name:"graphs"}),function(t){t.tipsPointerOf(e)})}},{key:"_tipsPointerHideAtAllGraphs",value:function(e){g.each(this.getComponents({name:"graphs"}),function(t){t.tipsPointerHideOf(e)})}}]),l}(_.Dispatcher));u.default.registerComponent(o,"chart"),e.default=o})),dataSection_1=(unwrapExports(chart),createCommonjsModule(function(t,e){function c(t){return parseFloat(t.toPrecision(14))}function i(t,e,n){t=Canvax._.without(t,void 0,null,"");var i=n&&n.scale?parseFloat(n.scale):1,n=n&&n.isInt?1:0,a=(isNaN(i)&&(i=1),Canvax._.max(t)),r=a,i=(a*=i,Canvax._.min(t));if(i==a)return 0<a?[i=0,a]:a<0?[a,0]:[0,a=1];t=a-i;t&&(s=i,(i-=.05*t)<0&&0<=s&&(i=0),a+=.05*t);var o=function(t,e){for(var n=[1,2,5,10],i=t/e,a=0;a<n.length&&!(i<=((t=n[a])+(n[a+1]||n[a]))/2);a++);return t*=e}(o=.3*(a-i),Math.pow(10,Math.floor(Math.log(o)/Math.LN10)));n&&(o=Math.ceil(o));for(var l,s=c(Math.floor(i/o)*o),u=c(Math.ceil(a/o)*o),d=[],h=s;h<=u&&(d.push(h),(h=c(h+o))!==l);)l=h;return 3<=d.length&&d[d.length-2]>=r&&d.pop(),d}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default={section:function(t,e,n){return Canvax._.uniq(i(t,0,n))}}})),axis_1=(unwrapExports(dataSection_1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=interopRequireDefault(classCallCheck$1),a=interopRequireDefault(createClass$1),r=interopRequireDefault(dataSection_1),n=function(){function n(t,e){(0,i.default)(this,n),this._opt=Canvax._.clone(t),this.dataOrg=e||[],this._dataSectionLayout=[],this._cellCount=null,this._cellLength=null,this._dataSectionGroup=[],this.originPos=0,this._originTrans=0,this._min=null,this._max=null,Canvax._.extend(!0,this,(0,tools.getDefaultProps)(n.defaultProps()),t)}return(0,a.default)(n,[{key:"resetDataOrg",value:function(t){this.dataSection=[],this._dataSectionGroup=[],this.dataOrg=t,this._cellCount=null,this._cellLength=null}},{key:"setAxisLength",value:function(t){this.axisLength=t,this.calculateProps()}},{key:"calculateProps",value:function(){var i=this;"proportion"==this.layoutType&&(this._min=Canvax._.min(this.dataSection),this._max=Canvax._.max(this.dataSection),"origin"in this._opt||(this.origin=0,Canvax._.max(this.dataSection)<0&&(this.origin=Canvax._.max(this.dataSection)),0<Canvax._.min(this.dataSection)&&(this.origin=Canvax._.min(this.dataSection))),this._originTrans=this._getOriginTrans(this.origin),this.originPos=this.getPosOfVal(this.origin)),this._dataSectionLayout=[],Canvax._.each(this.dataSection,function(t,e){var n=e,e=("proportion"==i.layoutType&&(n=i.getIndexOfVal(t)),parseInt(i.getPosOf({ind:e,val:t}),10));i._dataSectionLayout.push({val:t,ind:n,pos:e})})}},{key:"getDataSection",value:function(){return this.dataSection}},{key:"setDataSection",value:function(){if(Array.isArray(this._opt.dataSection)&&this._opt.dataSection.length)this.dataSection=this._opt.dataSection,this._dataSectionGroup=[this.dataSection];else if("proportion"==this.layoutType){var t=this._getDataSection();"origin"in this._opt&&t.push(this._opt.origin),1==t.length&&(e=t[0],t=10<Math.abs(e)?[e-1,e,e+1]:1<=Math.abs(e)&&Math.abs(e)<=10?[e-.1,e,e+.1]:[.5*e,e,2*e]),Array.isArray(this.verniers)&&this.verniers.length&&(t=t.concat(this.verniers)),this.symmetric&&(e=Canvax._.min(t),n=Canvax._.max(t),Math.abs(e)>Math.abs(n)?t.push(Math.abs(e)):t.push(-Math.abs(n)));for(var e,n,i=0,a=t.length;i<a;i++)t[i]=Number(t[i]),isNaN(t[i])&&(t.splice(i,1),i--,a--);Canvax._.isFunction(this.sectionHandler)&&(this.dataSection=this.sectionHandler(t)),this.dataSection&&this.dataSection.length||(this.dataSection=r.default.section(t,3)),this.symmetric&&(e=Canvax._.min(this.dataSection),n=Canvax._.max(this.dataSection),Math.abs(e)>Math.abs(n)?this.dataSection.push(Math.abs(e)):this.dataSection.unshift(-Math.abs(n))),0==this.dataSection.length&&(this.dataSection=[0]),this._dataSectionGroup=[Canvax._.clone(this.dataSection)],this._middleweight(),this._sort()}else this.dataSection=Canvax._.flatten(this.dataOrg),this._dataSectionGroup=[this.dataSection];this._middleWeightPos()}},{key:"_getDataSection",value:function(){var e=1;return Canvax._.each(this.dataOrg,function(t){e=Math.max(t.length,e)}),1==e?this._oneDimensional():1<e?this._twoDimensional():void 0}},{key:"_oneDimensional",value:function(){for(var t=Canvax._.flatten(this.dataOrg),e=[],n=0,i=t.length;n<i;n++)null!=t[n]&&null!=t[n]&&""!=t[n]&&e.push(t[n]);return Canvax._.unique(e)}},{key:"_twoDimensional",value:function(){var h,t=this.dataOrg,c=[];return Canvax._.each(t,function(t){if(t.length)if(Canvax._.isArray(t[0])){for(var e=[],n=t[0].length,i=t.length,a=0;a<n;a++){for(var r=0,o=0,l=0,s=0,u=0;u<i;u++){var d=t[u][a];!d&&0!==d||(null==h&&(h=d),h=Math.min(h,d),0<=d?(r+=d,o++):(l+=d,s++))}o&&e.push(r),s&&e.push(l)}c.push(e)}else c.push(t)}),c.push(h),Canvax._.flatten(c)}},{key:"_addValToSection",value:function(t){this.addVerniers(t),this.setDataSection(),this.calculateProps()}},{key:"addVerniers",value:function(t){-1==this.verniers.indexOf(t)&&this.verniers.push(t)}},{key:"_sort",value:function(){this.sort&&"desc"==this._getSortType()&&(this.dataSection.reverse(),Canvax._.each(this._dataSectionGroup,function(t){t.reverse()}),this._dataSectionGroup.reverse())}},{key:"_getSortType",value:function(){var t;return t=(t=Canvax._.isString(this.sort)?this.sort:t)||"asc"}},{key:"_middleweight",value:function(){if(this.middleWeight){Canvax._.isArray(this.middleWeight)||(this.middleWeight=[this.middleWeight]);for(var t=Canvax._.min(this.dataSection),e=Canvax._.max(this.dataSection),n=[t],i=[],a=0,r=this.middleWeight.length;a<r;a++){var o=t,l=(o=0<a?this.middleWeight[a-1]:o)+parseInt((this.middleWeight[a]-o)/2);n.push(l),n.push(this.middleWeight[a]),i.push([o,l,this.middleWeight[a]])}var s=this.middleWeight.slice(-1)[0];s<e&&(n.push(s+(e-s)/2),n.push(e),i.push([s,s+(e-s)/2,e])),this.dataSection=n,this._dataSectionGroup=i}}},{key:"_middleWeightPos",value:function(){var e,n,i=this;this.middleWeightPos&&(Canvax._.isArray(this.middleWeightPos)||(this.middleWeightPos=[this.middleWeightPos]),e=0,Canvax._.each(this.middleWeightPos,function(t){e+=t}),e<1&&this.middleWeightPos.push(1-e),1<e&&(this.middleWeightPos=null)),this.middleWeight?this.middleWeightPos||(this.middleWeightPos=[],n=0,Canvax._.each(this.middleWeight,function(){var t=1/(i.middleWeight.length+1);n+=t,i.middleWeightPos.push(t)}),this.middleWeightPos.push(1-n)):this.middleWeightPos=[1]}},{key:"_getOriginTrans",value:function(r){for(var o=this,l=0,s=this,t=this._dataSectionGroup.length,u=this.axisLength/t,e=0,n=t;e<n&&"break"!==function(n){var t=o._dataSectionGroup[n],i=(u=o.axisLength*o.middleWeightPos[n],0);if(Canvax._.each(o.middleWeightPos,function(t,e){e<n&&(i+=s.axisLength*t)}),"proportion"==o.layoutType){var e=Canvax._.min(t),t=Canvax._.max(t),a=Math.abs(t-e);if(e<=r&&r<=t)return l=(r-e)/a*u+i,"break"}}(e);e++);return"desc"==this.sort&&(l=-(u-l)),parseInt(l)}},{key:"_getLayoutDataOf",value:function(e){var n,i;return Canvax._.each(["val","ind","pos"],function(t){t in e&&(n=t)}),Canvax._.each(this._dataSectionLayout,function(t){t[n]===e[n]&&(i=t)}),i||{}}},{key:"getPosOfVal",value:function(t){return this.getPosOf({val:t})}},{key:"getPosOfInd",value:function(t){var e=this._getLayoutDataOf({ind:t}).pos;return null!=e?e:this.getPosOf({ind:t})}},{key:"getPosOf",value:function(h){var t,c,f=this,p=this,e=this._getCellCount();if("proportion"==this.layoutType)for(var n=0,i=this._dataSectionGroup.length;n<i;n++)!function(n,t){var e,i,a=f._dataSectionGroup[n],r=f.axisLength*f.middleWeightPos[n],o=0,l=(Canvax._.each(f.middleWeightPos,function(t,e){e<n&&(o+=p.axisLength*t)}),Canvax._.min(a)),a=Canvax._.max(a),s="val"in h?h.val:f.getValOfInd(h.ind),u=f.origin,d=!(u<l||a<u);d||(u=l),l<=s&&s<=a?(e=Math.max(Math.abs(a-u),Math.abs(u-l)),i=Math.abs(a-l),c=(s-u)/e*(e/i*r)+o,isNaN(c)&&(c=parseInt(o)),d&&(c+=f._originTrans)):(a<s&&n==t-1&&(c=p.axisLength),s<l&&0==n&&(c=0))}(n,i);else 1==e?c=this.axisLength/2:-1!=(t="ind"in h?h.ind:this.getIndexOfVal(h.val))&&("rule"==this.layoutType&&(c=t/(e-1)*this.axisLength),"peak"==this.layoutType&&(e=this.getCellLength(),c=e*(t+1)-e/2));return c=c||0,c=Number(c.toFixed(1)),Math.abs(c)}},{key:"getValOfPos",value:function(t){var e=this._getLayoutDataOf({pos:t}).val;return null!=e?e:this._getValOfInd(this.getIndexOfPos(t))}},{key:"getValOfInd",value:function(t){var e=this._getLayoutDataOf({ind:t}).val;return null!=e?e:this._getValOfInd(t)}},{key:"_getValOfInd",value:function(r){var o,l=this,t=Canvax._.flatten(this.dataOrg);return"proportion"==this.layoutType?Canvax._.each(this._dataSectionGroup,function(t,n){var e,i=l.axisLength*l.middleWeightPos[n],a=0;if(Canvax._.each(l.middleWeightPos,function(t,e){e<n&&(a+=l.axisLength*t)}),parseInt(r/i)==n||n==l._dataSectionGroup.length-1)return e=Canvax._.min(t),t=Canvax._.max(t),o=e+(t-e)/i*(r-a),!1}):o=t[r],o}},{key:"getIndexOfPos",value:function(t){var e=this._getLayoutDataOf({pos:t}).ind;if(null!=e)return e;var e=0,n=this.getCellLengthOfPos(t),i=this._getCellCount();return"proportion"==this.layoutType?t:("peak"==this.layoutType&&(e=parseInt(t/n))==i&&(e=i-1),"rule"==this.layoutType&&(e=parseInt((t+n/2)/n),1==i&&(e=0)),e)}},{key:"getIndexOfVal",value:function(e){var n=-1;if("proportion"==this.layoutType){var t=this._getLayoutDataOf({val:e}).ind;if(null!=t)return t;n=this.getPosOfVal(e)}else Canvax._.each(this.dataOrg,function(t){Canvax._.each(t,function(t){t=Canvax._.indexOf(t,e);-1!=t&&(n=t)})});return n}},{key:"getCellLength",value:function(){if(null!==this._cellLength)return this._cellLength;var t=this.axisLength,e=t,n=this._getCellCount();return n&&("proportion"==this.layoutType?e=1:(e=t/n,"rule"==this.layoutType&&(e=1==n?t/2:t/(n-1)),this.posParseToInt&&(e=parseInt(e)))),this._cellLength=e}},{key:"getCellLengthOfPos",value:function(){return this.getCellLength()}},{key:"getCellLengthOfInd",value:function(){return this.getCellLength()}},{key:"_getCellCount",value:function(){if(null!==this._cellCount)return this._cellCount;var t=0;return"proportion"==this.layoutType?t=this.axisLength:this.dataOrg.length&&this.dataOrg[0].length&&this.dataOrg[0][0].length&&(t=this.dataOrg[0][0].length),this._cellCount=t}}],[{key:"defaultProps",value:function(){return{layoutType:{detail:"布局方式",default:"proportion"},axisLength:{detail:"轴长度",default:1},dataSection:{detail:"轴数据集",default:[]},sectionHandler:{detail:"自定义dataSection的计算公式",default:null},verniers:{detail:"设定的游标，dataSection的区间一定会覆盖这些值",default:[]},middleWeight:{detail:"区间分隔线",default:null,documentation:"如果middleweight有设置的话 _dataSectionGroup 为被middleweight分割出来的n个数组>..[ [0,50 , 100],[100,500,1000] ]"},middleWeightPos:{detail:"区间分隔线的物理位置，百分比,默认 0.5 ",default:null},symmetric:{detail:"自动正负对称",default:!1,documentation:"proportion下，是否需要设置数据为正负对称的数据，比如 [ 0,5,10 ] = > [ -10, 0 10 ]，象限坐标系的时候需要"},origin:{detail:"轴的起源值",default:null,documentation:"                    1，如果数据中又正数和负数，则默认为0 <br />                    2，如果dataSection最小值小于0，则baseNumber为最小值<br />                    3，如果dataSection最大值大于0，则baseNumber为最大值<br />                    4，也可以由用户在第2、3种情况下强制配置为0，则section会补充满从0开始的刻度值                "},sort:{detail:"排序",default:null},posParseToInt:{detail:"是否位置计算取整",default:!1,documentation:"比如在柱状图中，有得时候需要高精度的能间隔1px的柱子，那么x轴的计算也必须要都是整除的"}}}}]),n}();e.default=n})),axis=(unwrapExports(axis_1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var n=function(t){(0,l.default)(i,t);var n=d(i);function i(t,e){return(0,a.default)(this,i),t=n.call(this,t,e),Canvax._.extend(!0,(0,o.default)(t),(0,tools.getDefaultProps)(i.defaultProps())),t}return(0,r.default)(i,[{key:"addValToSection",value:function(t){var e=this;if(Array.isArray(t)||(t=[t]),"proportion"==this.layoutType){var n=!0;if(t.forEach(function(t){t>=e._min&&t<=e._max||(n=!1)}),n)return}this.dataSection=[],t.forEach(function(t){e._addValToSection(t)}),this._initHandle(),this.draw(),this._coord.resetGraphsOfAxis(this)}}],[{key:"defaultProps",value:function(){return{field:{detail:"轴字段配置",documentation:"目前x轴的field只支持单维度设置，也就是说只支持一条x轴",default:[]},layoutType:{detail:"布局方式",default:"rule"},width:{detail:"轴宽",default:0},height:{detail:"轴高",default:0},enabled:{detail:"是否显示轴",default:!0},animation:{detail:"是否开启动画",default:!0},title:{detail:"轴名称",propertys:{shapeType:"text",textAlign:{detail:"水平对齐方式",default:"center"},textBaseline:{detail:"基线对齐方式",default:"middle"},strokeStyle:{detail:"文本描边颜色",default:null},lineHeight:{detail:"行高",default:0},text:{detail:"轴名称的内容",default:""},fontColor:{detail:"颜色",default:"#999"},fontSize:{detail:"字体大小",default:12}}},tickLine:{detail:"刻度线",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"刻度线宽",default:1},lineLength:{detail:"刻度线长度",default:4},distance:{detail:"和前面一个元素的距离",default:2},strokeStyle:{detail:"描边颜色",default:"#e6e6e6"}}},axisLine:{detail:"轴线配置",propertys:{enabled:{detail:"是否有轴线",default:!0},position:{detail:"轴线的位置",documentation:'default在align的位置（left，right），可选 "center" 和 具体的值',default:"default"},lineWidth:{detail:"轴线宽度",default:1},strokeStyle:{detail:"轴线的颜色",default:"#e6e6e6"}}},label:{detail:"刻度文本",propertys:{enabled:{detail:"是否显示刻度文本",default:!0},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"字体大小",default:10},rotation:{detail:"旋转角度",default:0},format:{detail:"label文本的格式化处理函数",default:null},distance:{detail:"和轴线之间的间距",default:2},textAlign:{detail:"水平方向对齐方式",default:"center"},lineHeight:{detail:"文本的行高",default:1},evade:{detail:"是否开启逃避算法,目前的逃避只是隐藏",default:!0},alpha:{detail:"透明度",default:1}}},filter:{detail:"过滤函数",documentation:"可以用来过滤哪些yaxis 的 节点是否显示已经颜色之类的",default:null},trimLayout:{detail:"自定义的显示规则函数",documentation:"如果用户有手动的 trimLayout ，那么就全部visible为true，然后调用用户自己的过滤程序",default:null}}}}]),i}(interopRequireDefault(axis_1).default);e.default=n})),xaxis=(unwrapExports(axis),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),f=interopRequireDefault(Canvax),u=interopRequireDefault(numeral),i=interopRequireDefault(axis);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var p=f.default._,g=f.default.Shapes.Line,i=function(t){(0,l.default)(a,t);var i=d(a);function a(t,e,n){return(0,r.default)(this,a),(e=i.call(this,t,e.org)).type="xAxis",e._coord=n||{},e._title=null,e._axisLine=null,e._formatTextSection=[],e._textElements=[],e.pos={x:0,y:0},e.layoutData=[],e.sprite=null,e.isH=!1,p.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(a.defaultProps()),t),e.init(t),e}return(0,n.default)(a,[{key:"init",value:function(t){this._setField(),this._initHandle(t),this.sprite=new f.default.Display.Sprite({id:"xAxisSprite_"+(new Date).getTime()}),this.rulesSprite=new f.default.Display.Sprite({id:"xRulesSprite_"+(new Date).getTime()}),this.sprite.addChild(this.rulesSprite)}},{key:"_initHandle",value:function(t){var n=this;!t||!t.isH||t.label&&void 0!==t.label.rotaion||(this.label.rotation=90),this.setDataSection(),n._formatTextSection=[],n._textElements=[],p.each(n.dataSection,function(t,e){n._formatTextSection[e]=n._getFormatText(t,e);t=new f.default.Display.Text(n._formatTextSection[e],{context:{fontSize:n.label.fontSize}});n._textElements[e]=t}),0!=this.label.rotation&&(this.label.textAlign="right"),this._getTitle(),this._setXAxisHeight()}},{key:"_setField",value:function(t){t&&(this.field=t),this.field=p.flatten([this.field])[0]}},{key:"draw",value:function(t){t&&p.extend(!0,this,t),this.setAxisLength(this.width),this._trimXAxis(),this._widget(t),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"resetData",value:function(t,e){e&&p.extend(!0,this,e),this._setField(t.field),this.resetDataOrg(t.org),this._initHandle(),this.draw(e)}},{key:"setX",value:function(t){this.sprite.context.x=t,this.pos.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t,this.pos.y=t}},{key:"_getTitle",value:function(){this.title.text&&(this._title?this._title.resetText(this.title.text||""):this._title=new f.default.Display.Text(this.title.text,{context:{fontSize:this.title.fontSize,textAlign:this.title.textAlign,textBaseline:this.title.textBaseline,fillStyle:this.title.fontColor,strokeStyle:this.title.strokeStyle,lineWidth:this.title.lineWidth,rotation:this.isH?-180:0}}))}},{key:"_setXAxisHeight",value:function(){var a,r=this;r.enabled?(a=0,this.label.enabled&&p.each(r.dataSection,function(t,e){var n,e=r._textElements[e],i=e.getTextWidth(),e=e.getTextHeight();r.label.rotation&&(e=90==r.label.rotation?i:(n=Math.sin(Math.abs(r.label.rotation)*Math.PI/180),parseInt(n*i))),a=Math.max(a,e)}),this.height=a+this.tickLine.lineLength+this.tickLine.distance+this.label.distance,this._title&&(this.height+=this._title.getTextHeight())):r.height=0}},{key:"getNodeInfoOfX",value:function(t){var t=this.getIndexOfPos(t),e=this.getValOfInd(t),n=this.getPosOf({ind:t,val:e});return this._getNodeInfo(t,e,n)}},{key:"getNodeInfoOfVal",value:function(t){var e=this.getIndexOfVal(t),n=this.getPosOf({ind:e,val:t});return this._getNodeInfo(e,t,n)}},{key:"_getNodeInfo",value:function(t,e,n){return{ind:t,value:e,text:this._getFormatText(e,t),x:n,field:this.field,layoutType:this.layoutType}}},{key:"_trimXAxis",value:function(){for(var t=[],e=this.dataSection,n=0,i=e.length;n<i;n++){var a=this._formatTextSection[n],r=this._textElements[n],a={ind:n,value:e[n],text:a,x:this.getPosOf({val:e[n],ind:n}),textWidth:r.getTextWidth(),field:this.field,visible:null};t.push(a)}return this.layoutData=t,this._trimLayoutData(),t}},{key:"_getFormatText",value:function(t,e){var n;return this.label.format?(p.isFunction(this.label.format)&&(t=this.label.format.apply(this,arguments)),"string"==typeof this.label.format&&(t=(0,u.default)(t).format(this.label.format))):(n=this._coord.fieldsConfig[this.field])&&(t=this._coord.getFormatValue(t,n,e)),t}},{key:"_widget",value:function(s){var u=this,d=this;if(s=s||{},d.enabled){for(var t,h=d.layoutData,c=0,e=function(n,t){p.isFunction(d.filter)&&d.filter({layoutData:h,index:n});var i=h[n];if(!i.visible)return"continue";function e(t){var e=t;return e=p.isFunction(t)?t.apply(u,[i,h,n]):e}var a=i.x,r=d.tickLine.lineLength+d.tickLine.distance+d.label.distance,o=d.rulesSprite.getChildAt(c),r={x:i._text_x||i.x,y:r,fillStyle:e(u.label.fontColor),fontSize:e(u.label.fontSize),rotation:-Math.abs(u.label.rotation),textAlign:e(u.label.textAlign),lineHeight:e(u.label.lineHeight),textBaseline:u.label.rotation?"middle":"top",globalAlpha:e(u.label.alpha)},a=(u.label.rotation&&90!=u.label.rotation&&(r.x+=5,r.y+=3),{x:a,y:u.tickLine.distance,end:{x:0,y:u.tickLine.lineLength},lineWidth:u.tickLine.lineWidth,strokeStyle:u.tickLine.strokeStyle}),l=300;Math.min(1e3/h.length,25);d.animation&&!s.resize||(l=0),o?(o._tickLine&&d.tickLine.enabled&&o._tickLine.animate(a,{duration:l,id:o._tickLine.id}),o._txt&&d.label.enabled&&(o._txt.animate(r,{duration:l,id:o._txt.id}),o._txt.resetText(i.text||""))):(o=new f.default.Display.Sprite({id:"xNode"+c}),d.tickLine.enabled&&(o._tickLine=new g({id:"xAxis_tickline_"+c,context:a}),o.addChild(o._tickLine)),d.label.enabled&&(o._txt=new f.default.Display.Text(i.text,{id:"xAxis_txt_"+c,context:r}),o.addChild(o._txt)),d.rulesSprite.addChild(o)),c++},n=0,i=h.length;n<i;n++)e(n);if(this.rulesSprite.children.length>=c)for(var a=c,r=this.rulesSprite.children.length;a<r;a++)this.rulesSprite.getChildAt(a).remove(),a--,r--;this.axisLine.enabled&&(t={start:{x:0,y:0},end:{x:this.width,y:0},lineWidth:this.axisLine.lineWidth,strokeStyle:this.axisLine.strokeStyle},this._axisLine?this._axisLine.animate(t):(t=new g({context:t}),this.sprite.addChild(t),this._axisLine=t)),this._title&&(this._title.context.y=this.height-this._title.getTextHeight()/2,this._title.context.x=this.width/2,this.sprite.addChild(this._title))}else d.height=0}},{key:"_trimLayoutData",value:function(){var t=this.layoutData.length;this.enabled&&t&&("proportion"==this.layoutType&&this._checkOver(),"peak"==this.layoutType&&this._checkOver(),"rule"==this.layoutType&&this._checkOver())}},{key:"_getRootPR",value:function(){var t=0;return t=this._coord.app?this._coord.app.padding.right:t}},{key:"_checkOver",value:function(){var t,u=this,d=u.layoutData,h=d.length,c=u.label.textAlign;if(!this.label.evade||u.trimLayout){p.each(d,function(t){t.visible=!0}),u.trimLayout&&u.trimLayout(d);for(var e=h-1;0<=e&&!t;e--)d[e].visible&&(t=d[e]);t&&("center"==c&&t.x+t.textWidth/2>u.width&&(t._text_x=u.width-t.textWidth/2+u._getRootPR()),"left"==c&&t.x+t.textWidth>u.width&&(t._text_x=u.width-t.textWidth))}else!function t(e){var n=d[e];if(void 0!==n){n.visible=!0;for(var i=e;i<h-1;i++){var a=d[i+1],r=a.textWidth,o=n.textWidth,l=(u.label.rotation&&(r=Math.min(r,22),o=Math.min(o,22)),a.x),s=n.x+o;if("center"==c&&(l=a.x-r/2,s=n.x+o/2),"right"==c&&(l=a.x-r,s=n.x),i==h-2&&l+r>u.width+u._getRootPR()&&("center"==c&&a.x+r/2>u.width&&(l=u.width-r,a._text_x=u.width-r/2+u._getRootPR()),"left"==c&&a.x+r>u.width&&(l=u.width-r,a._text_x=u.width-r)),!(l-s<1)){t(i+1);break}if(i==h-2)return a.visible=!0,void(n.visible=!1);a.visible=!1}}}(0)}}],[{key:"defaultProps",value:function(){return{}}}]),a}(i.default);e.default=i})),yaxis=(unwrapExports(xaxis),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),_=interopRequireDefault(Canvax),i=interopRequireDefault(axis),u=interopRequireDefault(numeral);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var v=_.default._,x=_.default.Shapes.Line,i=function(t){(0,l.default)(a,t);var i=d(a);function a(t,e,n){return(0,r.default)(this,a),(e=i.call(this,t,e.org)).type="yAxis",e._coord=n||{},e._title=null,e._axisLine=null,e.maxW=0,e.pos={x:0,y:0},e.yMaxHeight=0,e.layoutData=[],e.sprite=null,e.isH=!1,v.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(a.defaultProps()),t),e.init(t),e}return(0,n.default)(a,[{key:"init",value:function(t){this._setField(),this._initHandle(t),this.sprite=new _.default.Display.Sprite({id:"yAxisSprite_"+(new Date).getTime()}),this.rulesSprite=new _.default.Display.Sprite({id:"yRulesSprite_"+(new Date).getTime()}),this.sprite.addChild(this.rulesSprite)}},{key:"_initHandle",value:function(t){t&&(!t.isH||t.label&&void 0!==t.label.rotaion||(this.label.rotation=90),t.label&&t.label.textAlign||(this.label.textAlign="left"==this.align?"right":"left")),this.setDataSection(),this._getTitle(),this._setYaxisWidth()}},{key:"_setField",value:function(t){t&&(this.field=t),v.isArray(this.field)||(this.field=[this.field])}},{key:"draw",value:function(t){v.extend(!0,this,t||{}),this.height=parseInt(this.yMaxHeight-this._getYAxisDisLine()),this.setAxisLength(this.height),this.sprite.cleanAnimates(),this._trimYAxis(),this._widget(t),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"resetData",value:function(t){"width"in this._opt||(this.width=0),this._setField(t.field),this.resetDataOrg(t.org),this._initHandle(),this.draw()}},{key:"setX",value:function(t){this.sprite.context.x=t,this.pos.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t,this.pos.y=t}},{key:"_getTitle",value:function(){var t;this.title.text&&(this._title?this._title.resetText(this.title.text):(t=0,"left"==this.align?t=-90:(t=90,this.isH&&(t=270)),this._title=new _.default.Display.Text(this.title.text,{context:{fontSize:this.title.fontSize,textAlign:this.title.textAlign,textBaseline:this.title.textBaseline,fillStyle:this.title.fontColor,strokeStyle:this.title.strokeStyle,lineWidth:this.title.lineWidth,rotation:t}})))}},{key:"_setYaxisWidth",value:function(){}},{key:"_trimYAxis",value:function(){for(var t=[],e=0,n=this.dataSection.length;e<n;e++){var i={value:this.dataSection[e],y:-Math.abs(this.getPosOf({val:this.dataSection[e],ind:e})),visible:!0,text:""};i.text=this._getFormatText(i.value,e),t.push(i)}for(var a=0,r=0,o=t.length;r<o;r++)0!=r&&(0==a?t[r].text==t[a].text?t[r].visible=!1:a=r:(t[r].text==t[a].text&&(t[a].visible=!1),a=r));this.layoutData=t,this.trimLayout&&this.trimLayout(t)}},{key:"_getFormatText",value:function(t,e){if(this.label.format)v.isFunction(this.label.format)&&(t=this.label.format.apply(this,arguments)),"string"==typeof this.label.format&&(t=(0,u.default)(t).format(this.label.format));else{for(var n,i=v.flatten([this.field]),a=0,r=i.length;a<r&&!(n=this._coord.fieldsConfig[i[a]]);a++);n&&(t=this._coord.getFormatValue(t,n,e))}return t}},{key:"_getYAxisDisLine",value:function(){var t=0;return t=0<(t=0+this.yMaxHeight%this.dataSection.length)?0:t}},{key:"resetWidth",value:function(t){this.width=t,"left"==this.align&&(this.rulesSprite.context.x=this.width)}},{key:"_widget",value:function(t){var e=this;if(t=t||{},e.enabled){for(var n=this.layoutData,i=0,a=e.maxW=0,r=n.length;a<r;a++){v.isFunction(e.filter)&&e.filter({layoutData:n,index:a});var o,l,s,u,d,h,c,f=n[a];f.visible&&(o=f.y,l=e.label.textAlign,c=o+(0==a?-3:0)+(a==n.length-1?3:0),90!=e.label.rotation&&-90!=e.label.rotation||(l="center",a==n.length-1&&(c=o-2,l="right"),0==a&&(c=o)),s=16,f.value==e.origin&&(s=0),f.value<e.origin&&(s=-16),u=void(h=0),d=void(e.tickLine.enabled&&(u={x:h="left"==e.align?-e.tickLine.lineLength-e.tickLine.distance:e.tickLine.distance,y:o,end:{x:e.tickLine.lineLength,y:0},lineWidth:e.tickLine.lineWidth,strokeStyle:e._getStyle(e.tickLine.strokeStyle)})),e.label.enabled&&(h="left"==e.align?h-e.label.distance:h+e.tickLine.lineLength+e.label.distance,this.isH&&(h+=4*("left"==e.align?-1:1)),d={x:h,y:c,fillStyle:e._getStyle(e.label.fontColor),fontSize:e.label.fontSize,rotation:-Math.abs(e.label.rotation),textAlign:l,textBaseline:"middle",lineHeight:e.label.lineHeight,globalAlpha:1}),h=300,e.animation&&!t.resize||(h=0),(c=this.rulesSprite.getChildAt(i))?(c._tickLine&&e.tickLine.enabled&&c._tickLine.animate(u,{duration:h,id:c._tickLine.id}),c._txt&&e.label.enabled&&(c._txt.animate(d,{duration:h,id:c._txt.id}),c._txt.resetText(f.text))):(c=new _.default.Display.Sprite({id:"_node"+i}),e.tickLine.enabled&&(c._tickLine=new x({id:"yAxis_tickline_"+i,context:u}),c.addChild(c._tickLine)),e.label.enabled&&(c._txt=new _.default.Display.Text(f.text,{id:"yAxis_txt_"+i,context:d}),c.addChild(c._txt),e.animation&&!t.resize&&(c._txt.context.y=o+s,c._txt.context.globalAlpha=0,c._txt.animate({y:d.y,globalAlpha:1},{duration:300,id:c._txt.id}))),e.rulesSprite.addChild(c)),e.label.enabled&&(90==e.label.rotation||-90==e.label.rotation?e.maxW=Math.max(e.maxW,c._txt.getTextHeight()):e.maxW=Math.max(e.maxW,c._txt.getTextWidth())),i++)}if(e.rulesSprite.children.length>=i)for(var p=i,g=e.rulesSprite.children.length;p<g;p++)e.rulesSprite.getChildAt(p).remove(),p--,g--;"width"in e._opt||(e.width,e.width=parseInt(e.maxW+e.label.distance),e.tickLine.enabled&&(e.width+=parseInt(e.tickLine.lineLength+e.tickLine.distance)),e._title&&(e.width+=e._title.getTextHeight()),e.width);var y=0;"left"==e.align&&(e.rulesSprite.context.x=e.width,y=e.width),e.axisLine.enabled&&(y={start:{x:y,y:0},end:{x:y,y:-e.height},lineWidth:e.axisLine.lineWidth,strokeStyle:e._getStyle(e.axisLine.strokeStyle)},this._axisLine?this._axisLine.animate(y):(y=new x({context:y}),this.sprite.addChild(y),this._axisLine=y)),this._title&&(this._title.context.y=-this.height/2,this._title.context.x=this._title.getTextHeight()/2,"right"==this.align&&(this._title.context.x=this.width-this._title.getTextHeight()/2),this.sprite.addChild(this._title))}else e.width=0}},{key:"_getStyle",value:function(t){var e=t;return v.isFunction(t)&&(e=t.call(this,this)),e=t?e:"#999"}}],[{key:"defaultProps",value:function(){return{align:{detail:"左右轴设置",default:"left"},layoutType:{detail:"布局方式",default:"proportion"}}}}]),a}(i.default);e.default=i})),grid=(unwrapExports(yaxis),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),h=interopRequireDefault(Canvax);function u(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var c=h.default._,i=h.default.event,f=h.default.Shapes.Line,p=h.default.Shapes.Rect,i=function(t){(0,l.default)(a,t);var i=u(a);function a(t,e){var n;return(0,r.default)(this,a),n=i.call(this,t,e),c.extend(!0,(0,o.default)(n),(0,tools.getDefaultProps)(a.defaultProps())),n.width=0,n.height=0,n._coord=e,n.pos={x:0,y:0},n.sprite=null,n.xAxisSp=null,n.yAxisSp=null,n.init(t),n}return(0,n.default)(a,[{key:"init",value:function(t){c.extend(!0,this,t),this.sprite=new h.default.Display.Sprite}},{key:"setX",value:function(t){this.sprite.context.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t}},{key:"draw",value:function(t){c.extend(!0,this,t),this._widget(),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"clean",value:function(){this.sprite.removeAllChildren()}},{key:"reset",value:function(t){this.sprite.removeAllChildren(),this.draw(t)}},{key:"_widget",value:function(){var d=this;if(this.enabled){for(var n=d._coord._yAxis[0],i=d._coord._xAxis,t=(this.fillSp=new h.default.Display.Sprite,this.sprite.addChild(this.fillSp),c.each([d.fill.xDimension,d.fill.yDimension],function(s,u){var a=u?n:i,r=[];if(s.enabled){r=s.splitVals?c.flatten([s.splitVals]):a.dataSection;var o=[];if(r.length){for(var r=c.uniq(r),l=[0],t=0,e=r.length;t<e;t++)!function(t){var e,n,i=r[t],t=a.getPosOf({val:i});1==l.length&&(t||"xAxis"!=a.type||"rule"!=a.layoutType||(e=d._coord.app.dataFrame,(n=c.find(e.jsonOrg,function(t){return t[a.field]==i}))&&((n=n.__index__)<=e.range.start&&(t=0),n>=e.range.end&&(t=d.width))),l.push(t),o.push(l),l=[l[1]])}(t);c.each(o,function(t,e){var n,i,a,r,o,l;!t||t.length&&t[1]==t[0]||(l={fillStyle:d.getProp(s.fillStyle,e,"#000"),fillAlpha:d.getProp(s.alpha,e,e%2*.02)},u?(l.x=0,l.y=-t[0],l.width=d.width,l.height=-(t[1]-t[0])):(l.x=t[0],l.y=0,l.width=t[1]-t[0],l.height=-d.height),t=new p({context:l}),d.fillSp.addChild(t),(t=d.getProp(s.splitLabels,e,""))&&(n=d.getProp(s.fontColor,e,"#666"),e=d.getProp(s.fontSize,e,12),i="center",a="top",r=l.x+l.width/2,o=l.height+8,u&&(i="left",a="middle",r=l.x+8,o=l.y+l.height/2),l=new h.default.Display.Text(t,{context:{fontSize:e,fillStyle:n,x:r,y:o,textAlign:i,textBaseline:a}}),d.fillSp.addChild(l)))})}}}),d.xAxisSp=new h.default.Display.Sprite,d.sprite.addChild(d.xAxisSp),d.yAxisSp=new h.default.Display.Sprite,d.sprite.addChild(d.yAxisSp),n?n.layoutData:[]),e=0,a=t.length;e<a;e++){var r=t[e];r.visible&&(r=new f({id:"back_line_"+e,context:{y:r.y,lineType:d.getProp(d.line.xDimension.lineType,e,"solid"),lineWidth:d.getProp(d.line.xDimension.lineWidth,e,1),strokeStyle:d.getProp(d.line.xDimension.strokeStyle,e,"#f0f0f0"),visible:!0}}),d.line.xDimension.enabled&&(d.xAxisSp.addChild(r),r.context.start.x=0,r.context.end.x=d.width))}for(var o=0,l=(t=i.layoutData).length;o<l;o++){var s=t[o],s=new f({context:{x:s.x,start:{x:0,y:0},end:{x:0,y:-d.height},lineType:d.getProp(d.line.yDimension.lineType,o,"solid"),lineWidth:d.getProp(d.line.yDimension.lineWidth,o,1),strokeStyle:d.getProp(d.line.yDimension.strokeStyle,o,"#f0f0f0"),visible:!0}});d.line.yDimension.enabled&&d.yAxisSp.addChild(s)}}}},{key:"getProp",value:function(t,e,n){var i=n;return null!=t&&((c.isString(t)||c.isNumber(t))&&(i=t),c.isFunction(t)&&(i=t.apply(this,[e,n])),c.isArray(t)&&(i=t[e])),i}}],[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启grid绘制",default:!0},line:{detail:"网格线条配置",propertys:{xDimension:{detail:"一维方向的网格线",propertys:{enabled:{detail:"是否开启",default:!0},data:[],lineType:{detail:"线的样式，虚线或者实现",default:"solid"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#e6e6e6"}}},yDimension:{detail:"二维方向的网格线",propertys:{enabled:{detail:"是否开启",default:!1},data:[],lineType:{detail:"线的样式，虚线或者实现",default:"solid"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#f0f0f0"}}}}},fill:{detail:"背景色配置",propertys:{xDimension:{detail:"以为方向的背景色块，x方向",propertys:{enabled:{detail:"是否开启",default:!1},splitVals:{detail:"从x轴上面用来分割区块的vals",default:null},splitLabels:{detail:"对应splitVals的文本",default:null},fontColor:{detail:"对应splitLabels的文本颜色",default:null},fontSize:{detail:"对应splitLabels的文本字体大小",default:null},fillStyle:{detail:"背景颜色",default:null},alpha:{detail:"背景透明度",default:null}}},yDimension:{detail:"以为方向的背景色块，y方向",propertys:{enabled:{detail:"是否开启",default:!1},splitVals:{detail:"从x轴上面用来分割区块的vals",default:null},splitLabels:{detail:"对应splitVals的文本",default:null},fontColor:{detail:"对应splitLabels的文本颜色",default:null},fontSize:{detail:"对应splitLabels的文本字体大小",default:null},fillStyle:{detail:"背景颜色",default:null},alpha:{detail:"背景透明度",default:null}}}}}}}}]),a}(i.Dispatcher);e.default=i})),trigger=(unwrapExports(grid),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=interopRequireDefault(createClass$1),i=interopRequireDefault(classCallCheck$1);e.default=(0,n.default)(function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(0,i.default)(this,t),this.comp=e,this.params=n})})),rect=(unwrapExports(trigger),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),i=interopRequireDefault(coord),u=interopRequireDefault(Canvax),d=interopRequireDefault(xaxis),h=interopRequireDefault(yaxis),c=interopRequireDefault(grid),f=interopRequireDefault(trigger);function p(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var g=u.default._,y=u.default.event,_=function(t){(0,l.default)(a,t);var i=p(a);function a(t,e){var n;return(0,r.default)(this,a),n=i.call(this,t,e),g.extend(!0,(0,o.default)(n),(0,tools.getDefaultProps)(a.defaultProps()),n.setDefaultOpt(t,e)),n.type="rect",n._xAxis=null,n._yAxis=[],n._yAxisLeft=null,n._yAxisRight=null,n._grid=null,n.init(t),n}return(0,n.default)(a,[{key:"setDefaultOpt",value:function(t,e){for(var n,i={field:this.dataFrame.fields[0],xAxis:{layoutType:"rule",posParseToInt:!1},grid:{}},a=(g.extend(!0,i,t),i.yAxis?(n=[],g.each(g.flatten([i.yAxis]),function(t){n.push(g.clone(t))}),i.yAxis=n):i.yAxis=[],e._opt.graphs?g.flatten([e._opt.graphs]):[]),r=0;r<a.length;r++){var o=a[r];"bar"==o.type&&(i.xAxis.layoutType="peak"),o.field&&!function(){var n="left",t=("right"==o.yAxisAlign&&(n="right"),null);(t=g.find(i.yAxis,function(t,e){return t.align==n||!t.align&&e==("left"==n?0:1)}))?t.align||(t.align=n):(t={align:n,field:[]},i.yAxis.push(t)),t.field?g.isArray(t.field)||(t.field=[t.field]):t.field=[],g.isArray(o.field)?t.field=t.field.concat(o.field):t.field.push(o.field)}()}var l=[],s=[];return g.each(i.yAxis,function(t,e){t.align||(t.align=e?"right":"left"),("left"==t.align?l:s).push(t)}),i.yAxis=l.concat(s),i.horizontal&&(i.xAxis.isH=!0,g.each(i.yAxis,function(t){t.isH=!0})),"enabled"in i&&(g.extend(!0,i.xAxis,{enabled:i.enabled}),g.each(i.yAxis,function(t){g.extend(!0,t,{enabled:i.enabled})}),i.grid.enabled=i.enabled),"animation"in i&&(g.extend(!0,i.xAxis,{animation:i.animation}),g.each(i.yAxis,function(t){g.extend(!0,t,{animation:i.animation})}),i.grid.animation=i.animation),i}},{key:"init",value:function(){this._initModules(),this.graphsFieldsMap=this.setGraphsFieldsMap({type:"yAxis"})}},{key:"resetData",value:function(t){var n=this,e=this.app.padding,i=this._opt.width||this.app.width,a=(this.dataFrame=t,0),r=0,t=(g.each(this._yAxis,function(t){var e=n.getAxisDataFrame(t.field);t.resetData(e),a+=t.width,"left"==t.align&&(r=t.width)}),i-a-e.left-e.right),i=(this.width=t,this.getAxisDataFrame(this.xAxis.field));this._xAxis.resetData(i,{width:t,pos:{x:e.left+r}}),this.origin.x=r+e.left,this._resetXY_axisLine_pos(),this._grid.reset({animation:!1})}},{key:"draw",value:function(t){var e=this.app.padding,n=(t=t||{}).height||this.app.height,i=t.width||this.app.width,a=(this.horizontal&&(a=i,i=n,n=a),n-this._xAxis.height-e.bottom),r=0,o=0;this._yAxisLeft&&(this._yAxisLeft.draw({pos:{x:e.left,y:a},yMaxHeight:a-e.top,resize:t.resize}),r=this._yAxisLeft.width),this._yAxisRight&&(this._yAxisRight.draw({pos:{x:0,y:a},yMaxHeight:a-e.top,resize:t.resize}),o=this._yAxisRight.width),this._xAxis.draw({pos:{x:e.left+r,y:a},width:i-r-e.left-o-e.right,resize:t.resize}),this._yAxisRight&&this._yAxisRight.setX(r+e.left+this._xAxis.width),this.width=this._xAxis.width,this.height=this._yAxis.length?this._yAxis[0].height:0,this.origin.x=r+e.left,this.origin.y=a,this._grid.draw({width:this.width,height:this.height,pos:this.origin,resize:t.resize}),this._initInduce(),this._resetXY_axisLine_pos(),this.horizontal&&this._horizontal({w:i,h:n})}},{key:"_resetXY_axisLine_pos",value:function(){var t,n=this;this._xAxis.enabled&&("center"==this._xAxis.axisLine.position&&(t=-this._yAxis[0].height/2),"center"==this._xAxis.axisLine.position&&(t=-this._yAxis[0].height/2),void 0!==(t=g.isNumber(this._xAxis.axisLine.position)?-this._yAxis[0].getPosOfVal(this._xAxis.axisLine.position):t)&&(this._xAxis._axisLine.context.y=t)),g.each(this._yAxis,function(t){var e;t.enabled&&("center"==t.axisLine.position&&(e=n._xAxis.width/2),void 0!==(e=g.isNumber(t.axisLine.position)?n._xAxis.getPosOfVal(t.axisLine.position):e)&&(t._axisLine.context.x=e))})}},{key:"getSizeAndOrigin",value:function(){var t,e,n={width:this.width,height:this.height,origin:this.origin};return this.horizontal&&(t=(e=this.app.padding).bottom,e=e.right,n={width:this._yAxis[0].height,height:this._xAxis.width,origin:{x:this._xAxis.height+t,y:this._yAxis[0].height+e}}),n}},{key:"_initModules",value:function(){this._grid=new c.default(this.grid,this),this.sprite.addChild(this._grid.sprite);var t,e,n=this.getAxisDataFrame(this.xAxis.field),n=(this._xAxis=new d.default(this.xAxis,n,this),this._axiss.push(this._xAxis),this.sprite.addChild(this._xAxis.sprite),this.yAxis);g.isArray(n)||(n=[n]),(e=g.find(n,function(t){return"left"==t.align}))&&(t=this.getAxisDataFrame(e.field),this._yAxisLeft=new h.default(e,t,this),this._yAxisLeft.axis=e,this.sprite.addChild(this._yAxisLeft.sprite),this._yAxis.push(this._yAxisLeft),this._axiss.push(this._yAxisLeft)),(t=g.find(n,function(t){return"right"==t.align}))&&(e=this.getAxisDataFrame(t.field),this._yAxisRight=new h.default(t,e,this),this._yAxisRight.axis=t,this.sprite.addChild(this._yAxisRight.sprite),this._yAxis.push(this._yAxisRight),this._axiss.push(this._yAxisRight))}},{key:"_horizontal",value:function(t){var n=t.h,i=t.w;g.each([this.sprite.context],function(t){t.x+=(n-i)/2,t.y+=(i-n)/2;var e={x:i/2,y:n/2};t.rotation=90,t.rotateOrigin=e})}},{key:"changeFieldEnabled",value:function(t){this.setFieldEnabled(t);var t=this.getFieldConfig(t),t=t.yAxis||t.rAxis,e=this.getEnabledFieldsOf(t);t.resetData(this.getAxisDataFrame(e)),this._resetXY_axisLine_pos(),this._grid.reset({animation:!1})}},{key:"_initInduce",value:function(){var e=this;e.induce=new u.default.Shapes.Rect({id:"induce",context:{x:e.origin.x,y:e.origin.y-e.height,width:e.width,height:e.height,fillStyle:"#000000",globalAlpha:0,cursor:"pointer"}}),e.sprite.getChildById("induce")||e.sprite.addChild(e.induce),e.induce.on(y.types.get(),function(t){e.fire(t.type,t),e.app.fire(t.type,t)})}},{key:"getTipsInfoHandler",value:function(t){var e=t.point.x,e=(t.target!==this.induce&&(e=this.induce.globalToLocal(t.target.localToGlobal(t.point)).x),this._xAxis.getNodeInfoOfX(e)),n={xAxis:e,dimension_1:e,title:e.text,iNode:e.ind,nodes:[]};return t.eventInfo&&(g.extend(!0,n,t.eventInfo),n.xAxis&&(t.eventInfo.xAxis=e)),n}},{key:"getPoint",value:function(t){var e={x:0,y:void 0},n={type:"yAxis",field:t.field},i=this.getAxis({type:"xAxis"}),n=this.getAxis(n),a=t.iNode||0,r=t.value,i=("x"in r||(r.x=g.flatten(i.dataOrg)[a]),e.x=i.getPosOf({ind:a,val:r.x}),r.y);return isNaN(i)||null==i||""===i?e.y=void 0:(t.vIndex&&0<n._min&&(i+=n._min),e.y=-n.getPosOfVal(i)),{pos:e,value:r}}},{key:"getAxisOriginPoint",value:function(t){t=this.getAxis(t);return{pos:-t.originPos,value:t.origin}}},{key:"getOriginPos",value:function(t){var t={type:"yAxis",field:t.field},e=this.getAxis({type:"xAxis"}),t=this.getAxis(t);return{x:e.originPos,y:-t.originPos}}},{key:"resetGraphsOfAxis",value:function(e){var n=this,t=this.app.getGraphs();"yAxis"==e.type&&t.forEach(function(t){t.yAxisAlign==e.align&&t.resetData(null,new f.default(n))})}}],[{key:"defaultProps",value:function(){return{horizontal:{detail:"横向翻转坐标系",documentation:"横向翻转坐标系",insertText:"horizontal: ",default:!1,values:[!0,!1]},_props:{xAxis:d.default,yAxis:h.default,grid:c.default}}}}]),a}(i.default);i.default.registerComponent(_,"coord","rect"),e.default=_})),grid$1=(unwrapExports(rect),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),u=interopRequireDefault(Canvax);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var h=u.default._,i=u.default.event,c=u.default.Shapes.Line,f=u.default.Shapes.Circle,p=u.default.Shapes.Polygon,i=function(t){(0,l.default)(a,t);var i=d(a);function a(t,e){var n;return(0,r.default)(this,a),(n=i.call(this,t,e)).width=0,n.height=0,n.app=e,n.pos={x:0,y:0},n.dataSection=[],n.sprite=null,n.induce=null,h.extend(!0,(0,o.default)(n),(0,tools.getDefaultProps)(a.defaultProps()),t),n.init(t),n}return(0,n.default)(a,[{key:"init",value:function(){this.sprite=new u.default.Display.Sprite}},{key:"setX",value:function(t){this.sprite.context.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t}},{key:"draw",value:function(t){h.extend(!0,this,t),this._widget(),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"clean",value:function(){this.sprite.removeAllChildren()}},{key:"reset",value:function(t){}},{key:"_widget",value:function(){var r=this;h.each(this.dataSection,function(t,e){var n,i,a;t&&(t=r.app.getROfNum(t),n=r.app.getPointsOfR(t),i={lineWidth:r.ring.lineWidth,strokeStyle:r._getStyle(r.ring.strokeStyle,e-1),fillStyle:r._getStyle(r.ring.fillStyle,e-1),fillAlpha:r.ring.fillAlpha},a=f,t="circle"==r.ring.shapeType?(i.r=t,new a({context:i})):(i.pointList=[],h.each(n,function(t,e){e<n.length&&i.pointList.push([t.x,t.y])}),new(a=p)({context:i})),r.sprite.addChildAt(t,0),e==r.dataSection.length-1&&(i.fillAlpha=0,i.fillStyle="#ffffff",r.induce=new a({context:i}),r.sprite.addChild(r.induce)),h.each(n,function(t){t=new c({context:{end:t,lineWidth:r.ring.lineWidth,strokeStyle:r.ring.strokeStyle}});r.sprite.addChild(t)}))})}},{key:"_getStyle",value:function(t,e){return h.isArray(t)?t[e%t.length]:t}}],[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启grid",default:!1},ring:{detail:"环背景线",propertys:{shapeType:{detail:"线的图形样式，默认poly，可选circle",default:"poly"},lineType:{detail:"线条样式，sold实线，dashed虚线",default:"sold"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#e5e5e5"},fillStyle:{detail:"环填充色,支持函数配置",default:null},fillAlpha:{detail:"环填充的透明度",default:.5}}},ray:{detail:"射线",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#e5e5e5"}}}}}}]),a}(i.Dispatcher);e.default=i})),polar=(unwrapExports(grid$1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),i=interopRequireDefault(coord),u=interopRequireDefault(Canvax),d=interopRequireDefault(grid$1),h=interopRequireDefault(dataSection_1);function c(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var y=u.default._,f=u.default.event,p=function(t){(0,l.default)(a,t);var i=c(a);function a(t,e){var n;return(0,r.default)(this,a),(n=i.call(this,t,e)).type="polar",y.extend(!0,(0,o.default)(n),(0,tools.getDefaultProps)(a.defaultProps()),n.setDefaultOpt(t,e)),n.init(t),n}return(0,n.default)(a,[{key:"setDefaultOpt",value:function(t,e){var n={rAxis:{field:[]},aAxis:{},grid:{}},e=(y.extend(!0,n,t),y.isArray(n.rAxis.field)||(n.rAxis.field=[n.rAxis.field]),y.flatten([e._opt.graphs])),i=[];return y.each(e,function(t){t.field&&(t=t.field,y.isArray(t)||(t=[t]),i=i.concat(t))}),n.rAxis.field=n.rAxis.field.concat(i),t.aAxis&&t.aAxis.field?n.aAxis.enabled=!0:n.grid.enabled=!1,n}},{key:"init",value:function(){this._initModules(),this.graphsFieldsMap=this.setGraphsFieldsMap({type:"rAxis"})}},{key:"_initModules",value:function(){this.grid.enabled&&(this._grid=new d.default(this.grid,this),this.sprite.addChild(this._grid.sprite)),this.aAxis.enabled&&this.grid.enabled&&(this._aAxisScaleSp=new u.default.Display.Sprite({id:"aAxisScaleSp"}),this.sprite.addChild(this._aAxisScaleSp)),this._axiss.push({type:"rAxis",field:this.rAxis.field})}},{key:"draw",value:function(t){this._computeAttr(),this.rAxis.dataSection=this._getRDataSection(),this.aAxis.data=this.app.dataFrame.getFieldData(this.aAxis.field),this._setAAxisAngleList(),this.grid.enabled&&(this._grid.draw({pos:this.origin,width:this.width,height:this.height,dataSection:this.rAxis.dataSection},this),this.aAxis.enabled&&this._drawAAxis(),this._initInduce())}},{key:"resetData",value:function(){}},{key:"changeFieldEnabled",value:function(t){this.setFieldEnabled(t),this.rAxis.dataSection=this._getRDataSection(),this.aAxis.data=this.app.dataFrame.getFieldData(this.aAxis.field),this.grid.enabled&&this._grid.reset({dataSection:this.rAxis.dataSection},this)}},{key:"_getRDataSection",value:function(){var e=this;if(this._opt.rAxis&&this._opt.rAxis.dataSection)return this._opt.rAxis.dataSection;var n=[];return y.each(y.flatten([e.rAxis.field]),function(t){n=n.concat(e.app.dataFrame.getFieldData(t))}),n.push(0),h.default.section(n,3)}},{key:"_computeAttr",value:function(){for(var t=this.app.padding,e=this.app.width,n=this.app.height,e=("width"in this._opt||(this.width=e-t.left-t.right),"height"in this._opt||(this.height=n-t.top-t.bottom),this.width),n=this.height,i=0,a=0,r=0,o=0,l=[this.startAngle],s=0,u=parseInt((this.startAngle+this.allAngle)/90)-parseInt(this.startAngle/90);s<=u;s++){var d=90*parseInt(this.startAngle/90)+90*s;-1==y.indexOf(l,d)&&d>l.slice(-1)[0]&&l.push(d)}var h=this.startAngle+this.allAngle,c=(-1==y.indexOf(l,h)&&l.push(h),y.each(l,function(t){t%=360;var e=Math.sin(t*Math.PI/180),n=(180==t&&(e=0),Math.cos(t*Math.PI/180));270!=t&&90!=t||(n=0),i=Math.min(i,e),a=Math.max(a,e),r=Math.min(r,n),o=Math.max(o,n)}),h=(Math.abs(r)+Math.abs(o))/(Math.abs(i)+Math.abs(a)),Math.min(e,n)),h=(1==h?e=n=c:e<(c=n*h)?n=e/h:e=c,t.left+(this.width-e)/2),c=t.top+(this.height-n)/2,f=(this.origin={x:h+e*(r/(r-o)),y:c+n*(i/(i-a))},{top:this.origin.y-c,right:h+e-this.origin.x,bottom:c+n-this.origin.y,left:this.origin.x-h}),p=[],g=[["right","bottom"],["bottom","left"],["left","top"],["top","right"]];y.each(l,function(t){t%=360;var e=parseInt(t/90),n=g[e],i=(t%90==0&&(n=[["right","bottom","left","top"][e]]),Math.sin(t*Math.PI/180)),a=(180==t&&(i=0),Math.cos(t*Math.PI/180));270!=t&&90!=t||(a=0),y.each(n,function(t){var e;"top"!=t&&"bottom"!=t||i&&(e=Math.abs(f[t]/i)),"right"!=t&&"left"!=t||a&&(e=Math.abs(f[t]/a)),p.push(e)})}),t=y.min(p),this.aAxis.label.enabled&&(t-=20),this.radius=t}},{key:"getMaxDisToViewOfOrigin",value:function(){var t=this.origin,e=this.app.padding,n=this.app.width,i=this.app.height,n=n-e.left-e.right,i=i-e.top-e.bottom,n=[t.x-e.left,n+e.left-t.x,t.y-e.top,i+e.top-t.y];return y.max(n)}},{key:"getRadiansAtR",value:function(t,e,n){var i,a=this,r=(null==e&&(e=this.width),null==n&&(n=this.height),[]),o=this.app.padding,l={x:this.origin.x-o.left-(this.width-e)/2,y:this.origin.y-o.top-(this.height-n)/2},o=l.y,o=(o<t&&(s=Math.sqrt(Math.pow(t,2)-Math.pow(o,2)),r=r.concat(this._filterPointsInRect([{x:-s,y:-o},{x:s,y:-o}],l,e,n))),e-l.x),o=(o<t&&(i=Math.sqrt(Math.pow(t,2)-Math.pow(o,2)),r=r.concat(this._filterPointsInRect([{x:o,y:-i},{x:o,y:i}],l,e,n))),n-l.y),s=(o<t&&(s=Math.sqrt(Math.pow(t,2)-Math.pow(o,2)),r=r.concat(this._filterPointsInRect([{x:s,y:o},{x:-s,y:o}],l,e,n))),l.x),u=(s<t&&(i=Math.sqrt(Math.pow(t,2)-Math.pow(s,2)),r=r.concat(this._filterPointsInRect([{x:-s,y:i},{x:-s,y:-i}],l,e,n))),[]);0==r.length?u.push([{point:{x:t,y:0},radian:0},{point:{x:t,y:0},radian:2*Math.PI}]):y.each(r,function(t,e){e=e==r.length-1?0:e+1,e=r.slice(e,e+1)[0];u.push([{point:t,radian:a.getRadianInPoint(t)},{point:e,radian:a.getRadianInPoint(e)}])});for(var d=0,h=u.length;d<h;d++)this._checkArcInRect(u[d],t,l,e,n)||(u.splice(d,1),d--,h--);return u}},{key:"_filterPointsInRect",value:function(t,e,n,i){for(var a=0,r=t.length;a<r;a++)this._checkPointInRect(t[a],e,n,i)||(t.splice(a,1),a--,r--);return t}},{key:"_checkPointInRect",value:function(t,e,n,i){var a=t.x+e.x,t=t.y+e.y;return!(a<0||n<a||t<0||i<t)}},{key:"_checkArcInRect",value:function(t,e,n,i,a){var r=t[0],t=t[1],o=t.radian-r.radian,t=(t.radian<r.radian&&(o=2*Math.PI+t.radian-r.radian),(r.radian+o/2)%(2*Math.PI));return this._checkPointInRect(this.getPointInRadianOfR(t,e),n,i,a)}},{key:"getRadianInPoint",value:function(t){var e=2*Math.PI;return(Math.atan2(t.y,t.x)+e)%e}},{key:"getPointInRadianOfR",value:function(t,e){var n=Math.PI,i=Math.cos(t)*e,e=(t!=n/2&&t!=3*n/2||(i=0),Math.sin(t)*e);return{x:i,y:e=t%n==0?0:e}}},{key:"getROfNum",value:function(t){var e=y.max(this.rAxis.dataSection);return this.radius*(+t/+e)}},{key:"getPointsOfR",value:function(e){var n=this,i=[];return y.each(n.aAxis.angleList,function(t){t=Math.PI*t/180,t=n.getPointInRadianOfR(t,e);i.push(t)}),i}},{key:"_setAAxisAngleList",value:function(){var e=this,t=(e.aAxis.angleList=[],this.aAxis.data);if("proportion"==this.aAxis.layoutType)for(var t=[],n=0,i=this.aAxis.data.length;n<i;n++)t.push(n);var a=this.allAngle,r=y.max(t);"proportion"==this.aAxis.layoutType&&r++,y.each(t,function(t){t=(a*(+t/+r)+e.aAxis.beginAngle+a)%a;e.aAxis.angleList.push(t)})}},{key:"_drawAAxis",value:function(){var a=this,t=a.getROfNum(y.max(this.rAxis.dataSection)),r=a.getPointsOfR(t+3);a._aAxisScaleSp.context.x=this.origin.x,a._aAxisScaleSp.context.y=this.origin.y,y.each(this.aAxis.data,function(t,e){var n=r[e],i=y.isFunction(a.aAxis.label.format)?a.aAxis.label.format(t):t,t={value:t,text:i,iNode:e,field:a.aAxis.field};a._getProp(a.aAxis.label.enabled,t)&&(e={x:n.x,y:n.y,fillStyle:a._getProp(a.aAxis.label.fontColor,t)},y.extend(e,a._getTextAlignForPoint(Math.atan2(n.y,n.x))),a._aAxisScaleSp.addChild(new u.default.Display.Text(i,{context:e})),a.aAxis.layoutData.push(i))})}},{key:"_getTextAlignForPoint",value:function(t){var e="center",n="bottom";return t>-Math.PI/2&&t<0&&(e="left",n="bottom"),0==t&&(e="left",n="middle"),0<t&&t<Math.PI/2&&(e="left",n="top"),t==Math.PI/2&&(e="center",n="top"),t>Math.PI/2&&t<Math.PI&&(e="right",n="top"),t!=Math.PI&&t!=-Math.PI||(e="right",n="middle"),t>-Math.PI&&t<-Math.PI/2&&(e="right",n="bottom"),{textAlign:e,textBaseline:n}}},{key:"getAxisNodeOf",value:function(t){t=this.getAAxisIndOf(t);if(void 0!==t)return{ind:t,value:this.aAxis.data[t],text:this.aAxis.layoutData[t],angle:this.aAxis.angleList[t]}}},{key:"getAAxisIndOf",value:function(t){var a,r,o,l=this;if(void 0!==t.aAxisInd)return t.aAxisInd;if(l.aAxis.angleList.length)return t=t.point,a=(180*l.getRadianInPoint(t)/Math.PI-l.aAxis.beginAngle)%l.allAngle,r=0,o=l.aAxis.angleList.length,y.each(l.aAxis.angleList,function(t,e){t=(t-l.aAxis.beginAngle)%l.allAngle;var n=e+1,i=(l.aAxis.angleList[n]-l.aAxis.beginAngle)%l.allAngle;if(e==o-1&&(n=0,i=l.allAngle),t<=a&&a<=i)return r=a-t<i-a?e:n,!1}),r}},{key:"_initInduce",value:function(){var e=this;e.induce=this._grid.induce,e.induce&&e.induce.on(f.types.get(),function(t){e.fire(t.type,t),e.app.fire(t.type,t)})}},{key:"getTipsInfoHandler",value:function(t){var e=this.getAxisNodeOf(t),n={nodes:[]};return e&&(n.aAxis=e,n.title=e.text,n.iNode=e.ind),n=t.eventInfo?y.extend(n,t.eventInfo):n}},{key:"getPoint",value:function(){}},{key:"getSizeAndOrigin",value:function(){}},{key:"_getProp",value:function(t,e,n){var i=t;return i=!(i=y.isFunction(t)?t.apply(this,[e]):i)&&n?n:i}},{key:"resetGraphsOfAxis",value:function(t){this.app.getGraphs()}}],[{key:"defaultProps",value:function(){return{allAngle:{detail:"坐标系总角度",documentation:"",default:360,values:[0,360]},startAngle:{detail:"坐标系起始角度",documentation:"",default:0,values:[0,360]},radius:{detail:"坐标系的最大半径",documentation:"默认自动计算view的高宽，如果squareRange==true，则会取Math.min(width,height)",default:"auto",values:null},aAxis:{detail:"角度轴",documentation:"类似直角坐标系中的x轴",propertys:{data:[],angleList:[],layoutData:[],field:{detail:"数据字段",documentation:"",default:""},layoutType:{detail:"布局类型",documentation:"",default:"proportion"},beginAngle:{detail:"起始角度",documentation:"",default:-90},enabled:{detail:"是否显示",documentation:"",default:!1},label:{detail:"文本配置",documentation:"",propertys:{enabled:{detail:"是否显示",documentation:"",default:!0},format:{detail:"label的格式化处理函数",documentation:"",default:null},fontColor:{detail:"label颜色",documentation:"",default:"#666"}}}}},rAxis:{detail:"半径维度轴",documentation:"类似直角坐标系中的y轴维度",propertys:{field:{detail:"数据字段",documentation:"",default:""},dataSection:{detail:"轴的显示数据",documentation:"默认根据源数据中自动计算，用户也可以手动指定",default:!1},enabled:{detail:"是否显示",documentation:"",default:!1}}}}}}]),a}(i.default);i.default.registerComponent(p,"coord","polar"),e.default=p})),arrayWithHoles=(unwrapExports(polar),createCommonjsModule(function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports})),iterableToArrayLimit=(unwrapExports(arrayWithHoles),createCommonjsModule(function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,a,r=[],o=!0,l=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(r.push(i.value),!e||r.length!==e);o=!0);}catch(t){l=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return r}},t.exports.__esModule=!0,t.exports.default=t.exports})),arrayLikeToArray$1=(unwrapExports(iterableToArrayLimit),createCommonjsModule(function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports})),unsupportedIterableToArray$1=(unwrapExports(arrayLikeToArray$1),createCommonjsModule(function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return arrayLikeToArray$1(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?arrayLikeToArray$1(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports})),nonIterableRest=(unwrapExports(unsupportedIterableToArray$1),createCommonjsModule(function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports})),slicedToArray=(unwrapExports(nonIterableRest),createCommonjsModule(function(t){t.exports=function(t,e){return arrayWithHoles(t)||iterableToArrayLimit(t,e)||unsupportedIterableToArray$1(t,e)||nonIterableRest()},t.exports.__esModule=!0,t.exports.default=t.exports})),color=(unwrapExports(slicedToArray),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.colorIsHex=function(t){return o.test(t)},e.colorRgb=s,e.colorRgba=function(t,e){return s(t).replace(")",","+e+")").replace("RGB","RGBA")},e.gradient=function(t,e){for(var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100,i=u(t),t=u(e),a=(t[0]-i[0])/n,r=(t[1]-i[1])/n,o=(t[2]-i[2])/n,l=[],s=0;s<n;s++)l.push(d([parseInt(a*s+i[0]),parseInt(r*s+i[1]),parseInt(o*s+i[2])]));return l},e.hex2rgb=u,e.rgb2hex=d,e.rgba2rgb=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"#ffffff",t=t.match(/[\d\.]+/g),t=(0,l.default)(t,4),n=t[0],i=t[1],a=t[2],t=t[3],e=s(e).match(/[\d\.]+/g),e=(0,l.default)(e,3),r=e[0],o=e[1],e=e[2];return"RGB("+[(1-t)*r+t*n,(1-t)*o+t*i,(1-t)*e+t*a].join(",")+")"};var l=interopRequireDefault(slicedToArray),o=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;function s(t){if(!(t=Array.isArray(t)?t[0]:t))return"RGB(0,0,0)";var e=t.toLowerCase();if(e&&o.test(e)){if(4===e.length){for(var n="#",i=1;i<4;i+=1)n+=e.slice(i,i+1).concat(e.slice(i,i+1));e=n}for(var a=[],r=1;r<7;r+=2)a.push(parseInt("0x"+e.slice(r,r+2)));return"RGB("+a.join(",")+")"}return e}function u(t,e){for(var n=[],i=1;i<7;i+=2)n.push(parseInt("0x"+t.slice(i,i+2)));return n}function d(t){t=(t[0]<<16|t[1]<<8|t[2]).toString(16);return"#"+new Array(Math.abs(t.length-7)).join("0")+t}})),color_1=(unwrapExports(color),color.colorIsHex),color_2=color.colorRgb,color_3=color.colorRgba,color_4=color.gradient,color_5=color.hex2rgb,color_6=color.rgb2hex,color_7=color.rgba2rgb,graphs=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=interopRequireDefault(_typeof_1$1),l=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),s=interopRequireDefault(assertThisInitialized$1),i=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),r=interopRequireDefault(getPrototypeOf$1),u=interopRequireDefault(component),d=interopRequireDefault(Canvax);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,r.default)(n);return t=i?(t=(0,r.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var c=d.default.AnimationFrame,f=d.default._,u=function(t){(0,i.default)(r,t);var a=h(r);function r(t,e){(0,l.default)(this,r),n=a.call(this,t,e),f.extend(!0,(0,s.default)(n),(0,tools.getDefaultProps)(r.defaultProps())),n.name="graphs",n._opt=t||{},n.app=e,n.ctx=e.stage.ctx||e.stage.canvas.getContext("2d"),n.dataFrame=e.dataFrame,n.data=null,n.width=0,n.height=0,n.origin={x:0,y:0},n.inited=!1,n.sprite=new d.default.Display.Sprite({name:"graphs_"+t.type}),n.app.graphsSprite.addChild(n.sprite);var n,i=(n._growTween=null,s.default)(n);return n.sprite.on("destroy",function(){i._growTween&&(c.destroyTween(i._growTween),i._growTween=null)}),n}return(0,n.default)(r,[{key:"tipsPointerOf",value:function(t){}},{key:"tipsPointerHideOf",value:function(t){}},{key:"focusAt",value:function(t,e){}},{key:"unfocusAt",value:function(t,e){}},{key:"selectAt",value:function(t,e){}},{key:"unselectAt",value:function(t,e){}},{key:"getSelectedList",value:function(){return[]}},{key:"getSelectedRowList",value:function(){return[]}},{key:"hide",value:function(t){}},{key:"show",value:function(t){}},{key:"getLegendData",value:function(){}},{key:"triggerEvent",value:function(t){var e,n=this,i=t.eventInfo.trigger;(0,o.default)(i),"string"==typeof i&&("this"==i?i=this:i.split(".").map(function(t){"this"!=t&&(i=n[t])})),!i||(e=i["on"+t.type])&&f.isFunction(e)&&(t.eventInfo&&t.eventInfo.nodes&&t.eventInfo.nodes.length?1==t.eventInfo.nodes.length?e.apply(this,[t,t.eventInfo.nodes[0]]):e.apply(this,[t,t.eventInfo.nodes]):e.apply(this,arguments))}},{key:"grow",value:function(e,t){var n=this,i=this.aniDuration,a=(this.animation||(i=0),0),r=1;"from"in(t=t||{})&&(a=t.from),"to"in t&&(r=t.to),this._growTween=c.registTween({from:{process:a},to:{process:r},duration:i,easing:this.aniEasing,onUpdate:function(t){f.isFunction(e)&&e(t.process)},onComplete:function(){this._growTween=null,n.fire("complete")}})}},{key:"getFieldConfig",value:function(t){return this.app.getComponent({name:"coord"}).getFieldConfig(t)}}],[{key:"defaultProps",value:function(){return{type:{detail:"绘图组件",default:"",insertText:"type: ",values:["bar","line","pie","scat"]},animation:{detail:"是否开启入场动画",default:!0},aniDuration:{detail:"动画时长",default:800},aniEasing:{detail:"折线生长动画的动画类型参数，默认 Linear.None",documentation:"类型演示https://sole.github.io/tween.js/examples/03_graphs.html",default:"Linear.None"},color:{detail:"line,area,node,label的抄底样式",default:""}}}}]),r}(u.default);e.default=u}),bar=(unwrapExports(graphs),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),C=interopRequireDefault(Canvax),n=interopRequireDefault(graphs),S=interopRequireDefault(numeral);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var A=C.default._,P=C.default.event,h=C.default.AnimationFrame,R=C.default.Shapes.Rect,i=function(t){(0,l.default)(i,t);var n=d(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="bar",e.enabledField=null,e.node={_width:0,_count:0},e.select={_fillStyle:"#092848"},e._barsLen=0,e.txtsSp=null,A.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){this.barsSp=new C.default.Display.Sprite({id:"barsSp"}),this.txtsSp=new C.default.Display.Sprite({id:"txtsSp",context:{}})}},{key:"getNodesAt",value:function(e){var n=this.data,i=[];return A.each(this.enabledField,function(t){A.isArray(t)?A.each(t,function(t){t=n[t]?n[t][e]:null;t&&i.push(t)}):(t=n[t]?n[t][e]:null)&&i.push(t)}),i}},{key:"_getTargetField",value:function(t,e,n,i){return A.isString(i)?i:A.isArray(i)?(i=i[t],A.isString(i)?i:A.isArray(i)?i[e]:void 0):void 0}},{key:"_getColor",value:function(t,e){var n=e.field,i=A.flatten([this.field]),a=this.app.getComponent({name:"coord"}).getFieldConfig(n);return A.isFunction(t)&&(t=t.apply(this,[e])),A.isString(t),(t=A.isArray(t)?A.flatten(t)[A.indexOf(i,n)]:t)&&t.lineargradient&&t.lineargradient.length&&(t.points=[0,e.rectHeight,0,0]),t=null==t?a.color:t}},{key:"_getProp",value:function(t,e){var n;return A.isFunction(t)?(n=[],null!=e&&n.push(e),t.apply(this,n)):t}},{key:"_getBarWidth",value:function(t,e){return this.node.width?A.isFunction(this.node.width)?this.node._width=this.node.width(t):this.node._width=this.node.width:(this.node._width=e-Math.max(1,.2*e),1==this.node._width&&3<t&&(this.node._width=t-2)),this.node._width<1&&(this.node._width=1),this.node._width=parseInt(this.node._width),this.node._width>this.node.maxWidth&&(this.node._width=this.node.maxWidth),this.node._width}},{key:"show",value:function(){this.draw()}},{key:"hide",value:function(n){A.each(this.barsSp.children,function(t,e){t=t.getChildById("bar_"+e+"_"+n);t&&t.destroy()}),A.each(this.txtsSp.children,function(t,e){t=t.getChildById("text_"+e+"_"+n);t&&t.destroy()}),this.draw()}},{key:"resetData",value:function(t){t&&(this.dataFrame=t),this.draw()}},{key:"clean",value:function(){this.data={},this.barsSp.removeAllChildren(),this.label.enabled&&this.txtsSp.removeAllChildren()}},{key:"draw",value:function(t){A.extend(!0,this,t=t||{});var y,_,v,x,m,b,w=this,k=w.animation&&!t.resize;this.data=this._trimGraphs(),0==this.enabledField.length||0==this._dataLen?(w._preDataLen=0,this.clean()):(y=w._preDataLen,_=this.enabledField.length,x=w.node._count=v=0,m=w.app.getComponents({name:"graphs",type:"bar"}),A.each(m,function(t,e){t==w&&(x=e)}),b=this.app.getComponent({name:"coord"}),A.each(this.enabledField,function(t,e){var n=(t=A.flatten([t])).length;if(0!=n){v=w.width/w._dataLen,w._barsLen=w._dataLen*_;for(var i=0;i<w._dataLen;i++){var a,r,o=null,l=(0==e?(i<=y-1?o=w.barsSp.getChildById("barGroup_"+i):(o=new C.default.Display.Sprite({id:"barGroup_"+i}),w.barsSp.addChild(o),o.iNode=i),x||(a=void 0,r=v*w.select.width,1<w.select.width&&(r=w.select.width),i<=y-1?((a=o.getChildById("group_region_"+i)).context.width=r,a.context.x=v*i+(v-r)/2,a.context.globalAlpha=-1<A.indexOf(w.select.inds,w.dataFrame.range.start+i)?w.select.alpha:0):(a=new R({id:"group_region_"+i,pointChkPriority:!1,hoverClone:!1,xyToInt:!1,context:{x:v*i+(v-r)/2,y:-w.height,width:r,height:w.height,fillStyle:w._getGroupRegionStyle(i),globalAlpha:-1<A.indexOf(w.select.inds,w.dataFrame.range.start+i)?w.select.alpha:0}}),o.addChild(a),a.iNode=i,a.on(P.types.get(),function(t){t.eventInfo={trigger:w,iNode:this.iNode},g.bind(this)(t),w.app.fire(t.type,t)})))):o=w.barsSp.getChildById("barGroup_"+i),null);0!=e||i<=y-1?l=w.txtsSp.getChildById("txtGroup_"+i):(l=new C.default.Display.Sprite({id:"txtGroup_"+i}),w.txtsSp.addChild(l),l.iGroup=e);for(var s=0;s<n;s++){w.node._count++;var u=w.data[t[s]][i],d=(u.iGroup=e,u.iNode=i,u.iLay=s,u.y-u.fromY),h=(isNaN(u.value)?d=0:Math.abs(d)<Math.abs(w.node.minHeight)&&(d=-w.node.minHeight),u.rectHeight=d,w._getColor(w.node.fillStyle,u)),c=((u.color=h).addColorStop&&w.node.fillStyle.lineargradient&&(c=w.node.fillStyle.lineargradient[parseInt(w.node.fillStyle.lineargradient.length/2)])&&(u.color=c.color),{x:Math.round(u.x),y:u.fromY,width:w.node._width,height:d,fillStyle:h,fillAlpha:w.node.fillAlpha,scaleY:-1}),f=(u.width=c.width,w._getFillStyle(c.fillStyle,c)),f={x:c.x,y:u.yOriginPoint.pos,width:c.width,height:c.height,fillStyle:f,fillAlpha:w.node.fillAlpha,scaleY:0,cursor:"pointer"},d=(w.node.radius&&u.isLeaf&&!w.proportion&&(d=Math.min(w.node._width/2,Math.abs(d)),d=Math.min(d,w.node.radius),f.radius=[d,d,0,0]),k||(delete f.scaleY,f.y=c.y),null),p="bar_"+i+"_"+u.field;(d=i<=y-1?o.getChildById(p):d)?d.context.fillStyle=h:((d=new R({id:p,context:f})).field=u.field,o.addChild(d),w.node.eventEnabled&&d.on(P.types.get(),function(t){t.eventInfo={trigger:"this.node",nodes:[this.nodeData]},g.bind(this)(t),w.app.fire(t.type,t)})),d.finalPos=c,d.iGroup=e,d.iNode=i,d.iLay=s,(d.nodeData=u).nodeElement=d,w.node.filter&&w.node.filter.apply(d,[u,w]),w.label.enabled&&(h=u.value,w.label.format?(!A.isFunction(w.label.format)||void 0===(p=w.label.format.apply(w,[h,u]))&&null===p||(h=p),"string"==typeof w.label.format&&(h=(0,S.default)(h).format(w.label.format))):(f=b.getFieldConfig(u.field))&&(h=f.getFormatValue(h)),null!=h&&""!==h&&(d={fillStyle:w._getProp(w.label.fontColor,u)||c.fillStyle,fontSize:w._getProp(w.label.fontSize,u),lineWidth:w._getProp(w.label.lineWidth,u),strokeStyle:w._getProp(w.label.strokeStyle,u)||c.fillStyle,textBaseline:w._getProp(w.label.verticalAlign,u),rotation:w._getProp(w.label.rotation,u)},p=w._getTextPos(c,u),d.x=p.x,d.y=p.y,d.textAlign=w._getTextAlign(c,u),f=null,p="text_"+i+"_"+u.field,(f=i<=y-1?l.getChildById(p):f)?(f.resetText(h),f.context.x=d.x,f.context.y=d.y):((f=new C.default.Display.Text(h,{id:p,context:d})).field=u.field,l.addChild(f))))}}}function g(t){var e;w.select.enabled&&-1<w.select.triggerEventType.indexOf(t.type)&&(e=w.dataFrame.range.start+this.iNode,-1<A.indexOf(w.select.inds,e)?A.each(m,function(t){t.unselectAt(e)}):A.each(m,function(t){t.selectAt(e)}))}}),this.sprite.addChild(this.barsSp),this.label.enabled&&this.sprite.addChild(this.txtsSp),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.grow(function(){w.fire("complete")},{delay:0,duration:300,animate:k}),w._preDataLen=w._dataLen)}},{key:"_getFillStyle",value:function(t,e){return"string"==typeof t&&(0,color.colorIsHex)(t)?{points:[0,e.height,0,0],lineargradient:[{position:0,color:(0,color.colorRgba)(t,1)},{position:1,color:(0,color.colorRgba)(t,.6)}]}:t}},{key:"setEnabledField",value:function(){this.enabledField=this.app.getComponent({name:"coord"}).filterEnabledFields(this.field)}},{key:"_getGroupRegionStyle",value:function(t){var e=this.select.fillStyle;return A.isArray(this.select.fillStyle)&&(e=this.select.fillStyle[t]),null==(e=A.isFunction(this.select.fillStyle)?this.select.fillStyle.apply(this,[{iNode:t,rowData:this.dataFrame.getRowDataAt(t)}]):e)?this.select._fillStyle:e}},{key:"_trimGraphs",value:function(){var f=this,p=this.app.getComponent({name:"coord"}),e=(this.setEnabledField(),this.data={},[]),n=0,i=0,a=!1,g=(this.absolute?(e=[this],n=this.enabledField.length):A.each(f.app.getComponents({name:"graphs",type:"bar"}),function(t){t.absolute||((a=t===f?!0:a)?t.setEnabledField():i+=t.enabledField.length,n+=t.enabledField.length,e.push(t))}),p.getAxis({type:"xAxis"}).getCellLength()),t=g/(n+1),y=this._getBarWidth(g,t),_=t-y,v=(null!=this.node.xDis&&(_=this.node.xDis),(g-y*n-_*(n-1))/2),t=(i&&(v+=(_+y)*i),this.dataFrame.getDataOrg(this.enabledField)),r=f.getGraphSelectOpt();return!f.select.inds.length&&r&&r.inds&&r.inds.length&&(f.select.inds=A.clone(r.inds)),A.each(t,function(d,h){var c=[];A.each(d,function(t,s){c[s]=[],f._dataLen=t.length,A.each(t,function(t,e){var n=t,i=(f.proportion&&(n=0,A.each(d,function(t){n+=t[e]})),f._getTargetField(h,s,e,f.enabledField)),a=p.getPoint({iNode:e,vIndex:s,field:i,value:{y:t}}),r=a.pos.x,o=r-g/2+v+(y+_)*h,l=0,l=f.proportion?-t/n*p.height:a.pos.y,u=(isNaN(l)&&(l=0),p.getAxisOriginPoint({field:i}));a=function t(e,n,i,a){var r=e[n-1];if(!r)return u.pos;var o=r[i].y,l=r[i].value,s=u.value;return s<=a?s<=l?(r[i].isLeaf=!1,o):t(e,n-1,i,a):l<s?(r[i].isLeaf=!1,o):t(e,n-1,i,a)}(c,s,e,t),l+=a-u.pos,t={type:"bar",value:t,vInd:s,vCount:n,field:i,fromX:o,fromY:a,x:o,y:l,width:y,yOriginPoint:u,isLeaf:!0,xAxis:p.getAxis({type:"xAxis"}).getNodeInfoOfX(r),iNode:e,rowData:f.dataFrame.getRowDataAt(e),color:null,selected:!1};f.data[t.field]||(f.data[t.field]=c[s]),-1<A.indexOf(f.select.inds,e)&&(t.selected=!0),c[s].push(t)})})}),f.data}},{key:"_getTextAlign",value:function(t,e){var n=this.label.textAlign;return e.value<e.yOriginPoint.value&&("left"==n?n="right":"right"==n&&(n="left")),n}},{key:"_getTextPos",value:function(t,e){var n={x:0,y:0},i=t.x,a=t.y,r=!0;switch(t.y>=e.y&&(r=!1),this.label.position){case"top":i=t.x+t.width/2,a=t.y+t.height,r&&(a+=16);break;case"topRight":i=t.x+t.width,a=t.y+t.height,r&&(a+=16);break;case"right":i=t.x+t.width,a=t.y+t.height/2;break;case"rightBottom":i=t.x+t.width,a=t.y;break;case"bottom":i=t.x+t.width/2,a=t.y;break;case"bottomLeft":i=t.x,a=t.y;break;case"left":i=t.x,a=t.y+t.height/2;break;case"leftTop":i=t.x,a=t.y+t.height,r&&(a+=16);break;case"center":i=t.x+t.width/2,a=t.y+t.height/2}i-=this.label.offsetX;var o=1;return a-=(o=e.value<e.yOriginPoint.value?-1:o)*this.label.offsetY,n.x=i,n.y=a,n}},{key:"grow",value:function(r,t){var o,l,s=this;if(s._preDataLen>s._dataLen)for(var e=s._dataLen,n=s._preDataLen;e<n;e++)s.barsSp.getChildAt(e).destroy(),s.label.enabled&&s.txtsSp.getChildAt(e).destroy(),e--,n--;t.animate?(o=A.extend({delay:Math.min(1e3/this._barsLen,80),easing:"Linear.None",duration:500},t),l=0,A.each(s.enabledField,function(t){var e=(t=A.flatten([t])).length;if(0!=e)for(var n=0;n<s._dataLen;n++)for(var i=0;i<e;i++){var a=s.data[t[i]][n],a=s.barsSp.getChildById("barGroup_"+n).getChildById("bar_"+n+"_"+a.field);0==o.duration?(a.context.scaleY=1,a.context.y=+a.finalPos.y,a.context.x=a.finalPos.x,a.context.width=a.finalPos.width,a.context.height=a.finalPos.height):(a._tweenObj&&h.destroyTween(a._tweenObj),a._tweenObj=a.animate({scaleY:1,y:+a.finalPos.y,x:a.finalPos.x,width:a.finalPos.width,height:a.finalPos.height},{duration:o.duration,easing:o.easing,delay:n*o.delay,onUpdate:function(){this.context.fillStyle=s._getFillStyle(this.nodeData.color,this.context)},onComplete:function(t){t.width<3&&this.context&&(this.context.radius=0),++l===s.node._count&&r&&r(s)},id:a.id}))}})):r&&r(s)}},{key:"selectAt",value:function(t){var e,n=this;-1<A.indexOf(this.select.inds,t)||(this.select.inds.push(t),e=t-this.dataFrame.range.start,A.each(this.data,function(t){t=t[e];t.selected=!0,n.setNodeElementStyle(t)}),(t=this.barsSp.getChildById("barGroup_"+e))&&(t=t.getChildById("group_region_"+e))&&(t.context.globalAlpha=this.select.alpha))}},{key:"unselectAt",value:function(t){var e,n,i=this;-1!=A.indexOf(this.select.inds,t)&&(n=A.indexOf(this.select.inds,t),this.select.inds.splice(n,1),e=t-this.dataFrame.range.start,A.each(this.data,function(t){t=t[e];t.selected=!1,i.setNodeElementStyle(t)}),(n=this.barsSp.getChildById("barGroup_"+e))&&(t=n.getChildById("group_region_"+e))&&(t.context.globalAlpha=0))}},{key:"getSelectedRowList",value:function(){var e=[],n=this;return A.each(n.select.inds,function(t){e.push(n.dataFrame.jsonOrg[t])}),e}},{key:"setNodeElementStyle",value:function(t){var e=this._getColor(this.node.fillStyle,t);t.nodeElement.context.fillStyle=e}},{key:"getGraphSelectOpt",value:function(){var t,e=this._opt.select;return e||(t=this.app.getComponents({name:"graphs",type:"bar"}),A.each(t,function(t){if(e)return!1;!e&&t._opt.select&&(e=t.select)})),e}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段设置",documentation:"支持二维数组格式的设置，一维方向就是横向分组，二维方向就是纵向的堆叠",default:null},yAxisAlign:{detail:"绘制在哪根y轴上面",default:"left"},absolute:{detail:"是否脱离graphs的位置计算",documentation:"                    trimGraphs的时候是否需要和其他的 bar graphs一起并排计算，                    true的话这个就会和别的重叠,                    和css中得absolute概念一致，脱离文档流的绝对定位",default:!1},proportion:{detail:"比例柱状图",default:!1},node:{detail:"单个数据对应的图形设置",propertys:{width:{detail:"bar的宽度",default:0},maxWidth:{detail:"最大width",default:50},minWidth:{detail:"最小width",default:1},minHeight:{detail:"最小height",default:0},radius:{detail:"叶子节点的圆角半径",default:10},fillStyle:{detail:"bar填充色",default:null},fillAlpha:{detail:"bar透明度",default:.95},xDis:{detail:"单分组内bar之间的间隔",default:null},filter:{detail:"bar过滤处理器",default:null},eventEnabled:{detail:"是否在单个柱子上面启动事件的监听",default:!0}}},label:{detail:"文本设置",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本颜色",default:null,documentation:"如果有设置text.fontColor那么优先使用fontColor"},fontSize:{detail:"文本字体大小",default:12},format:{detail:"文本格式化处理函数",default:null},lineWidth:{detail:"文本描边线宽",default:0},strokeStyle:{detail:"文本描边颜色",default:null},rotation:{detail:"旋转角度",default:0},textAlign:{detail:"水平对齐方式",documentation:"left center right",default:"center"},verticalAlign:{detail:"垂直基线对齐方式",documentation:"top middle bottom",default:"bottom"},position:{detail:"文本布局位置",documentation:"top,topRight,right,rightBottom,bottom,bottomLeft,left,leftTop,center",default:"top"},offsetX:{detail:"x偏移量",default:0},offsetY:{detail:"y偏移量",default:0}}},select:{detail:"分组选中",documentation:"                    分组的选中，不是选中具体的某个node，这里的选中靠groupRegion来表现出来,                    目前只有在第一个graphs bar 上配置有效",propertys:{enabled:{detail:"是否开启",default:!1},inds:{detail:"选中的分组索引集合",documentation:"选中的列的索引集合,注意，这里的ind不是当前视图的ind，而是加上了dataFrame.range.start的全局ind",default:[]},width:{detail:"选中态背景宽度",default:1},alpha:{detail:"选中态背景透明度",default:.2},fillStyle:{detail:"选中态背景填充色",default:null},triggerEventType:{detail:"触发选中效果的事件",default:"click,tap"}}}}}}]),i}(n.default);n.default.registerComponent(i,"graphs","bar"),e.default=i})),group=(unwrapExports(bar),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var h=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),c=interopRequireDefault(assertThisInitialized$1),i=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),r=interopRequireDefault(getPrototypeOf$1),f=interopRequireDefault(Canvax),p=interopRequireDefault(numeral);function o(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,r.default)(n);return t=i?(t=(0,r.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var g=f.default._,y=f.default.event,l=f.default.AnimationFrame,s=f.default.Shapes.BrokenLine,_=f.default.Shapes.Circle,v=f.default.Shapes.Isogon,x=f.default.Shapes.Rect,m=f.default.Shapes.Path,u=function(t){(0,i.default)(d,t);var u=o(d);function d(t,e,n,i,a,r,o){var l,s=7<arguments.length&&void 0!==arguments[7]?arguments[7]:{};return(0,h.default)(this,d),(l=u.call(this))._graphs=o,l._opt=n,l.fieldConfig=t,l.field=null,l.iGroup=e,l._yAxis=t.yAxis,l.ctx=i,l.w=r,l.h=a,l.y=0,l.data=[],l.sprite=null,l._pointList=[],l._currPointList=[],l._line=null,l._bottomPointList=[],l._currBottomPointList=[],l._bottomLine=null,l.color=t.color,g.extend(!0,(0,c.default)(l),(0,tools.getDefaultProps)(d.defaultProps()),n),l.field=t.field,l.clipRect=null,l.__currFocusInd=-1,l._growed=!1,l._bottomField=s[l.field],l.init(n),l}return(0,n.default)(d,[{key:"init",value:function(){this.sprite=new f.default.Display.Sprite,this.graphSprite=new f.default.Display.Sprite,this.sprite.addChild(this.graphSprite),this.lineSprite=new f.default.Display.Sprite,this.graphSprite.addChild(this.lineSprite),this._focusNodes=new f.default.Display.Sprite({}),this.sprite.addChild(this._focusNodes),this._nodes=new f.default.Display.Sprite({}),this.sprite.addChild(this._nodes),this._labels=new f.default.Display.Sprite({}),this.sprite.addChild(this._labels)}},{key:"_clean",value:function(){this.lineSprite.removeAllChildren(),this._focusNodes.removeAllChildren(),this._nodes.removeAllChildren(),this._labels.removeAllChildren(),this._line=null,this._bottomLine=null,this._area=null}},{key:"draw",value:function(t,e){g.extend(!0,this,t),this.data=e,this._widget(t)}},{key:"destroy",value:function(){var t=this;t.sprite.animate({globalAlpha:0},{duration:300,onComplete:function(){t.sprite.remove()}})}},{key:"_getColor",value:function(t,e){e=this._getProp(t,e);return 1<arguments.length&&null==e&&((e=t&&t.lineargradient?t.lineargradient[parseInt(t.lineargradient.length/2)].color:e)&&g.isString(e)||(e=this.fieldConfig.color)),e}},{key:"_getProp",value:function(t,e){return g.isArray(t)?t[this.iGroup]:g.isFunction(t)?(n=[],null!=e&&n.push(this.data[e]),t.apply(this,n)):t;var n}},{key:"getNodeInfoAt",value:function(t,e){var n=this.data[t];if(e&&e.eventInfo&&e.eventInfo.dimension_1&&"proportion"==e.eventInfo.dimension_1.layoutType)for(var i,a=0,r=this.data.length;a<r;a++){var o=this.data[a],l=Math.abs(o.x-t);(null==i||l<i)&&(i=l,n=o)}return n}},{key:"resetData",value:function(t,e,n){var i=this;t&&(this.data=t),e&&e.comp?(i._pointList=this._getPointList(this.data),i._bottomPointList=this._getBottomPointList(),t={left:0,right:i._pointList.length-i._currPointList.length},e&&e.params&&g.extend(t,e.params),t.left&&(0<t.left&&(this._currPointList=this._pointList.slice(0,t.left).concat(this._currPointList),this._bottomField&&(this._currBottomPointList=this._bottomPointList.slice(0,t.left).concat(this._currBottomPointList))),t.left<0&&(this._currPointList.splice(0,Math.abs(t.left)),this._bottomField&&this._currBottomPointList.splice(0,Math.abs(t.left)))),t.right&&(0<t.right&&(this._currPointList=this._currPointList.concat(this._pointList.slice(-t.right)),this._bottomField&&(this._currBottomPointList=this._currBottomPointList.concat(this._bottomPointList.slice(-t.right)))),t.right<0&&(this._currPointList.splice(this._currPointList.length-Math.abs(t.right)),this._bottomField&&this._currBottomPointList.splice(this._currBottomPointList.length-Math.abs(t.right)))),i._createNodes(),i._createTexts(),i._transition()):(i._growed=!1,i.clipRect&&(i.clipRect.destroy(),i.clipRect=null),i._widget(this),i._grow())}},{key:"_transition",value:function(t){var r=this;function o(t,e){var n,i;r._line?(n=r._getLineStrokeStyle(),r._line.context&&(r._line.context.pointList=g.clone(t),r._line.context.strokeStyle=n),r._bottomField&&r._bottomLine&&r._bottomLine.context&&(r._bottomLine.context.pointList=g.clone(e),r._bottomLine.context.strokeStyle=n),r._area&&r._area.context&&(r._area.context.path=r._getFillPath(r._line,r._bottomLine),r._area.context.fillStyle=r._getFillStyle()),i=0,g.each(t,function(t,e){var n;g.isNumber(t[1])&&(r._nodes&&(n=r._nodes.getChildAt(i))&&(n.context.x=t[0],n.context.y=t[1]),r._labels&&(n=r._labels.getChildAt(i))&&(n.context.x=t[0],n.context.y=t[1]-3-3,r._checkTextPos(n,e)),i++)})):(r.sprite._removeTween(r._transitionTween),r._transitionTween=null)}r.data.length?this._growed?(this._transitionTween=l.registTween({from:r._getPointPosStr(r._currPointList,r._currBottomPointList),to:r._getPointPosStr(r._pointList,r._bottomPointList),desc:r.field,onUpdate:function(t){for(var e in t){var n="p"==e.split("_")[0]?r._currPointList:r._currBottomPointList,i=parseInt(e.split("_")[2]),a=parseInt(e.split("_")[1]);n[i]&&(n[i][a]=t[e])}o(r._currPointList,r._currBottomPointList)},onComplete:function(){r.sprite._removeTween(r._transitionTween),r._transitionTween=null,o(r._pointList,r._bottomPointList),t&&t(r)}}),this.sprite._tweens.push(this._transitionTween)):(r._currPointList=r._pointList,r._currBottomPointList=r._bottomPointList,o(r._currPointList,r._currBottomPointList)):(r._line.context&&(r._line.context.pointList=[]),r._bottomLine.context&&(r._bottomLine.context.pointList=[]),r._area&&r._area.context&&(r._area.context.path=""),t&&t(r))}},{key:"_grow",value:function(t){var e=this,n=this._graphs.app.getCoord(),i=n.width,n=n.height,n=(this.clipRect=new x({context:{x:0,y:-n-3,width:0,height:n+6,fillStyle:"green"}}),{width:i});this.lineSprite.clipTo(this.clipRect),this.graphSprite.addChild(this.clipRect),"rightLeft"==this.line.growDriction&&(this.clipRect.context.x=i,n.x=0),this.clipRect.animate(n,{duration:this._graphs.aniDuration,easing:this.aniEasing,onUpdate:function(){var n=e.clipRect.context;e._nodes.children.concat(e._labels.children).forEach(function(t){var e=t.context;0==e.globalAlpha&&e.x>=n.x&&e.x<=n.x+n.width&&t.animate({globalAlpha:1},{duration:300})})},onComplete:function(){e._growed=!0,t&&t()}})}},{key:"_getPointPosStr",value:function(t,e){var n={};return t.forEach(function(t,e){t&&(n["p_1_"+e]=t[1],n["p_0_"+e]=t[0])}),e.forEach(function(t,e){t&&(n["bp_1_"+e]=t[1],n["bp_0_"+e]=t[0])}),n}},{key:"_getPointList",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var a=t[n];e.push([a.x,a.y])}return e}},{key:"_widget",value:function(t){var e,n,i=this;(t=t||{}).isResize&&(i._growed=!0),i._clean(),i._pointList=this._getPointList(i.data),0!=i._pointList.length&&(e=i._pointList,i._currPointList=e,n=i._getLineStrokeStyle(e),e={pointList:e,lineWidth:i.line.lineWidth,y:i.y,strokeStyle:n,smooth:i.line.smooth,lineType:i._getProp(i.line.lineType),lineDash:i.line.lineDash,lineJoin:"bevel",lineCap:"round"},i.line.shadowBlur&&(e.shadowBlur=i._getProp(i.line.shadowBlur),e.shadowColor=i._getProp(i.line.shadowColor)||n,e.shadowOffsetY=i._getProp(i.line.shadowOffsetY),e.shadowOffsetX=i._getProp(i.line.shadowOffsetX)),(n=new s({context:e})).on(y.types.get(),function(t){t.eventInfo={trigger:"this.line",nodes:[]},i._graphs.app.fire(t.type,t)}),this.line.enabled||(n.context.visible=!1),i.lineSprite.addChild(n),i._line=n,i.area.enabled&&(this._bottomField&&(i._bottomPointList=this._getBottomPointList(),n=i._bottomPointList,i._currBottomPointList=n,n={},Object.assign(n,e),n.pointList=i._bottomPointList,e=new s({context:n}),this.area.bottomLine.enabled||(e.context.visible=!1),i.lineSprite.addChild(e),i._bottomLine=e),(n=new m({context:{path:i._getFillPath(i._line,i._bottomLine),fillStyle:i._getFillStyle(),globalAlpha:i.area.alpha}})).on(y.types.get(),function(t){t.eventInfo={trigger:"this.area",nodes:[]},i._graphs.app.fire(t.type,t)}),i.lineSprite.addChild(n),i._area=n),i._createNodes(t),i._createTexts(t))}},{key:"_getBottomPointList",value:function(){var n=this;if(!this._bottomField)return[];var i=this._graphs.app.getCoord(),t=this._graphs.dataFrame.getFieldData(this._bottomField),a=(this._yAxis.addValToSection(t),[]);return t.forEach(function(t,e){e=i.getPoint({iNode:e,field:n.field,value:{y:t}});a.push([e.pos.x,e.pos.y])}),a}},{key:"_getFirstNode",value:function(){for(var t=null,e=0,n=this.data.length;e<n;e++){var i=this.data[e];if(g.isNumber(i.y)&&(null!==t&&"right"!=this.yAxisAlign||(t=i),"right"!==this.yAxisAlign&&null!==t))break}return t}},{key:"_getFillStyle",value:function(){var t,e=this._opt.area&&this._opt.area.fillStyle?this._getColor(this._opt.area.fillStyle):this.color,n=this.area.alpha;return(0,color.colorIsHex)(e)&&!g.isArray(n)&&(n=[1,0]),g.isArray(n)&&(n.length=2,null==n[0]&&(n[0]=0),null==n[1]&&(n[1]=0),t={lineargradient:[]},(0,color.colorIsHex)(e)&&(t.lineargradient=[{position:0,color:(0,color.colorRgba)(e,n[0])},{position:1,color:(0,color.colorRgba)(e,n[1])}],e=t)),e&&e.lineargradient&&(n=e.lineargradient,"right"==this.yAxisAlign&&(n=n.reverse()),(t=this._getLinearGradientPoints("area"))&&t.length&&(e.points=t)),e}},{key:"_getLineStrokeStyle",value:function(t,e){n=this._opt.line&&this._opt.line.strokeStyle?this._getColor(this._opt.line.strokeStyle):this.color;var n,i=(n=(0,color.colorIsHex)(n)?{lineargradient:[{position:0,color:(0,color.colorRgba)(n,.2)},{position:.05,color:(0,color.colorRgba)(n,1)},{position:.95,color:(0,color.colorRgba)(n,1)},{position:1,color:(0,color.colorRgba)(n,.2)}]}:n).lineargradient;return i?("right"==this.yAxisAlign&&(i=i.reverse()),(i=this._getLinearGradientPoints("line",t))?(n.points=i,n):void 0):n}},{key:"_getLinearGradientPoints",value:function(){var t,e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"line",i=1<arguments.length?arguments[1]:void 0,a=this[n].lineargradientDriction,i=i||this._line.context.pointList;if("topBottom"==a){for(var r=0,o=0,l=0,s=i.length;l<s;l++){var u=i[l][1];isNaN(u)||(r=Math.min(u,r),o=Math.max(u,o))}t={x:0,y:r},e={x:0,y:o},"area"==n&&(e.y=0)}else{for(var d,h,c=0,f=i.length;c<f;c++){var p=i[c],g=p[0],p=p[1];isNaN(g)||isNaN(p)||(d=null==d?g:Math.min(g,d),h=Math.max(g,d))}t={x:d,y:0},e={x:h,y:0}}return null==t.x||null==t.y||null==e.x||null==e.y?null:[t.x,t.y,e.x,e.y]}},{key:"_createNodes",value:function(){for(var s=this,u=this,d=u._currPointList,h=0,t=0,e=d.length;t<e;t++)!function(t){var e=u.data[t],n=u._getColor(u.node.strokeStyle||u.color,t),i=(e.color=n,u.node.enabled),a=(1!=d.length||i||(i=!0),u._currPointList[t]);if(!a||!g.isNumber(a[1]))return;var r=a[0],a=a[1],o=0,l=(s.clipRect&&u._growed&&(r>=(l=s.clipRect.context).x&&r<=l.x+l.width&&(o=1)),u.node.lineWidth||u.line.lineWidth),r={x:r,y:a,r:u._getProp(u.node.radius,t),lineWidth:u._getProp(l,t)||2,strokeStyle:n,fillStyle:u._getProp(u.node.fillStyle,t)||n,visible:i&&!!u._getProp(u.node.visible,t),globalAlpha:o},a=_,l=u._getProp(u.node.shapeType,t),n=("isogon"==l&&(a=v,r.n=u._getProp(u.node.isogonPointNum,t)),"path"==l&&(a=m,r.path=u._getProp(u.node.path,t)),u._nodes.children[h]);n?n.type==l?g.extend(n.context,r):(n.destroy(),(n=new a({context:r})).on(y.types.get(),function(t){t.eventInfo={trigger:"this.node",nodes:[e]},u._graphs.app.fire(t.type,t)}),u._nodes.addChildAt(n,h)):((n=new a({context:r})).on(y.types.get(),function(t){t.eventInfo={trigger:"this.node",nodes:[e]},u._graphs.app.fire(t.type,t)}),u._nodes.addChild(n)),u.node.corner&&(i=u._pointList[t][1],o=u._pointList[t-1],l=u._pointList[t+1],o&&l&&i==o[1]&&i==l[1]&&(n.context.visible=!1)),e.nodeElement=n,h++}(t);if(u._nodes.children.length>h)for(var n=h,i=u._nodes.children.length;n<i;n++)u._nodes.children[n].destroy(),n--,i--}},{key:"_createTexts",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=this,n=e._currPointList,i=this._graphs.app.getCoord();if(e.label.enabled){for(var a=0,r=0,o=n.length;r<o;r++){var l,s,u,d=n[r];d&&g.isNumber(d[1])&&(u=d[0],d=d[1]-this.node.radius-2,s=0,this.clipRect&&t._growed&&(u>=(l=this.clipRect.context).x&&u<=l.x+l.width&&(s=1)),l={x:u,y:d,fontSize:this.label.fontSize,textAlign:this.label.textAlign,textBaseline:this.label.textBaseline,fillStyle:e._getColor(e.label.fontColor,r),lineWidth:1,strokeStyle:"#ffffff",globalAlpha:s},d=(u=e.data[r]).value,e.label.format?(g.isFunction(e.label.format)&&(d=e.label.format.apply(e,[d,u])),"string"==typeof e.label.format&&(d=(0,p.default)(d).format(e.label.format))):(s=i.getFieldConfig(this.field))&&(d=s.getFormatValue(d)),null!=d&&((u=this._labels.children[a])?(u.resetText(d),g.extend(u.context,l)):(u=new f.default.Display.Text(d,{context:l}),e._labels.addChild(u),e._checkTextPos(u,r)),a++))}if(e._labels.children.length>a)for(var h=a,c=e._labels.children.length;h<c;h++)e._labels.children[h].destroy(),h--,c--}}},{key:"_checkTextPos",value:function(t,e){var n=this._currPointList,i=n[e-1],n=n[e+1];i&&n&&i[1]<t.context.y&&n[1]<t.context.y&&(t.context.y+=12,t.context.textBaseline="top")}},{key:"_getFillPath",value:function(t,e){var d="",h=-this._yAxis.originPos,c=e?e.graphics.graphicsData:[];return t.graphics.graphicsData.forEach(function(t,e){var n=[].concat(t.shape.points);if(1<n.length){if(c.length){for(var i=(c[e]||c.slice(-1)[0]).shape.points,a=0,r=i.length/2;a<r;a++)n.push(i[2*(r-a-1)]),n.push(i[2*(r-a-1)+1]);n=n.concat([n[0],n[1]])}else n=n.concat([n[n.length-2],h,n[0],h,n[0],n[1]]);for(var o=n.length/2,l=0;l<o;l++){var s=n[2*l],u=n[2*l+1];l?(d+="L"+s+" "+u,l==o-1&&(d+="z")):d+="M"+s+" "+u}}}),d}},{key:"getNodeInfoOfX",value:function(l){for(var t=0,e=this.data.length;t<e;t++)if(null!==this.data[t].value&&Math.abs(this.data[t].x-l)<=.5)return this.data[t];function s(t){if(!(t.length<2)){var e=t.length/2;if(!(l<t[0]||l>t[2*(e-1)])){var e=parseInt(e/2),n=e+1,i=e-1,a=t[2*e],r=t[2*e+1];if(Math.abs(a-l)<=.5)u={x:a,y:r};else{var o=[];if(a<l){if(l<t[2*n])return void(u=d(l,[[a,r],[t[2*n],t[2*n+1]]]));o=t.slice(2*n)}else{if(l>t[2*i])return void(u=d(l,[[t[2*i],t[2*i+1]],[a,r]]));o=t.slice(0,2*e)}s(o)}}}}var u,d=function(t,e){var n={x:t,y:0};return n.y=e[0][1]+(e[1][1]-e[0][1])/(e[1][0]-e[0][0])*(t-e[0][0]),n};if(this._line&&this._line.graphics.graphicsData.forEach(function(t){u||s(t.shape.points)}),!u||null==u.y)return null;var n={type:"line",iGroup:this.iGroup,iNode:-1,field:this.field,value:this._yAxis.getValOfPos(-u.y),x:u.x,y:u.y,rowData:null,color:null};return n.color=this._getProp(this.node.strokeStyle,n),n}},{key:"tipsPointerOf",value:function(t){t.eventInfo&&(t.eventInfo.iNode!=this.__currFocusInd&&-1!=this.__currFocusInd&&this.unfocusOf(this.__currFocusInd),this.focusOf(t.eventInfo.iNode))}},{key:"tipsPointerHideOf",value:function(t){t.eventInfo&&this.unfocusOf(t.eventInfo.iNode)}},{key:"focusOf",value:function(t){var e,n,i=this.data[t];i&&((e=i.nodeElement)&&!i.focused&&this.__currFocusInd!=t&&(e._fillStyle=e.context.fillStyle,e.context.fillStyle="white",e.context.r+=e.context.lineWidth/2,e._visible=e.context.visible,e.context.visible=!0,n=e.clone(),this._focusNodes.addChild(n),n.context.visible=!0,n.context.lineWidth=0,n.context.fillStyle=e.context.strokeStyle,n.context.globalAlpha=this.node.focus.alpha,n.animate({r:n.context.r+this.node.focus.radiusDiff},{duration:300}),this.__currFocusInd=t),i.focused=!0)}},{key:"unfocusOf",value:function(t){-1<this.__currFocusInd&&(t=this.__currFocusInd);var e,t=this.data[t];t&&(this._focusNodes.removeAllChildren(),(e=t.nodeElement)&&t.focused&&(e.context.fillStyle=e._fillStyle,e.context.r-=e.context.lineWidth/2,e.context.visible=e._visible,t.focused=!1,this.__currFocusInd=-1))}}],[{key:"defaultProps",value:function(){return{aniDuration:{detail:"动画时长",default:1e3},line:{detail:"线配置",propertys:{enabled:{detail:"是否开启",default:!0},growDriction:{detail:"生长动画的方向，默认为从左到右（leftRgiht）,可选rightLeft",default:"leftRight"},strokeStyle:{detail:"线的颜色",default:void 0},lineargradientDriction:{detail:"线的填充色是渐变对象的话，这里用来描述方向，默认从上到下（topBottom）,可选leftRight",default:"leftRight"},lineWidth:{detail:"线的宽度",default:2},lineType:{detail:"线的样式",default:"solid"},lineDash:{detail:"虚线的线段样式，默认[6,3]",default:[2,5]},smooth:{detail:"是否平滑处理",default:!0},shadowOffsetX:{detail:"折线的X方向阴影偏移量",default:0},shadowOffsetY:{detail:"折线的Y方向阴影偏移量",default:2},shadowBlur:{detail:"折线的阴影模糊效果",default:8},shadowColor:{detail:"折线的阴影颜色，默认和折线的strokeStyle同步， 如果strokeStyle是一个渐变色，那么shadowColor就会失效，变成默认的黑色，需要手动设置该shadowColor",default:function(){var t=this.color;return(0,color.colorRgba)(t,.4)}}}},node:{detail:"单个数据节点配置，对应线上的小icon图形",propertys:{enabled:{detail:"是否开启",default:!0},shapeType:{detail:"节点icon的图形类型，默认circle",documentation:'可选有"isogon"(正多边形)，"path"（自定义path路径，待实现）',default:"circle"},isogonPointNum:{detail:'shapeType为"isogon"时有效，描述正多边形的边数',default:3},path:{detail:"shapeType为path的时候，描述图形的path路径",default:null},corner:{detail:"拐角才有节点",default:!1},radius:{detail:"节点半径",default:3},fillStyle:{detail:"节点图形的背景色",default:null},strokeStyle:{detail:"节点图形的描边色，默认和line.strokeStyle保持一致",default:null},lineWidth:{detail:"节点图形边宽大小,默认跟随line.lineWidth",default:null},visible:{detail:"节点是否显示,支持函数",default:!0},focus:{detail:"节点hover态设置",propertys:{radiusDiff:{detail:"hover后的背景节点半径相差，正数为变大值,默认为4",default:4},alpha:{detail:"hover后的背景节点透明度，默认为0.5",default:.5}}}}},label:{detail:"文本配置",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本颜色",default:null},strokeStyle:{detail:"文本描边色",default:null},fontSize:{detail:"文本字体大小",default:12},format:{detail:"文本格式化处理函数",default:null},textAlign:{detail:"水平布局方式",default:"center"},textBaseline:{detail:"垂直布局方式",default:"bottom"}}},area:{detail:"面积区域配置",propertys:{enabled:{detail:"是否开启",default:!0},lineargradientDriction:{detail:"面积的填充色是渐变对象的话，这里用来描述方向，默认null(就会从line中取),从上到下（topBottom）,可选leftRight",default:"topBottom"},fillStyle:{detail:"面积背景色",default:null},alpha:{detail:"面积透明度",default:.5},bottomLine:{detail:"area的底部线配置",propertys:{enabled:{detail:"是否开启",default:!0}}}}}}}}]),d}(y.Dispatcher);e.default=u})),line=(unwrapExports(group),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),f=interopRequireDefault(group),n=interopRequireDefault(graphs);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var p={},i=function(t){(0,l.default)(i,t);var n=d(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="line",e.enabledField=null,e.groups=[],Canvax._.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){}},{key:"draw",value:function(t){return this.width=(t=t||{}).width,this.height=t.height,Canvax._.extend(!0,this.origin,t.origin),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.data=this._trimGraphs(),this._setGroupsForYfield(this.data,null,t),this.animation&&!t.resize?this.grow():this.fire("complete"),this}},{key:"resetData",value:function(t,e,n){var i=this;t&&(i.dataFrame=t),n&&"origin"in n&&("x"in n.origin&&(this.sprite.context.x=n.origin.x),"y"in n.origin&&(this.sprite.context.y=n.origin.y)),i.data=i._trimGraphs(),i.groups.forEach(function(t){t.resetData(i.data[t.field].data,e,n)})}},{key:"setEnabledField",value:function(){this.enabledField=this.app.getComponent({name:"coord"}).filterEnabledFields(this.field)}},{key:"_trimGraphs",value:function(){var s=this,u=this.app.getComponent({name:"coord"}),d={};return s.setEnabledField(),Canvax._.each(Canvax._.flatten(s.enabledField),function(t,e){var n=s.app.getComponent({name:"coord"}).getFieldConfig(t),i=s.dataFrame.getFieldData(t);if(i){for(var a=[],r=0,o=i.length;r<o;r++){var l=u.getPoint({iNode:r,field:t,value:{y:i[r]}}),l={type:"line",iGroup:e,iNode:r,field:t,value:i[r],x:l.pos.x,y:l.pos.y,rowData:s.dataFrame.getRowDataAt(r),color:n.color};a.push(l)}d[t]={yAxis:n.yAxis,field:t,data:a}}}),d}},{key:"grow",value:function(e){var n=0,i=this.groups.length,a=this;return Canvax._.each(this.groups,function(t){t._grow(function(){n++,e&&e(t),n==i&&a.fire("complete")})}),this}},{key:"show",value:function(t){var e=this;this.data=this._trimGraphs(),this.groups.forEach(function(t){t.resetData(e.data[t.field].data)}),this._setGroupsForYfield(this.data,t).forEach(function(t){t._grow()})}},{key:"hide",value:function(t){var e=this,t=e.getGroupIndex(t);-1<t&&this.groups.splice(t,1)[0].destroy(),this.data=this._trimGraphs(),Canvax._.each(this.groups,function(t){t.resetData(e.data[t.field].data)})}},{key:"getGroupIndex",value:function(t){for(var e=-1,n=0,i=this.groups.length;n<i;n++)if(this.groups[n].field===t){e=n;break}return e}},{key:"getGroup",value:function(t){return this.groups[this.getGroupIndex(t)]}},{key:"_setGroupsForYfield",value:function(t,s,u){var d=this,h=(u=u||{},s=s&&Canvax._.flatten([s]),Canvax._.flatten([this.field])),c=[];return Canvax._.each(t,function(t,e){if(!s||-1!=Canvax._.indexOf(s,e)){for(var n=d.app.getComponent({name:"coord"}).getFieldConfig(e),i=Canvax._.indexOf(h,e),a=new f.default(n,i,d._opt,d.ctx,d.height,d.width,d,p),r=!1,o=0,l=d.groups.length;o<l;o++)if(i<d.groups[o].iGroup){d.groups.splice(o,0,a),r=!0,d.sprite.addChildAt(a.sprite,o);break}r||((e=d.groups.find(function(t){return t.field==a.field}))&&(d.groups.splice(d.groups.indexOf(e),1),e.destroy()),d.groups.push(a),d.sprite.addChild(a.sprite)),a.draw({animation:d.animation,isResize:u.resize},t.data),c.push(a)}}),c}},{key:"getNodesAt",value:function(e,n){var i=[];return Canvax._.each(this.groups,function(t){t=t.getNodeInfoAt(e,n);t&&i.push(t)}),i}},{key:"getNodesOfPos",value:function(e){var n=[];return Canvax._.each(this.groups,function(t){t=t.getNodeInfoOfX(e);t&&n.push(t)}),n}},{key:"tipsPointerOf",value:function(e){this.groups.forEach(function(t){t.tipsPointerOf(e)})}},{key:"tipsPointerHideOf",value:function(e){this.groups.forEach(function(t){t.tipsPointerHideOf(e)})}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置，支持二维数组格式",default:null},yAxisAlign:{detail:"绘制在哪根y轴上面",default:"left"},_props:[f.default]}}},{key:"polyfill",value:function(t){return Array.isArray(t.field)&&t.field.forEach(function(t){var e;Array.isArray(t)&&1<t.length&&(e=t[1],t.length=1,p[t[0]]=e)}),t}}]),i}(n.default);n.default.registerComponent(i,"graphs","line"),e.default=i})),intersect_1=(unwrapExports(line),createCommonjsModule(function(t,e){function s(t,e,n,i,a,r){r=(r-e)*(n-t)-(i-e)*(a-t);return 0<r||!(r<0)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=function(t,e){var n=t[0][0],i=t[0][1],a=t[1][0],t=t[1][1],r=e[0][0],o=e[0][1],l=e[1][0],e=e[1][1];return s(n,i,r,o,l,e)!==s(a,t,r,o,l,e)&&s(n,i,a,t,r,o)!==s(n,i,a,t,l,e)}})),grid_1=(unwrapExports(intersect_1),createCommonjsModule(function(t,e){function n(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(var n=0;n<t.length;n++){var i,a=t[n],r=this.coordToCellNum(a[0]),o=this.coordToCellNum(a[1]);this._cells[r]?this._cells[r][o]?this._cells[r][o].push(a):this._cells[r][o]=[a]:((i=[])[o]=[a],this._cells[r]=i)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n.prototype={cellPoints:function(t,e){return void 0!==this._cells[t]&&void 0!==this._cells[t][e]?this._cells[t][e]:[]},rangePoints:function(t){for(var e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),i=this.coordToCellNum(t[2]),a=this.coordToCellNum(t[3]),r=[],o=e;o<=i;o++)for(var l=n;l<=a;l++)Array.prototype.push.apply(r,this.cellPoints(o,l));return r},removePoint:function(t){for(var e,n=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),a=this._cells[n][i],r=0;r<a.length;r++)if(a[r][0]===t[0]&&a[r][1]===t[1]){e=r;break}return a.splice(e,1),a},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}},e.default=function(t,e){return new n(t,e)}})),format=(unwrapExports(grid_1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default={toXy:function(t,e){return void 0===e?t.slice():t.map(function(t){return new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(t)})},fromXy:function(t,e){return void 0===e?t.slice():t.map(function(t){return new Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(t)})}}})),convex_1=(unwrapExports(format),createCommonjsModule(function(t,e){function a(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=function(t){var e=function(t){for(var e=[],n=0;n<t.length;n++){for(;2<=e.length&&a(e[e.length-2],e[e.length-1],t[n])<=0;)e.pop();e.push(t[n])}return e.pop(),e}(t);return(e=function(t){for(var e=t.reverse(),n=[],i=0;i<e.length;i++){for(;2<=n.length&&a(n[n.length-2],n[n.length-1],e[i])<=0;)n.pop();n.push(e[i])}return n.pop(),n}(t).concat(e)).push(t[0]),e}})),hull_1=(unwrapExports(convex_1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(intersect_1),l=interopRequireDefault(grid_1),s=interopRequireDefault(format),u=interopRequireDefault(convex_1);function g(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function y(t,e,n){var i=[e[0]-t[0],e[1]-t[1]],a=[n[0]-t[0],n[1]-t[1]],e=g(t,e),t=g(t,n);return(i[0]*a[0]+i[1]*a[1])/Math.sqrt(e*t)}function _(t,e){for(var n=0;n<e.length-1;n++){var i=[e[n],e[n+1]];if(!(t[0][0]===i[0][0]&&t[0][1]===i[0][1]||t[0][0]===i[1][0]&&t[0][1]===i[1][1])&&(0,a.default)(t,i))return 1}}function v(t,e,n,i,a){for(var r,o=!1,l=0;l<t.length-1;l++){var s=[t[l],t[l+1]],u=s[0][0]+","+s[0][1]+","+s[1][0]+","+s[1][1];if(!(g(s[0],s[1])<e||a.has(u))){for(var d=0,h=(r=s,[Math.min(r[0][0],r[1][0]),Math.min(r[0][1],r[1][1]),Math.max(r[0][0],r[1][0]),Math.max(r[0][1],r[1][1])]),c=void 0,f=void 0,p=void 0;c=(h=i.extendBbox(h,d))[2]-h[0],f=h[3]-h[1],d++,null===(p=function(t,e,n){for(var i,a,r=null,o=x,l=x,s=0;s<e.length;s++)i=y(t[0],t[1],e[s]),a=y(t[1],t[0],e[s]),o<i&&l<a&&!_([t[0],e[s]],n)&&!_([t[1],e[s]],n)&&(o=i,l=a,r=e[s]);return r}(s,i.rangePoints(h),t))&&(n[0]>c||n[1]>f););c>=n[0]&&f>=n[1]&&a.add(u),null!==p&&(t.splice(l+1,0,p),i.removePoint(p),o=!0)}}return o?v(t,e,n,i,a):t}var x=Math.cos(90/(180/Math.PI));e.default=function(t,e,n){if(e=e||20,(t=function(t){for(var e=[t[0]],n=t[0],i=1;i<t.length;i++){var a=t[i];n[0]===a[0]&&n[1]===a[1]||e.push(a),n=a}return e}(s.default.toXy(t,n).sort(function(t,e){return t[0]-e[0]||t[1]-e[1]}))).length<4)return t.concat([t[0]]);var i=[.6*(o=function(t){for(var e=1/0,n=1/0,i=-1/0,a=-1/0,r=t.length-1;0<=r;r--)t[r][0]<e&&(e=t[r][0]),t[r][1]<n&&(n=t[r][1]),t[r][0]>i&&(i=t[r][0]),t[r][1]>a&&(a=t[r][1]);return[i-e,a-n]}(t))[0],.6*o[1]],a=(0,u.default)(t),r=t.filter(function(t){return a.indexOf(t)<0}),t=Math.ceil(1/(t.length/(o[0]*o[1]))),o=v(a,Math.pow(e,2),i,(0,l.default)(r,t),new Set);return n?s.default.fromXy(o,n):o}})),scat=(unwrapExports(hull_1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(_typeof_1$1),r=interopRequireDefault(classCallCheck$1),o=interopRequireDefault(createClass$1),l=interopRequireDefault(assertThisInitialized$1),s=interopRequireDefault(inherits$1),u=interopRequireDefault(possibleConstructorReturn$1),d=interopRequireDefault(getPrototypeOf$1),w=interopRequireDefault(Canvax),n=interopRequireDefault(graphs),k=interopRequireDefault(hull_1);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,d.default)(n);return t=i?(t=(0,d.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,u.default)(this,t)}}var C=w.default._,S=w.default.event,A=w.default.Shapes.Circle,P=w.default.Shapes.Rect,R=w.default.Shapes.Line,D=w.default.Shapes.Polygon,i=function(t){(0,s.default)(i,t);var n=h(i);function i(t,e){return(0,r.default)(this,i),(e=n.call(this,t,e)).type="scat",e._rData=null,e._rMaxValue=null,e._rMinValue=null,e._alphaData=null,e._alphaMaxValue=null,e._alphaMinValue=null,e._groupData={},C.extend(!0,(0,l.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.init(),e}return(0,o.default)(i,[{key:"init",value:function(){this._shapesp=new w.default.Display.Sprite({id:"scat_shapesp"}),this._textsp=new w.default.Display.Sprite({id:"textsp"}),this._linesp=new w.default.Display.Sprite({id:"textsp"}),this._areasp=new w.default.Display.Sprite({id:"areasp"}),this.sprite.addChild(this._areasp),this.sprite.addChild(this._linesp),this.sprite.addChild(this._shapesp),this.sprite.addChild(this._textsp)}},{key:"draw",value:function(t){C.extend(!0,this,t=t||{}),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y;var e=this;return!this.animation||t.resize||e.inited?this.fire("complete"):this.grow(function(){e.fire("complete")}),this.inited=!0,this}},{key:"resetData",value:function(t){this.dataFrame=t,this.data=this._trimGraphs(),this._widget(),this.grow()}},{key:"getNodesAt",value:function(){return[]}},{key:"_trimGraphs",value:function(){var t=[],e=(this._groupData={},this.app.getComponent({name:"coord"})),n=this.dataFrame.length;this._rData=null,this._rMaxValue=null,this._rMinValue=null,this._alphaData=null,this._alphaMaxValue=null,this._alphaMinValue=null;for(var i=0;i<n;i++){var a=this.dataFrame.getRowDataAt(i),r=e.getFieldConfig(this.field),o=e.getPoint({iNode:i,field:this.field,value:{y:a[this.field]}});null!=o.pos.x&&null!=o.pos.y&&(o={type:"scat",rowData:a,x:o.pos.x,y:o.pos.y,value:o.value,field:this.field,fieldColor:r.color,iNode:i,focused:!1,selected:!1,radius:null,fillStyle:null,color:null,strokeStyle:null,lineType:null,lineDash:null,strokeAlpha:1,lineWidth:0,shapeType:null,label:null,fillAlpha:1,nodeElement:null},this._setR(o),this._setFillStyle(o),this._setFillAlpha(o),this._setStrokeStyle(o),this._setLineWidth(o),this._setLineType(o),this._setLineDash(o),this._setStrokeAlpha(o),this._setNodeType(o),this._setText(o),this.dataFilter&&C.isFunction(this.dataFilter)&&!this.dataFilter.apply(this,[o])||(this.groupField?(r=a[this.groupField])&&(this._groupData[r]||(this._groupData[r]=[]),this._groupData[r].push(o)):(this._groupData.all||(this._groupData.all=[]),this._groupData.all.push(o)),t.push(o)))}return t}},{key:"_setR",value:function(t){var e,n=this.node.normalRadius,i=t.rowData;return null!=this.node.radius&&(C.isString(this.node.radius)&&i[this.node.radius]&&(this._rData||this._rMaxValue||this._rMinValue||(this._rData=this.dataFrame.getFieldData(this.node.radius),this._rData=this._rData.filter(function(t){return t||0==t}),this._rMaxValue=C.max(this._rData),this._rMinValue=C.min(this._rData)),e=i[this.node.radius],n=this._rMaxValue==this._rMinValue?this.node.minRadius+(this.node.maxRadius-this.node.minRadius)/2:this.node.minRadius+(e-this._rMinValue)/(this._rMaxValue-this._rMinValue)*(this.node.maxRadius-this.node.minRadius)),C.isFunction(this.node.radius)&&(n=this.node.radius(i)),isNaN(parseInt(this.node.radius))||(n=parseInt(this.node.radius))),n=Math.max(n*this.node.radiusScale,2),t.radius=n,this}},{key:"_setText",value:function(t){null!=this.label.field&&C.isString(this.label.field)&&t.rowData[this.label.field]&&(t.label=this.label.format(t.rowData[this.label.field],t))}},{key:"_setFillStyle",value:function(t){return t.color=t.fillStyle=this._getStyle(this.node.fillStyle,t),this}},{key:"_setFillAlpha",value:function(t){var e=this.node.fillAlpha,n=this.node.minFillAlpha,i=this.node.maxFillAlpha,a=t.rowData;return e=null!=e?C.isString(e)&&a[e]?(this._alphaData||this._alphaMaxValue||this._alphaMinValue||(this._alphaData=this.dataFrame.getFieldData(e),this._alphaData=this._alphaData.filter(function(t){return t||0==t}),this._alphaMaxValue=C.max(this._alphaData),this._alphaMinValue=C.min(this._alphaData)),a=a[e],this._alphaMaxValue==this._alphaMinValue?n+(i-n)/2:n+(a-this._alphaMinValue)/(this._alphaMaxValue-this._alphaMinValue)*(i-n)):this._getProp(this.node.fillAlpha,t):0,t.fillAlpha=e,this}},{key:"_setStrokeAlpha",value:function(t){return t.strokeAlpha=this._getProp(this.node.strokeAlpha,t),this}},{key:"_setStrokeStyle",value:function(t){return t.strokeStyle=this._getStyle(this.node.strokeStyle||this.node.fillStyle,t),this}},{key:"_getProp",value:function(t,e){var n=t;return C.isArray(t)&&(n=t[e.iGroup]),n=C.isFunction(t)?t.apply(this,[e]):n}},{key:"_getStyle",value:function(t,e){var n=t;return C.isArray(t)&&(n=t[e.iGroup]),n=(n=C.isFunction(t)?t.apply(this,[e]):n)||e.fieldColor}},{key:"_setLineWidth",value:function(t){return t.lineWidth=this._getProp(this.node.lineWidth,t),this}},{key:"_setLineType",value:function(t){return t.lineType=this._getProp(this.node.lineType,t),this}},{key:"_setLineDash",value:function(t){var e,n,i=this;return t.lineDash=(e=this.node.lineDash,t=t,n=e,n=C.isFunction(e)?e.apply(i,[t]):n),this}},{key:"_setNodeType",value:function(t){var e=this.node.shapeType;return C.isArray(e)&&(e=e[t.iGroup]),C.isFunction(e)&&(e=e(t)),t.shapeType=e=e||"circle",this}},{key:"_widget",value:function(){var l=this,s=this;if(C.each(C.flatten([s._shapesp.children,s._textsp.children,s._linesp.children]),function(t){t.__used=!1}),C.each(s.data,function(t,e){var n,i=s._getNodeElement(t,e),a=(i||(t.__isNew=!0),s._getNodeContext(t)),r="circle"==t.shapeType?A:P;i?i.animate(a):(i=new r({id:"shape_"+e,hoverClone:!1,context:a}),s._shapesp.addChild(i),i.on(S.types.get(),function(t){t.eventInfo={title:null,trigger:"this.node",nodes:[this.nodeData]},this.nodeData.label&&(t.eventInfo.title=this.nodeData.label),"mouseover"==t.type&&s.focusAt(this.nodeData),"mouseout"!=t.type||this.nodeData.selected||s.unfocusAt(this.nodeData),s.app.fire(t.type,t)})),i.__used=!0,i.nodeData=t,i.iNode=e,t.nodeElement=i,s.line.enabled&&(r=i.lineElement,n={start:{x:a.x,y:a.y+a.r},end:{x:a.x,y:0},lineWidth:s.line.lineWidth,strokeStyle:s.line.strokeStyle,lineType:s.line.lineType},r?r.animate(n):(r=new R({context:n}),s._linesp.addChild(r)),r.__used=!0,i.lineElement=r),t.label&&s.label.enabled&&(n={},(r=i.labelElement)?(r.resetText(t.label),n=s._getTextContext(r,a),r.animate(n)):(r=new w.default.Display.Text(t.label,{id:"scat_text_"+e,context:{}}),n=s._getTextContext(r,a),C.extend(r.context,n),s._textsp.addChild(r)),r.__used=!0,(i.labelElement=r).nodeElement=i)}),s.area.enabled){s._areasp.removeAllChildren();var t,u=0,e=function(t){var e=l._groupData[t],t={name:t,iGroup:u,data:e},n=[];C.each(e,function(t){n=n.concat(function(t,e){if(!e||1==e)return[[t.x,t.y]];for(var n=[],i=0;i<e;i++){var a=360/(e-1)*i,r=t.radius+3,o=t.x+Math.cos(2*Math.PI/360*a)*r,a=t.y+Math.sin(2*Math.PI/360*a)*r;n.push([o,a])}return n}(t,s.area.quantile))});var e=(0,k.default)(n,s.area.concavity),i=s.app.getTheme(u),a=s._getStyle(s.area.fillStyle,t)||i,r=s._getProp(s.area.fillAlpha,t),i=s._getStyle(s.area.strokeStyle,t)||i,o=s._getProp(s.area.lineWidth,t),t=s._getProp(s.area.strokeAlpha,t),e=new D({context:{pointList:e,fillStyle:a,fillAlpha:r,strokeStyle:i,lineWidth:o,strokeAlpha:t,smooth:!1}});s._areasp.addChild(e),u++};for(t in this._groupData)e(t)}if(C.each(C.flatten([s._shapesp.children,s._textsp.children,s._linesp.children]),function(t){t.__used||t.animate({globalAlpha:0,r:0},{onComplete:function(){t.destroy()}})}),s.label.enabled)for(var n=0,i=s.data.length;n<i;n++){var a=s.data.length-1-n,r=s.data[a],o=s.data[a].nodeElement.labelElement;if(o){var d=void 0;if(a==s.data.length-1)o.context.visible=!0;else{for(var h=!1,c=1+a,f=s.data.length-1;c<=f;c++){var p,g,y,_,v,x,m,b=s.data[c];(d=s.data[c].nodeElement.labelElement).context.visible&&(g=(p=r.x-o.getTextWidth()/2)+o.getTextWidth(),_=(y=r.y-o.getTextHeight()/2)+o.getTextHeight(),x=(v=b.x-d.getTextWidth()/2)+d.getTextWidth(),m=(b=b.y-d.getTextHeight()/2)+d.getTextHeight(),g<v||x<p||_<b||m<y||(h=!0))}o.context.visible=!h}}}}},{key:"_getNodeElement",value:function(t,e){var n,i=this.node.dataKey;if(i){C.isString(i)&&(i=i.split(","));for(var a=0,r=this._shapesp.children.length;a<r;a++){for(var o=this._shapesp.children[a],l=!0,s=0,u=i.length;s<u;s++){var d=i[s];if(o.nodeData.rowData[d]!=t.rowData[d]){l=!1;break}}if(l&&i.length){n=o;break}}}else n=this._shapesp.getChildAt(e);return n}},{key:"_getTextPosition",value:function(t,e){var n=0,i=0;switch(this.label.position){case"center":n=e.x,i=e.y;break;case"top":n=e.x,i=e.y-e.r;break;case"right":n=e.x+e.r,i=e.y;break;case"bottom":n=e.x,i=e.y+e.r;break;case"left":n=e.x-e.r,i=e.y;break;case"auto":n=e.x,i=e.y,t.getTextWidth()>2*e.r&&(i=e.y+e.r+.5*t.getTextHeight())}return{x:n+this.label.offsetX,y:i+this.label.offsetY}}},{key:"_getTextContext",value:function(t,e){var n=this._getTextPosition(t,e),i=this.label.fontSize,t=(t.getTextWidth()>2*e.r&&(i-=2),{x:n.x,y:n.y,fillStyle:this.label.fontColor||e.fillStyle,fontSize:i,strokeStyle:this.label.strokeStyle||e.fillStyle,lineWidth:this.label.lineWidth,textAlign:this.label.textAlign,textBaseline:this.label.verticalAlign});return this.animation&&!this.inited&&this._setCtxAniOrigin(t),t}},{key:"_setCtxAniOrigin",value:function(t){var e;"default"==this.aniOrigin&&(t.y=0),"origin"==this.aniOrigin&&(e=this.app.getComponent({name:"coord"}).getOriginPos({field:this.field}),t.x=e.x,t.y=e.y),"center"==this.aniOrigin&&(t.x=this.width/2,t.y=-this.height/2)}},{key:"_getNodeContext",value:function(t){if("circle"==t.shapeType)return this._getCircleContext(t)}},{key:"_getCircleContext",value:function(t){var e={x:t.x,y:t.y,r:t.radius,fillStyle:t.fillStyle,strokeStyle:t.strokeStyle,strokeAlpha:t.strokeAlpha,lineWidth:t.lineWidth,lineType:t.lineType,lineDash:t.lineDash,fillAlpha:t.fillAlpha,cursor:"pointer"};return!this.animation||this.inited&&!t.__isNew||(this._setCtxAniOrigin(e),e.r=1),e}},{key:"grow",value:function(e){var n=0,i=this.data.length-1,a=this;C.each(this.data,function(t){t.__isNew&&a._growNode(t,function(){n+=1,delete t.__isNew,n==i&&e&&e()})})}},{key:"_growNode",value:function(t,e){var n=this;t.nodeElement.animate({x:t.x,y:t.y,r:t.radius},{onUpdate:function(t){var e;this.labelElement&&this.labelElement.context&&(e=n._getTextPosition(this.labelElement,t),this.labelElement.context.x=e.x,this.labelElement.context.y=e.y),this.lineElement&&this.lineElement.context&&(this.lineElement.context.start.y=t.y+t.r)},delay:Math.round(300*Math.random()),onComplete:function(){e&&e()}})}},{key:"focusAt",value:function(t){var e,n,t="object"==(0,a.default)(t)?t:(e=t,this.data.find(function(t){return t.iNode==e}));this.node.focus.enabled&&!t.focused&&((n=t.nodeElement.context).lineWidth=this._getProp(this.node.focus.lineWidth,t),n.strokeAlpha=this._getProp(this.node.focus.strokeAlpha,t),n.fillAlpha=this._getProp(this.node.focus.fillAlpha,t),t.focused=!0)}},{key:"unfocusAt",value:function(t){var e,n,t="object"==(0,a.default)(t)?t:(e=t,this.data.find(function(t){return t.iNode==e}));this.node.focus.enabled&&t.focused&&((n=t.nodeElement.context).lineWidth=this._getProp(t.lineWidth,t),n.strokeAlpha=this._getProp(t.strokeAlpha,t),n.fillAlpha=this._getProp(t.fillAlpha,t),n.strokeStyle=this._getProp(t.strokeStyle,t),t.focused=!1)}},{key:"selectAt",value:function(t){var e,n,t="object"==(0,a.default)(t)?t:(e=t,this.data.find(function(t){return t.iNode==e}));this.node.select.enabled&&!t.selected&&((n=t.nodeElement.context).lineWidth=this._getProp(this.node.select.lineWidth,t),n.strokeAlpha=this._getProp(this.node.select.strokeAlpha,t),n.fillAlpha=this._getProp(this.node.select.fillAlpha,t),t.selected=!0)}},{key:"unselectAt",value:function(t){var e,n,t="object"==(0,a.default)(t)?t:(e=t,this.data.find(function(t){return t.iNode==e}));this.node.select.enabled&&t.selected&&(n=t.nodeElement.context,t.focused?(n.lineWidth=this._getProp(this.node.focus.lineWidth,t),n.strokeAlpha=this._getProp(this.node.focus.strokeAlpha,t),n.fillAlpha=this._getProp(this.node.focus.fillAlpha,t)):(n.lineWidth=t.lineWidth,n.strokeAlpha=t.strokeAlpha,n.fillAlpha=t.fillAlpha),t.selected=!1)}},{key:"getNodesOfPos",value:function(){return[]}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},groupField:{detail:"分组字段",default:null,documentation:"分组字段，如果area配置enabled为true，那么需要groupField来构建几个area"},dataFilter:{detail:"散点过滤数据",default:null,documentation:"数据过滤器，可以和groupField实现交叉过滤"},aniOrigin:{detail:"节点动画的原点",default:"default",documentation:"可选的还有center（坐标正中）、origin（坐标原点）"},node:{detail:"单数据节点图形设置",propertys:{dataKey:{detail:"元素的数据id，默认索引匹配",default:"__index__"},shapeType:{detail:"图形类型",default:"circle",documentation:"节点的现状可以是圆 ，也可以是rect，也可以是三角形，后面两种后面实现"},maxRadius:{detail:"节点最大半径",default:25},minRadius:{detail:"节点最小半径",default:5},radius:{detail:"半径",default:null},radiusScale:{detail:"半径缩放比例",documentation:"在计算好真实半径后缩放，主要用在,缩略图中，比如datazoom的缩略图",default:1},normalRadius:{detail:"默认半径",default:15},fillStyle:{detail:"节点景色",default:null},fillAlpha:{detail:"节点透明度",default:.8},maxFillAlpha:{detail:"节点最大透明度",default:1},minFillAlpha:{detail:"节点最小透明度",default:.2},strokeStyle:{detail:"节点描边颜色",default:null},lineWidth:{detail:"节点描边线宽",default:0},lineType:{detail:"描边样式",default:"solid"},lineDash:{detail:"虚线样式",default:[2,6]},strokeAlpha:{detail:"节点描边透明度",default:1},focus:{detail:"节点hover态设置",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"hover后的边框大小",default:6},strokeAlpha:{detail:"hover后的边框透明度",default:.2},fillAlpha:{detail:"hover后的背景透明度",default:.8}}},select:{detail:"节点选中态设置",propertys:{enabled:{detail:"是否开启",default:!1},lineWidth:{detail:"选中后的边框大小",default:8},strokeAlpha:{detail:"选中后的边框透明度",default:.4},fillAlpha:{detail:"选中后的背景透明度",default:1}}}}},line:{detail:"每个节点和指标轴线的连线",propertys:{enabled:{detail:"是否开启",default:!1},lineWidth:{detail:"连线宽",default:1},strokeStyle:{detail:"连线颜色",default:"#ccc"},lineType:{detail:"连线类型",default:"dashed"}}},area:{detail:"散点集合组成的面",propertys:{enabled:{detail:"是否开启",default:!1},concavity:{detail:"凹凸系数，默认80，越大越凸",default:88},quantile:{detail:"散点用来计入面积的分位数",default:8},fillStyle:{detail:"散点集合面的背景色",default:null},fillAlpha:{detail:"散点集合面的透明度",default:.15},strokeStyle:{detail:"散点集合面的描边颜色",default:null},lineWidth:{detail:"散点集合面的描边线宽",default:0},strokeAlpha:{detail:"散点集合面的描边透明度",default:.5}}},label:{detail:"文本设置",propertys:{enabled:{detail:"是否开启",default:!0},field:{detail:"获取label的字段",default:null},format:{detail:"label格式化处理函数",default:function(t){return t}},fontSize:{detail:"label字体大小",default:13},fontColor:{detail:"字体颜色",default:"#888"},strokeStyle:{detail:"字体描边颜色",default:"#ffffff"},lineWidth:{detail:"描边大小",default:0},textAlign:{detail:"水平对齐方式",default:"center"},verticalAlign:{detail:"垂直基线对齐方式",default:"middle"},position:{detail:"文本布局位置",documentation:"auto(目前等于center，还未实现),center,top,right,bottom,left",default:"center"},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0}}}}}}]),i}(n.default);n.default.registerComponent(i,"graphs","scat"),e.default=i})),pie=(unwrapExports(scat),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),l=interopRequireDefault(getPrototypeOf$1),s=interopRequireDefault(Canvax);function u(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,l.default)(n);return t=i?(t=(0,l.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var d=s.default._,h=s.default.event,c=s.default.Shapes.Sector,C=s.default.Shapes.Path,S=s.default.Display.Text,f=s.default.AnimationFrame,i=function(t){(0,o.default)(a,t);var i=u(a);function a(t,e){var n;return(0,r.default)(this,a),(n=i.call(this)).width=0,n.height=0,n.origin={x:0,y:0},n._graphs=t,n.domContainer=t.app.canvax.domView,n.data=e,n.sprite=null,n.textSp=null,n.sectorsSp=null,n.selectedSp=null,n.init(),n.sectors=[],n.textMaxCount=15,n.textList=[],n.completed=!1,n}return(0,n.default)(a,[{key:"init",value:function(){this.sprite=new s.default.Display.Sprite,this.sectorsSp=new s.default.Display.Sprite,this.sprite.addChild(this.sectorsSp),this.selectedSp=new s.default.Display.Sprite,this.sprite.addChild(this.selectedSp),this._graphs.label.enabled&&(this.textSp=new s.default.Display.Sprite)}},{key:"draw",value:function(t){d.extend(!0,this,t),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this._widget()}},{key:"resetData",value:function(t){for(var e=this,n=(this.data=t,e.destroyLabel(),0),i=0;i<e.sectors.length;i++){var a=e.sectors[i],r=this.data.list[i];a.animate({r:r.outRadius,startAngle:r.startAngle,endAngle:r.endAngle},{duration:280,onComplete:function(){++n==e.sectors.length&&e._graphs.label.enabled&&e._startWidgetLabel()}})}}},{key:"_widget",value:function(){var e=this,t=e.data.list,n=e.data.total;if(0<t.length&&0<n){e.textSp&&e.sprite.addChild(e.textSp);for(var i=0;i<t.length;i++){var a=t[i],r=new c({hoverClone:!1,xyToInt:!1,context:{x:a.focused?a.outOffsetx:0,y:a.focused?a.outOffsety:0,r0:a.innerRadius,r:a.outRadius,startAngle:a.startAngle,endAngle:a.endAngle,fillStyle:a.fillStyle,cursor:"pointer"},id:"sector"+i});(r.nodeData=a).focusEnabled&&r.hover(function(){e.focusOf(this.nodeData)},function(){this.nodeData.selected||e.unfocusOf(this.nodeData)}),r.on(h.types.get(),function(t){t.eventInfo={trigger:"this._graphs.node",nodes:[this.nodeData]},e._graphs.app.fire(t.type,t)}),e.sectorsSp.addChildAt(r,0),e.sectors.push(r)}e._graphs.label.enabled&&e._startWidgetLabel()}}},{key:"focusOf",value:function(t,e){t.focused||(this.sectors[t.iNode].animate({r:t.outRadius+t.moveDis},{duration:100,onComplete:function(){e&&e()}}),t.focused=!0)}},{key:"unfocusOf",value:function(t,e){t.focused&&(this.sectors[t.iNode].animate({r:t.outRadius},{duration:100,onComplete:function(){e&&e()}}),t.focused=!1)}},{key:"selectOf",value:function(t){var e,n=this;this.sectors.length&&t.selectEnabled&&(e=this.sectors[t.iNode],t.selected||(t.focused?this.addCheckedSec(e):(t._focusTigger="select",this.focusOf(t,function(){n.addCheckedSec(e)})),t.selected=!0))}},{key:"unselectOf",value:function(t){var e,n=this.sectors[t.iNode];t.selected&&t.selectEnabled&&((e=this).cancelCheckedSec(n,function(){"select"==t._focusTigger&&e.unfocusOf(t)}),t.selected=!1)}},{key:"addCheckedSec",value:function(t,e){var n=t.context,i=t.nodeData;n&&(i=new c({xyToInt:!1,context:{x:n.x,y:n.y,r0:n.r-1,r:n.r+i.selectedR,startAngle:n.startAngle,endAngle:n.startAngle,fillStyle:n.fillStyle,globalAlpha:i.selectedAlpha},id:"selected_"+t.id}),t._selectedSec=i,this.selectedSp.addChild(i),this.completed?i.animate({endAngle:n.endAngle},{duration:this._getAngleTime(n),onComplete:function(){e&&e()}}):i.context.endAngle=n.endAngle)}},{key:"cancelCheckedSec",value:function(t,e){var n=t._selectedSec;n.animate({startAngle:n.context.endAngle-.5},{duration:this._getAngleTime(t.context),onComplete:function(){delete t._selectedSec,n.destroy(),e&&e()}})}},{key:"_getAngleTime",value:function(t){return Math.abs(t.startAngle-t.endAngle)/360*500}},{key:"grow",value:function(t){var u=this,e=(d.each(u.sectors,function(t){t.context&&(t.context.r0=0,t.context.r=0,t.context.startAngle=u._graphs.startAngle,t.context.endAngle=u._graphs.startAngle)}),u._hideGrowLabel(),f.registTween({from:{process:0},to:{process:1},duration:500,onUpdate:function(t){for(var e=0;e<u.sectors.length;e++){var n=u.sectors[e],i=n.nodeData,a=n.context,r=i.startAngle,o=i.endAngle,l=i.outRadius,s=i.innerRadius;a&&(a.r=l*t.process,a.r0=s*t.process,0==e?(a.startAngle=r,a.endAngle=r+(o-r)*t.process):(l=function(t){var t=t-1,e=u.sectors[t].context;return 0==t?e?e.endAngle:0:e?e.endAngle:arguments.callee(t)}(e),a.startAngle=l,a.endAngle=a.startAngle+(o-r)*t.process),n._selectedSec&&(n._selectedSec.context.r0=a.r-1,n._selectedSec.context.r=a.r+i.selectedR,n._selectedSec.context.startAngle=a.startAngle,n._selectedSec.context.endAngle=a.endAngle))}},onComplete:function(){u.sprite._removeTween(e),u._showGrowLabel(),u.completed=!0,t&&t()}}));u.sprite._tweens.push(e)}},{key:"_widgetLabel",value:function(t,e,n,i,a,r){var o,l,s,u,d=this,h=0,c=d.data.list,f=2==t||3==t,p=3==t||4==t,g=f?n:i;0<e.length&&e.sort(function(t,e){return p?c[t].edgey-c[e].edgey:c[e].edgey-c[t].edgey});for(var y=0;y<e.length;y++){var _=e[y],_=c[_],v=_.outRadius+_.moveDis;if(!(!_.enabled||_.y<g||h>=d.textMaxCount)){h++,l=_.edgey,s=Math.abs(_.edgex),x=l-o,0!=y&&(Math.abs(x)<15||p&&x<0||!p&&0<x)&&(l=p?o+15:o-15,0<v-Math.abs(l)&&(s=Math.sqrt(Math.pow(v,2)-Math.pow(l,2))),(f&&-s>_.edgex||!f&&s<_.edgex)&&(s=Math.abs(_.edgex))),a&&(x=f?r.left:r.right,v=e.length-y,x=p?x-15*v:x+15*v,(p&&x<l||!p&&l<x)&&(l=x)),o=l,a||(f?r.left=o:r.right=o);var v=f?-s-5:s+5,x=v+d.origin.x,m=l+d.origin.y;if(x>d._graphs.app.width||m<0||m>d._graphs.app.height)return;var x="M"+_.centerx+","+_.centery,m=(x+="Q"+_.outx+","+_.outy+","+v+","+l,new C({context:{lineType:"solid",path:x,lineWidth:1,strokeStyle:_.fillStyle}})),v=_.labelText,x=void 0,b=d.domContainer?((x=document.createElement("div")).style.cssText=" ;position:absolute;left:-1000px;top:-1000px;color:"+_.fillStyle,x.innerHTML=v,d.domContainer.appendChild(x),u=x.offsetWidth,x.offsetHeight):(x=new S(v,{context:{fillStyle:_.fillStyle}}),d.textSp.addChild(x),u=Math.ceil(x.getTextWidth()),Math.ceil(x.getTextHeight())),w=f?-s:s,k=l;switch(t){case 1:w+=5,k-=b/2;break;case 2:case 3:w-=u+5,k-=b/2;break;case 4:w+=5,k-=b/2}x.style?(x.style.left=w+d.origin.x+"px",x.style.top=k+d.origin.y+"px"):x.context&&(x.context.x=w,x.context.y=k),d.textSp.addChild(m),d.textList.push({width:u,height:b,x:w+d.origin.x,y:k+d.origin.y,data:_,textTxt:v,textEle:x})}}}},{key:"_startWidgetLabel",value:function(){for(var t,e,n=this.data.list,i=0,a=0,r=[],o=[{indexs:[],count:0},{indexs:[],count:0},{indexs:[],count:0},{indexs:[],count:0}],l={right:{startQuadrant:4,endQuadrant:1,clockwise:!0,indexs:[]},left:{startQuadrant:3,endQuadrant:2,clockwise:!1,indexs:[]}},s=0;s<n.length;s++){var u=n[s].quadrant;o[u-1].indexs.push(s),o[u-1].count++}1<o[0].count&&o[0].indexs.reverse(),1<o[2].count&&o[2].indexs.reverse(),o[0].count>o[3].count&&(l.right.startQuadrant=1,l.right.endQuadrant=4,l.right.clockwise=!1),o[1].count>o[2].count&&(l.left.startQuadrant=2,l.left.endQuadrant=3,l.left.clockwise=!0),l.right.indexs=o[l.right.startQuadrant-1].indexs.concat(o[l.right.endQuadrant-1].indexs),l.left.indexs=o[l.left.startQuadrant-1].indexs.concat(o[l.left.endQuadrant-1].indexs),l.right.indexs.length>this.textMaxCount&&((e=l.right.indexs.slice(0)).sort(function(t,e){return n[e].y-n[t].y}),t=e.slice(this.textMaxCount),n[t[0]].percentage,i=n[t[0]].y),l.left.indexs.length>this.textMaxCount&&((e=l.left.indexs.slice(0)).sort(function(t,e){return n[e].y-n[t].y}),t=e.slice(this.textMaxCount),n[t[0]].percentage,a=n[t[0]].y),r.push(l.right.startQuadrant),r.push(l.right.endQuadrant),r.push(l.left.startQuadrant),r.push(l.left.endQuadrant);for(var d={},h=0;h<r.length;h++)this._widgetLabel(r[h],o[r[h]-1].indexs,a,i,1==h||3==h,d)}},{key:"destroyLabel",value:function(){var e=this;this.textSp&&this.textSp.removeAllChildren(),d.each(this.textList,function(t){e.domContainer&&e.domContainer.removeChild(t.textEle)}),this.textList=[]}},{key:"_showGrowLabel",value:function(){this.textSp&&this.textSp.context&&(this.textSp.context.globalAlpha=1,d.each(this.textList,function(t){t.textEle.style&&(t.textEle.style.visibility="visible")}))}},{key:"_hideGrowLabel",value:function(){this.textSp&&this.textSp.context&&(this.textSp.context.globalAlpha=0,d.each(this.textList,function(t){t.textEle.style&&(t.textEle.style.visibility="hidden")}))}}]),a}(h.Dispatcher);e.default=i})),pie$1=(unwrapExports(pie),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),d=interopRequireDefault(pie),n=interopRequireDefault(graphs);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var i=function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="pie",Canvax._.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){this.data=this._dataHandle()}},{key:"_computerProps",value:function(){var t=this.width,e=this.height;this.node.outRadius||(t=Math.min(t,e)/2,this.label.enabled&&(t-=this.node.moveDis),this.node.outRadius=parseInt(t)),null!==this.node.radius&&Canvax._.isNumber(this.node.radius)&&(this.node.radius=Math.max(this.node.radius,this.node.minRadius),this.node.innerRadius=this.node.outRadius-this.node.radius),this.node.outRadius-this.node.innerRadius<this.node.minRadius&&(this.node.innerRadius=this.node.outRadius-this.node.minRadius),this.node.innerRadius<0&&(this.node.innerRadius=0)}},{key:"draw",value:function(t){Canvax._.extend(!0,this,t=t||{}),this._computerProps(),this._pie=new d.default(this,this._trimGraphs(this.data)),this._pie.draw(t);var e=this;this.animation&&!t.resize?this._pie.grow(function(){e.fire("complete")}):this.fire("complete"),this.sprite.addChild(this._pie.sprite)}},{key:"show",value:function(t){this._setEnabled(t,!0)}},{key:"hide",value:function(t){this._setEnabled(t,!1)}},{key:"_setEnabled",value:function(e,n){Canvax._.each(this.data,function(t){if(t.label===e)return t.enabled=n,!1}),this._pie.resetData(this._trimGraphs(this.data))}},{key:"_dataHandle",value:function(){for(var n=this,t=[],e=n.dataFrame,i=0,a=e.length;i<a;i++){var r=e.getRowDataAt(i),r={type:"pie",field:n.field,rowData:r,focused:!1,focusEnabled:n.node.focus.enabled,selected:!1,selectEnabled:n.node.select.enabled,selectedR:n.node.select.radius,selectedAlpha:n.node.select.alpha,enabled:!0,fillStyle:null,color:null,value:r[n.field],label:r[n.keyField||n.field],labelText:null,iNode:i},o=n._getColor(n.node.fillStyle,r);r.fillStyle=r.color=o,t.push(r)}return t.length&&n.sort&&(t.sort(function(t,e){return"asc"==n.sort?t.value-e.value:e.value-t.value}),Canvax._.each(t,function(t,e){t.iNode=e})),t}},{key:"_trimGraphs",value:function(t){var n=this,e=0,i=(n.currentAngle=0+n.startAngle%360,n.allAngle+n.startAngle%n.allAngle),a=0,r=0;if(t.length){for(var o,l=0;l<t.length;l++)t[l].enabled&&(e+=t[l].value,n.node.radius&&Canvax._.isString(n.node.radius)&&n.node.radius in t[l].rowData&&(o=Number(t[l].rowData[n.node.radius]),a=Math.max(a,o),r=Math.min(r,o)));if(0<e)for(var s=0;s<t.length;s++){var u=t[s].value/e,d=+(100*(u=t[s].enabled?u:0)).toFixed(2),h=n.allAngle*u,c=n.currentAngle+h>i?i:n.currentAngle+h,f=Math.cos((n.currentAngle+h/2)/180*Math.PI),p=Math.sin((n.currentAngle+h/2)/180*Math.PI),g=n.currentAngle+h/2,y=function(t){i<=t&&(t=i),t%=n.allAngle;var e=parseInt(t/90);if(0<=t)switch(e){case 0:return 1;case 1:return 2;case 2:return 3;case 3:case 4:return 4}else if(t<0)switch(e){case 0:return 4;case-1:return 3;case-2:return 2;case-3:case-4:return 1}}(g),_=n.node.outRadius,v=(n.node.radius&&Canvax._.isString(n.node.radius)&&n.node.radius in t[s].rowData&&(v=Number(t[s].rowData[n.node.radius]),_=parseInt((n.node.outRadius-n.node.innerRadius)*((v-r)/(a-r))+n.node.innerRadius)),n.node.moveDis);Canvax._.extend(t[s],{outRadius:_,innerRadius:n.node.innerRadius,startAngle:n.currentAngle,endAngle:c,midAngle:g,moveDis:v,outOffsetx:.7*v*f,outOffsety:.7*v*p,centerx:_*f,centery:_*p,outx:(_+v)*f,outy:(_+v)*p,edgex:(_+v)*f,edgey:(_+v)*p,orginPercentage:u,percentage:d,quadrant:y,labelDirection:1==y||4==y?1:0,iNode:s}),t[s].labelText=n._getLabelText(t[s]),t[s].subValue=d+"%",n.currentAngle+=h,n.currentAngle>i&&(n.currentAngle=i)}}return{list:t,total:e}}},{key:"_getColor",value:function(t,e){var n=e.iNode,i=t;return Canvax._.isArray(t)&&(i=t[n]),i=(i=Canvax._.isFunction(t)?t.apply(this,[e]):i)||this.app.getTheme(n)}},{key:"_getLabelText",value:function(t){var e,n;return this.label.enabled&&(this.label.format?Canvax._.isFunction(this.label.format)&&(n=this.label.format(t.label,t)):n=(e=this.keyField)?t.rowData[e]+"："+t.percentage+"%":t.percentage+"%"),n}},{key:"getList",value:function(){return this.data}},{key:"getLegendData",value:function(){var e=[];return Canvax._.each(this.data,function(t){e.push({name:t.label,color:t.fillStyle,enabled:t.enabled})}),e}},{key:"tipsPointerOf",value:function(){}},{key:"tipsPointerHideOf",value:function(){}},{key:"focusAt",value:function(t){t=this._pie.data.list[t];this.node.focus.enabled&&this._pie.focusOf(t)}},{key:"unfocusAt",value:function(t){t=this._pie.data.list[t];t.node.focus.enabled&&this._pie.unfocusOf(t)}},{key:"selectAt",value:function(t){t=this._pie.data.list[t];this.node.select.enabled&&this._pie.selectOf(t)}},{key:"unselectAt",value:function(t){t=this._pie.data.list[t];this.node.select.enabled&&this._pie.unselectOf(t)}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},keyField:{detail:"分组字段",default:null,documentation:"keyField主要是给legend用的， 所有在legend中需要显示的分组数据，都用keyField"},sort:{detail:"排序，默认不排序，可以配置为asc,desc",default:null},startAngle:{detail:"起始角度",default:-90},allAngle:{detail:"全部角度",default:360},node:{detail:"单个节点（扇形）配置",propertys:{radius:{detail:"半径",default:null,documentation:"每个扇形单元的半径，也可以配置一个字段，就成了丁格尔玫瑰图"},innerRadius:{detail:"内径",default:0},outRadius:{detail:"外径",default:null},minRadius:{detail:"最小的半径厚度",default:10,documentation:"outRadius - innerRadius ， 也就是radius的最小值"},moveDis:{detail:"hover偏移量",default:8,documentation:"要预留moveDis位置来hover sector 的时候外扩"},fillStyle:{detail:"单个图形背景色",default:null},focus:{detail:"图形的hover设置",propertys:{enabled:{detail:"是否开启",default:!0}}},select:{detail:"图形的选中效果",propertys:{enabled:{detail:"是否开启",default:!0},radius:{detail:"选中效果图形的半径厚度",default:5},alpha:{detail:"选中效果图形的透明度",default:.7}}}}},label:{detail:"label",propertys:{field:{detail:"获取label的字段",default:null},enabled:{detail:"是否开启",default:!1},format:{detail:"label的格式化函数，支持html",default:null}}}}}},{key:"polyfill",value:function(t){return t.groupField&&(t.keyField=t.groupField,delete t.groupField),t.label&&t.label.field&&(t.keyField=t.label.field,delete t.label.field),t}}]),i}(n.default);n.default.registerComponent(i,"graphs","pie"),e.default=i})),radar=(unwrapExports(pie$1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(Canvax),i=interopRequireDefault(graphs);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=n.default._,f=n.default.event,p=n.default.Shapes.Polygon,g=n.default.Shapes.Circle,n=function(t){(0,l.default)(i,t);var n=d(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="radar",e.enabledField=null,e.groups={},c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){}},{key:"draw",value:function(t){c.extend(!0,this,t=t||{}),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.fire("complete")}},{key:"_widget",value:function(){var u=this,d=this.app.getComponent({name:"coord"}),h=0;c.each(this.data,function(t,e){var n={},i=[],a=(c.each(t,function(t){i.push([t.point.x,t.point.y])}),d.getFieldConfig(e)),r=u._getStyle(u.line.strokeStyle,a,h,a.color),o=u._getStyle(u.line.lineType,a,h,a.color),l={pointList:i,cursor:"pointer"},o=(u.line.enabled&&(l.lineWidth=u.line.lineWidth,l.strokeStyle=r,l.lineType=o),u.area.enabled&&(l.fillStyle=u._getStyle(u.area.fillStyle,a,h,a.color),l.fillAlpha=u._getStyle(u.area.fillAlpha,a,h,1)),new p({hoverClone:!1,context:l})),s=(n.area=o,u.sprite.addChild(o),o.__hoverFillAlpha=o.context.fillAlpha+.2,o.__fillAlpha=o.context.fillAlpha,o.on(f.types.get(),function(t){"mouseover"==t.type&&(this.context.fillAlpha=this.__hoverFillAlpha),"mouseout"==t.type&&(this.context.fillAlpha=this.__fillAlpha),u.app.fire(t.type,t)}),[]);u.node.enabled&&c.each(t,function(t,e){i.push([t.point.x,t.point.y]);var n=new g({context:{cursor:"pointer",x:t.point.x,y:t.point.y,r:u.node.radius,lineWidth:u.node.lineWidth,strokeStyle:u.node.strokeStyle,fillStyle:r}});u.sprite.addChild(n),n.iNode=e,n.nodeData=t,n._strokeStyle=r,n.on(f.types.get(),function(t){t.aAxisInd=this.iNode,t.eventInfo={trigger:"this.node",nodes:[this.nodeData]},u.app.fire(t.type,t)}),s.push(n)}),n.nodes=s,u.groups[e]=n,h++})}},{key:"tipsPointerOf",value:function(t){var i=this;i.tipsPointerHideOf(t),t.eventInfo&&t.eventInfo.nodes&&c.each(t.eventInfo.nodes,function(n){i.data[n.field]&&c.each(i.data[n.field],function(t,e){n.iNode==e&&i.focusOf(t)})})}},{key:"tipsPointerHideOf",value:function(){var e=this;c.each(e.data,function(t){c.each(t,function(t){e.unfocusOf(t)})})}},{key:"focusOf",value:function(t){var e;t.focused||(this.node.enabled&&((e=this.groups[t.field].nodes[t.iNode]).context.r+=1,e.context.fillStyle=this.node.strokeStyle,e.context.strokeStyle=e._strokeStyle),t.focused=!0)}},{key:"unfocusOf",value:function(t){var e;t.focused&&(this.node.enabled&&(--(e=this.groups[t.field].nodes[t.iNode]).context.r,e.context.fillStyle=e._strokeStyle,e.context.strokeStyle=this.node.strokeStyle),t.focused=!1)}},{key:"hide",value:function(t){var e=this.app.getComponent({name:"coord"}),e=(this.enabledField=e.filterEnabledFields(this.field),this.groups[t]);e&&(e.area.context.visible=!1,c.each(e.nodes,function(t){t.context.visible=!1}))}},{key:"show",value:function(t){var e=this.app.getComponent({name:"coord"}),e=(this.enabledField=e.filterEnabledFields(this.field),this.groups[t]);e&&(e.area.context.visible=!0,c.each(e.nodes,function(t){t.context.visible=!0}))}},{key:"_trimGraphs",value:function(){var o=this,l=this.app.getComponent({name:"coord"}),t=(this.enabledField=l.filterEnabledFields(this.field),{});return c.each(this.enabledField,function(n){var i=o.dataFrame.getFieldData(n),a=l.getFieldConfig(n),r=[];c.each(l.aAxis.angleList,function(t,e){t=Math.PI*t/180,t=l.getPointInRadianOfR(t,l.getROfNum(i[e]));r.push({type:"radar",field:n,iNode:e,rowData:o.dataFrame.getRowDataAt(e),focused:!1,value:i[e],point:t,color:a.color})}),t[n]=r}),t}},{key:"_getStyle",value:function(t,e,n,i){var a=i;return(c.isString(t)||c.isNumber(t))&&(a=t),c.isArray(t)&&(a=t[n]),a=null==(a=c.isFunction(t)?t(n,e):a)?i:a}},{key:"getNodesAt",value:function(e){var n=this.data,i=[];return c.each(this.enabledField,function(t){c.isArray(t)?c.each(t,function(t){t=n[t][e];t&&i.push(t)}):(t=n[t][e])&&i.push(t)}),i}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},line:{detail:"线配置",propertys:{enabled:{detail:"是否显示",default:!0},lineWidth:{detail:"线宽",default:2},strokeStyle:{detail:"线颜色",default:null},lineType:{detail:"线条样式,默认solid，可选dashed",default:"solid"}}},area:{detail:"面积区域配置",propertys:{enabled:{detail:"是否显示",default:!0},fillStyle:{detail:"面积背景色",default:null},fillAlpha:{detail:"面积透明度",default:.1}}},node:{detail:"线上面的单数据节点图形配置",propertys:{enabled:{detail:"是否显示",default:!0},strokeStyle:{detail:"边框色",default:"#ffffff"},radius:{detail:"半径",default:4},lineWidth:{detail:"边框大小",default:1}}}}}}]),i}(i.default);i.default.registerComponent(n,"graphs","radar"),e.default=n})),dispatch_1=(unwrapExports(radar),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={value:function(){}};function n(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i)throw new Error("illegal type: "+t);i[t]=[]}return new a(i)}function a(t){this._=t}function s(t,e,n){for(var i=0,a=t.length;i<a;++i)if(t[i].name===e){t[i]=r,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}a.prototype=n.prototype={constructor:a,on:function(t,e){var n,i,a=this._,r=(i=a,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,l=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<l;)if(n=(t=r[o]).type)a[n]=s(a[n],t.name,e);else if(null==e)for(n in a)a[n]=s(a[n],t.name,null);return this}for(;++o<l;)if((n=(t=r[o]).type)&&(n=function(t,e){for(var n,i=0,a=t.length;i<a;++i)if((n=t[i]).name===e)return n.value}(a[n],t.name)))return n},copy:function(){var t,e={},n=this._;for(t in n)e[t]=n[t].slice();return new a(e)},call:function(t,e){if(0<(n=arguments.length-2))for(var n,i,a=new Array(n),r=0;r<n;++r)a[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=0,n=(i=this._[t]).length;r<n;++r)i[r].value.apply(e,a)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],a=0,r=i.length;a<r;++a)i[a].value.apply(e,n)}},e.default=n})),cloud_1=(unwrapExports(dispatch_1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=interopRequireDefault(dispatch_1),A=Math.PI/180,P=64,R=2048;function r(t){return t.text}function o(){return"serif"}function l(){return"normal"}function s(t){return Math.sqrt(t.value)}function u(){return 30*(~~(6*Math.random())-3)}function d(){return 1}function h(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function D(){return document.createElement("canvas")}function T(t){return"function"==typeof t?t:function(){return t}}var O={archimedean:h,rectangular:function(t){var n=4*t[0]/t[1],i=0,a=0;return function(t){var e=t<0?-1:1;switch(Math.sqrt(1+4*e*t)-e&3){case 0:i+=n;break;case 1:a+=4;break;case 2:i-=n;break;default:a-=4}return[i,a]}}};e.default=function(){var c,w=[256,256],i=r,a=o,f=s,p=l,g=l,y=u,_=d,k=h,v=[],x=1/0,m=(0,n.default)("word","end"),b=null,C=Math.random,S=D;return(c={canvas:function(t){return arguments.length?(S=T(t),c):S}}).start=function(){(t=S()).width=t.height=1,e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2),t.width=(P<<5)/e,t.height=R/e,(t=t.getContext("2d")).fillStyle=t.strokeStyle="red",t.textAlign="center";var t,e,r={context:t,ratio:e},o=function(t){var e=[],n=-1;for(;++n<t;)e[n]=0;return e}((w[0]>>5)*w[1]),l=null,s=v.length,u=-1,d=[],h=v.map(function(t,e){return t.text=i.call(this,t,e),t.font=a.call(this,t,e),t.style=p.call(this,t,e),t.weight=g.call(this,t,e),t.rotate=y.call(this,t,e),t.size=~~f.call(this,t,e),t.padding=_.call(this,t,e),t}).sort(function(t,e){return e.size-t.size});return b&&clearInterval(b),b=setInterval(n,0),n(),c;function n(){for(var t=Date.now();Date.now()-t<x&&++u<s&&b;){var e=h[u];if(e.x=w[0]*(C()+.5)>>1,e.y=w[1]*(C()+.5)>>1,!function(t,e,n,i){if(!e.sprite){var a=t.context,r=t.ratio,o=(a.clearRect(0,0,(P<<5)/r,R/r),0),l=0,s=0,u=n.length;for(--i;++i<u;){e=n[i],a.save(),a.font=e.style+" "+e.weight+" "+~~((e.size+1)/r)+"px "+e.font;var d,h,c,f,p=a.measureText(e.text+"m").width*r,g=e.size<<1;if(e.rotate?(f=Math.sin(e.rotate*A),c=Math.cos(e.rotate*A),d=p*c,h=p*f,c=g*c,f=g*f,p=Math.max(Math.abs(d+f),Math.abs(d-f))+31>>5<<5,g=~~Math.max(Math.abs(h+c),Math.abs(h-c))):p=p+31>>5<<5,s<g&&(s=g),P<<5<=o+p&&(l+=s,s=o=0),R<=l+g)break;a.translate((o+(p>>1))/r,(l+(g>>1))/r),e.rotate&&a.rotate(e.rotate*A),a.fillText(e.text,0,0),e.padding&&(a.lineWidth=2*e.padding,a.strokeText(e.text,0,0)),a.restore(),e.width=p,e.height=g,e.xoff=o,e.yoff=l,e.x1=p>>1,e.y1=g>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,o+=p}for(var y=a.getImageData(0,0,(P<<5)/r,R/r).data,_=[];0<=--i;)if((e=n[i]).hasText){for(var v=(p=e.width)>>5,g=e.y1-e.y0,x=0;x<g*v;x++)_[x]=0;if(null==(o=e.xoff))return;l=e.yoff;for(var m=0,b=-1,w=0;w<g;w++){for(x=0;x<p;x++){var k=v*w+(x>>5),C=y[(l+w)*(P<<5)+(o+x)<<2]?1<<31-x%32:0;_[k]|=C,m|=C}m?b=w:(e.y0++,g--,w--,l++)}e.y1=e.y0+b,e.sprite=_.slice(0,(e.y1-e.y0)*v)}}}(r,e,h,u),e.hasText&&function(t,e,n){w[0],w[1];var i,a,r=e.x,o=e.y,l=Math.sqrt(w[0]*w[0]+w[1]*w[1]),s=k(w),u=C()<.5?1:-1,d=-u;for(;(g=s(d+=u))&&(i=~~g[0],a=~~g[1],!(Math.min(Math.abs(i),Math.abs(a))>=l));)if(e.x=r+i,e.y=o+a,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>w[0]||e.y+e.y1>w[1])&&(!n||!function(t,e,n){n>>=5;for(var i,a=t.sprite,r=t.width>>5,o=t.x-(r<<4),l=127&o,s=32-l,u=t.y1-t.y0,d=(t.y+t.y0)*n+(o>>5),h=0;h<u;h++){for(var c=i=0;c<=r;c++)if((i<<s|(c<r?(i=a[h*r+c])>>>l:0))&e[d+c])return 1;d+=n}return}(e,t,w[0]))&&(!n||function(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}(e,n))){for(var h,c=e.sprite,f=e.width>>5,p=w[0]>>5,g=e.x-(f<<4),y=127&g,_=32-y,v=e.y1-e.y0,x=(e.y+e.y0)*p+(g>>5),m=0;m<v;m++){for(var b=h=0;b<=f;b++)t[x+b]|=h<<_|(b<f?(h=c[m*f+b])>>>y:0);x+=p}return delete e.sprite,1}return}(o,e,l)){if(d.push(e),m.call("word",c,e),l){a=i=n=a=void 0;var n=e,i=(a=l)[0],a=a[1];n.x+n.x0<i.x&&(i.x=n.x+n.x0),n.y+n.y0<i.y&&(i.y=n.y+n.y0),n.x+n.x1>a.x&&(a.x=n.x+n.x1),n.y+n.y1>a.y&&(a.y=n.y+n.y1)}else l=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}];e.x-=w[0]>>1,e.y-=w[1]>>1}}s<=u&&(c.stop(),m.call("end",c,d,l))}},c.stop=function(){return b&&(clearInterval(b),b=null),c},c.timeInterval=function(t){return arguments.length?(x=null==t?1/0:t,c):x},c.words=function(t){return arguments.length?(v=t,c):v},c.size=function(t){return arguments.length?(w=[+t[0],+t[1]],c):w},c.font=function(t){return arguments.length?(a=T(t),c):a},c.fontStyle=function(t){return arguments.length?(p=T(t),c):p},c.fontWeight=function(t){return arguments.length?(g=T(t),c):g},c.rotate=function(t){return arguments.length?(y=T(t),c):y},c.text=function(t){return arguments.length?(i=T(t),c):i},c.spiral=function(t){return arguments.length?(k=O[t]||t,c):k},c.fontSize=function(t){return arguments.length?(f=T(t),c):f},c.padding=function(t){return arguments.length?(_=T(t),c):_},c.random=function(t){return arguments.length?(C=t,c):C},c.on=function(){var t=m.on.apply(m,arguments);return t===m?c:t},c}})),cloud=(unwrapExports(cloud_1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),i=interopRequireDefault(Canvax),u=interopRequireDefault(graphs),d=interopRequireDefault(cloud_1);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var c=i.default._,f=i.default.event,p=i.default.Display.Text,i=function(t){(0,l.default)(a,t);var i=h(a);function a(t,e){(0,r.default)(this,a),(e=i.call(this,t,e)).type="cloud";var n=(0,o.default)(e);return e.node={_maxFontSizeVal:0,_minFontSizeVal:null},c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(a.defaultProps()),t),e.node.fontColor=function(t){return n.app.getTheme(t.iNode)},e.init(),e}return(0,n.default)(a,[{key:"init",value:function(){}},{key:"draw",value:function(t){c.extend(!0,this,t=t||{}),this._drawGraphs(),this.sprite.context.x=this.width/2,this.sprite.context.y=this.height/2,this.fire("complete")}},{key:"getDaraFrameIndOfVal",value:function(t){var e=this,n=this.dataFrame,n=c.find(n.data,function(t){return t.field==e.field});return c.indexOf(n.data,t)}},{key:"_getFontSize",value:function(t){var e=this.node.minFontSize;return c.isFunction(this.node.fontSize)&&(e=this.node.fontSize(t)),c.isString(this.node.fontSize)&&this.node.fontSize in t&&(t=Number(t[this.node.fontSize]),isNaN(t)||(e=this.node.minFontSize+(this.node.maxFontSize-this.node.minFontSize)/(this.node._maxFontSizeVal-this.node._minFontSizeVal)*(t-this.node._minFontSizeVal))),e=c.isNumber(this.node.fontSize)?this.node.fontSize:e}},{key:"_getRotate",value:function(t,e){var n=this.node.rotation;return n=c.isFunction(this.node.rotation)?this.node.rotation(t,e)||0:n}},{key:"_getFontColor",value:function(t){var e;return c.isString(this.node.fontColor)&&(e=this.node.fontColor),e=null==(e=c.isFunction(this.node.fontColor)?this.node.fontColor(t):e)?"#ccc":e}},{key:"_drawGraphs",value:function(){var a=this;c.isString(this.node.fontSize)&&c.each(a.dataFrame.getFieldData(this.node.fontSize),function(t){a.node._maxFontSizeVal=Math.max(a.node._maxFontSizeVal,t),a.node._minFontSizeVal=Math.min(a.node._minFontSizeVal,t)}),(0,d.default)().size([a.width,a.height]).words(a.dataFrame.getFieldData(a.field).map(function(t,e){var n,i=a.app.dataFrame.getRowDataAt(a.getDaraFrameIndOfVal(t)),i={type:"cloud",rowData:i,field:a.field,name:"",value:t,text:null,size:a._getFontSize(i,t),iNode:e,color:null,__no__name:!0},e=(i.fontColor=a._getFontColor(i),t);return a.node.format?e=a.node.format(t,i):(n=a.app.getComponent({name:"coord"}).getFieldConfig(a.field))&&(e=n.getFormatValue(t)),i.text=e||t,i})).padding(a.node.padding).rotate(function(t,e){return a._getRotate(t,e)}).font(a.node.fontFamily).fontSize(function(t){return t.size}).on("end",function(n){a.data=n,a.sprite.removeAllChildren(),c.each(n,function(t,e){t.iNode=e,t.dataLen=n.length,t.focused=!1,t.selected=!1;e=new p(t.text,{context:{x:t.x,y:t.y,fontSize:t.size,fontFamily:t.font,rotation:t.rotate,textBaseline:"middle",textAlign:"center",cursor:"pointer",fontWeight:a.node.fontWeight,fillStyle:t.fontColor}});a.sprite.addChild(e),a.node.focus.enabled&&e.hover(function(){a.focusAt(this.nodeData.iNode)},function(){this.nodeData.selected||a.unfocusAt(this.nodeData.iNode)}),((e.nodeData=t)._node=e).on(f.types.get(),function(t){t.eventInfo={trigger:"this.node",title:null,nodes:[this.nodeData]},this.nodeData.text&&(t.eventInfo.title=""),a.app.fire(t.type,t)})})}).start()}},{key:"focusAt",value:function(t){t=this.data[t];this.node.focus.enabled&&!t.focused&&(t._node.context.fontSize+=3,t.focused=!0)}},{key:"unfocusAt",value:function(t){t=this.data[t];this.node.focus.enabled&&t.focused&&(t._node.context.fontSize-=3,t.focused=!1)}},{key:"selectAt",value:function(t){var e,t=this.data[t];this.node.select.enabled&&!t.selected&&((e=t._node.context).lineWidth=this.node.select.lineWidth,e.strokeAlpha=this.node.select.strokeAlpha,e.strokeStyle=this.node.select.strokeStyle,t.selected=!0)}},{key:"unselectAt",value:function(t){t=this.data[t];this.node.select.enabled&&t.selected&&(t._node.context.strokeStyle=this.node.strokeStyle,t.selected=!1)}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},node:{detail:"节点文字配置",propertys:{fontFamily:{detail:"字体设置",default:"Impact"},fontColor:{detail:"文字颜色",default:"#999"},fontSize:{detail:"文本字体大小",default:function(){return this.minFontSize+Math.random()*this.maxFontSize}},maxFontSize:{detail:"文本最大字体大小",default:30},minFontSize:{detail:"文本最小字体大小",default:16},fontWeight:{detail:"fontWeight",default:"normal"},format:{detail:"文本格式化处理函数",default:null},padding:{detail:"文本间距",default:10},rotation:{detail:"文本旋转角度",default:function(){return 30*(~~(6*Math.random())-3)}},strokeStyle:{detail:"文本描边颜色",default:null},select:{detail:"文本选中效果",propertys:{enabled:{detail:"是否开启选中",default:!0},lineWidth:{detail:"选中后的文本描边宽",default:2},strokeStyle:{detail:"选中后的文本描边色",default:"#666"}}},focus:{detail:"文本hover效果",propertys:{enabled:{detail:"是否开启hover效果",default:!0}}}}}}}}]),a}(u.default);u.default.registerComponent(i,"graphs","cloud"),e.default=i})),group$1=(unwrapExports(cloud),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),x=interopRequireDefault(Canvax),m=x.default._,b=x.default.event,w=x.default.Shapes.Circle,i=function(){function i(t,e,n){(0,a.default)(this,i),this._opt=t,this.dataFrame=e,this._graphs=n,this.app=n.app,this.field=null,this.iGroup=0,this.groupLen=1,this.rRange={start:0,to:0},this.width=0,this.height=0,this.selectInds=[],this.layoutType="radian",this.pit={radius:30},this.planets=[],this.maxRingNum=0,this.ringNum=0,m.extend(!0,this,(0,tools.getDefaultProps)(i.defaultProps()),t),this.node.maxRadius>this.pit.radius&&(this.pit.radius=this.node.maxRadius),this.init()}return(0,n.default)(i,[{key:"init",value:function(){var t=this.app.getComponent({name:"coord"});this.sprite=new x.default.Display.Sprite({id:"group_"+this.iGroup,context:{x:t.origin.x,y:t.origin.y}}),this._trimGraphs(),this.draw()}},{key:"_trimGraphs",value:function(){for(var i=this,t=this.app.getComponent({name:"coord"}).getMaxDisToViewOfOrigin(),e=((t-this.rRange.to)/(2*this.pit.radius)<this.groupLen-1-this.iGroup&&(this.rRange.to=t-(this.groupLen-1-this.iGroup)*this.pit.radius*2),this.rRange.to-this.rRange.start<2*this.pit.radius&&(this.rRange.to=this.rRange.start+2*this.pit.radius),this.maxRingNum||(this.maxRingNum=parseInt((this.rRange.to-this.rRange.start)/(2*this.pit.radius),10),this.ringNum=this.maxRingNum),this.rRange.to=this.rRange.start+this.ringNum*this.pit.radius*2,[]),n=this.dataFrame.length,a=0;a<n;a++){var r=this.dataFrame.getRowDataAt(a),r={type:"planet",groupLen:this.groupLen,iGroup:i.iGroup,iNode:a,nodeElement:null,labelElement:null,rowData:r,iRing:null,iPlanet:null,fillStyle:null,color:null,strokeStyle:null,pit:null,ringInd:-1,field:i.field,label:r[i.field],focused:!1,selected:!!~m.indexOf(this.selectInds,r.__index__)};e.push(r)}i.sortField&&(e=e.sort(function(t,e){var n=i.sortField;return"desc"==i.sort?e.rowData[n]-t.rowData[n]:t.rowData[n]-e.rowData[n]}),m.each(e,function(t,e){t.iNode=e})),this._rings=this["_setRings_"+this.layoutType+"Range"](e),this.planets=e}},{key:"_setRings_radianRange",value:function(i){for(var s=this,a=[],t=this.app.getComponent({name:"coord"}),e=0,n=this.ringNum;e<n;e++){var r=e*this.pit.radius*2+this.pit.radius+this.rRange.start,o=(s._graphs.center.enabled||(r=e*this.pit.radius*2+this.rRange.start),t.getRadiansAtR(r,s.width,s.height));a.push({arcs:o,pits:[],planets:[],radius:r,max:0})}var u=0,l=(m.each(a,function(r){var o=2*Math.asin(s.pit.radius/r.radius),l=(0==r.radius&&(o=2*Math.PI),0);m.each(r.arcs,function(t){var e=s._getDiffRadian(t[0].radian,t[1].radian);if(o<=e){var n=parseInt(e/o,10);l+=n;for(var i=0;i<n;i++){var a={hasRadish:!1,start:(t[0].radian+o*i+2*Math.PI)%(2*Math.PI)};a.middle=(a.start+o/2+2*Math.PI)%(2*Math.PI),a.to=(a.start+o+2*Math.PI)%(2*Math.PI),r.pits.push(a)}}}),r.max=l,u+=l,r.pits=m.shuffle(r.pits)}),0);return m.each(a,function(n,t){if(l>=i.length)return!1;var e=Math.ceil(n.max/u*i.length),e=Math.min(n.max,e);n.planets=i.slice(l,l+e),t==a.length-1&&(n.planets=i.slice(l)),l+=e,m.each(n.planets,function(t,e){e>=n.pits.length||((e=(e=m.filter(n.pits,function(t){return!t.hasRadish}))[parseInt(Math.random()*e.length)]).hasRadish=!0,t.pit=e)})}),a}},{key:"_getDiffRadian",value:function(t,e){var n=e-t;return n=e<t?(e+2*Math.PI-t)%(2*Math.PI):n}},{key:"_setRings_indexRange",value:function(){}},{key:"_setRings_valRange",value:function(){}},{key:"draw",value:function(){var _=this,v=this.app.getComponent({name:"coord"});m.each(this._rings,function(f,p){var g={rotation:0},y=(1==f.arcs.length&&0==f.arcs[0][0].radian&&f.arcs[0][1].radian==2*Math.PI&&(g.rotation=parseInt(360*Math.random())),new x.default.Display.Sprite({context:g}));m.each(f.planets,function(t,e){var n,i,a,r,o,l,s,u,d,h;function c(){l.y=n.y+i+3,l.rotation=-g.rotation,l.rotateOrigin={x:0,y:-(i+.7*d)}}t.pit&&(n=v.getPointInRadianOfR(t.pit.middle,f.radius),i=_._getRProp(_.node.radius,p,e,t),s=_.node.maxRadius-i,s=parseInt(Math.random()*s),h=parseInt(360*Math.random())*Math.PI/180,0!=s&&(n.x+=Math.sin(h)*s,n.y+=Math.cos(h)*s),h=_.node,t.selected&&(h=_.node.select),s=_._getProp(_.node.fillStyle,t),u=_._getProp(h.strokeStyle,t),o=_._getProp(h.strokeAlpha,t),h=_._getProp(h.lineWidth,t),h={x:n.x,y:n.y,r:i,fillStyle:s,lineWidth:h,strokeStyle:u,strokeAlpha:o,cursor:"pointer"},t.color=t.fillStyle=s,t.strokeStyle=u,t.iRing=p,t.iPlanet=e,(a=new w({hoverClone:!1,context:h})).on(b.types.get(),function(t){var e,n;t.eventInfo={title:null,trigger:"this.node",nodes:[this.nodeData]},this.nodeData.label&&(t.eventInfo.title=this.nodeData.label),_.node.focus.enabled&&("mouseover"==t.type&&_.focusAt(this.nodeData),"mouseout"==t.type&&_.unfocusAt(this.nodeData)),_.node.select.enabled&&-1<_.node.select.triggerEventType.indexOf(t.type)&&(e=_.node.select.onbefore,n=_.node.select.onend,e&&("function"!=typeof e||!1===e.apply(_,[this.nodeData]))||(this.nodeData.selected?_.unselectAt(this.nodeData):_.selectAt(this.nodeData),n&&"function"==typeof n&&n.apply(_,[this.nodeData]))),_.app.fire(t.type,t)}),((a.nodeData=t).nodeElement=a).ringInd=p,a.planetIndInRing=e,y.addChild(a),_._graphs.animation&&(r=a.context.r,o=a.context.globalAlpha,a.context.r=1,a.context.globalAlpha=.1,a.animate({r:r,globalAlpha:o},{delay:Math.round(1500*Math.random()),onComplete:function(){a.labelElement&&(a.labelElement.context.visible=!0);var t=a.clone();y.addChildAt(t,0),t.animate({r:r+10,globalAlpha:0},{onComplete:function(){t.destroy()}})}})),l={x:n.x,y:n.y,fontSize:_.label.fontSize,textAlign:_.label.textAlign,textBaseline:_.label.verticalAlign,fillStyle:_.label.fontColor,rotation:-g.rotation,rotateOrigin:{x:0,y:0}},u=(s=new x.default.Display.Text(t.label,{context:l})).getTextWidth(),d=s.getTextHeight(),2*i<u&&(l.fontSize=_.label.fontSize-3),m.isFunction(_.label.position)&&(h=_.label.position({node:a,circleR:i,circleCenter:{x:n.x,y:n.y},textWidth:u,textHeight:d}),l.rotation=-g.rotation,l.rotateOrigin={x:-(h.x-l.x),y:-(h.y-l.y)},l.x=h.x,l.y=h.y),"auto"==_.label.position&&2*i<u&&c(),"bottom"==_.label.position&&c(),l.x+=_.label.offsetX,l.y+=_.label.offsetY,s=new x.default.Display.Text(t.label,{context:l}),((a.labelElement=s).nodeData=t).labelElement=s,_._graphs.animation&&(s.context.visible=!1),y.addChild(s))}),_.sprite.addChild(y)})}},{key:"_getRProp",value:function(e,t,n,i){var a,r=this;return m.isString(e)&&-1<m.indexOf(r.dataFrame.fields,e)?(null==this.__rValMax&&null==this.__rValMax&&(this.__rValMax=0,this.__rValMin=0,m.each(r.planets,function(t){r.__rValMax=Math.max(r.__rValMax,t.rowData[e]),r.__rValMin=Math.min(r.__rValMin,t.rowData[e])})),a=i.rowData[e],r.node.minRadius+(a-this.__rValMin)/(this.__rValMax-this.__rValMin)*(r.node.maxRadius-r.node.minRadius)):r._getProp(e,i)}},{key:"_getProp",value:function(t,e){var n=this.iGroup;return m.isFunction(t)?t.apply(this,[e,n]):t}},{key:"getPlanetAt",value:function(e){var n=e;return m.isNumber(e)&&m.each(this.planets,function(t){if(t.rowData.__index__==e)return n=t,!1}),n}},{key:"selectAt",value:function(t){if(this.node.select.enabled){var e=this.getPlanetAt(t);e.selected=!0,e.nodeElement&&(e.nodeElement.context.lineWidth=this._getProp(this.node.select.lineWidth,e),e.nodeElement.context.strokeStyle=this._getProp(this.node.select.strokeStyle,e),e.nodeElement.context.strokeAlpha=this._getProp(this.node.select.strokeAlpha,e));for(var n=0;n<this.selectInds.length;n++)if(t===this.selectInds[n]){this.selectInds.splice(n--,1);break}}}},{key:"unselectAt",value:function(t){var e;this.node.select.enabled&&((e=this.getPlanetAt(t)).selected=!1,e.nodeElement&&(e.nodeElement.context.lineWidth=this._getProp(this.node.lineWidth,e),e.nodeElement.context.strokeAlpha=this._getProp(this.node.strokeAlpha,e)),this.selectInds.push(t))}},{key:"getSelectedNodes",value:function(){return m.filter(this.planets,function(t){return t.selected})}},{key:"focusAt",value:function(t){!this.node.focus.enabled||(t=this.getPlanetAt(t)).selected||(t.focused=!0,t.nodeElement&&(t.nodeElement.context.lineWidth=this._getProp(this.node.focus.lineWidth,t),t.nodeElement.context.strokeStyle=this._getProp(this.node.focus.strokeStyle,t),t.nodeElement.context.strokeAlpha=this._getProp(this.node.focus.strokeAlpha,t)))}},{key:"unfocusAt",value:function(t){!this.node.focus.enabled||(t=this.getPlanetAt(t)).selected||(t.focused=!1,t.nodeElement&&(t.nodeElement.context.lineWidth=this._getProp(this.node.lineWidth,t),t.nodeElement.context.strokeAlpha=this._getProp(this.node.strokeAlpha,t)))}}],[{key:"defaultProps",value:function(){return{sort:{detail:"排序",default:"desc"},sortField:{detail:"用来排序的字段",default:"null"},node:{detail:"单个数据节点图形配置",propertys:{maxRadius:{detail:"最大半径",default:30},minRadius:{detail:"最小半径",default:5},radius:{detail:"半径",default:15,documentation:'也可以是个function,也可以配置{field:"pv"}来设置字段， 自动计算r'},lineWidth:{detail:"描边线宽",default:1},strokeStyle:{detail:"描边颜色",default:"#ffffff"},fillStyle:{detail:"图形填充色",default:"#f2fbfb"},strokeAlpha:{detail:"边框透明度",default:.6},focus:{detail:"hover态设置",propertys:{enabled:{detail:"是否开启",default:!0},strokeAlpha:{detail:"hover时候边框透明度",default:.7},lineWidth:{detail:"hover时候边框大小",default:2},strokeStyle:{detail:"hover时候边框颜色",default:"#fff"}}},select:{detail:"选中态设置",propertys:{enabled:{detail:"是否开启",default:!1},strokeAlpha:{detail:"选中时候边框透明度",default:1},lineWidth:{detail:"选中时候边框大小",default:2},strokeStyle:{detail:"选中时候边框颜色",default:"#fff"},triggerEventType:{detail:"触发事件",default:"click,tap"},onbefore:{detail:"执行select处理函数的前处理函数，返回false则取消执行select",default:null},onend:{detail:"执行select处理函数的后处理函数",default:null}}}}},label:{detail:"文本设置",propertys:{enabled:{detail:"是否开启",default:!0},fontColor:{detail:"文本颜色",default:"#666666"},fontSize:{detail:"文本字体大小",default:13},textAlign:{detail:"水平对齐方式",default:"center"},verticalAlign:{detail:"基线对齐方式",default:"middle"},position:{detail:"文本布局位置",default:"center"},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0}}}}}}]),i}();e.default=i})),planet=(unwrapExports(group$1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),d=interopRequireDefault(Canvax),n=interopRequireDefault(graphs),h=interopRequireDefault(group$1),c=interopRequireDefault(dataSection_1);function f(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var p=d.default._,g=d.default.event,y=d.default.Display.Text,_=d.default.Shapes.Circle,v=d.default.Shapes.Line,x=d.default.Shapes.Rect,m=d.default.Shapes.Sector,i=function(t){(0,l.default)(i,t);var n=f(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="planet",e.groupDataFrames=[],e.groupField=null,e._ringGroups=[],e.grid={rings:{_section:[]}},p.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),0!=e.center.radius&&e.center.enabled||(e.center.radius=0,e.center.margin=0,e.center.enabled=!1),e.__scanIngCurOration=0,e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){this.gridSp=new d.default.Display.Sprite({id:"gridSp"}),this.groupSp=new d.default.Display.Sprite({id:"groupSp"}),this.scanSp=new d.default.Display.Sprite({id:"scanSp"}),this.centerSp=new d.default.Display.Sprite({id:"centerSp"}),this.sprite.addChild(this.gridSp),this.sprite.addChild(this.groupSp),this.sprite.addChild(this.scanSp),this.sprite.addChild(this.centerSp)}},{key:"draw",value:function(t){p.extend(!0,this,t=t||{}),this._dataGroupHandle(),this._drawGroups(),this._drawBack(),this._drawBewrite(),this._drawCenter(),this._drawScan(),this.fire("complete")}},{key:"_getMaxR",value:function(){var t;return t=null==(t=this.graphs&&this.graphs.group&&this.graphs.group.circle?this.graphs.group.circle.maxRadius:t)?30:t}},{key:"_drawGroups",value:function(){var i=this,a=this.center.radius+this.center.margin,r=i.app.getComponent({name:"coord"}).getMaxDisToViewOfOrigin()-i.center.radius-i.center.margin,o=this._getMaxR();p.each(this.groupDataFrames,function(t,e){var n=a+r*(t.length/i.dataFrame.length),e=new h.default(p.extend(!0,{iGroup:e,groupLen:i.groupDataFrames.length,rRange:{start:a,to:n},width:i.width-2*o,height:i.height-2*o,selectInds:i.selectInds},i._opt),t,i);a=e.rRange.to,i._ringGroups.push(e),i.grid.rings._section.push({radius:e.rRange.to})}),p.each(i._ringGroups,function(t){i.sprite.addChild(t.sprite)})}},{key:"_drawCenter",value:function(){var e=this;this.center.enabled&&(this._center=new _({hoverClone:!1,context:{x:this.origin.x,y:this.origin.y,fillStyle:this.center.fillStyle,r:this.center.radius,cursor:this.center.cursor}}),this._centerTxt=new y(this.center.text,{context:{x:this.origin.x,y:this.origin.y,fontSize:this.center.fontSize,textAlign:"center",textBaseline:"middle",fillStyle:this.center.fontColor}}),this._center.on(g.types.get(),function(t){t.eventInfo={title:e.center.text,trigger:"this.center",nodes:[e.center]},e.center.onclick&&("mousedown"==t.type&&(e._center.context.r+=2),"mouseup"==t.type&&(e._center.context.r-=2)),e.app.fire(t.type,t)}),this.centerSp.addChild(this._center),this.centerSp.addChild(this._centerTxt))}},{key:"_drawBack",value:function(){var t=this,e=this.app.getComponent({name:"coord"});if(1==t.grid.rings._section.length){var n=(t.grid.rings._section[0].radius-t.center.radius)/t.grid.rings.count;t.grid.rings._section=[];for(var i=0;i<t.grid.rings.count;i++)t.grid.rings._section.push({radius:t.center.radius+n*(i+1)})}else t.grid.rings.count=t.grid.rings._section.length;for(var a=t.grid.rings._section.length-1;0<=a;a--){var r=t.grid.rings._section[a];t.gridSp.addChild(new _({context:{x:e.origin.x,y:e.origin.y,r:r.radius,lineWidth:t._getBackProp(t.grid.rings.lineWidth,a),strokeStyle:t._getBackProp(t.grid.rings.strokeStyle,a),fillStyle:t._getBackProp(t.grid.rings.fillStyle,a)}}))}if(1<t.grid.rays.count){var o=e.origin.x,l=e.origin.y,s=360/t.grid.rays.count,u=e.getMaxDisToViewOfOrigin();t.grid.rings._section.length&&(u=t.grid.rings._section.slice(-1)[0].radius);for(var d=0,h=t.grid.rays.count;d<h;d++){var c=s*d/180*Math.PI,f=o+u*Math.cos(c),c=l+u*Math.sin(c);t.gridSp.addChild(new v({context:{start:{x:o,y:l},end:{x:f,y:c},lineWidth:t._getBackProp(t.grid.rays.lineWidth,d),strokeStyle:t._getBackProp(t.grid.rays.strokeStyle,d),globalAlpha:t.grid.rays.globalAlpha}}))}}var p=new x({name:"clipRect",context:{x:e.origin.x-t.app.width/2,y:e.origin.y-t.height/2,width:t.app.width,height:t.height}});t.gridSp.clipTo(p),t.sprite.addChild(p)}},{key:"_getBackProp",value:function(t,e){var n=null;return p.isFunction(t)&&(n=t.apply(this,[{scaleInd:e,count:this.grid.rings._section.length,groups:this._ringGroups,graphs:this}])),(p.isString(t)||p.isNumber(t))&&(n=t),n=p.isArray(t)?t[e]:n}},{key:"_drawBewrite",value:function(){var t,e,a,n,i,r,o,l=this;l.bewrite.enabled&&(t=function(t,e,n,i){n.context.x=t*l.center.radius+20*t,r.addChild(n),r.addChild(new v({context:{lineType:"dashed",start:{x:n.context.x,y:0},end:{x:t*(e?o/2-a/2:o),y:0},lineWidth:1,strokeStyle:"#ccc"}})),e&&(e.context.x=t*(o/2),r.addChild(e),r.addChild(new v({context:{lineType:"dashed",start:{x:t*(o/2+a/2),y:0},end:{x:t*o,y:0},lineWidth:1,strokeStyle:"#ccc"}}))),i.context.x=t*o,r.addChild(i)},l.bewrite.text&&(e=new d.default.Display.Text(l.bewrite.text,{context:{fillStyle:l.bewrite.fontColor,fontSize:l.bewrite.fontSize,textBaseline:"middle",textAlign:"center"}}),a=e.getTextWidth()),n=new d.default.Display.Text("强",{context:{fillStyle:l.bewrite.fontColor,fontSize:l.bewrite.fontSize,textBaseline:"middle",textAlign:"center"}}),i=new d.default.Display.Text("弱",{context:{fillStyle:l.bewrite.fontColor,fontSize:l.bewrite.fontSize,textBaseline:"middle",textAlign:"center"}}),r=new d.default.Display.Sprite({context:{x:this.origin.x,y:this.origin.y}}),l.sprite.addChild(r),o=l.width/2,t(1,e.clone(),n.clone(),i.clone()),t(-1,e.clone(),n.clone(),i.clone()))}},{key:"scan",value:function(){var e=this,t=(this._scanAnim&&this._scanAnim.stop(),e._getScanSp());360==e.__scanIngCurOration&&(t.context.rotation=0),e._scanAnim=t.animate({rotation:360,globalAlpha:1},{duration:(360-e.__scanIngCurOration)/360*1e3,onUpdate:function(t){e.__scanIngCurOration=t.rotation},onComplete:function(){t.context.rotation=0,e._scanAnim=t.animate({rotation:360},{duration:1e3,repeat:1e3,onUpdate:function(t){e.__scanIngCurOration=t.rotation}})}})}},{key:"_drawScan",value:function(t){var e,n=this;n.scan.enabled&&(e=n._getScanSp(),360==n.__scanIngCurOration&&(e.context.rotation=0),n._scanAnim&&n._scanAnim.stop(),n._scanAnim=e.animate({rotation:360,globalAlpha:1},{duration:(360-n.__scanIngCurOration)/360*1e3,onUpdate:function(t){n.__scanIngCurOration=t.rotation},onComplete:function(){e.context.rotation=0,n._scanAnim=e.animate({rotation:360},{duration:1e3,repeat:n.scan.repeat-2,onUpdate:function(t){n.__scanIngCurOration=t.rotation},onComplete:function(){e.context.rotation=0,n._scanAnim=e.animate({rotation:360,globalAlpha:0},{duration:1e3,onUpdate:function(t){n.__scanIngCurOration=t.rotation},onComplete:function(){e.destroy(),n.__scanSp=null,delete n.__scanSp,n.__scanIngCurOration=0,t&&t()}})}})}}))}},{key:"_getScanSp",value:function(){var t=this,e=t.__scanSp;if(!e){e=new d.default.Display.Sprite({context:{x:this.origin.x,y:this.origin.y,globalAlpha:0,rotation:t.__scanIngCurOration}}),t.scanSp.addChild(e),t.__scanSp=e;for(var n=t.scan.r||t.height/2-10,i=t.scan.fillStyle||t.center.fillStyle,a=t.scan.angle,r=0,o=a;r<o;r++){var l=new m({context:{r:n,fillStyle:i,clockwise:!0,startAngle:360-r,endAngle:359-r,globalAlpha:t.scan.alpha-t.scan.alpha/a*r}});e.addChild(l)}var s=new v({context:{end:{x:n,y:0},lineWidth:1,strokeStyle:i}});e.addChild(s)}return e}},{key:"_dataGroupHandle",value:function(){var n=p.indexOf(this.dataFrame.fields,this.groupField);if(0<=n){var t,i=this.dataFrame.org[0],a={};for(t in p.each(this.dataFrame.org,function(t,e){e&&(a[t[n]]||(a[t[n]]=[p.clone(i)]),a[t[n]].push(t))}),a)this.groupDataFrames.push((0,c.default)(a[t]))}else this.groupDataFrames.push(this.dataFrame)}},{key:"show",value:function(t,e){this.getAgreeNodeData(e,function(t){t.nodeElement&&(t.nodeElement.context.visible=!0),t.labelElement&&(t.labelElement.context.visible=!0)})}},{key:"hide",value:function(t,e){this.getAgreeNodeData(e,function(t){t.nodeElement&&(t.nodeElement.context.visible=!1),t.labelElement&&(t.labelElement.context.visible=!1)})}},{key:"getAgreeNodeData",value:function(n,i){p.each(this._ringGroups,function(t){p.each(t._rings,function(t){p.each(t.planets,function(t){var e=t.rowData;n.params.name==e[n.params.field]&&i&&i(t)})})})}},{key:"getLayoutNodes",value:function(){var e=[];return p.each(this._ringGroups,function(t){p.each(t.planets,function(t){t.pit&&e.push(t)})}),e}},{key:"getInvalidNodes",value:function(){var e=[];return p.each(this._ringGroups,function(t){p.each(t.planets,function(t){t.pit||e.push(t)})}),e}},{key:"selectAt",value:function(e){p.each(this._ringGroups,function(t){t.selectAt(e)})}},{key:"selectAll",value:function(){var e=this;p.each(e.dataFrame.getFieldData("__index__"),function(t){e.selectAt(t)})}},{key:"unselectAt",value:function(e){p.each(this._ringGroups,function(t){t.unselectAt(e)})}},{key:"unselectAll",value:function(){var e=this;p.each(e.dataFrame.getFieldData("__index__"),function(t){e.unselectAt(t)})}},{key:"getSelectedNodes",value:function(){var e=[];return p.each(this._ringGroups,function(t){e=e.concat(t.getSelectedNodes())}),e}},{key:"getSelectedRowList",value:function(){var n=[];return p.each(this._ringGroups,function(t){var e=[];p.each(t.getSelectedNodes(),function(t){e.push(t.rowData)}),n=n.concat(e)}),n}},{key:"getNodesAt",value:function(){}},{key:"resetData",value:function(t){this.clean(),this.dataFrame=t,this._dataGroupHandle(),this._drawGroups(),this._drawScan()}},{key:"clean",value:function(){this.groupDataFrames=[],p.each(this._ringGroups,function(t){t.sprite.destroy()}),this._ringGroups=[]}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段设置",default:null},center:{detail:"中心点设置",propertys:{enabled:{detail:"是否显示中心",default:!0},text:{detail:"中心区域文本",default:"center"},radius:{detail:"中心圆半径",default:30},fillStyle:{detail:"中心背景色",default:"#70629e"},fontSize:{detail:"中心字体大小",default:15},fontColor:{detail:"中心字体颜色",default:"#ffffff"},margin:{detail:"中区区域和外围可绘图区域距离",default:20},cursor:{detail:"中心节点的鼠标手势",default:"default"}}},selectInds:{detail:"选中的数据索引",default:[]},grid:{detail:"星系图自己的grid",propertys:{rings:{detail:"环配置",propertys:{fillStyle:{detail:"背景色",default:null},strokeStyle:{detail:"环线色",default:null},lineWidth:{detail:"环线宽",default:1},count:{detail:"分几环",default:3}}},rays:{detail:"射线配置",propertys:{count:{detail:"射线数量",default:0},globalAlpha:{detail:"线透明度",default:.4},strokeStyle:{detail:"线色",default:"#10519D"},lineWidth:{detail:"线宽",default:1}}}}},bewrite:{detail:"planet的趋势描述",propertys:{enabled:{detail:"是否开启趋势描述",default:!1},text:{detail:"描述文本",default:null},fontColor:{detail:"fontColor",default:"#999"},fontSize:{detail:"fontSize",default:12}}},scan:{detail:"扫描效果",propertys:{enabled:{detail:"是否开启扫描效果",default:!1},fillStyle:{detail:"扫描效果颜色",default:null},alpha:{detail:"起始透明度",default:.6},angle:{detail:"扫描效果的覆盖角度",default:90},r:{detail:"扫描效果覆盖的半径",default:null},repeat:{detail:"扫描次数",default:3}}},_props:[h.default]}}}]),i}(n.default);n.default.registerComponent(i,"graphs","planet"),e.default=i})),funnel=(unwrapExports(planet),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),d=interopRequireDefault(Canvax),n=interopRequireDefault(graphs),h=interopRequireDefault(numeral);function c(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var f=d.default._,p=d.default.event,g=d.default.Display.Text,y=d.default.Shapes.Polygon,i=function(t){(0,l.default)(i,t);var n=c(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="funnel",e.dataOrg=[],e.data=[],e.maxValue=null,e.minValue=null,f.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){this.node.maxFillStyle||(this.node.maxFillStyle=this.app.getTheme(0)),this._nodesp=new d.default.Display.Sprite({id:"nodeSp"}),this._textsp=new d.default.Display.Sprite({id:"textsp"}),this.sprite.addChild(this._nodesp),this.sprite.addChild(this._textsp)}},{key:"_computerAttr",value:function(){this.field&&(this.dataOrg=this.dataFrame.getFieldData(this.field)),this.maxValue=f.max(this.dataOrg),this.minValue=f.min(this.dataOrg),null==this.node.maxWidth&&(this.node.maxWidth=parseInt(+this.width)),null==this.node.minWidth&&(this.maxValue==this.minValue?this.node.minWidth=this.node.maxValue:this.node.minWidth=parseInt(this.node.maxWidth*(this.minValue/this.maxValue))),null==this.node.spireWidth&&(this.node.spireWidth=this.node.minWidth),this.node.height||(this.node.height=parseInt(this.height/this.dataOrg.length))}},{key:"draw",value:function(t){f.extend(!0,this,t=t||{}),this._computerAttr(),this.data=this._trimGraphs(),this._drawGraphs(),this.sprite.context.x=this.origin.x+this.width/2,this.sprite.context.y=this.origin.y,this.fire("complete")}},{key:"_trimGraphs",value:function(){var i,a,r;if(this.field)return i=this,a=[],r=this.app.getCoord(),f.each(this.dataOrg,function(t,e){var n=i.dataFrame.getRowDataAt(e),n={type:"funnel",field:i.field,rowData:n,value:t,name:i.nameField?n[i.nameField]:e+1,width:i._getNodeWidth(t),color:"",cursor:"pointer",label:"",middlePoint:null,iNode:-1,points:[]};n.color=i._getProp(i.node,"fillStyle",n),a.push(n)}),this.sort&&(a=a.sort(function(t,e){return"desc"==i.sort?e.value-t.value:t.value-e.value})),f.each(a,function(t,e){t.iNode=e;var n,e=t.value;i.label.format?(!f.isFunction(i.label.format)||void 0===(n=i.label.format.apply(i,[e,t]))&&null===n||(e=n),"string"==typeof i.label.format&&(e=(0,h.default)(e).format(i.label.format))):(n=r.getFieldConfig(i.field))&&(e=n.getFormatValue(e)),t.label=e}),f.each(a,function(t,e){t.points=i._getPoints(t,a[e+1],a[e-1]),t.middlePoint={x:0,y:(t.iNode+.5)*i.node.height}}),a}},{key:"_getNodeWidth",value:function(t){var e=this.node.maxWidth;return e=this.maxValue!=this.minValue?parseInt(this.node.minWidth+(this.node.maxWidth-this.node.minWidth)/(this.maxValue-this.minValue)*(t-this.minValue)):e}},{key:"_getPoints",value:function(t,e,n){var i,a=[],r=t.iNode*this.node.height,o=r+this.node.height;return"asc"!==this.sort?(a.push([-t.width/2,r]),a.push([t.width/2,r]),i=(e||t).width,e||null==this.node.spireWidth||this.maxValue==this.minValue||(i=Math.min(this.node.spireWidth,i)),a.push([i/2,o]),a.push([-i/2,o])):(e=(n||t).width,n||null==this.node.spireWidth||this.maxValue==this.minValue||(e=Math.min(this.node.spireWidth,e)),a.push([-e/2,r]),a.push([e/2,r]),a.push([t.width/2,o]),a.push([-t.width/2,o])),a}},{key:"_drawGraphs",value:function(){var o=this,l=this.app.getCoord().getFieldConfig(o.field).name||this.field;f.each(this.data,function(t){var e=o._getProp(o.node,"fillAlpha",t),n=o._getProp(o.node,"strokeStyle",t),i=o._getProp(o.node,"strokeAlpha",t),a=o._getProp(o.node,"lineWidth",t),r=o._getProp(o.node,"lineType",t),e=new y({id:"funel_item_"+t.iNode,hoverClone:!1,context:{pointList:t.points,fillStyle:t.color,cursor:t.cursor,fillAlpha:e,strokeStyle:n,strokeAlpha:i,lineWidth:a,lineType:r}}),n=(t.nodeElement=e,o._nodesp.addChild(e),e.nodeData=t,e.on(p.types.get(),function(t){t.eventInfo={trigger:"this.node",title:l,nodes:[this.nodeData]},"mouseover"==t.type&&o.focusAt(this.nodeData.iNode),"mouseout"!=t.type||this.nodeData.selected||o.unfocusAt(this.nodeData.iNode),o.app.fire(t.type,t)}),"center"),i={x:t.middlePoint.x,y:t.middlePoint.y},a=("left"==o.label.textAlign&&(i.x=t.points[0][0]-(t.points[0][0]-t.points[3][0])/2,i.x-=15,n="right"),"right"==o.label.textAlign&&(i.x=t.points[1][0]-(t.points[1][0]-t.points[2][0])/2,i.x+=15,n="left"),t.textPoint=i,new g(t.label,{context:{x:i.x,y:i.y,fontSize:o.label.fontSize,fillStyle:"center"==o.label.textAlign?o.label.fontColor:t.color,strokeStyle:o.label.strokeStyle,lineWidth:o.label.lineWidth,textAlign:n,textBaseline:o.label.textBaseline}}));o._textsp.addChild(a),o.node.drawEnd(t)})}},{key:"focusAt",value:function(t){var e,n,i,a,r,t=this._nodesp.getChildById("funel_item_"+t),o=t.nodeData;t&&(e=(a=t.context).fillStyle,n=a.fillAlpha,i=a.strokeStyle,a=a.strokeAlpha,t._default={fillStyle:e,fillAlpha:n,strokeStyle:i,strokeAlpha:a},e=this._getProp(this.node.focus,"fillStyle",o)||e,n=this._getProp(this.node.focus,"fillAlpha",o)||n,i=this._getProp(this.node.focus,"strokeStyle",o)||i,a=this._getProp(this.node.focus,"strokeAlpha",o)||a,r=this._getProp(this.node.focus,"lineWidth",o),o=this._getProp(this.node.focus,"lineType",o),t.context.fillStyle=e,t.context.fillAlpha=n,t.context.strokeStyle=i,t.context.strokeAlpha=a,t.context.lineWidth=r,t.context.lineType=o)}},{key:"unfocusAt",value:function(t){var e,n,i,a,r,o,t=this._nodesp.getChildById("funel_item_"+t);t&&(e=(o=t._default).fillStyle,n=o.fillAlpha,i=o.strokeStyle,a=o.strokeAlpha,r=o.lineType,o=o.lineWidth,t.context.fillStyle=e,t.context.fillAlpha=n,t.context.strokeStyle=i,t.context.strokeAlpha=a,t.context.lineWidth=o,t.context.lineType=r)}},{key:"_getProp",value:function(t,e,n){t=t[e],t=f.isFunction(t)?t.apply(this,[n,this.dataFrame]):t;return"fillStyle"==e&&(n=n.rowData)&&(void 0!==n[e]?t=n[e]:(e=n[this.field],isNaN(e)||""==e||(n=(e-this.minValue)/(this.maxValue-this.minValue)*(this.node.fillAlpha-this.node.minFillAlpha)+this.node.minFillAlpha,isNaN(n)&&(n=1),t=(0,color.colorRgba)(this.node.maxFillStyle,parseFloat(n.toFixed(2)))))),t}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},nameFiled:{detail:"field字段每行数据对应的name名称字段配置",default:null},sort:{detail:"排序规则",default:null},node:{detail:"单个元素图形配置",propertys:{margin:{detail:"node节点之间的间距",default:2},maxWidth:{detail:"最大的元素宽",default:null},minWidth:{detail:"最小的元素宽",default:null},spireWidth:{detail:"漏斗的塔尖的宽度，默认等于minWidth",documentation:"如果想要实现全三角的效果，可以设置为0",default:null},height:{detail:"高",default:0,documentation:"漏斗单元高，如果options没有设定， 就会被自动计算为 this.height/dataOrg.length"},drawEnd:{detail:"单个节点绘制完毕处理函数",default:function(){}},fillStyle:{detail:"单个区块背景色",default:null},fillAlpha:{detail:"单个区块透明度",default:1},maxFillStyle:{detail:"单个区块数值最大的颜色值",default:null},maxFillAlpha:{detail:"单个区块最大透明度",default:1},minFillAlpha:{detail:"单个区块最小透明度",default:.5},strokeStyle:{detail:"单个区块描边颜色",default:null},strokeAlpha:{detail:"单个区块描边透明度",default:1},lineWidth:{detail:"单个区块描边线宽",default:0},lineType:{detail:"区块描边样式",default:"solid"},focus:{detail:"单个区块hover态设置",propertys:{enabled:{detail:"是否开启",default:!0},fillStyle:{detail:"hover态单个区块背景色",default:null},fillAlpha:{detail:"hover态单个区块透明度",default:.95},strokeStyle:{detail:"hover态单个区块描边颜色",default:null},strokeAlpha:{detail:"hover态单个区块描边透明度",default:null},lineWidth:{detail:"hover态单个区块描边线宽",default:null},lineType:{detail:"hover态区块描边样式",default:null}}},select:{detail:"单个区块选中态设置",propertys:{enabled:{detail:"是否开启",default:!1},fillStyle:{detail:"选中态单个区块背景色",default:null},fillAlpha:{detail:"选中态单个区块透明度",default:1},strokeStyle:{detail:"选中态单个区块描边颜色",default:null},strokeAlpha:{detail:"选中态单个区块描边颜色",default:null},lineWidth:{detail:"选中态单个区块描边线宽",default:null},lineType:{detail:"选中态区块描边样式",default:null}}}}},label:{detail:"文本配置",propertys:{enabled:{detail:"是否开启文本",default:!0},textAlign:{detail:"文本布局位置(left,center,right)",default:"center"},textBaseline:{detail:"文本基线对齐方式",default:"middle"},format:{detail:"文本格式化处理函数",default:null},fontSize:{detail:"文本字体大小",default:13},fontColor:{detail:"文本颜色",default:"#ffffff",documentation:"align为center的时候的颜色，align为其他属性时候取node的颜色"},strokeStyle:{detail:"文本描边色",default:"#fff"},lineWidth:{detail:"文本描边宽",default:0}}}}}}]),i}(n.default);n.default.registerComponent(i,"graphs","funnel"),e.default=i})),fmin=(unwrapExports(funnel),createCommonjsModule(function(t,e){function n(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=0;return e}function g(t,e){for(var n=0,i=0;i<t.length;++i)n+=t[i]*e[i];return n}function p(t){return Math.sqrt(g(t,t))}function y(t,e,n){for(var i=0;i<e.length;++i)t[i]=e[i]*n}function P(t,e,n,i,a){for(var r=0;r<t.length;++r)t[r]=e*n[r]+i*a[r]}function _(a,r,o,l,s,u,d){var h=o.fx,c=g(o.fxprime,r),f=h,t=h,p=c,e=0;function n(t,e,n){for(var i=0;i<16;++i)if(s=(t+e)/2,P(l.x,1,o.x,s,r),f=l.fx=a(l.x,l.fxprime),p=g(l.fxprime,r),h+u*s*c<f||n<=f)e=s;else{if(Math.abs(p)<=-d*c)return s;0<=p*(e-t)&&(e=t),t=s,n=f}return 0}s=s||1,u=u||1e-6,d=d||.1;for(var i=0;i<10;++i){if(P(l.x,1,o.x,s,r),f=l.fx=a(l.x,l.fxprime),p=g(l.fxprime,r),h+u*s*c<f||i&&t<=f)return n(e,s,t);if(Math.abs(p)<=-d*c)return s;if(0<=p)return n(s,e,f);t=f,e=s,s*=2}return s}(e=e).bisect=function(t,e,n,i){var a=(i=i||{}).maxIterations||100,r=i.tolerance||1e-10,o=t(e),i=t(n),l=n-e;if(0<o*i)throw"Initial bisect points must have opposite signs";if(0===o)return e;if(0===i)return n;for(var s=0;s<a;++s){var u=e+(l/=2),d=t(u);if(0<=d*o&&(e=u),Math.abs(l)<r||0===d)return u}return e+l},e.nelderMead=function(t,e,n){var i,a=(n=n||{}).maxIterations||200*e.length,r=n.nonZeroDelta||1.05,o=n.zeroDelta||.001,l=n.minErrorDelta||1e-6,s=n.minErrorDelta||1e-5,u=void 0!==n.rho?n.rho:1,d=void 0!==n.chi?n.chi:2,h=void 0!==n.psi?n.psi:-.5,c=void 0!==n.sigma?n.sigma:.5,f=e.length,p=new Array(f+1);p[0]=e,p[0].fx=t(e);for(var g=p[0].id=0;g<f;++g){var y=e.slice();y[g]=y[g]?y[g]*r:o,p[g+1]=y,p[g+1].fx=t(y),p[g+1].id=g+1}function _(t){for(var e=0;e<t.length;e++)p[f][e]=t[e];p[f].fx=t.fx}for(var v=function(t,e){return t.fx-e.fx},x=e.slice(),m=e.slice(),b=e.slice(),w=e.slice(),k=0;k<a;++k){for(p.sort(v),n.history&&((S=p.map(function(t){var e=t.slice();return e.fx=t.fx,e.id=t.id,e})).sort(function(t,e){return t.id-e.id}),n.history.push({x:p[0].slice(),fx:p[0].fx,simplex:S})),g=i=0;g<f;++g)i=Math.max(i,Math.abs(p[0][g]-p[1][g]));if(Math.abs(p[0].fx-p[f].fx)<l&&i<s)break;for(g=0;g<f;++g){for(var C=x[g]=0;C<f;++C)x[g]+=p[C][g];x[g]/=f}var S=p[f];if(P(m,1+u,x,-u,S),m.fx=t(m),m.fx<p[0].fx)P(w,1+d,x,-d,S),w.fx=t(w),w.fx<m.fx?_(w):_(m);else if(m.fx>=p[f-1].fx){var A=!1;if(m.fx>S.fx?(P(b,1+h,x,-h,S),b.fx=t(b),b.fx<S.fx?_(b):A=!0):(P(b,1-h*u,x,h*u,S),b.fx=t(b),b.fx<m.fx?_(b):A=!0),A){if(1<=c)break;for(g=1;g<p.length;++g)P(p[g],1-c,p[0],c,p[g]),p[g].fx=t(p[g])}}else _(m)}return p.sort(v),{fx:p[0].fx,x:p[0]}},e.conjugateGradient=function(t,e,n){var i,a,r={x:e.slice(),fx:0,fxprime:e.slice()},o={x:e.slice(),fx:0,fxprime:e.slice()},l=e.slice(),s=1;a=(n=n||{}).maxIterations||20*e.length,r.fx=t(r.x,r.fxprime),y(i=r.fxprime.slice(),r.fxprime,-1);for(var u=0;u<a;++u){var d;if(s=_(t,i,r,o,s),n.history&&n.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:s}),s?(P(l,1,o.fxprime,-1,r.fxprime),d=g(r.fxprime,r.fxprime),d=Math.max(0,g(l,o.fxprime)/d),P(i,d,i,-1,o.fxprime),d=r,r=o,o=d):y(i,r.fxprime,-1),p(r.fxprime)<=1e-5)break}n.history&&n.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),alpha:s});return r},e.gradientDescent=function(t,e,n){for(var i=(n=n||{}).maxIterations||100*e.length,a=n.learnRate||.001,r={x:e.slice(),fx:0,fxprime:e.slice()},o=0;o<i&&(r.fx=t(r.x,r.fxprime),n.history&&n.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice()}),P(r.x,1,r.x,-a,r.fxprime),!(p(r.fxprime)<=1e-5));++o);return r},e.gradientDescentLineSearch=function(t,e,n){n=n||{};var i,a={x:e.slice(),fx:0,fxprime:e.slice()},r={x:e.slice(),fx:0,fxprime:e.slice()},o=n.maxIterations||100*e.length,l=n.learnRate||1,s=e.slice(),u=n.c1||.001,d=n.c2||.1,h=[];{var c;n.history&&(c=t,t=function(t,e){return h.push(t.slice()),c(t,e)})}a.fx=t(a.x,a.fxprime);for(var f=0;f<o&&(y(s,a.fxprime,-1),l=_(t,s,a,r,l,u,d),n.history&&(n.history.push({x:a.x.slice(),fx:a.fx,fxprime:a.fxprime.slice(),functionCalls:h,learnRate:l,alpha:l}),h=[]),i=a,a=r,r=i,!(0===l||p(a.fxprime)<1e-5));++f);return a},e.zeros=n,e.zerosM=function(t,e){return n(t).map(function(){return n(e)})},e.norm2=p,e.weightedSum=P,e.scale=y})),circleintersection=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.circleArea=w,e.circleCircleIntersection=C,e.circleOverlap=function(t,e,n){if(t+e<=n)return 0;if(n<=Math.abs(t-e))return Math.PI*Math.min(t,e)*Math.min(t,e);var i=e-(n*n-t*t+e*e)/(2*n);return w(t,t-(n*n-e*e+t*t)/(2*n))+w(e,i)},e.containedInCircles=b,e.distance=k,e.getCenter=S,e.intersectionArea=function(e,t){var n,i=function(t){for(var e=[],n=0;n<t.length;++n)for(var i=n+1;i<t.length;++i)for(var a=C(t[n],t[i]),r=0;r<a.length;++r){var o=a[r];o.parentIndex=[n,i],e.push(o)}return e}(e),a=i.filter(function(t){return b(t,e)}),r=0,o=0,l=[];if(1<a.length){var s=S(a);for(n=0;n<a.length;++n){var u=a[n];u.angle=Math.atan2(u.x-s.x,u.y-s.y)}a.sort(function(t,e){return e.angle-t.angle});var d=a[a.length-1];for(n=0;n<a.length;++n){for(var h,c,f,p=a[n],g=(o+=(d.x+p.x)*(p.y-d.y),{x:(p.x+d.x)/2,y:(p.y+d.y)/2}),y=null,_=0;_<p.parentIndex.length;++_)-1<d.parentIndex.indexOf(p.parentIndex[_])&&(h=e[p.parentIndex[_]],f=Math.atan2(p.x-h.x,p.y-h.y),c=Math.atan2(d.x-h.x,d.y-h.y),(f=c-f)<0&&(f+=2*Math.PI),c=c-f/2,(f=k(g,{x:h.x+h.radius*Math.sin(c),y:h.y+h.radius*Math.cos(c)}))>2*h.radius&&(f=2*h.radius),(null===y||y.width>f)&&(y={circle:h,width:f,p1:p,p2:d}));null!==y&&(l.push(y),r+=w(y.circle.radius,y.width),d=p)}}else{var v=e[0];for(n=1;n<e.length;++n)e[n].radius<v.radius&&(v=e[n]);var x=!1;for(n=0;n<e.length;++n)if(k(e[n],v)>Math.abs(v.radius-e[n].radius)){x=!0;break}x?r=o=0:(r=v.radius*v.radius*Math.PI,l.push({circle:v,p1:{x:v.x,y:v.y+v.radius},p2:{x:v.x-m,y:v.y+v.radius},width:2*v.radius}))}o/=2,t&&(t.area=r+o,t.arcArea=r,t.polygonArea=o,t.arcs=l,t.innerPoints=a,t.intersectionPoints=i);return r+o};var m=1e-10;function b(t,e){for(var n=0;n<e.length;++n)if(k(t,e[n])>e[n].radius+m)return!1;return!0}function w(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function k(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function C(t,e){var n=k(t,e),i=t.radius,a=e.radius;if(i+a<=n||n<=Math.abs(i-a))return[];var a=(i*i-a*a+n*n)/(2*n),i=Math.sqrt(i*i-a*a),r=t.x+a*(e.x-t.x)/n,a=t.y+a*(e.y-t.y)/n,o=-(e.y-t.y)*(i/n),e=-(e.x-t.x)*(i/n);return[{x:r+o,y:a-e},{x:r-o,y:a+e}]}function S(t){for(var e={x:0,y:0},n=0;n<t.length;++n)e.x+=t[n].x,e.y+=t[n].y;return e.x/=t.length,e.y/=t.length,e}}),circleintersection_1=(unwrapExports(circleintersection),circleintersection.circleArea),circleintersection_2=circleintersection.circleCircleIntersection,circleintersection_3=circleintersection.circleOverlap,circleintersection_4=circleintersection.containedInCircles,circleintersection_5=circleintersection.distance,circleintersection_6=circleintersection.getCenter,circleintersection_7=circleintersection.intersectionArea,layout=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.bestInitialLayout=d,e.constrainedMDSLayout=a,e.disjointCluster=p,e.distanceFromIntersectArea=$,e.getDistanceMatrices=g,e.greedyLayout=r,e.lossFunction=M,e.normalizeSolution=function(t,e,n){null===e&&(e=Math.PI/2);var i,a,s=[];for(a in t){var r;t.hasOwnProperty(a)&&(r=t[a],s.push({x:r.x,y:r.y,radius:r.radius,setid:a}))}var o=p(s);for(i=0;i<o.length;++i){!function(t,e,n){null===n?t.sort(function(t,e){return e.radius-t.radius}):t.sort(n);var i;if(0<t.length){var a=t[0].x,r=t[0].y;for(i=0;i<t.length;++i)t[i].x-=a,t[i].y-=r}2==t.length&&(0,circleintersection.distance)(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y);if(1<t.length){var o,l,n=Math.atan2(t[1].x,t[1].y)-e,s=Math.cos(n),u=Math.sin(n);for(i=0;i<t.length;++i)o=t[i].x,l=t[i].y,t[i].x=s*o-u*l,t[i].y=u*o+s*l}if(2<t.length){for(var d=Math.atan2(t[2].x,t[2].y)-e;d<0;)d+=2*Math.PI;for(;d>2*Math.PI;)d-=2*Math.PI;if(d>Math.PI){var h=t[1].y/(1e-10+t[1].x);for(i=0;i<t.length;++i){var c=(t[i].x+h*t[i].y)/(1+h*h);t[i].x=2*c-t[i].x,t[i].y=2*c*h-t[i].y}}}}(o[i],e,n);var l=_(o[i]);o[i].size=(l.xRange.max-l.xRange.min)*(l.yRange.max-l.yRange.min),o[i].bounds=l}o.sort(function(t,e){return e.size-t.size});var u=(s=o[0]).bounds,d=(u.xRange.max-u.xRange.min)/50;function h(t,e,n){if(t){var i,a,r,o=t.bounds;e?i=u.xRange.max-o.xRange.min+d:(i=u.xRange.max-o.xRange.max,(r=(o.xRange.max-o.xRange.min)/2-(u.xRange.max-u.xRange.min)/2)<0&&(i+=r)),n?a=u.yRange.max-o.yRange.min+d:(a=u.yRange.max-o.yRange.max,(r=(o.yRange.max-o.yRange.min)/2-(u.yRange.max-u.yRange.min)/2)<0&&(a+=r));for(var l=0;l<t.length;++l)t[l].x+=i,t[l].y+=a,s.push(t[l])}}var c=1;for(;c<o.length;)h(o[c],!0,!1),h(o[c+1],!1,!0),h(o[c+2],!0,!0),c+=3,u=_(s);var f={};for(i=0;i<s.length;++i)f[s[i].setid]=s[i];return f},e.scaleSolution=function(t,e,n,i){var a,r=[],o=[];for(a in t)t.hasOwnProperty(a)&&(o.push(a),r.push(t[a]));e-=2*i,n-=2*i;var l=_(r),s=l.xRange,u=l.yRange;if(s.max==s.min||u.max==u.min)return t;for(var l=e/(s.max-s.min),d=n/(u.max-u.min),h=Math.min(d,l),c=(e-(s.max-s.min)*h)/2,f=(n-(u.max-u.min)*h)/2,p={},g=0;g<r.length;++g){var y=r[g];p[o[g]]={radius:h*y.radius,x:i+c+(y.x-s.min)*h,y:i+f+(y.y-u.min)*h}}return p},e.venn=function(a,t){(t=t||{}).maxIterations=t.maxIterations||500;var e,n=t.initialLayout||d,r=t.lossFunction||M,o=(a=function(t){t=t.slice();var e,n,i,a,r=[],o={};for(e=0;e<t.length;++e){var l=t[e];1==l.sets.length?r.push(l.sets[0]):2==l.sets.length&&(i=l.sets[0],a=l.sets[1],o[[i,a]]=!0,o[[a,i]]=!0)}for(r.sort(function(t,e){return e<t}),e=0;e<r.length;++e)for(i=r[e],n=e+1;n<r.length;++n)a=r[n],[i,a]in o||t.push({sets:[i,a],size:0});return t}(a),n(a,t)),i=[],l=[];for(e in o)o.hasOwnProperty(e)&&(i.push(o[e].x),i.push(o[e].y),l.push(e));for(var s=(0,fmin.nelderMead)(function(t){for(var e={},n=0;n<l.length;++n){var i=l[n];e[i]={x:t[2*n],y:t[2*n+1],radius:o[i].radius}}return r(e,a)},i,t).x,u=0;u<l.length;++u)e=l[u],o[e].x=s[2*u],o[e].y=s[2*u+1];return o};var E=1e-10;function $(e,n,i){return Math.min(e,n)*Math.min(e,n)*Math.PI<=i+E?Math.abs(e-n):(0,fmin.bisect)(function(t){return(0,circleintersection.circleOverlap)(e,n,t)-i},0,e+n)}function g(t,a,r){var o=(0,fmin.zerosM)(a.length,a.length),l=(0,fmin.zerosM)(a.length,a.length);return t.filter(function(t){return 2==t.sets.length}).map(function(t){var e=r[t.sets[0]],n=r[t.sets[1]],i=$(Math.sqrt(a[e].size/Math.PI),Math.sqrt(a[n].size/Math.PI),t.size),i=(o[e][n]=o[n][e]=i,0);t.size+1e-10>=Math.min(a[e].size,a[n].size)?i=1:t.size<=1e-10&&(i=-1),l[e][n]=l[n][e]=i}),{distances:o,constraints:l}}function d(t,e){var n=r(t,e),i=e.lossFunction||M;return 8<=t.length&&(i(e=a(t,e),t)+1e-8<i(n,t)&&(n=e)),n}function a(t,e){for(var n=(e=e||{}).restarts||10,i=[],a={},r=0;r<t.length;++r){var o=t[r];1==o.sets.length&&(a[o.sets[0]]=i.length,i.push(o))}function l(t,e){for(var n=t,i=e,a=_,r=v,o=0,l=0;l<i.length;++l)i[l]=0;for(l=0;l<a.length;++l)for(var s=n[2*l],u=n[2*l+1],d=l+1;d<a.length;++d){var h=n[2*d],c=n[2*d+1],f=a[l][d],p=r[l][d],g=(h-s)*(h-s)+(c-u)*(c-u),y=Math.sqrt(g),g=g-f*f;0<p&&y<=f||p<0&&f<=y||(o+=2*g*g,i[2*l]+=4*g*(s-h),i[2*l+1]+=4*g*(u-c),i[2*d]+=4*g*(h-s),i[2*d+1]+=4*g*(c-u))}return o}var s,u=g(t,i,a),_=u.distances,v=u.constraints,d=(0,fmin.norm2)(_.map(fmin.norm2))/_.length,_=_.map(function(t){return t.map(function(t){return t/d})});for(r=0;r<n;++r){var h=(0,fmin.zeros)(2*_.length).map(Math.random),h=(0,fmin.conjugateGradient)(l,h,e);(!s||h.fx<s.fx)&&(s=h)}var c=s.x,f={};for(r=0;r<i.length;++r){var p=i[r];f[p.sets[0]]={x:c[2*r]*d,y:c[2*r+1]*d,radius:Math.sqrt(p.size/Math.PI)}}if(e.history)for(r=0;r<e.history.length;++r)(0,fmin.scale)(e.history[r].x,d);return f}function r(t,e){for(var n=e&&e.lossFunction?e.lossFunction:M,i={},a={},r=0;r<t.length;++r){var o=t[r];1==o.sets.length&&(x=o.sets[0],i[x]={x:1e10,y:1e10,rowid:i.length,size:o.size,radius:Math.sqrt(o.size/Math.PI)},a[x]=[])}for(t=t.filter(function(t){return 2==t.sets.length}),r=0;r<t.length;++r){var l=t[r],s=l.hasOwnProperty("weight")?l.weight:1,u=l.sets[0],d=l.sets[1];l.size+E>=Math.min(i[u].size,i[d].size)&&(s=0),a[u].push({set:d,size:l.size,weight:s}),a[d].push({set:u,size:l.size,weight:s})}var h=[];for(x in a)if(a.hasOwnProperty(x)){for(var c=0,r=0;r<a[x].length;++r)c+=a[x][r].size*a[x][r].weight;h.push({set:x,size:c})}function f(t,e){return e.size-t.size}h.sort(f);var p={};function g(t){return t.set in p}function y(t,e){i[e].x=t.x,i[e].y=t.y,p[e]=!0}for(y({x:0,y:0},h[0].set),r=1;r<h.length;++r){var _=h[r].set,v=a[_].filter(g),x=i[_];if(v.sort(f),0===v.length)throw"ERROR: missing pairwise overlap information";for(var m=[],b=0;b<v.length;++b){var w=i[v[b].set],k=$(x.radius,w.radius,v[b].size);m.push({x:w.x+k,y:w.y}),m.push({x:w.x-k,y:w.y}),m.push({y:w.y+k,x:w.x}),m.push({y:w.y-k,x:w.x});for(var C=b+1;C<v.length;++C)for(var S=i[v[C].set],A=$(x.radius,S.radius,v[C].size),P=(0,circleintersection.circleCircleIntersection)({x:w.x,y:w.y,radius:k},{x:S.x,y:S.y,radius:A}),R=0;R<P.length;++R)m.push(P[R])}for(var D=1e50,T=m[0],b=0;b<m.length;++b){i[_].x=m[b].x,i[_].y=m[b].y;var O=n(i,t);O<D&&(D=O,T=m[b])}y(T,_)}return i}function M(e,t){var n=0;for(var i=0;i<t.length;++i){var a,r,o=t[i];1!=o.sets.length&&(r=2==o.sets.length?(r=e[o.sets[0]],a=e[o.sets[1]],(0,circleintersection.circleOverlap)(r.radius,a.radius,(0,circleintersection.distance)(r,a))):(0,circleintersection.intersectionArea)(o.sets.map(function(t){return e[t]})),n+=(o.hasOwnProperty("weight")?o.weight:1)*(r-o.size)*(r-o.size))}return n}function p(t){function e(t){return t.parent!==t&&(t.parent=e(t.parent)),t.parent}t.map(function(t){t.parent=t});for(var n,i=0;i<t.length;++i)for(var a=i+1;a<t.length;++a){var r=t[i].radius+t[a].radius;(0,circleintersection.distance)(t[i],t[a])+1e-10<r&&(r=t[a],n=t[i],r=e(r),n=e(n),r.parent=n)}for(var o,l={},i=0;i<t.length;++i)(o=e(t[i]).parent.setid)in l||(l[o]=[]),l[o].push(t[i]);t.map(function(t){delete t.parent});var s=[];for(o in l)l.hasOwnProperty(o)&&s.push(l[o]);return s}function _(t){function e(e){return{max:Math.max.apply(null,t.map(function(t){return t[e]+t.radius})),min:Math.min.apply(null,t.map(function(t){return t[e]-t.radius}))}}return{xRange:e("x"),yRange:e("y")}}}),layout_1=(unwrapExports(layout),layout.bestInitialLayout),layout_2=layout.constrainedMDSLayout,layout_3=layout.disjointCluster,layout_4=layout.distanceFromIntersectArea,layout_5=layout.getDistanceMatrices,layout_6=layout.greedyLayout,layout_7=layout.lossFunction,layout_8=layout.normalizeSolution,layout_9=layout.scaleSolution,layout_10=layout.venn,venn=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),d=interopRequireDefault(Canvax),n=interopRequireDefault(graphs);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=d.default._,f=d.default.event,p=d.default.Display.Text,g=d.default.Shapes.Path,y=d.default.Shapes.Circle,i=function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="venn",e.vennData=null,c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e._dataCircleLen=0,e._dataLabelLen=0,e._dataPathLen=0,e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){this.venn_circles=new d.default.Display.Sprite({id:"venn_circles"}),this.sprite.addChild(this.venn_circles),this.venn_paths=new d.default.Display.Sprite({id:"venn_paths"}),this.sprite.addChild(this.venn_paths),this.venn_labels=new d.default.Display.Sprite({id:"venn_labels"}),this.sprite.addChild(this.venn_labels)}},{key:"draw",value:function(t){c.extend(!0,this,t=t||{}),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.app.padding.left,this.sprite.context.y=this.app.padding.top,this.fire("complete")}},{key:"resetData",value:function(t){this.dataFrame=t,this.data=this._trimGraphs(),this._widget()}},{key:"_trimGraphs",value:function(){var n=this,t=n._vennData(),e=layout.venn,i=layout.lossFunction,a=Math.PI/2,r={},o={},l=(this._dataCircleLen=0,this._dataLabelLen=0,(this._dataPathLen=0)<t.length&&(e=e(t,{lossFunction:i}),e=(0,layout.normalizeSolution)(e,a,null),o=function(t,e){for(var n={},i=function(t){var e,n={},i=[];for(e in t)i.push(e),n[e]=[];for(var a=0;a<i.length;a++)for(var r=t[i[a]],o=a+1;o<i.length;++o){var l=t[i[o]],s=(0,circleintersection.distance)(r,l);s+l.radius<=r.radius+1e-10?n[i[o]].push(i[a]):s+r.radius<=l.radius+1e-10&&n[i[a]].push(i[o])}return n}(t),a=0;a<e.length;++a){for(var r=e[a].sets,o={},l={},s=0;s<r.length;++s){o[r[s]]=!0;for(var u=i[r[s]],d=0;d<u.length;++d)l[u[d]]=!0}var h,c=[],f=[];for(h in t)h in o?c.push(t[h]):h in l||f.push(t[h]);var p=function t(e,n){var i,a=[];for(i=0;i<e.length;++i){var r=e[i];a.push({x:r.x,y:r.y}),a.push({x:r.x+r.radius/2,y:r.y}),a.push({x:r.x-r.radius/2,y:r.y}),a.push({x:r.x,y:r.y+r.radius/2}),a.push({x:r.x,y:r.y-r.radius/2})}var o=a[0],l=_(a[0],e,n);for(i=1;i<a.length;++i){var s=_(a[i],e,n);l<=s&&(o=a[i],l=s)}var u=(0,fmin.nelderMead)(function(t){return-1*_({x:t[0],y:t[1]},e,n)},[o.x,o.y],{maxIterations:500,minErrorDelta:1e-10}).x;var d={x:u[0],y:u[1]};var h=!0;for(i=0;i<e.length;++i)if((0,circleintersection.distance)(d,e[i])>e[i].radius){h=!1;break}for(i=0;i<n.length;++i)if((0,circleintersection.distance)(d,n[i])<n[i].radius){h=!1;break}h||(d=1==e.length?{x:e[0].x,y:e[0].y}:(u={},(0,circleintersection.intersectionArea)(e,u),0===u.arcs.length?{x:0,y:-1e3,disjoint:!0}:1==u.arcs.length?{x:u.arcs[0].circle.x,y:u.arcs[0].circle.y}:n.length?t(e,[]):(0,circleintersection.getCenter)(u.arcs.map(function(t){return t.p1}))));return d}(c,f);(n[r]=p).disjoint&&e[a].size}return n}(r=(0,layout.scaleSolution)(e,this.width,this.height,0),t)),0),s=0;return c.each(t,function(t){var e;!t.label||1<t.sets.length&&!n.label.showInter||(t.labelPosition=o[t.nodeId],n._dataLabelLen++),1<t.sets.length?(e=function(t){var e={},n=((0,circleintersection.intersectionArea)(t,e),e.arcs);{if(0===n.length)return"M 0 0";if(1==n.length)return function(t,e,n){var i=[];return i.push("\nM",t,e),i.push("\nm",-n,0),i.push("\na",n,n,0,1,0,2*n,0),i.push("\na",n,n,0,1,0,2*-n,0),i.join(" ")}((t=n[0].circle).x,t.y,t.radius);for(var i=["\nM",n[0].p2.x,n[0].p2.y],a=0;a<n.length;++a){var r=n[a],o=r.circle.radius,l=r.width>o;i.push("\nA",o,o,0,l?1:0,1,r.p1.x,r.p1.y)}return i.join(" ")+" z"}}(t.sets.map(function(t){return r[t]})),t.shape={type:"path",path:e,pathInd:s++},n._dataPathLen++):1==t.sets.length&&(t.shape=c.extend({type:"circle",circleInd:l++},r[t.nodeId]),n._dataCircleLen++)}),t}},{key:"_vennData",value:function(){for(var t=[],e=0,n=this.dataFrame.length;e<n;e++){var i,a=this.dataFrame.getRowDataAt(e),r={type:"venn",field:this.field,iNode:e,nodeId:null,rowData:a,sets:null,size:null,value:null,fillStyle:null,strokeStyle:null,label:null,labelPosition:null};for(i in a){var o=a[i];i==this.keyField&&(c.isString(o)&&(o=o.split(/[,|]/)),r.sets=o,r.nodeId=o.join(),this.label.field||(r.label=o.join())),i==this.field&&(r.size=o,r.value=o),i==this.label.field&&(r.label=o)}t.push(r)}return t}},{key:"_getStyle",value:function(t,e,n,i){var a;return c.isString(t)&&(a=t),a=(a=(a=c.isFunction(t)?t(n):a)||null==e?a:this.app.getTheme(e))||null==i?a:i}},{key:"_widget",value:function(){var r=this;if(r.venn_circles.children.length>r._dataCircleLen)for(var t=r._dataCircleLen;t<r.venn_circles.children.length;t++)r.venn_circles.getChildAt(t--).destroy();if(r.venn_paths.children.length>r._dataPathLen)for(var e=r._dataPathLen;e<r.venn_paths.children.length;e++)r.venn_paths.getChildAt(e--).destroy();if(r.venn_labels.children.length>r._dataLabelLen)for(var n=r._dataLabelLen;n<r.venn_labels.children.length;n++)r.venn_labels.getChildAt(n--).destroy();var o=0,l=0,s=0;c.each(this.data,function(t){var e,n,i=t.shape,a=!0;i&&("circle"==i.type&&(e=r._getStyle(r.node.fillStyle,i.circleInd,t),n=r._getStyle(r.node.strokeStyle,i.circleInd,t),t.fillStyle=e,t.strokeStyle=n,e={x:i.x,y:i.y,r:i.radius,fillStyle:e,fillAlpha:r.node.fillAlpha,lineWidth:r.node.lineWidth,strokeStyle:n,strokeAlpha:r.node.strokeAlpha},(n=r.venn_circles.getChildAt(o++))?(a=!1,n.animate(e)):(n=new y({pointChkPriority:!1,hoverClone:!1,context:e}),r.venn_circles.addChild(n))),"path"==t.shape.type&&(e={path:i.path,fillStyle:"#ffffff",fillAlpha:0,lineWidth:r.node.lineWidth,strokeStyle:"#ffffff",strokeAlpha:0},(n=r.venn_paths.getChildAt(l++))?(a=!1,n.context.path=i.path):(n=new g({pointChkPriority:!1,context:e}),r.venn_paths.addChild(n))),(n.nodeData=t)._node=n,r.node.focus.enabled&&n.hover(function(){r.focusAt(this.nodeData.iNode)},function(){this.nodeData.selected||r.unfocusAt(this.nodeData.iNode)}),a&&n.on(f.types.get(),function(t){t.eventInfo={trigger:"this.node",title:null,nodes:[this.nodeData]},r.app.fire(t.type,t)})),t.label&&r.label.enabled&&(e=r._getStyle(r.label.fontColor,i.circleInd,t,"#999"),a=r.label.fontSize,1<t.sets.length&&(r.label.showInter?a-=2:a=0),a&&(n={x:t.labelPosition.x,y:t.labelPosition.y,fontSize:a,textBaseline:"middle",textAlign:"center",fontWeight:r.label.fontWeight,fillStyle:e},(i=r.venn_labels.getChildAt(s++))?(i.resetText(t.label),i.animate(n)):(i=new p(t.label,{context:n}),r.venn_labels.addChild(i))))})}},{key:"focusAt",value:function(t){var e,t=this.data[t];this.node.focus.enabled&&!t.focused&&(e=t._node.context,1<t.sets.length?e.strokeAlpha=1:e.strokeAlpha=this.node.focus.strokeAlpha,t.focused=!0)}},{key:"unfocusAt",value:function(t){t=this.data[t];this.node.focus.enabled&&t.focused&&(t._node.context.strokeAlpha=this.node.strokeAlpha,t.focused=!1)}},{key:"selectAt",value:function(t){var e,t=this.data[t];this.node.select.enabled&&!t.selected&&((e=t._node.context).lineWidth=this.node.select.lineWidth,e.strokeAlpha=this.node.select.strokeAlpha,e.strokeStyle=this.node.select.strokeStyle,t.selected=!0)}},{key:"unselectAt",value:function(t){t=this.data[t];this.node.select.enabled&&t.selected&&(t._node.context.strokeStyle=this.node.strokeStyle,t.selected=!1)}}],[{key:"defaultProps",value:function(){return{field:{detail:"value字段",default:"value"},keyField:{detail:"key字段",default:"name"},node:{detail:"单个节点配置",propertys:{strokeStyle:{detail:"边框颜色",default:null},lineWidth:{detail:"边框大小",default:2},strokeAlpha:{detail:"边框透明度",default:0},fillStyle:{detail:"背景色",default:null},fillAlpha:{detail:"背景透明度",default:.25},focus:{detail:"hover设置",propertys:{enabled:{detail:"是否开启",default:!0},strokeAlpha:{detail:"边框透明度",default:.3}}},select:{detail:"选中设置",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"描边宽度",default:2},strokeStyle:{detail:"描边颜色",default:"#666666"}}}}},label:{detail:"文本设置",propertys:{field:{detail:"获取文本的字段",default:null},fontSize:{detail:"字体大小",default:14},fontColor:{detail:"文本颜色",default:null},fontWeight:{detail:"fontWeight",default:"normal"},showInter:{detail:"是否显示相交部分的文本",default:!0}}}}}},{key:"polyfill",value:function(t){return t.valueField&&(t.field=t.valueField,delete t.valueField),t}}]),i}(n.default);function _(t,e,n){for(var i,a=e[0].radius-(0,circleintersection.distance)(e[0],t),r=1;r<e.length;++r)(i=e[r].radius-(0,circleintersection.distance)(e[r],t))<=a&&(a=i);for(r=0;r<n.length;++r)(i=(0,circleintersection.distance)(n[r],t)-n[r].radius)<=a&&(a=i);return a}n.default.registerComponent(i,"graphs","venn"),e.default=i}),rebind=(unwrapExports(venn),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n,i=1,a=arguments.length;for(;++i<a;)t[n=arguments[i]]=function(e,n,i){return function(){var t=i.apply(n,arguments);return t===n?e:t}}(t,e,e[n]);return t}})),arrays=(unwrapExports(rebind),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default={merge:function(t){for(var e,n,i,a=t.length,r=-1,o=0;++r<a;)o+=t[r].length;for(n=new Array(o);0<=--a;)for(e=(i=t[a]).length;0<=--e;)n[--o]=i[e];return n}}})),hierarchy=(unwrapExports(arrays),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function c(){var s=o,u=a,d=r;function h(t){var e,n,i,a,r,o=[t],l=[];for(t.depth=0;null!=(e=o.pop());)if(l.push(e),(i=u.call(h,e,e.depth))&&(n=i.length)){for(;0<=--n;)o.push(a=i[n]),a.parent=e,a.depth=e.depth+1;!d||(r=+d.call(h,e,e.depth))&&!isNaN(r)&&(e._value=r),d&&(e.value=0),e.children=i}else d&&(e.value=+d.call(h,e,e.depth)||0),delete e.children;return c.layout_hierarchyVisitAfter(t,function(t){var e;s&&(e=t.children)&&e.sort(s),d&&(e=t.parent)&&(e.value+=t.value),t._value&&t._value>t.value&&(t.value=t._value),delete t._value}),l}return h.sort=function(t){return arguments.length?(s=t,h):s},h.children=function(t){return arguments.length?(u=t,h):u},h.value=function(t){return arguments.length?(d=t,h):d},h.revalue=function(t){return d&&(c.layout_hierarchyVisitBefore(t,function(t){t.children&&(t.value=0)}),c.layout_hierarchyVisitAfter(t,function(t){var e;t.children||(t.value=+d.call(h,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value),t._value&&t._value>t.value&&(t.value=t._value),delete t._value})),t},h}var n=interopRequireDefault(rebind),i=interopRequireDefault(arrays);function a(t){return t.children}function r(t){return t.value}function o(t,e){return e.value-t.value}function l(t){return i.default.merge(t.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}c.layout_hierarchyRebind=function(t,e){return(0,n.default)(t,e,"sort","children","value"),(t.nodes=t).links=l,t},c.layout_hierarchyVisitBefore=function(t,e){for(var n,i,a=[t];null!=(t=a.pop());)if(e(t),(i=t.children)&&(n=i.length))for(;0<=--n;)a.push(i[n])},c.layout_hierarchyVisitAfter=function(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(r=t.children)&&(a=r.length))for(var a,r,o=-1;++o<a;)n.push(r[o]);for(;null!=(t=i.pop());)e(t)},e.default=c})),partition=(unwrapExports(hierarchy),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var n=(0,a.default)(),i=[1,1];function e(t,e){t=n.call(this,t,e);return function t(e,n,i,a){var r=e.children;if(e.x=n,e.y=e.depth*a,e.dx=i,e.dy=a,r&&(o=r.length)){var o,l,s=-1;for(i=e.value?i/e.value:0;++s<o;)t(l=r[s],n,l=l.value*i,a),n+=l}}(t[0],0,i[0],i[1]/function t(e){var n=e.children,i=0;if(n&&(a=n.length))for(var a,r=-1;++r<a;)i=Math.max(i,t(n[r]));return 1+i}(t[0])),t}return e.size=function(t){return arguments.length?(i=t,e):i},a.default.layout_hierarchyRebind(e,n)};var a=interopRequireDefault(hierarchy)})),sunburst=(unwrapExports(partition),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(Canvax),i=interopRequireDefault(graphs),d=interopRequireDefault(partition);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=n.default._,f=n.default.event,p=n.default.Shapes.Sector,n=function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="sunburst",c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.data=[],e.dataGroup=[],e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){}},{key:"draw",value:function(t){c.extend(!0,this,t=t||{}),this.data=this._trimGraphs(),this.dataGroup=this._getDataGroupOfDepth(),this._widget(),this.sprite.context.x=this.width/2+this.origin.x,this.sprite.context.y=this.height/2+this.origin.y,this.fire("complete")}},{key:"_trimGraphs",value:function(){var e=this,n=this,t=parseInt(Math.min(this.width,this.height)/2),t=(0,d.default)().sort(null).size([2*Math.PI,t*t]).value(function(t){return t[n.field]}),i=this._tansTreeData();return this.data=t(i,0),this.data.forEach(function(t){t.field=e.field}),this.data}},{key:"_getDataGroupOfDepth",value:function(){var t,e={},n=(c.each(this.data,function(t){e[t.depth]=[]}),c.each(this.data,function(t){e[t.depth].push(t)}),[]);for(t in e)n.push(e[t]);return n}},{key:"_tansTreeData",value:function(){var t=this.dataFrame,e={},l=t.getFieldData(this.keyField),s=t.getFieldData(this.field),u=t.getFieldData(this.parentKeyField);return function n(i,t,e){for(var a=t?t.name:void 0,r=e||0;r<u.length;r++){var o=u[r];if(a===(o=o||0===o?o:void 0)){i.name=l[r],i.iNode=r,!(o=s[r])&&0!==o||(i.value=o),c.each(u,function(t,e){t===i.name&&(i.children||(i.children=[]),n(t={},i,e),i.children.push(t))});break}}}(e),e}},{key:"_widget",value:function(){var l=this;c.each(this.dataGroup,function(r,o){c.each(r,function(e,t){var n,i,a;e.depth&&(n=Math.sqrt(e.y+e.dy),i={r0:Math.sqrt(e.y),r:Math.sqrt(e.y)+2,startAngle:180*e.x/Math.PI,endAngle:180*(e.x+e.dx)/Math.PI,fillStyle:e.color||l.app.getTheme(e.iNode),strokeStyle:l.node.strokeStyle,lineWidth:l.node.lineWidth,globalAlpha:0},((a=new p({id:"sector_"+o+"_"+t,context:i})).layoutData=e).sector=a,e.group=r,l.sprite.addChild(a),a.hover(function(){l._focus(e,r)},function(){l._unfocus(e,r)}),a.on(f.types.get(),function(t){t.eventInfo={trigger:"this.node",iNode:e.iNode},l.app.fire(t.type,t)}),o<=1?(a.context.r=n,a.context.globalAlpha=1):setTimeout(function(){a.context&&(a.context.globalAlpha=1,a.animate({r:n},{duration:350}))},350*(o-1)))})})}},{key:"getNodesAt",value:function(e){var t,n=[];return void 0!==e&&((t=c.find(this.data,function(t){return t.iNode==e})).type="sunburst",t&&n.push(t)),n}},{key:"_focus",value:function(e,t){var n=this;c.each(t,function(t){t!==e&&(t.sector.context.globalAlpha=n.node.blurAlpha,n._focusChildren(t,function(t){t.sector.context.globalAlpha=n.node.blurAlpha}))}),n._focusParent(e)}},{key:"_unfocus",value:function(){c.each(this.data,function(t){t.sector&&(t.sector.context.globalAlpha=1)})}},{key:"_focusChildren",value:function(t,e){var n=this;t.children&&t.children.length&&c.each(t.children,function(t){e(t),n._focusChildren(t,e)})}},{key:"_focusParent",value:function(e){var n=this;e.parent&&e.parent.sector&&e.parent.group&&c.each(e.parent.group,function(t){t===e.parent?(t.sector.context.globalAlpha=1,n._focusParent(e.parent)):t.sector.context.globalAlpha=n.node.blurAlpha})}}],[{key:"defaultProps",value:function(){return{keyField:{detail:"key字段",default:""},field:{detail:"value字段",default:""},parentKeyField:{detail:"parent字段",default:""},node:{detail:"单个节点图形设置",propertys:{strokeStyle:{detail:"描边色",default:"#ffffff"},lineWidth:{detail:"描边线宽",default:1},strokeAlpha:{detail:"描边边框透明度",default:1},fillStyle:{detail:"背景色",default:null},fillAlpha:{detail:"背景透明度",default:1},blurAlpha:{detail:"非激活状态透明度",documentation:"比如选中其中一项，其他不先关的要降低透明度",default:.4}}}}}},{key:"polyfill",value:function(t){return t}}]),i}(i.default);i.default.registerComponent(n,"graphs","sunburst"),e.default=n})),sankey=(unwrapExports(sunburst),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var o={},r=24,l=8,s=[1,1],u=[],d=function(t,e){return t.y-e.y},h=[];function c(t,e){var n,i=0,a=t.length,r=-1;if(1===arguments.length)for(;++r<a;)isNaN(n=+t[r])||(i+=n);else for(;++r<a;)isNaN(n=+e.call(t,t[r],r))||(i+=n);return i}function f(){for(var e,n,i,t=u,a=0;t.length;)e=[],t.forEach(function(t){t.x=a,t.dx=r,t.sourceLinks.forEach(function(t){e.indexOf(t.target)<0&&e.push(t.target)})}),t=e,++a;n=a,u.forEach(function(t){t.sourceLinks.length||(t.x=n-1)}),i=(s[0]-r)/(a-1),u.forEach(function(t){t.x*=i})}o.nodeWidth=function(t){return arguments.length?(r=+t,o):r},o.nodeSort=function(t){return arguments.length?(d=t,o):d},o.nodePadding=function(t){return arguments.length?(l=+t,o):l},o.nodes=function(t){return arguments.length?(u=t,o):u},o.links=function(t){return arguments.length?(h=t,o):h},o.size=function(t){return arguments.length?(s=t,o):s},o.layout=function(t){u.forEach(function(t){t.sourceLinks=[],t.targetLinks=[]}),h.forEach(function(t){var e=t.source,n=t.target;"number"==typeof e&&(e=t.source=u[t.source]),"number"==typeof n&&(n=t.target=u[t.target]),e.sourceLinks.push(t),n.targetLinks.push(t)}),u.forEach(function(t){t.value=Math.max(c(t.sourceLinks,m),c(t.targetLinks,m))}),f();var e=t,a=p().key(function(t){return t.x}).sortKeys(_).entries(u).map(function(t){return t.values}),n=function(t,e){var n,i,a=-1,r=t.length;if(1===arguments.length){for(;++a<r&&(null==(n=t[a])||n!=n);)n=void 0;for(;++a<r;)null!=(i=t[a])&&i<n&&(n=i)}else{for(;++a<r&&(null==(n=e.call(t,t[a],a))||n!=n);)n=void 0;for(;++a<r;)null!=(i=e.call(t,t[a],a))&&i<n&&(n=i)}return n}(a,function(t){return(s[1]-(t.length-1)*l)/c(t,m)});a.forEach(function(t){t.forEach(function(t,e){t.y=e,t.dy=t.value*n})}),h.forEach(function(t){t.dy=t.value*n}),r();for(var i=1;0<e;--e)!function(n){function i(t){return x(t.target)*t.value}a.slice().reverse().forEach(function(t){t.forEach(function(t){var e;t.sourceLinks.length&&(e=c(t.sourceLinks,i)/c(t.sourceLinks,m),t.y+=(e-x(t))*n)})})}(i*=.99),r(),function(n){function i(t){return x(t.source)*t.value}a.forEach(function(t,e){t.forEach(function(t){var e;t.targetLinks.length&&(e=c(t.targetLinks,i)/c(t.targetLinks,m),t.y+=(e-x(t))*n)})})}(i),r();function r(){a.forEach(function(t){var e,n,i,a=0,r=t.length;for(d&&t.sort(d),i=0;i<r;++i)0<(n=a-(e=t[i]).y)&&(e.y+=n),a=e.y+e.dy+l;if(0<(n=a-l-s[1]))for(a=e.y-=n,i=r-2;0<=i;--i)0<(n=(e=t[i]).y+e.dy+l-a)&&(e.y-=n),a=e.y})}return v(),o},o.relayout=function(){return v(),o},o.link=function(){var u=.5;function e(t){var e,n,i=t.source.x+t.source.dx,a=t.target.x,r=(e=+(e=i),n=+(n=a),function(t){return e*(1-t)+n*t}),o=r(u),r=r(1-u),l=t.source.y+t.sy,s=t.target.y+t.ty,t=t.dy,a="M"+i+","+l+"C"+o+","+l+" "+r+","+s+" "+a+","+s;return(a+="v"+(t=t<1?1:t))+("C"+r+","+(s+t)+" "+o+","+(l+t)+" "+i+","+(l+t))+("v"+-t+"z")}return e.curvature=function(t){return arguments.length?(u=+t,e):u},e};var p=function(){var h,c,f={},p=[],e=[];function g(n,t,i){if(i>=p.length)return c?c.call(f,t):h?t.sort(h):t;for(var e,a,r,o,l=-1,s=t.length,u=p[i++],d=new y;++l<s;)(o=d.get(e=u(a=t[l])))?o.push(a):d.set(e,[a]);return r=n?(a=n(),function(t,e){a.set(t,g(n,e,i))}):(a={},function(t,e){a[t]=g(n,e,i)}),d.forEach(r),a}return f.map=function(t,e){return g(e,t,0)},f.entries=function(t){return function n(t,i){if(i>=p.length)return t;var a=[],r=e[i++];return t.forEach(function(t,e){a.push({key:t,values:n(e,i)})}),r?a.sort(function(t,e){return r(t.key,e.key)}):a}(g(n,t,0),0)},f.key=function(t){return p.push(t),f},f.sortKeys=function(t){return e[p.length-1]=t,f},f.sortValues=function(t){return h=t,f},f.rollup=function(t){return c=t,f},f},n=function(t,e){var n=new y;if(t instanceof y)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var i,a=-1,r=t.length;if(1===arguments.length)for(;++a<r;)n.set(a,t[a]);else for(;++a<r;)n.set(e.call(t,i=t[a],a),i)}else for(var o in t)n.set(o,t[o]);return n};function y(){this._=Object.create(null)}var e="__proto__",i="\0";function a(t){return(t+="")===e||t[0]===i?i+t:t}function g(t){return(t+="")[0]===i?t.slice(1):t}function _(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}function v(){function e(t,e){return t.source.y-e.source.y}function n(t,e){return t.target.y-e.target.y}u.forEach(function(t){t.sourceLinks.sort(n),t.targetLinks.sort(e)}),u.forEach(function(t){var e=0,n=0;t.sourceLinks.forEach(function(t){t.sy=e,e+=t.dy}),t.targetLinks.forEach(function(t){t.ty=n,n+=t.dy})})}function x(t){return t.y+t.dy/2}function m(t){return t.value}return function(t,e){if(Object.defineProperty)for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1});else Canvax._.extend(t.prototype,e)}(y,{has:function(t){return a(t)in this._},get:function(t){return this._[a(t)]},set:function(t,e){return this._[a(t)]=e},remove:function(t){return(t=a(t))in this._&&delete this._[t]},keys:function(){var t,e=[];for(t in this._)e.push(g(t));return e},values:function(){var t,e=[];for(t in this._)e.push(this._[t]);return e},entries:function(){var t,e=[];for(t in this._)e.push({key:g(t),value:this._[t]});return e},size:function(){var t,e=0;for(t in this._)++e;return e},empty:function(){for(var t in this._)return!1;return!0},forEach:function(t){for(var e in this._)t.call(this,g(e),this._[e])}}),o}})),sankey$1=(unwrapExports(sankey),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),d=interopRequireDefault(Canvax),n=interopRequireDefault(graphs),h=interopRequireDefault(sankey);function c(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var f=d.default._,p=d.default.event,g=d.default.Shapes.Path,y=d.default.Shapes.Rect,i=function(t){(0,l.default)(i,t);var n=c(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="sankey",f.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){this._links=new d.default.Display.Sprite,this._nodes=new d.default.Display.Sprite,this._labels=new d.default.Display.Sprite,this.sprite.addChild(this._links),this.sprite.addChild(this._nodes),this.sprite.addChild(this._labels)}},{key:"draw",value:function(t){f.extend(!0,this,t=t||{}),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.fire("complete")}},{key:"_trimGraphs",value:function(){var i=this,a=[],r=[],t=i.dataFrame.getFieldData(i.keyField),o=i.dataFrame.getFieldData(i.field),l=i.dataFrame.getFieldData(i.parentField),s={};return f.each(t,function(t,e){var n=[];i.parentField&&n.push(l[e]),n=n.concat(t.split(/[|]/)),f.each(n,function(t){void 0===s[t]&&(s[t]=a.length,a.push({name:t}))})}),f.each(t,function(t,e){var n=[];i.parentField&&n.push(l[e]),2==(n=n.concat(t.split(/[|]/))).length&&r.push({source:s[n[0]],target:s[n[1]],value:o[e]})}),(0,h.default)().nodeWidth(this.node.width).nodePadding(this.node.padding).nodeSort(this.node.sort).size([this.width,this.height]).nodes(a).links(r).layout(16)}},{key:"_widget",value:function(){this._drawNodes(),this._drawLinks(),this._drawLabels()}},{key:"_getColor",value:function(t,e,n){return f.isArray(t)&&(t=t[n]),t=(t=f.isFunction(t)?t(e):t)||this.app.getTheme(n)}},{key:"_drawNodes",value:function(){var t=this.data.nodes(),n=this;f.each(t,function(t,e){t.field=n.field;e=n._getColor(n.node.fillStyle,t,e),e=new y({xyToInt:!1,context:{x:t.x,y:t.y,width:n.data.nodeWidth(),height:Math.max(t.dy,1),fillStyle:e}});e.data=t,n._nodes.addChild(e)})}},{key:"_drawLinks",value:function(){var t=this.data.links(),i=this;f.each(t,function(n,t){var t=i._getColor(i.line.strokeStyle,n,t),e=i.data.link()(n),e=new g({xyToInt:!1,context:{path:e,fillStyle:t,globalAlpha:i.line.alpha,cursor:"pointer"}});e.__glpha=i.line.alpha,e.link=n,e.on(p.types.get(),function(t){i.line.focus.enabled&&("mouseover"==t.type&&(this.__glpha+=.1),"mouseout"==t.type&&(this.__glpha-=.1));var e=this.link;e.type="sankey",n.field=i.field,n.__no__name=!0,t.eventInfo={trigger:"this.node",title:e.source.name+" <span style='display:inline-block;margin-left:4px;position:relative;top:-0.5px;font-size:16px;left:-3px;'>></span> "+e.target.name,nodes:[e]},i.app.fire(t.type,t)}),i._links.addChild(e)})}},{key:"_drawLabels",value:function(){var t=this.data.nodes(),r=this;f.each(t,function(t){var e=r.label.textAlign,n=t.x+r.data.nodeWidth()+4,i=t.y+Math.max(t.dy/2,1),a=r.label.format?r.label.format(t.name,t):t.name,a=new d.default.Display.Text(a,{context:{x:n,y:i,fillStyle:r.label.fontColor,fontSize:r.label.fontSize,textAlign:e,textBaseline:r.label.verticalAlign}});r._labels.addChild(a),a.getTextWidth()+n>r.width&&(a.context.x=t.x-4,a.context.textAlign="right")})}}],[{key:"defaultProps",value:function(){return{keyField:{detail:"key字段",default:null},field:{detail:"value字段",default:"value"},parentField:{detail:"parent字段",default:null},node:{detail:"node",propertys:{width:{detail:"节点宽",default:18},padding:{detail:"节点间距",default:10},sort:{detail:"节点排序字段",default:function(t,e){return t.y-e.y}},fillStyle:{detail:"节点背景色",default:null}}},line:{detail:"线设置",propertys:{strokeStyle:{detail:"线颜色",default:"blue"},alpha:{detail:"线透明度",default:.3},focus:{detail:"图形的hover设置",propertys:{enabled:{detail:"是否开启",default:!0}}}}},label:{detail:"文本设置",propertys:{fontColor:{detail:"文本颜色",default:"#666666"},fontSize:{detail:"文本字体大小",default:12},textAlign:{detail:"水平对齐方式",default:"left"},verticalAlign:{detail:"垂直对齐方式",default:"middle"},format:{detail:"文本格式函数",default:null}}}}}},{key:"polyfill",value:function(t){return t.valueField&&(t.field=t.valueField,delete t.valueField),t}}]),i}(n.default);n.default.registerComponent(i,"graphs","sankey"),e.default=i})),progress=(unwrapExports(sankey$1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=interopRequireDefault(defineProperty$1),a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),d=interopRequireDefault(Canvax),n=interopRequireDefault(graphs);function h(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach(function(t){(0,i.default)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function f(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var p=d.default._,g=function(t){(0,l.default)(i,t);var n=f(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="progress",p.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.bgNodeData=null,e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){}},{key:"draw",value:function(t){var e=this;p.extend(!0,this,t=t||{}),e.grow(function(t){e.data=e._trimGraphs(t),e._widget()}),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.fire("complete")}},{key:"_trimGraphs",value:function(r){var o=this,t=(null==r&&(r=1),this.app.getComponent({name:"coord"})),l=(this.enabledField=t.filterEnabledFields(this.field),o.startAngle||t.startAngle),s=o.allAngle||t.allAngle,e=(this.bgNodeData=this._getNodeData(l,s),this.bgNodeData.fillStyle=this._getStyle(this.bgNodeData,this.bgColor),{});return p.each(this.enabledField,function(i){var t=o.dataFrame.getFieldData(i),a=[];p.each(t,function(t,e){t*=r;var n=a.slice(-1)[0],n=n?n.endAngle:l,n=o._getNodeData(n,s*(t/100),i,t,e);n.fillStyle=o._getStyle(n,o.node.fillStyle),a.push(n)}),e[i]=a}),e}},{key:"_getNodeData",value:function(t,e,n,i,a){var r=this.app.getComponent({name:"coord"}),o=t+Math.min(e,180),l=t+e,s=Math.PI*t/180,u=Math.PI*o/180,d=Math.PI*l/180,h=this.radius||r.radius,c=h-this.node.width,e={field:n,value:i,text:i,iNode:a,allAngle:e,startAngle:t,middleAngle:o,endAngle:l,startRadian:s,middleRadian:u,endRadian:d,outRadius:h,innerRadius:c,startOutPoint:r.getPointInRadianOfR(s,h),middleOutPoint:r.getPointInRadianOfR(u,h),endOutPoint:r.getPointInRadianOfR(d,h),startInnerPoint:r.getPointInRadianOfR(s,c),middleInnerPoint:r.getPointInRadianOfR(u,c),endInnerPoint:r.getPointInRadianOfR(d,c),rowData:this.dataFrame.getRowDataAt(a),fillStyle:null};return n&&(this.label.format?p.isFunction(this.label.format)&&(e.text=this.label.format.apply(this,[i,e])):(t=this.app.getComponent({name:"coord"}).getFieldConfig(n),e.text=t?t.getFormatValue(e.value):e.value.toFixed(this.label.fixNum))),e}},{key:"_widget",value:function(){var t,l=this;l.bgEnabled&&(t=l._getPathStr(this.bgNodeData),l._bgPathElement?l._bgPathElement.context.path=t:(l._bgPathElement=new d.default.Shapes.Path({context:{path:t}}),l.sprite.addChild(l._bgPathElement)),l._bgPathElement.context.lineWidth=this.node.width,l._bgPathElement.context.strokeStyle=this.bgNodeData.fillStyle),p.each(this.data,function(t){p.each(t,function(t,e){var n,i,a=l._getBarPathStr1(t),r="progress_bar_"+t.field+"_"+e,o=l.sprite.getChildById(r),r=(o?o.context.path=a:(o=new d.default.Shapes.Path({id:r,context:{path:a}}),l.sprite.addChild(o)),o.context.lineWidth=l.node.width,t.fillStyle),a=[];r&&r.lineargradient&&(i=[c({},r.lineargradient[0]),n=c({},r.lineargradient.slice(-1)[0])],t.endAngle>t.middleAngle&&(a=(0,color.gradient)(r.lineargradient[0].color,r.lineargradient.slice(-1)[0].color,parseInt(t.allAngle/10)),n.color=a[17]),r={lineargradient:i,points:[t.startOutPoint.x,t.startOutPoint.y,t.middleOutPoint.x,t.middleOutPoint.y]}),o.context.strokeStyle=r,t.endAngle>t.middleAngle&&(n=l._getBarPathStr2(t),i="progress_bar_"+t.field+"_"+e+"_2",(o=l.sprite.getChildById(i))?o.context.path=n:(o=new d.default.Shapes.Path({id:i,context:{path:n}}),l.sprite.addChild(o)),o.context.lineWidth=l.node.width,(r=t.fillStyle)&&r.lineargradient&&((i=c({},r.lineargradient[0])).color=a[17],r={lineargradient:[i,c({},r.lineargradient.slice(-1)[0])],points:[t.middleOutPoint.x,t.middleOutPoint.y,t.endOutPoint.x,t.endOutPoint.y]}),o.context.strokeStyle=r),l.label.enabled&&(n="progress_label_"+t.field+"_sprite_"+e,(a=l.sprite.getChildById(n))||(a=new d.default.Display.Sprite({id:n}),l.sprite.addChild(a)),a.context.x=l.label.offsetX-6,a.context.y=l.label.offsetY,i={fillStyle:l.label.fontColor||t.fillStyle,fontSize:l.label.fontSize,lineWidth:l.label.lineWidth,strokeStyle:l.label.strokeStyle,textAlign:l.label.textAlign,textBaseline:l.label.verticalAlign,rotation:l.label.rotation},o="progress_label_"+t.field+"_"+e,(r=a.getChildById(o))?(r.resetText(t.text),p.extend(r.context,i)):(r=new d.default.Display.Text(t.text,{id:o,context:i}),a.addChild(r)),n="progress_label_"+t.field+"_symbol_"+e,o=a.getChildById(n),i={x:r.getTextWidth()/2+2,y:3,fillStyle:l.label.unitColor||l.label.fontColor||t.fillStyle,fontSize:l.label.unitFontSize,textAlign:"left",textBaseline:l.label.verticalAlign},o?p.extend(o.context,i):(e=l.label.unit,o=new d.default.Display.Text(e,{id:n,context:i}),a.addChild(o)))})})}},{key:"_getPathStr",value:function(t){var e="M"+t.startOutPoint.x+" "+t.startOutPoint.y;return(e+="A"+t.outRadius+" "+t.outRadius+" 0 0 1 "+t.middleOutPoint.x+" "+t.middleOutPoint.y)+("A"+t.outRadius+" "+t.outRadius+" 0 0 1 "+t.endOutPoint.x+" "+t.endOutPoint.y)}},{key:"_getBarPathStr1",value:function(t){var e="M"+t.startOutPoint.x+" "+t.startOutPoint.y;return e+="A"+t.outRadius+" "+t.outRadius+" 0 0 1 "+t.middleOutPoint.x+" "+t.middleOutPoint.y}},{key:"_getBarPathStr2",value:function(t){var e="M"+t.middleOutPoint.x+" "+t.middleOutPoint.y;return e+="A"+t.outRadius+" "+t.outRadius+" 0 0 1 "+t.endOutPoint.x+" "+t.endOutPoint.y}},{key:"_getStyle",value:function(t,e,n){var i=this.app.getComponent({name:"coord"}).getFieldConfig(t.field),i=(n=n||(i?i.color:"#171717"),e);return e&&(p.isString(e)&&(i=e),p.isArray(e)&&(i=e[t.iNode]),p.isFunction(e)&&(i=e.apply(this,arguments))),i=i||n}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},aniEasing:"Quintic.Out",node:{detail:"进度条设置",propertys:{width:{detail:"进度条的宽度",default:16},fillStyle:{detail:"进度条的填充色",documentation:"可以是单个颜色，也可以是数组，也可以是一个函数,也可以是个lineargradient",default:null}}},label:{detail:"进度值文本",propertys:{enabled:{detail:"是否启用label",default:"true"},unit:{detail:"单位值，默认%",default:"%"},unitColor:{detail:"单位值的颜色",default:null},unitFontSize:{detail:"单位值的大小",default:14},fontColor:{detail:"label颜色",default:null},fontSize:{detail:"label文本大小",default:26},fixNum:{detail:"toFixed的位数",default:2},format:{detail:"label格式化处理函数",default:null},lineWidth:{detail:"label文本描边线宽",default:null},strokeStyle:{detail:"label描边颜色",default:null},rotation:{detail:"label旋转角度",default:0},textAlign:{detail:"label textAlign",default:"center",values:["left","center","right"]},verticalAlign:{detail:"label verticalAlign",default:"middle",values:["top","middle","bottom"]},position:{detail:"label位置",default:"origin"},offsetX:{detail:"label在x方向的偏移量",default:0},offsetY:{detail:"label在y方向的偏移量",default:0}}},bgEnabled:{detail:"是否开启背景",default:!0},bgColor:{detail:"进度条背景颜色",default:"#f7f7f7"},radius:{detail:"半径",default:null},allAngle:{detail:"总角度",documentation:"默认为null，则和坐标系同步",default:null},startAngle:{detail:"其实角度",documentation:"默认为null，则和坐标系同步",default:null}}}}]),i}(n.default);n.default.registerComponent(g,"graphs","progress"),e.default=g})),arrayWithoutHoles$1=(unwrapExports(progress),createCommonjsModule(function(t){t.exports=function(t){if(Array.isArray(t))return arrayLikeToArray$1(t)},t.exports.__esModule=!0,t.exports.default=t.exports})),iterableToArray$1=(unwrapExports(arrayWithoutHoles$1),createCommonjsModule(function(t){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports})),nonIterableSpread$1=(unwrapExports(iterableToArray$1),createCommonjsModule(function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports})),toConsumableArray$1=(unwrapExports(nonIterableSpread$1),createCommonjsModule(function(t){t.exports=function(t){return arrayWithoutHoles$1(t)||iterableToArray$1(t)||unsupportedIterableToArray$1(t)||nonIterableSpread$1()},t.exports.__esModule=!0,t.exports.default=t.exports})),data=(unwrapExports(toConsumableArray$1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.arrayToTreeJsonForRelation=function(t,n){var r={},o={},e=(Canvax._.each(t,function(t){var e=t[n.field]+"";1==e.split(",").length?r[e]=t:o[e]=t}),[]);return Canvax._.each(r,function(t,n){var i=!0;Canvax._.each(o,function(t,e){if((e+="").split(",")[1]==n)return i=!1}),i&&(e.push(t),t.__inRelation=!0)}),function t(e){Canvax._.each(e,function(i){var a;i.__cycle||(a=i[n.field],Canvax._.each(o,function(t,e){var n;(e+="").split(",")[0]==a&&(n=r[e.split(",")[1]])&&(i.children||(i.children=[]),Canvax._.find(i.children,function(t){return t.key==n.key})||i.children.push(n),n.__inRelation&&(n.__cycle=!0))}),i.children&&i.children.length&&t(i.children))})}(e),e},e.checkDataIsJson=a,e.jsonToArrayForRelation=function(t,e,n){h=n;var r=[],o=new WeakMap,l=e.field||i,s=e.node&&e.node.content&&e.node.content.field;if(a(t,l,h)){var u=[],d=0;for(Canvax._.each(t,function(t){u.push(t)});u.length;)!function(){var t,e,n=u.pop(),i=(n[l]||(n[l]=d),n[h]),a=(i&&(Canvax._.each(i,function(t){o.set(t,{parentIndex:d,parentNode:n})}),u=u.concat(i.reverse())),{}),i=(Canvax._.each(n,function(t,e){e!==h&&(a[e]=t)}),r.push(a),o.get(n));i&&(t=i.parentIndex,i=i.parentNode,(e={}).key=[t,d].join(","),s&&(e[s]=[i[s],n[s]].join("_")),r.push(e)),d++}()}return r};var i="__key__",h="children";function a(t,e,n){h=n;return!!Canvax._.isArray(t)&&(Canvax._.every(t,function(t){return Canvax._.isObject(t)})&&Canvax._.every(t,function(t){return!Canvax._.isArray(t[e])}),Canvax._.some(t,function(t){return h in t}))}})),data_1=(unwrapExports(data),data.arrayToTreeJsonForRelation),data_2=data.checkDataIsJson,data_3=data.jsonToArrayForRelation,zoom=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){function n(){return Math.floor(((0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)-u)*o+h)}function i(){return Math.floor(((0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)-d)*o+c)}function a(t){r.x=t.x,r.y=t.y;var t=r.rx,e=r.ry;return r.rx=f(r.x),r.ry=p(r.y),{xx:t,yy:e}}function e(t){var e=(t=a(t)).xx,t=t.yy;return u-=r.rx-e,d-=r.ry-t,r.rx=f(r.x),r.ry=p(r.y),{scale:o,x:n(),y:i()}}var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r={x:0,y:0,rx:0,ry:0},o=t.scale||1,l=t.scaleMin||1,s=t.scaleMax||8,u=0,d=0,h=0,c=0,f=function(){return Math.floor(1/o*((0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)-h)+u)},p=function(){return Math.floor(1/o*((0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)-c)+d)};this.wheel=function(t,e){return a(e),u=r.rx,d=r.ry,h=r.x,c=r.y,{scale:o=t.deltaY<0?Math.min(s,1.1*o):Math.max(l,o*(1/1.1)),x:n(),y:i()}},this.move=e,this.mouseMoveTo=a,this.offset=function(t){return r.x+=t.x,r.y+=t.y,e(r)},this.getZoomedPoint=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};return{x:n(t.x),y:i(t.y)}}}});function listCacheClear(){this.__data__=[],this.size=0}unwrapExports(zoom);var _listCacheClear=listCacheClear;function eq(t,e){return t===e||t!=t&&e!=e}var eq_1=eq;function assocIndexOf(t,e){for(var n=t.length;n--;)if(eq_1(t[n][0],e))return n;return-1}var _assocIndexOf=assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(t){var e=this.__data__,t=_assocIndexOf(e,t);return!(t<0)&&(t==e.length-1?e.pop():splice.call(e,t,1),--this.size,!0)}var _listCacheDelete=listCacheDelete;function listCacheGet(t){var e=this.__data__,t=_assocIndexOf(e,t);return t<0?void 0:e[t][1]}var _listCacheGet=listCacheGet;function listCacheHas(t){return-1<_assocIndexOf(this.__data__,t)}var _listCacheHas=listCacheHas;function listCacheSet(t,e){var n=this.__data__,i=_assocIndexOf(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}var _listCacheSet=listCacheSet;function ListCache(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}ListCache.prototype.clear=_listCacheClear,ListCache.prototype.delete=_listCacheDelete,ListCache.prototype.get=_listCacheGet,ListCache.prototype.has=_listCacheHas,ListCache.prototype.set=_listCacheSet;var _ListCache=ListCache;function stackClear(){this.__data__=new _ListCache,this.size=0}var _stackClear=stackClear;function stackDelete(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t}var _stackDelete=stackDelete;function stackGet(t){return this.__data__.get(t)}var _stackGet=stackGet;function stackHas(t){return this.__data__.has(t)}var _stackHas=stackHas,freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=_freeGlobal||freeSelf||Function("return this")(),_root=root,Symbol$1=_root.Symbol,_Symbol=Symbol$1,objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(t){var e=hasOwnProperty$1.call(t,symToStringTag),n=t[symToStringTag];try{var i=!(t[symToStringTag]=void 0)}catch(t){}var a=nativeObjectToString.call(t);return i&&(e?t[symToStringTag]=n:delete t[symToStringTag]),a}var _getRawTag=getRawTag,objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString;function objectToString(t){return nativeObjectToString$1.call(t)}var _objectToString=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(t){return null==t?void 0===t?undefinedTag:nullTag:(symToStringTag$1&&symToStringTag$1 in Object(t)?_getRawTag:_objectToString)(t)}var _baseGetTag=baseGetTag;function isObject(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var isObject_1=isObject,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(t){if(!isObject_1(t))return!1;t=_baseGetTag(t);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var isFunction_1=isFunction,coreJsData=_root["__core-js_shared__"],_coreJsData=coreJsData,maskSrcKey=function(){var t=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}var _isMasked=isMasked,funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(t){if(null!=t){try{return funcToString.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var _toSource=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$2=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$2=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$2).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(t){return!(!isObject_1(t)||_isMasked(t))&&(isFunction_1(t)?reIsNative:reIsHostCtor).test(_toSource(t))}var _baseIsNative=baseIsNative;function getValue(t,e){return null==t?void 0:t[e]}var _getValue=getValue;function getNative(t,e){t=_getValue(t,e);return _baseIsNative(t)?t:void 0}var _getNative=getNative,Map$1=_getNative(_root,"Map"),_Map=Map$1,nativeCreate=_getNative(Object,"create"),_nativeCreate=nativeCreate;function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0}var _hashClear=hashClear;function hashDelete(t){t=this.has(t)&&delete this.__data__[t];return this.size-=t?1:0,t}var _hashDelete=hashDelete,HASH_UNDEFINED="__lodash_hash_undefined__",objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function hashGet(t){var e,n=this.__data__;return _nativeCreate?(e=n[t])===HASH_UNDEFINED?void 0:e:hasOwnProperty$3.call(n,t)?n[t]:void 0}var _hashGet=hashGet,objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty;function hashHas(t){var e=this.__data__;return _nativeCreate?void 0!==e[t]:hasOwnProperty$4.call(e,t)}var _hashHas=hashHas,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=_nativeCreate&&void 0===e?HASH_UNDEFINED$1:e,this}var _hashSet=hashSet;function Hash(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Hash.prototype.clear=_hashClear,Hash.prototype.delete=_hashDelete,Hash.prototype.get=_hashGet,Hash.prototype.has=_hashHas,Hash.prototype.set=_hashSet;var _Hash=Hash;function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}}var _mapCacheClear=mapCacheClear;function isKeyable(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}var _isKeyable=isKeyable;function getMapData(t,e){t=t.__data__;return _isKeyable(e)?t["string"==typeof e?"string":"hash"]:t.map}var _getMapData=getMapData;function mapCacheDelete(t){t=_getMapData(this,t).delete(t);return this.size-=t?1:0,t}var _mapCacheDelete=mapCacheDelete;function mapCacheGet(t){return _getMapData(this,t).get(t)}var _mapCacheGet=mapCacheGet;function mapCacheHas(t){return _getMapData(this,t).has(t)}var _mapCacheHas=mapCacheHas;function mapCacheSet(t,e){var n=_getMapData(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}var _mapCacheSet=mapCacheSet;function MapCache(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}MapCache.prototype.clear=_mapCacheClear,MapCache.prototype.delete=_mapCacheDelete,MapCache.prototype.get=_mapCacheGet,MapCache.prototype.has=_mapCacheHas,MapCache.prototype.set=_mapCacheSet;var _MapCache=MapCache,LARGE_ARRAY_SIZE=200;function stackSet(t,e){var n=this.__data__;if(n instanceof _ListCache){var i=n.__data__;if(!_Map||i.length<LARGE_ARRAY_SIZE-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new _MapCache(i)}return n.set(t,e),this.size=n.size,this}var _stackSet=stackSet;function Stack(t){t=this.__data__=new _ListCache(t);this.size=t.size}Stack.prototype.clear=_stackClear,Stack.prototype.delete=_stackDelete,Stack.prototype.get=_stackGet,Stack.prototype.has=_stackHas,Stack.prototype.set=_stackSet;var _Stack=Stack;function arrayEach(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}var _arrayEach=arrayEach,defineProperty$2=function(){try{var t=_getNative(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),_defineProperty=defineProperty$2;function baseAssignValue(t,e,n){"__proto__"==e&&_defineProperty?_defineProperty(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var _baseAssignValue=baseAssignValue,objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function assignValue(t,e,n){var i=t[e];hasOwnProperty$5.call(t,e)&&eq_1(i,n)&&(void 0!==n||e in t)||_baseAssignValue(t,e,n)}var _assignValue=assignValue;function copyObject(t,e,n,i){for(var a=!n,r=(n=n||{},-1),o=e.length;++r<o;){var l=e[r],s=i?i(n[l],t[l],l,n,t):void 0;void 0===s&&(s=t[l]),(a?_baseAssignValue:_assignValue)(n,l,s)}return n}var _copyObject=copyObject;function baseTimes(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var _baseTimes=baseTimes;function isObjectLike(t){return null!=t&&"object"==typeof t}var isObjectLike_1=isObjectLike,argsTag="[object Arguments]";function baseIsArguments(t){return isObjectLike_1(t)&&_baseGetTag(t)==argsTag}var _baseIsArguments=baseIsArguments,objectProto$6=Object.prototype,hasOwnProperty$6=objectProto$6.hasOwnProperty,propertyIsEnumerable=objectProto$6.propertyIsEnumerable,isArguments=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(t){return isObjectLike_1(t)&&hasOwnProperty$6.call(t,"callee")&&!propertyIsEnumerable.call(t,"callee")},isArguments_1=isArguments,isArray=Array.isArray,isArray_1=isArray;function stubFalse(){return!1}var stubFalse_1=stubFalse,isBuffer_1=createCommonjsModule(function(t,e){var e=e&&!e.nodeType&&e,n=e&&t&&!t.nodeType&&t,n=n&&n.exports===e?_root.Buffer:void 0,e=n?n.isBuffer:void 0;t.exports=e||stubFalse_1}),MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(t,e){var n=typeof t;return!!(e=null==e?MAX_SAFE_INTEGER:e)&&("number"==n||"symbol"!=n&&reIsUint.test(t))&&-1<t&&t%1==0&&t<e}var _isIndex=isIndex,MAX_SAFE_INTEGER$1=9007199254740991;function isLength(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=MAX_SAFE_INTEGER$1}var isLength_1=isLength,argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(t){return isObjectLike_1(t)&&isLength_1(t.length)&&!!typedArrayTags[_baseGetTag(t)]}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var _baseIsTypedArray=baseIsTypedArray;function baseUnary(e){return function(t){return e(t)}}var _baseUnary=baseUnary,_nodeUtil=createCommonjsModule(function(t,e){var e=e&&!e.nodeType&&e,n=e&&t&&!t.nodeType&&t,i=n&&n.exports===e&&_freeGlobal.process,e=function(){try{var t=n&&n.require&&n.require("util").types;return t?t:i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=e}),nodeIsTypedArray=_nodeUtil&&_nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?_baseUnary(nodeIsTypedArray):_baseIsTypedArray,isTypedArray_1=isTypedArray,objectProto$7=Object.prototype,hasOwnProperty$7=objectProto$7.hasOwnProperty;function arrayLikeKeys(t,e){var n,i=isArray_1(t),a=!i&&isArguments_1(t),r=!i&&!a&&isBuffer_1(t),o=!i&&!a&&!r&&isTypedArray_1(t),l=i||a||r||o,s=l?_baseTimes(t.length,String):[],u=s.length;for(n in t)!e&&!hasOwnProperty$7.call(t,n)||l&&("length"==n||r&&("offset"==n||"parent"==n)||o&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||_isIndex(n,u))||s.push(n);return s}var _arrayLikeKeys=arrayLikeKeys,objectProto$8=Object.prototype;function isPrototype(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||objectProto$8)}var _isPrototype=isPrototype;function overArg(e,n){return function(t){return e(n(t))}}var _overArg=overArg,nativeKeys$1=_overArg(Object.keys,Object),_nativeKeys=nativeKeys$1,objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty;function baseKeys(t){if(!_isPrototype(t))return _nativeKeys(t);var e,n=[];for(e in Object(t))hasOwnProperty$8.call(t,e)&&"constructor"!=e&&n.push(e);return n}var _baseKeys=baseKeys;function isArrayLike$1(t){return null!=t&&isLength_1(t.length)&&!isFunction_1(t)}var isArrayLike_1=isArrayLike$1;function keys(t){return(isArrayLike_1(t)?_arrayLikeKeys:_baseKeys)(t)}var keys_1=keys;function baseAssign(t,e){return t&&_copyObject(e,keys_1(e),t)}var _baseAssign=baseAssign;function nativeKeysIn(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}var _nativeKeysIn=nativeKeysIn,objectProto$a=Object.prototype,hasOwnProperty$9=objectProto$a.hasOwnProperty;function baseKeysIn(t){if(!isObject_1(t))return _nativeKeysIn(t);var e,n=_isPrototype(t),i=[];for(e in t)("constructor"!=e||!n&&hasOwnProperty$9.call(t,e))&&i.push(e);return i}var _baseKeysIn=baseKeysIn;function keysIn(t){return isArrayLike_1(t)?_arrayLikeKeys(t,!0):_baseKeysIn(t)}var keysIn_1=keysIn;function baseAssignIn(t,e){return t&&_copyObject(e,keysIn_1(e),t)}var _baseAssignIn=baseAssignIn,_cloneBuffer=createCommonjsModule(function(t,e){var e=e&&!e.nodeType&&e,n=e&&t&&!t.nodeType&&t,n=n&&n.exports===e?_root.Buffer:void 0,i=n?n.allocUnsafe:void 0;t.exports=function(t,e){return e?t.slice():(e=t.length,e=i?i(e):new t.constructor(e),t.copy(e),e)}});function copyArray(t,e){var n=-1,i=t.length;for(e=e||Array(i);++n<i;)e[n]=t[n];return e}var _copyArray=copyArray;function arrayFilter(t,e){for(var n=-1,i=null==t?0:t.length,a=0,r=[];++n<i;){var o=t[n];e(o,n,t)&&(r[a++]=o)}return r}var _arrayFilter=arrayFilter;function stubArray(){return[]}var stubArray_1=stubArray,objectProto$b=Object.prototype,propertyIsEnumerable$1=objectProto$b.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(e){return null==e?[]:(e=Object(e),_arrayFilter(nativeGetSymbols(e),function(t){return propertyIsEnumerable$1.call(e,t)}))}:stubArray_1,_getSymbols=getSymbols;function copySymbols(t,e){return _copyObject(t,_getSymbols(t),e)}var _copySymbols=copySymbols;function arrayPush(t,e){for(var n=-1,i=e.length,a=t.length;++n<i;)t[a+n]=e[n];return t}var _arrayPush=arrayPush,getPrototype=_overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols$1?function(t){for(var e=[];t;)_arrayPush(e,_getSymbols(t)),t=_getPrototype(t);return e}:stubArray_1,_getSymbolsIn=getSymbolsIn;function copySymbolsIn(t,e){return _copyObject(t,_getSymbolsIn(t),e)}var _copySymbolsIn=copySymbolsIn;function baseGetAllKeys(t,e,n){e=e(t);return isArray_1(t)?e:_arrayPush(e,n(t))}var _baseGetAllKeys=baseGetAllKeys;function getAllKeys(t){return _baseGetAllKeys(t,keys_1,_getSymbols)}var _getAllKeys=getAllKeys;function getAllKeysIn(t){return _baseGetAllKeys(t,keysIn_1,_getSymbolsIn)}var _getAllKeysIn=getAllKeysIn,DataView=_getNative(_root,"DataView"),_DataView=DataView,Promise$1=_getNative(_root,"Promise"),_Promise=Promise$1,Set$1=_getNative(_root,"Set"),_Set=Set$1,WeakMap$1=_getNative(_root,"WeakMap"),_WeakMap=WeakMap$1,mapTag$1="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$1="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$1="[object DataView]",dataViewCtorString=_toSource(_DataView),mapCtorString=_toSource(_Map),promiseCtorString=_toSource(_Promise),setCtorString=_toSource(_Set),weakMapCtorString=_toSource(_WeakMap),getTag=_baseGetTag,_getTag=getTag=_DataView&&getTag(new _DataView(new ArrayBuffer(1)))!=dataViewTag$1||_Map&&getTag(new _Map)!=mapTag$1||_Promise&&getTag(_Promise.resolve())!=promiseTag||_Set&&getTag(new _Set)!=setTag$1||_WeakMap&&getTag(new _WeakMap)!=weakMapTag$1?function(t){var e=_baseGetTag(t),t=e==objectTag$1?t.constructor:void 0,t=t?_toSource(t):"";if(t)switch(t){case dataViewCtorString:return dataViewTag$1;case mapCtorString:return mapTag$1;case promiseCtorString:return promiseTag;case setCtorString:return setTag$1;case weakMapCtorString:return weakMapTag$1}return e}:getTag,objectProto$c=Object.prototype,hasOwnProperty$a=objectProto$c.hasOwnProperty;function initCloneArray(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&hasOwnProperty$a.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var _initCloneArray=initCloneArray,Uint8Array=_root.Uint8Array,_Uint8Array=Uint8Array;function cloneArrayBuffer(t){var e=new t.constructor(t.byteLength);return new _Uint8Array(e).set(new _Uint8Array(t)),e}var _cloneArrayBuffer=cloneArrayBuffer;function cloneDataView(t,e){e=e?_cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}var _cloneDataView=cloneDataView,reFlags=/\w*$/;function cloneRegExp(t){var e=new t.constructor(t.source,reFlags.exec(t));return e.lastIndex=t.lastIndex,e}var _cloneRegExp=cloneRegExp,symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function cloneSymbol(t){return symbolValueOf?Object(symbolValueOf.call(t)):{}}var _cloneSymbol=cloneSymbol;function cloneTypedArray(t,e){e=e?_cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}var _cloneTypedArray=cloneTypedArray,boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(t,e,n){var i=t.constructor;switch(e){case arrayBufferTag$1:return _cloneArrayBuffer(t);case boolTag$1:case dateTag$1:return new i(+t);case dataViewTag$2:return _cloneDataView(t,n);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return _cloneTypedArray(t,n);case mapTag$2:return new i;case numberTag$1:case stringTag$1:return new i(t);case regexpTag$1:return _cloneRegExp(t);case setTag$2:return new i;case symbolTag:return _cloneSymbol(t)}}var _initCloneByTag=initCloneByTag,objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!isObject_1(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;t=new e;return e.prototype=void 0,t}}(),_baseCreate=baseCreate;function initCloneObject(t){return"function"!=typeof t.constructor||_isPrototype(t)?{}:_baseCreate(_getPrototype(t))}var _initCloneObject=initCloneObject,mapTag$3="[object Map]";function baseIsMap(t){return isObjectLike_1(t)&&_getTag(t)==mapTag$3}var _baseIsMap=baseIsMap,nodeIsMap=_nodeUtil&&_nodeUtil.isMap,isMap=nodeIsMap?_baseUnary(nodeIsMap):_baseIsMap,isMap_1=isMap,setTag$3="[object Set]";function baseIsSet(t){return isObjectLike_1(t)&&_getTag(t)==setTag$3}var _baseIsSet=baseIsSet,nodeIsSet=_nodeUtil&&_nodeUtil.isSet,isSet=nodeIsSet?_baseUnary(nodeIsSet):_baseIsSet,isSet_1=isSet,CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,argsTag$2="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",mapTag$4="[object Map]",numberTag$2="[object Number]",objectTag$2="[object Object]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",symbolTag$1="[object Symbol]",weakMapTag$2="[object WeakMap]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",cloneableTags={};function baseClone(n,i,a,t,e,r){var o,l=i&CLONE_DEEP_FLAG,s=i&CLONE_FLAT_FLAG,u=i&CLONE_SYMBOLS_FLAG;if(void 0===(o=a?e?a(n,t,e,r):a(n):o)){if(!isObject_1(n))return n;t=isArray_1(n);if(t){if(o=_initCloneArray(n),!l)return _copyArray(n,o)}else{var d=_getTag(n),h=d==funcTag$2||d==genTag$1;if(isBuffer_1(n))return _cloneBuffer(n,l);if(d==objectTag$2||d==argsTag$2||h&&!e){if(o=s||h?{}:_initCloneObject(n),!l)return s?_copySymbolsIn(n,_baseAssignIn(o,n)):_copySymbols(n,_baseAssign(o,n))}else{if(!cloneableTags[d])return e?n:{};o=_initCloneByTag(n,d,l)}}h=(r=r||new _Stack).get(n);if(h)return h;r.set(n,o),isSet_1(n)?n.forEach(function(t){o.add(baseClone(t,i,a,t,n,r))}):isMap_1(n)&&n.forEach(function(t,e){o.set(e,baseClone(t,i,a,e,n,r))});var c=t?void 0:(u?s?_getAllKeysIn:_getAllKeys:s?keysIn_1:keys_1)(n);_arrayEach(c||n,function(t,e){c&&(t=n[e=t]),_assignValue(o,e,baseClone(t,i,a,e,n,r))})}return o}cloneableTags[argsTag$2]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$2]=cloneableTags[dataViewTag$3]=cloneableTags[boolTag$2]=cloneableTags[dateTag$2]=cloneableTags[float32Tag$2]=cloneableTags[float64Tag$2]=cloneableTags[int8Tag$2]=cloneableTags[int16Tag$2]=cloneableTags[int32Tag$2]=cloneableTags[mapTag$4]=cloneableTags[numberTag$2]=cloneableTags[objectTag$2]=cloneableTags[regexpTag$2]=cloneableTags[setTag$4]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag$2]=cloneableTags[uint8ClampedTag$2]=cloneableTags[uint16Tag$2]=cloneableTags[uint32Tag$2]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag$2]=cloneableTags[weakMapTag$2]=!1;var _baseClone=baseClone,CLONE_SYMBOLS_FLAG$1=4;function clone(t){return _baseClone(t,CLONE_SYMBOLS_FLAG$1)}var clone_1=clone;function constant(t){return function(){return t}}var constant_1=constant;function createBaseFor(s){return function(t,e,n){for(var i=-1,a=Object(t),r=n(t),o=r.length;o--;){var l=r[s?o:++i];if(!1===e(a[l],l,a))break}return t}}var _createBaseFor=createBaseFor,baseFor=createBaseFor(),_baseFor=baseFor;function baseForOwn(t,e){return t&&_baseFor(t,e,keys_1)}var _baseForOwn=baseForOwn;function createBaseEach(r,o){return function(t,e){if(null!=t){if(!isArrayLike_1(t))return r(t,e);for(var n=t.length,i=o?n:-1,a=Object(t);(o?i--:++i<n)&&!1!==e(a[i],i,a););}return t}}var _createBaseEach=createBaseEach,baseEach=createBaseEach(_baseForOwn),_baseEach=baseEach;function identity(t){return t}var identity_1=identity;function castFunction(t){return"function"==typeof t?t:identity_1}var _castFunction=castFunction;function forEach(t,e){return(isArray_1(t)?_arrayEach:_baseEach)(t,_castFunction(e))}var forEach_1=forEach,each$1=forEach_1;function baseFilter(t,i){var a=[];return _baseEach(t,function(t,e,n){i(t,e,n)&&a.push(t)}),a}var _baseFilter=baseFilter,HASH_UNDEFINED$2="__lodash_hash_undefined__";function setCacheAdd(t){return this.__data__.set(t,HASH_UNDEFINED$2),this}var _setCacheAdd=setCacheAdd;function setCacheHas(t){return this.__data__.has(t)}var _setCacheHas=setCacheHas;function SetCache(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new _MapCache;++e<n;)this.add(t[e])}SetCache.prototype.add=SetCache.prototype.push=_setCacheAdd,SetCache.prototype.has=_setCacheHas;var _SetCache=SetCache;function arraySome(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var _arraySome=arraySome;function cacheHas(t,e){return t.has(e)}var _cacheHas=cacheHas,COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function equalArrays(t,e,n,i,a,r){var o=n&COMPARE_PARTIAL_FLAG,l=t.length,s=e.length;if(l!=s&&!(o&&l<s))return!1;var s=r.get(t),u=r.get(e);if(s&&u)return s==e&&u==t;var d=-1,h=!0,c=n&COMPARE_UNORDERED_FLAG?new _SetCache:void 0;for(r.set(t,e),r.set(e,t);++d<l;){var f,p=t[d],g=e[d];if(void 0!==(f=i?o?i(g,p,d,e,t,r):i(p,g,d,t,e,r):f)){if(f)continue;h=!1;break}if(c){if(!_arraySome(e,function(t,e){if(!_cacheHas(c,e)&&(p===t||a(p,t,n,i,r)))return c.push(e)})){h=!1;break}}else if(p!==g&&!a(p,g,n,i,r)){h=!1;break}}return r.delete(t),r.delete(e),h}var _equalArrays=equalArrays;function mapToArray(t){var n=-1,i=Array(t.size);return t.forEach(function(t,e){i[++n]=[e,t]}),i}var _mapToArray=mapToArray;function setToArray(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}var _setToArray=setToArray,COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2,boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",mapTag$5="[object Map]",numberTag$3="[object Number]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",symbolProto$1=_Symbol?_Symbol.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function equalByTag(t,e,n,i,a,r,o){switch(n){case dataViewTag$4:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case arrayBufferTag$3:return t.byteLength==e.byteLength&&r(new _Uint8Array(t),new _Uint8Array(e))?!0:!1;case boolTag$3:case dateTag$3:case numberTag$3:return eq_1(+t,+e);case errorTag$2:return t.name==e.name&&t.message==e.message;case regexpTag$3:case stringTag$3:return t==e+"";case mapTag$5:var l=_mapToArray;case setTag$5:l=l||_setToArray;if(t.size!=e.size&&!(i&COMPARE_PARTIAL_FLAG$1))return!1;var s=o.get(t);if(s)return s==e;i|=COMPARE_UNORDERED_FLAG$1,o.set(t,e);s=_equalArrays(l(t),l(e),i,a,r,o);return o.delete(t),s;case symbolTag$2:if(symbolValueOf$1)return symbolValueOf$1.call(t)==symbolValueOf$1.call(e)}return!1}var _equalByTag=equalByTag,COMPARE_PARTIAL_FLAG$2=1,objectProto$d=Object.prototype,hasOwnProperty$b=objectProto$d.hasOwnProperty;function equalObjects(t,e,n,i,a,r){var o=n&COMPARE_PARTIAL_FLAG$2,l=_getAllKeys(t),s=l.length;if(s!=_getAllKeys(e).length&&!o)return!1;for(var u=s;u--;){var d=l[u];if(!(o?d in e:hasOwnProperty$b.call(e,d)))return!1}var h=r.get(t),c=r.get(e);if(h&&c)return h==e&&c==t;for(var f=!0,p=(r.set(t,e),r.set(e,t),o);++u<s;){var g,y=t[d=l[u]],_=e[d];if(!(void 0===(g=i?o?i(_,y,d,e,t,r):i(y,_,d,t,e,r):g)?y===_||a(y,_,n,i,r):g)){f=!1;break}p=p||"constructor"==d}return f&&!p&&(h=t.constructor)!=(c=e.constructor)&&"constructor"in t&&"constructor"in e&&!("function"==typeof h&&h instanceof h&&"function"==typeof c&&c instanceof c)&&(f=!1),r.delete(t),r.delete(e),f}var _equalObjects=equalObjects,COMPARE_PARTIAL_FLAG$3=1,argsTag$3="[object Arguments]",arrayTag$2="[object Array]",objectTag$3="[object Object]",objectProto$e=Object.prototype,hasOwnProperty$c=objectProto$e.hasOwnProperty;function baseIsEqualDeep(t,e,n,i,a,r){var o=isArray_1(t),l=isArray_1(e),s=o?arrayTag$2:_getTag(t),l=l?arrayTag$2:_getTag(e),u=(s=s==argsTag$3?objectTag$3:s)==objectTag$3,d=(l=l==argsTag$3?objectTag$3:l)==objectTag$3,l=s==l;if(l&&isBuffer_1(t)){if(!isBuffer_1(e))return!1;u=!(o=!0)}if(l&&!u)return r=r||new _Stack,o||isTypedArray_1(t)?_equalArrays(t,e,n,i,a,r):_equalByTag(t,e,s,n,i,a,r);if(!(n&COMPARE_PARTIAL_FLAG$3)){o=u&&hasOwnProperty$c.call(t,"__wrapped__"),s=d&&hasOwnProperty$c.call(e,"__wrapped__");if(o||s)return a(o?t.value():t,s?e.value():e,n,i,r=r||new _Stack)}return!!l&&(r=r||new _Stack,_equalObjects(t,e,n,i,a,r))}var _baseIsEqualDeep=baseIsEqualDeep;function baseIsEqual(t,e,n,i,a){return t===e||(null==t||null==e||!isObjectLike_1(t)&&!isObjectLike_1(e)?t!=t&&e!=e:_baseIsEqualDeep(t,e,n,i,baseIsEqual,a))}var _baseIsEqual=baseIsEqual,COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2;function baseIsMatch(t,e,n,i){var a=n.length,r=a,o=!i;if(null==t)return!r;for(t=Object(t);a--;){var l=n[a];if(o&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++a<r;){var s=(l=n[a])[0],u=t[s],d=l[1];if(o&&l[2]){if(void 0===u&&!(s in t))return!1}else{var h,c=new _Stack;if(!(void 0===(h=i?i(u,d,s,t,e,c):h)?_baseIsEqual(d,u,COMPARE_PARTIAL_FLAG$4|COMPARE_UNORDERED_FLAG$2,i,c):h))return!1}}return!0}var _baseIsMatch=baseIsMatch;function isStrictComparable(t){return t==t&&!isObject_1(t)}var _isStrictComparable=isStrictComparable;function getMatchData(t){for(var e=keys_1(t),n=e.length;n--;){var i=e[n],a=t[i];e[n]=[i,a,_isStrictComparable(a)]}return e}var _getMatchData=getMatchData;function matchesStrictComparable(e,n){return function(t){return null!=t&&(t[e]===n&&(void 0!==n||e in Object(t)))}}var _matchesStrictComparable=matchesStrictComparable;function baseMatches(e){var n=_getMatchData(e);return 1==n.length&&n[0][2]?_matchesStrictComparable(n[0][0],n[0][1]):function(t){return t===e||_baseIsMatch(t,e,n)}}var _baseMatches=baseMatches,symbolTag$3="[object Symbol]";function isSymbol(t){return"symbol"==typeof t||isObjectLike_1(t)&&_baseGetTag(t)==symbolTag$3}var isSymbol_1=isSymbol,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(t,e){if(isArray_1(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!isSymbol_1(t))||(reIsPlainProp.test(t)||!reIsDeepProp.test(t)||null!=e&&t in Object(e))}var _isKey=isKey,FUNC_ERROR_TEXT="Expected a function";function memoize(i,a){if("function"!=typeof i||null!=a&&"function"!=typeof a)throw new TypeError(FUNC_ERROR_TEXT);function r(){var t=arguments,e=a?a.apply(this,t):t[0],n=r.cache;return n.has(e)?n.get(e):(t=i.apply(this,t),r.cache=n.set(e,t)||n,t)}return r.cache=new(memoize.Cache||_MapCache),r}memoize.Cache=_MapCache;var memoize_1=memoize,MAX_MEMOIZE_SIZE=500;function memoizeCapped(t){var t=memoize_1(t,function(t){return e.size===MAX_MEMOIZE_SIZE&&e.clear(),t}),e=t.cache;return t}var _memoizeCapped=memoizeCapped,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(t){var a=[];return 46===t.charCodeAt(0)&&a.push(""),t.replace(rePropName,function(t,e,n,i){a.push(n?i.replace(reEscapeChar,"$1"):e||t)}),a}),_stringToPath=stringToPath;function arrayMap(t,e){for(var n=-1,i=null==t?0:t.length,a=Array(i);++n<i;)a[n]=e(t[n],n,t);return a}var _arrayMap=arrayMap,INFINITY=1/0,symbolProto$2=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(t){if("string"==typeof t)return t;if(isArray_1(t))return _arrayMap(t,baseToString)+"";if(isSymbol_1(t))return symbolToString?symbolToString.call(t):"";var e=t+"";return"0"==e&&1/t==-INFINITY?"-0":e}var _baseToString=baseToString;function toString$1(t){return null==t?"":_baseToString(t)}var toString_1=toString$1;function castPath(t,e){return isArray_1(t)?t:_isKey(t,e)?[t]:_stringToPath(toString_1(t))}var _castPath=castPath,INFINITY$1=1/0;function toKey(t){if("string"==typeof t||isSymbol_1(t))return t;var e=t+"";return"0"==e&&1/t==-INFINITY$1?"-0":e}var _toKey=toKey;function baseGet(t,e){for(var n=0,i=(e=_castPath(e,t)).length;null!=t&&n<i;)t=t[_toKey(e[n++])];return n&&n==i?t:void 0}var _baseGet=baseGet;function get(t,e,n){t=null==t?void 0:_baseGet(t,e);return void 0===t?n:t}var get_1=get;function baseHasIn(t,e){return null!=t&&e in Object(t)}var _baseHasIn=baseHasIn;function hasPath(t,e,n){for(var i=-1,a=(e=_castPath(e,t)).length,r=!1;++i<a;){var o=_toKey(e[i]);if(!(r=null!=t&&n(t,o)))break;t=t[o]}return r||++i!=a?r:!!(a=null==t?0:t.length)&&isLength_1(a)&&_isIndex(o,a)&&(isArray_1(t)||isArguments_1(t))}var _hasPath=hasPath;function hasIn(t,e){return null!=t&&_hasPath(t,e,_baseHasIn)}var hasIn_1=hasIn,COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function baseMatchesProperty(n,i){return _isKey(n)&&_isStrictComparable(i)?_matchesStrictComparable(_toKey(n),i):function(t){var e=get_1(t,n);return void 0===e&&e===i?hasIn_1(t,n):_baseIsEqual(i,e,COMPARE_PARTIAL_FLAG$5|COMPARE_UNORDERED_FLAG$3)}}var _baseMatchesProperty=baseMatchesProperty;function baseProperty(e){return function(t){return null==t?void 0:t[e]}}var _baseProperty=baseProperty;function basePropertyDeep(e){return function(t){return _baseGet(t,e)}}var _basePropertyDeep=basePropertyDeep;function property(t){return _isKey(t)?_baseProperty(_toKey(t)):_basePropertyDeep(t)}var property_1=property;function baseIteratee(t){return"function"==typeof t?t:null==t?identity_1:"object"==typeof t?isArray_1(t)?_baseMatchesProperty(t[0],t[1]):_baseMatches(t):property_1(t)}var _baseIteratee=baseIteratee;function filter(t,e){return(isArray_1(t)?_arrayFilter:_baseFilter)(t,_baseIteratee(e))}var filter_1=filter,objectProto$f=Object.prototype,hasOwnProperty$d=objectProto$f.hasOwnProperty;function baseHas(t,e){return null!=t&&hasOwnProperty$d.call(t,e)}var _baseHas=baseHas;function has(t,e){return null!=t&&_hasPath(t,e,_baseHas)}var has_1=has,mapTag$6="[object Map]",setTag$6="[object Set]",objectProto$g=Object.prototype,hasOwnProperty$e=objectProto$g.hasOwnProperty;function isEmpty(t){if(null!=t){if(isArrayLike_1(t)&&(isArray_1(t)||"string"==typeof t||"function"==typeof t.splice||isBuffer_1(t)||isTypedArray_1(t)||isArguments_1(t)))return!t.length;var e,n=_getTag(t);if(n==mapTag$6||n==setTag$6)return!t.size;if(_isPrototype(t))return!_baseKeys(t).length;for(e in t)if(hasOwnProperty$e.call(t,e))return!1}return!0}var isEmpty_1=isEmpty;function isUndefined(t){return void 0===t}var isUndefined_1=isUndefined;function baseMap(t,i){var a=-1,r=isArrayLike_1(t)?Array(t.length):[];return _baseEach(t,function(t,e,n){r[++a]=i(t,e,n)}),r}var _baseMap=baseMap;function map(t,e){return(isArray_1(t)?_arrayMap:_baseMap)(t,_baseIteratee(e))}var map_1=map;function arrayReduce(t,e,n,i){var a=-1,r=null==t?0:t.length;for(i&&r&&(n=t[++a]);++a<r;)n=e(n,t[a],a,t);return n}var _arrayReduce=arrayReduce;function baseReduce(t,i,a,r,e){return e(t,function(t,e,n){a=r?(r=!1,t):i(a,t,e,n)}),a}var _baseReduce=baseReduce;function reduce(t,e,n){var i=isArray_1(t)?_arrayReduce:_baseReduce,a=arguments.length<3;return i(t,_baseIteratee(e),n,a,_baseEach)}var reduce_1=reduce,stringTag$4="[object String]";function isString(t){return"string"==typeof t||!isArray_1(t)&&isObjectLike_1(t)&&_baseGetTag(t)==stringTag$4}var isString_1=isString,asciiSize=_baseProperty("length"),_asciiSize=asciiSize,rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsVarRange="\\ufe0e\\ufe0f",rsZWJ="\\u200d",reHasUnicode=RegExp("["+rsZWJ+rsAstralRange+rsComboRange+rsVarRange+"]");function hasUnicode(t){return reHasUnicode.test(t)}var _hasUnicode=hasUnicode,rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsVarRange$1="\\ufe0e\\ufe0f",rsAstral="["+rsAstralRange$1+"]",rsCombo="["+rsComboRange$1+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange$1+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ$1="\\u200d",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange$1+"]?",rsOptJoin="(?:"+rsZWJ$1+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");function unicodeSize(t){for(var e=reUnicode.lastIndex=0;reUnicode.test(t);)++e;return e}var _unicodeSize=unicodeSize;function stringSize(t){return(_hasUnicode(t)?_unicodeSize:_asciiSize)(t)}var _stringSize=stringSize,mapTag$7="[object Map]",setTag$7="[object Set]";function size(t){if(null==t)return 0;if(isArrayLike_1(t))return isString_1(t)?_stringSize(t):t.length;var e=_getTag(t);return e==mapTag$7||e==setTag$7?t.size:_baseKeys(t).length}var size_1=size;function transform(t,i,a){var e,n=isArray_1(t),r=n||isBuffer_1(t)||isTypedArray_1(t);return i=_baseIteratee(i),null==a&&(e=t&&t.constructor,a=r?n?new e:[]:isObject_1(t)&&isFunction_1(e)?_baseCreate(_getPrototype(t)):{}),(r?_arrayEach:_baseForOwn)(t,function(t,e,n){return i(a,t,e,n)}),a}var transform_1=transform,spreadableSymbol=_Symbol?_Symbol.isConcatSpreadable:void 0;function isFlattenable(t){return isArray_1(t)||isArguments_1(t)||!!(spreadableSymbol&&t&&t[spreadableSymbol])}var _isFlattenable=isFlattenable;function baseFlatten(t,e,n,i,a){var r=-1,o=t.length;for(n=n||_isFlattenable,a=a||[];++r<o;){var l=t[r];0<e&&n(l)?1<e?baseFlatten(l,e-1,n,i,a):_arrayPush(a,l):i||(a[a.length]=l)}return a}var _baseFlatten=baseFlatten;function apply(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var _apply=apply,nativeMax=Math.max;function overRest(r,o,l){return o=nativeMax(void 0===o?r.length-1:o,0),function(){for(var t=arguments,e=-1,n=nativeMax(t.length-o,0),i=Array(n);++e<n;)i[e]=t[o+e];for(var e=-1,a=Array(o+1);++e<o;)a[e]=t[e];return a[o]=l(i),_apply(r,this,a)}}var _overRest=overRest,baseSetToString=_defineProperty?function(t,e){return _defineProperty(t,"toString",{configurable:!0,enumerable:!1,value:constant_1(e),writable:!0})}:identity_1,_baseSetToString=baseSetToString,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(n){var i=0,a=0;return function(){var t=nativeNow(),e=HOT_SPAN-(t-a);if(a=t,0<e){if(++i>=HOT_COUNT)return arguments[0]}else i=0;return n.apply(void 0,arguments)}}var _shortOut=shortOut,setToString=shortOut(_baseSetToString),_setToString=setToString;function baseRest(t,e){return _setToString(_overRest(t,e,identity_1),t+"")}var _baseRest=baseRest;function baseFindIndex(t,e,n,i){for(var a=t.length,r=n+(i?1:-1);i?r--:++r<a;)if(e(t[r],r,t))return r;return-1}var _baseFindIndex=baseFindIndex;function baseIsNaN(t){return t!=t}var _baseIsNaN=baseIsNaN;function strictIndexOf(t,e,n){for(var i=n-1,a=t.length;++i<a;)if(t[i]===e)return i;return-1}var _strictIndexOf=strictIndexOf;function baseIndexOf(t,e,n){return e==e?_strictIndexOf(t,e,n):_baseFindIndex(t,_baseIsNaN,n)}var _baseIndexOf=baseIndexOf;function arrayIncludes(t,e){return!!(null==t?0:t.length)&&-1<_baseIndexOf(t,e,0)}var _arrayIncludes=arrayIncludes;function arrayIncludesWith(t,e,n){for(var i=-1,a=null==t?0:t.length;++i<a;)if(n(e,t[i]))return!0;return!1}var _arrayIncludesWith=arrayIncludesWith;function noop(){}var noop_1=noop,INFINITY$2=1/0,createSet=_Set&&1/_setToArray(new _Set([,-0]))[1]==INFINITY$2?function(t){return new _Set(t)}:noop_1,_createSet=createSet,LARGE_ARRAY_SIZE$1=200;function baseUniq(t,e,n){var i=-1,a=_arrayIncludes,r=t.length,o=!0,l=[],s=l;if(n)o=!1,a=_arrayIncludesWith;else if(LARGE_ARRAY_SIZE$1<=r){var u=e?null:_createSet(t);if(u)return _setToArray(u);o=!1,a=_cacheHas,s=new _SetCache}else s=e?[]:l;t:for(;++i<r;){var d=t[i],h=e?e(d):d,d=n||0!==d?d:0;if(o&&h==h){for(var c=s.length;c--;)if(s[c]===h)continue t;e&&s.push(h),l.push(d)}else a(s,h,n)||(s!==l&&s.push(h),l.push(d))}return l}var _baseUniq=baseUniq;function isArrayLikeObject(t){return isObjectLike_1(t)&&isArrayLike_1(t)}var isArrayLikeObject_1=isArrayLikeObject,union=_baseRest(function(t){return _baseUniq(_baseFlatten(t,1,isArrayLikeObject_1,!0))}),union_1=union;function baseValues(e,t){return _arrayMap(t,function(t){return e[t]})}var _baseValues=baseValues;function values(t){return null==t?[]:_baseValues(t,keys_1(t))}var values_1=values;if("function"==typeof commonjsRequire)try{lodash={clone:clone_1,constant:constant_1,each:each$1,filter:filter_1,has:has_1,isArray:isArray_1,isEmpty:isEmpty_1,isFunction:isFunction_1,isUndefined:isUndefined_1,keys:keys_1,map:map_1,reduce:reduce_1,size:size_1,transform:transform_1,union:union_1,values:values_1}}catch(t){}var lodash,lodash_1=lodash=lodash||window._,graph=Graph,DEFAULT_EDGE_NAME="\0",GRAPH_NODE="\0",EDGE_KEY_DELIM="";function Graph(t){this._isDirected=!lodash_1.has(t,"directed")||t.directed,this._isMultigraph=!!lodash_1.has(t,"multigraph")&&t.multigraph,this._isCompound=!!lodash_1.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=lodash_1.constant(void 0),this._defaultEdgeLabelFn=lodash_1.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[GRAPH_NODE]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function incrementOrInitEntry(t,e){t[e]?t[e]++:t[e]=1}function decrementOrRemoveEntry(t,e){--t[e]||delete t[e]}function edgeArgsToId(t,e,n,i){e=""+e,n=""+n;return!t&&n<e&&(t=e,e=n,n=t),e+EDGE_KEY_DELIM+n+EDGE_KEY_DELIM+(lodash_1.isUndefined(i)?DEFAULT_EDGE_NAME:i)}function edgeArgsToObj(t,e,n,i){e=""+e,n=""+n,!t&&n<e&&(t=e,e=n,n=t),t={v:e,w:n};return i&&(t.name=i),t}function edgeObjToId(t,e){return edgeArgsToId(t,e.v,e.w,e.name)}Graph.prototype._nodeCount=0,Graph.prototype._edgeCount=0,Graph.prototype.isDirected=function(){return this._isDirected},Graph.prototype.isMultigraph=function(){return this._isMultigraph},Graph.prototype.isCompound=function(){return this._isCompound},Graph.prototype.setGraph=function(t){return this._label=t,this},Graph.prototype.graph=function(){return this._label},Graph.prototype.setDefaultNodeLabel=function(t){return lodash_1.isFunction(t)||(t=lodash_1.constant(t)),this._defaultNodeLabelFn=t,this},Graph.prototype.nodeCount=function(){return this._nodeCount},Graph.prototype.nodes=function(){return lodash_1.keys(this._nodes)},Graph.prototype.sources=function(){var e=this;return lodash_1.filter(this.nodes(),function(t){return lodash_1.isEmpty(e._in[t])})},Graph.prototype.sinks=function(){var e=this;return lodash_1.filter(this.nodes(),function(t){return lodash_1.isEmpty(e._out[t])})},Graph.prototype.setNodes=function(t,e){var n=arguments,i=this;return lodash_1.each(t,function(t){1<n.length?i.setNode(t,e):i.setNode(t)}),this},Graph.prototype.setNode=function(t,e){return lodash_1.has(this._nodes,t)?1<arguments.length&&(this._nodes[t]=e):(this._nodes[t]=1<arguments.length?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=GRAPH_NODE,this._children[t]={},this._children[GRAPH_NODE][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount),this},Graph.prototype.node=function(t){return this._nodes[t]},Graph.prototype.hasNode=function(t){return lodash_1.has(this._nodes,t)},Graph.prototype.removeNode=function(t){var e,n=this;return lodash_1.has(this._nodes,t)&&(e=function(t){n.removeEdge(n._edgeObjs[t])},delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],lodash_1.each(this.children(t),function(t){n.setParent(t)}),delete this._children[t]),lodash_1.each(lodash_1.keys(this._in[t]),e),delete this._in[t],delete this._preds[t],lodash_1.each(lodash_1.keys(this._out[t]),e),delete this._out[t],delete this._sucs[t],--this._nodeCount),this},Graph.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(lodash_1.isUndefined(e))e=GRAPH_NODE;else{for(var n=e+="";!lodash_1.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},Graph.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},Graph.prototype.parent=function(t){if(this._isCompound){t=this._parent[t];if(t!==GRAPH_NODE)return t}},Graph.prototype.children=function(t){if(lodash_1.isUndefined(t)&&(t=GRAPH_NODE),!this._isCompound)return t===GRAPH_NODE?this.nodes():this.hasNode(t)?[]:void 0;t=this._children[t];return t?lodash_1.keys(t):void 0},Graph.prototype.predecessors=function(t){t=this._preds[t];if(t)return lodash_1.keys(t)},Graph.prototype.successors=function(t){t=this._sucs[t];if(t)return lodash_1.keys(t)},Graph.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return lodash_1.union(e,this.successors(t))},Graph.prototype.isLeaf=function(t){t=this.isDirected()?this.successors(t):this.neighbors(t);return 0===t.length},Graph.prototype.filterNodes=function(n){var i=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound}),a=(i.setGraph(this.graph()),this),r=(lodash_1.each(this._nodes,function(t,e){n(e)&&i.setNode(e,t)}),lodash_1.each(this._edgeObjs,function(t){i.hasNode(t.v)&&i.hasNode(t.w)&&i.setEdge(t,a.edge(t))}),{});return this._isCompound&&lodash_1.each(i.nodes(),function(t){i.setParent(t,function t(e){var n=a.parent(e);return void 0===n||i.hasNode(n)?r[e]=n:n in r?r[n]:t(n)}(t))}),i},Graph.prototype.setDefaultEdgeLabel=function(t){return lodash_1.isFunction(t)||(t=lodash_1.constant(t)),this._defaultEdgeLabelFn=t,this},Graph.prototype.edgeCount=function(){return this._edgeCount},Graph.prototype.edges=function(){return lodash_1.values(this._edgeObjs)},Graph.prototype.setPath=function(t,n){var i=this,a=arguments;return lodash_1.reduce(t,function(t,e){return 1<a.length?i.setEdge(t,e,n):i.setEdge(t,e),e}),this},Graph.prototype.setEdge=function(){var t,e,n=!1,i=arguments[0],i=("object"==typeof i&&null!==i&&"v"in i?(a=i.v,r=i.w,t=i.name,2===arguments.length&&(e=arguments[1],n=!0)):(a=i,r=arguments[1],t=arguments[3],2<arguments.length&&(e=arguments[2],n=!0)),a=""+a,r=""+r,lodash_1.isUndefined(t)||(t=""+t),edgeArgsToId(this._isDirected,a,r,t));if(lodash_1.has(this._edgeLabels,i))n&&(this._edgeLabels[i]=e);else{if(!lodash_1.isUndefined(t)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(a),this.setNode(r),this._edgeLabels[i]=n?e:this._defaultEdgeLabelFn(a,r,t);var n=edgeArgsToObj(this._isDirected,a,r,t),a=n.v,r=n.w;Object.freeze(n),this._edgeObjs[i]=n,incrementOrInitEntry(this._preds[r],a),incrementOrInitEntry(this._sucs[a],r),this._in[r][i]=n,this._out[a][i]=n,this._edgeCount++}return this},Graph.prototype.edge=function(t,e,n){t=1===arguments.length?edgeObjToId(this._isDirected,t):edgeArgsToId(this._isDirected,t,e,n);return this._edgeLabels[t]},Graph.prototype.hasEdge=function(t,e,n){t=1===arguments.length?edgeObjToId(this._isDirected,t):edgeArgsToId(this._isDirected,t,e,n);return lodash_1.has(this._edgeLabels,t)},Graph.prototype.removeEdge=function(t,e,n){var n=1===arguments.length?edgeObjToId(this._isDirected,arguments[0]):edgeArgsToId(this._isDirected,t,e,n),i=this._edgeObjs[n];return i&&(t=i.v,e=i.w,delete this._edgeLabels[n],delete this._edgeObjs[n],decrementOrRemoveEntry(this._preds[e],t),decrementOrRemoveEntry(this._sucs[t],e),delete this._in[e][n],delete this._out[t][n],this._edgeCount--),this},Graph.prototype.inEdges=function(t,e){var t=this._in[t];if(t)return t=lodash_1.values(t),e?lodash_1.filter(t,function(t){return t.v===e}):t},Graph.prototype.outEdges=function(t,e){var t=this._out[t];if(t)return t=lodash_1.values(t),e?lodash_1.filter(t,function(t){return t.w===e}):t},Graph.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))};var version="2.1.8",lib={Graph:graph,version:version},json={write:write,read:read};function write(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:writeNodes(t),edges:writeEdges(t)};return lodash_1.isUndefined(t.graph())||(e.value=lodash_1.clone(t.graph())),e}function writeNodes(i){return lodash_1.map(i.nodes(),function(t){var e=i.node(t),n=i.parent(t),t={v:t};return lodash_1.isUndefined(e)||(t.value=e),lodash_1.isUndefined(n)||(t.parent=n),t})}function writeEdges(i){return lodash_1.map(i.edges(),function(t){var e=i.edge(t),n={v:t.v,w:t.w};return lodash_1.isUndefined(t.name)||(n.name=t.name),lodash_1.isUndefined(e)||(n.value=e),n})}function read(t){var e=new graph(t.options).setGraph(t.value);return lodash_1.each(t.nodes,function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)}),lodash_1.each(t.edges,function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)}),e}var components_1=components;function components(e){var n,i={},a=[];function r(t){lodash_1.has(i,t)||(i[t]=!0,n.push(t),lodash_1.each(e.successors(t),r),lodash_1.each(e.predecessors(t),r))}return lodash_1.each(e.nodes(),function(t){n=[],r(t),n.length&&a.push(n)}),a}var priorityQueue=PriorityQueue;function PriorityQueue(){this._arr=[],this._keyIndices={}}PriorityQueue.prototype.size=function(){return this._arr.length},PriorityQueue.prototype.keys=function(){return this._arr.map(function(t){return t.key})},PriorityQueue.prototype.has=function(t){return lodash_1.has(this._keyIndices,t)},PriorityQueue.prototype.priority=function(t){t=this._keyIndices[t];if(void 0!==t)return this._arr[t].priority},PriorityQueue.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},PriorityQueue.prototype.add=function(t,e){var n,i,a=this._keyIndices;return t=String(t),!lodash_1.has(a,t)&&(i=(n=this._arr).length,a[t]=i,n.push({key:t,priority:e}),this._decrease(i),!0)},PriorityQueue.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},PriorityQueue.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},PriorityQueue.prototype._heapify=function(t){var e=this._arr,n=2*t,i=1+n,a=t;n<e.length&&(a=e[n].priority<e[a].priority?n:a,(a=i<e.length?e[i].priority<e[a].priority?i:a:a)!==t&&(this._swap(t,a),this._heapify(a)))},PriorityQueue.prototype._decrease=function(t){for(var e,n=this._arr,i=n[t].priority;0!==t&&!(n[e=t>>1].priority<i);)this._swap(t,e),t=e},PriorityQueue.prototype._swap=function(t,e){var n=this._arr,i=this._keyIndices,a=n[t],r=n[e];n[t]=r,n[e]=a,i[r.key]=t,i[a.key]=e};var dijkstra_1=dijkstra,DEFAULT_WEIGHT_FUNC=lodash_1.constant(1);function dijkstra(e,t,n,i){return runDijkstra(e,String(t),n||DEFAULT_WEIGHT_FUNC,i||function(t){return e.outEdges(t)})}function runDijkstra(t,n,r,e){function i(t){var e=t.v!==o?t.v:t.w,n=s[e],i=r(t),a=l.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);a<n.distance&&(n.distance=a,n.predecessor=o,u.decrease(e,a))}var o,l,s={},u=new priorityQueue;for(t.nodes().forEach(function(t){var e=t===n?0:Number.POSITIVE_INFINITY;s[t]={distance:e},u.add(t,e)});0<u.size()&&(o=u.removeMin(),(l=s[o]).distance!==Number.POSITIVE_INFINITY);)e(o).forEach(i);return s}var dijkstraAll_1=dijkstraAll;function dijkstraAll(n,i,a){return lodash_1.transform(n.nodes(),function(t,e){t[e]=dijkstra_1(n,e,i,a)},{})}var tarjan_1=tarjan;function tarjan(r){var o=0,l=[],s={},u=[];return r.nodes().forEach(function(t){lodash_1.has(s,t)||!function e(t){var n=s[t]={onStack:!0,lowlink:o,index:o++};if(l.push(t),r.successors(t).forEach(function(t){lodash_1.has(s,t)?s[t].onStack&&(n.lowlink=Math.min(n.lowlink,s[t].index)):(e(t),n.lowlink=Math.min(n.lowlink,s[t].lowlink))}),n.lowlink===n.index){for(var i,a=[];i=l.pop(),s[i].onStack=!1,a.push(i),t!==i;);u.push(a)}}(t)}),u}var findCycles_1=findCycles;function findCycles(e){return lodash_1.filter(tarjan_1(e),function(t){return 1<t.length||1===t.length&&e.hasEdge(t[0],t[0])})}var floydWarshall_1=floydWarshall,DEFAULT_WEIGHT_FUNC$1=lodash_1.constant(1);function floydWarshall(e,t,n){return runFloydWarshall(e,t||DEFAULT_WEIGHT_FUNC$1,n||function(t){return e.outEdges(t)})}function runFloydWarshall(t,i,e){var o={},l=t.nodes();return l.forEach(function(n){o[n]={},o[n][n]={distance:0},l.forEach(function(t){n!==t&&(o[n][t]={distance:Number.POSITIVE_INFINITY})}),e(n).forEach(function(t){var e=t.v===n?t.w:t.v,t=i(t);o[n][e]={distance:t,predecessor:n}})}),l.forEach(function(a){var r=o[a];l.forEach(function(t){var i=o[t];l.forEach(function(t){var e=i[a],n=r[t],t=i[t],e=e.distance+n.distance;e<t.distance&&(t.distance=e,t.predecessor=n.predecessor)})})}),o}var topsort_1=topsort;function topsort(n){var i={},a={},r=[];if(lodash_1.each(n.sinks(),function t(e){if(lodash_1.has(a,e))throw new CycleException;lodash_1.has(i,e)||(a[e]=!0,i[e]=!0,lodash_1.each(n.predecessors(e),t),delete a[e],r.push(e))}),lodash_1.size(i)!==n.nodeCount())throw new CycleException;return r}function CycleException(){}(topsort.CycleException=CycleException).prototype=new Error;var isAcyclic_1=isAcyclic;function isAcyclic(t){try{topsort_1(t)}catch(t){if(t instanceof topsort_1.CycleException)return!1;throw t}return!0}var dfs_1=dfs;function dfs(e,t,n){lodash_1.isArray(t)||(t=[t]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),a=[],r={};return lodash_1.each(t,function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);doDfs(e,t,"post"===n,r,i,a)}),a}function doDfs(e,t,n,i,a,r){lodash_1.has(i,t)||(i[t]=!0,n||r.push(t),lodash_1.each(a(t),function(t){doDfs(e,t,n,i,a,r)}),n&&r.push(t))}var postorder_1=postorder;function postorder(t,e){return dfs_1(t,e,"post")}var preorder_1=preorder;function preorder(t,e){return dfs_1(t,e,"pre")}var prim_1=prim;function prim(t,i){var a,e=new graph,r={},o=new priorityQueue;function n(t){var e=t.v===a?t.w:t.v,n=o.priority(e);void 0!==n&&(t=i(t))<n&&(r[e]=a,o.decrease(e,t))}if(0!==t.nodeCount()){lodash_1.each(t.nodes(),function(t){o.add(t,Number.POSITIVE_INFINITY),e.setNode(t)}),o.decrease(t.nodes()[0],0);for(var l=!1;0<o.size();){if(a=o.removeMin(),lodash_1.has(r,a))e.setEdge(a,r[a]);else{if(l)throw new Error("Input graph is not connected: "+t);l=!0}t.nodeEdges(a).forEach(n)}}return e}var alg={components:components_1,dijkstra:dijkstra_1,dijkstraAll:dijkstraAll_1,findCycles:findCycles_1,floydWarshall:floydWarshall_1,isAcyclic:isAcyclic,postorder:postorder,preorder:preorder,prim:prim,tarjan:tarjan_1,topsort:topsort_1},_graphlib_2_1_8_graphlib={Graph:lib.Graph,json:json,alg:alg,version:lib.version};if("function"==typeof commonjsRequire)try{graphlib=_graphlib_2_1_8_graphlib}catch(t){}var graphlib,graphlib_1=graphlib=graphlib||window.graphlib,CLONE_DEEP_FLAG$1=1,CLONE_SYMBOLS_FLAG$2=4;function cloneDeep(t){return _baseClone(t,CLONE_DEEP_FLAG$1|CLONE_SYMBOLS_FLAG$2)}var cloneDeep_1=cloneDeep;function isIterateeCall(t,e,n){if(!isObject_1(n))return!1;var i=typeof e;return!!("number"==i?isArrayLike_1(n)&&_isIndex(e,n.length):"string"==i&&e in n)&&eq_1(n[e],t)}var _isIterateeCall=isIterateeCall,objectProto$h=Object.prototype,hasOwnProperty$f=objectProto$h.hasOwnProperty,defaults=_baseRest(function(t,e){t=Object(t);var n=-1,i=e.length,a=2<i?e[2]:void 0;for(a&&_isIterateeCall(e[0],e[1],a)&&(i=1);++n<i;)for(var r=e[n],o=keysIn_1(r),l=-1,s=o.length;++l<s;){var u=o[l],d=t[u];(void 0===d||eq_1(d,objectProto$h[u])&&!hasOwnProperty$f.call(t,u))&&(t[u]=r[u])}return t}),defaults_1=defaults;function createFind(r){return function(t,e,n){var i,a=Object(t),e=(isArrayLike_1(t)||(i=_baseIteratee(e),t=keys_1(t),e=function(t){return i(a[t],t,a)}),r(t,e,n));return-1<e?a[i?t[e]:e]:void 0}}var _createFind=createFind,reWhitespace=/\s/;function trimmedEndIndex(t){for(var e=t.length;e--&&reWhitespace.test(t.charAt(e)););return e}var _trimmedEndIndex=trimmedEndIndex,reTrimStart=/^\s+/;function baseTrim(t){return t&&t.slice(0,_trimmedEndIndex(t)+1).replace(reTrimStart,"")}var _baseTrim=baseTrim,NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(t){if("number"==typeof t)return t;if(isSymbol_1(t))return NAN;if(isObject_1(t)&&(e="function"==typeof t.valueOf?t.valueOf():t,t=isObject_1(e)?e+"":e),"string"!=typeof t)return 0===t?t:+t;t=_baseTrim(t);var e=reIsBinary.test(t);return e||reIsOctal.test(t)?freeParseInt(t.slice(2),e?2:8):reIsBadHex.test(t)?NAN:+t}var toNumber_1=toNumber,INFINITY$3=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(t){return t?(t=toNumber_1(t))===INFINITY$3||t===-INFINITY$3?(t<0?-1:1)*MAX_INTEGER:t==t?t:0:0===t?t:0}var toFinite_1=toFinite;function toInteger(t){var t=toFinite_1(t),e=t%1;return t==t?e?t-e:t:0}var toInteger_1=toInteger,nativeMax$1=Math.max;function findIndex(t,e,n){var i=null==t?0:t.length;if(!i)return-1;n=null==n?0:toInteger_1(n);return n<0&&(n=nativeMax$1(i+n,0)),_baseFindIndex(t,_baseIteratee(e),n)}var findIndex_1=findIndex,find=_createFind(findIndex),find_1=find;function flatten$1(t){return(null==t?0:t.length)?_baseFlatten(t,1):[]}var flatten_1=flatten$1;function forIn(t,e){return null==t?t:_baseFor(t,_castFunction(e),keysIn_1)}var forIn_1=forIn;function last(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var last_1=last;function mapValues(t,i){var a={};return i=_baseIteratee(i),_baseForOwn(t,function(t,e,n){_baseAssignValue(a,e,i(t,e,n))}),a}var mapValues_1=mapValues;function baseExtremum(t,e,n){for(var i=-1,a=t.length;++i<a;){var r,o,l=t[i],s=e(l);null!=s&&(void 0===r?s==s&&!isSymbol_1(s):n(s,r))&&(r=s,o=l)}return o}var _baseExtremum=baseExtremum;function baseGt(t,e){return e<t}var _baseGt=baseGt;function max(t){return t&&t.length?_baseExtremum(t,identity_1,_baseGt):void 0}var max_1=max;function assignMergeValue(t,e,n){(void 0===n||eq_1(t[e],n))&&(void 0!==n||e in t)||_baseAssignValue(t,e,n)}var _assignMergeValue=assignMergeValue,objectTag$4="[object Object]",funcProto$2=Function.prototype,objectProto$i=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$g=objectProto$i.hasOwnProperty,objectCtorString=funcToString$2.call(Object);function isPlainObject(t){if(!isObjectLike_1(t)||_baseGetTag(t)!=objectTag$4)return!1;t=_getPrototype(t);if(null===t)return!0;t=hasOwnProperty$g.call(t,"constructor")&&t.constructor;return"function"==typeof t&&t instanceof t&&funcToString$2.call(t)==objectCtorString}var isPlainObject_1=isPlainObject;function safeGet(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var _safeGet=safeGet;function toPlainObject(t){return _copyObject(t,keysIn_1(t))}var toPlainObject_1=toPlainObject;function baseMergeDeep(t,e,n,i,a,r,o){var l,s,u,d=_safeGet(t,n),h=_safeGet(e,n),c=o.get(h);c||((e=void 0===(c=r?r(d,h,n+"",t,e,o):void 0))&&(s=!(l=isArray_1(h))&&isBuffer_1(h),u=!l&&!s&&isTypedArray_1(h),c=h,l||s||u?c=isArray_1(d)?d:isArrayLikeObject_1(d)?_copyArray(d):s?_cloneBuffer(h,!(e=!1)):u?_cloneTypedArray(h,!(e=!1)):[]:isPlainObject_1(h)||isArguments_1(h)?isArguments_1(c=d)?c=toPlainObject_1(d):isObject_1(d)&&!isFunction_1(d)||(c=_initCloneObject(h)):e=!1),e&&(o.set(h,c),a(c,h,i,r,o),o.delete(h))),_assignMergeValue(t,n,c)}var _baseMergeDeep=baseMergeDeep;function baseMerge(i,a,r,o,l){i!==a&&_baseFor(a,function(t,e){var n;l=l||new _Stack,isObject_1(t)?_baseMergeDeep(i,a,e,r,baseMerge,o,l):(n=o?o(_safeGet(i,e),t,e+"",i,a,l):void 0,_assignMergeValue(i,e,n=void 0===n?t:n))},keysIn_1)}var _baseMerge=baseMerge;function createAssigner(l){return _baseRest(function(t,e){var n=-1,i=e.length,a=1<i?e[i-1]:void 0,r=2<i?e[2]:void 0,a=3<l.length&&"function"==typeof a?(i--,a):void 0;for(r&&_isIterateeCall(e[0],e[1],r)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var o=e[n];o&&l(t,o,n,a)}return t})}var _createAssigner=createAssigner,merge=createAssigner(function(t,e,n){_baseMerge(t,e,n)}),merge_1=merge;function baseLt(t,e){return t<e}var _baseLt=baseLt;function min(t){return t&&t.length?_baseExtremum(t,identity_1,_baseLt):void 0}var min_1=min;function minBy(t,e){return t&&t.length?_baseExtremum(t,_baseIteratee(e),_baseLt):void 0}var minBy_1=minBy,now$2=function(){return _root.Date.now()},now_1=now$2;function baseSet(t,e,n,i){if(isObject_1(t))for(var a=-1,r=(e=_castPath(e,t)).length,o=r-1,l=t;null!=l&&++a<r;){var s,u=_toKey(e[a]),d=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return t;a!=o&&(s=l[u],void 0===(d=i?i(s,u,l):void 0)&&(d=isObject_1(s)?s:_isIndex(e[a+1])?[]:{})),_assignValue(l,u,d),l=l[u]}return t}var _baseSet=baseSet;function basePickBy(t,e,n){for(var i=-1,a=e.length,r={};++i<a;){var o=e[i],l=_baseGet(t,o);n(l,o)&&_baseSet(r,_castPath(o,t),l)}return r}var _basePickBy=basePickBy;function basePick(n,t){return _basePickBy(n,t,function(t,e){return hasIn_1(n,e)})}var _basePick=basePick;function flatRest(t){return _setToString(_overRest(t,void 0,flatten_1),t+"")}var _flatRest=flatRest,pick=flatRest(function(t,e){return null==t?{}:_basePick(t,e)}),pick_1=pick,nativeCeil=Math.ceil,nativeMax$2=Math.max;function baseRange(t,e,n,i){for(var a=-1,r=nativeMax$2(nativeCeil((e-t)/(n||1)),0),o=Array(r);r--;)o[i?r:++a]=t,t+=n;return o}var _baseRange=baseRange;function createRange(i){return function(t,e,n){return n&&"number"!=typeof n&&_isIterateeCall(t,e,n)&&(e=n=void 0),t=toFinite_1(t),void 0===e?(e=t,t=0):e=toFinite_1(e),n=void 0===n?t<e?1:-1:toFinite_1(n),_baseRange(t,e,n,i)}}var _createRange=createRange,range=createRange(),range_1=range;function baseSortBy(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}var _baseSortBy=baseSortBy;function compareAscending(t,e){if(t!==e){var n=void 0!==t,i=null===t,a=t==t,r=isSymbol_1(t),o=void 0!==e,l=null===e,s=e==e,u=isSymbol_1(e);if(!l&&!u&&!r&&e<t||r&&o&&s&&!l&&!u||i&&o&&s||!n&&s||!a)return 1;if(!i&&!r&&!u&&t<e||u&&n&&a&&!i&&!r||l&&n&&a||!o&&a||!s)return-1}return 0}var _compareAscending=compareAscending;function compareMultiple(t,e,n){for(var i=-1,a=t.criteria,r=e.criteria,o=a.length,l=n.length;++i<o;){var s=_compareAscending(a[i],r[i]);if(s)return l<=i?s:s*("desc"==n[i]?-1:1)}return t.index-e.index}var _compareMultiple=compareMultiple;function baseOrderBy(t,i,n){i=i.length?_arrayMap(i,function(e){return isArray_1(e)?function(t){return _baseGet(t,1===e.length?e[0]:e)}:e}):[identity_1];var a=-1,t=(i=_arrayMap(i,_baseUnary(_baseIteratee)),_baseMap(t,function(e,t,n){return{criteria:_arrayMap(i,function(t){return t(e)}),index:++a,value:e}}));return _baseSortBy(t,function(t,e){return _compareMultiple(t,e,n)})}var _baseOrderBy=baseOrderBy,sortBy=_baseRest(function(t,e){if(null==t)return[];var n=e.length;return 1<n&&_isIterateeCall(t,e[0],e[1])?e=[]:2<n&&_isIterateeCall(e[0],e[1],e[2])&&(e=[e[0]]),_baseOrderBy(t,_baseFlatten(e,1),[])}),sortBy_1=sortBy,idCounter=0;function uniqueId(t){var e=++idCounter;return toString_1(t)+e}var uniqueId_1=uniqueId;function baseZipObject(t,e,n){for(var i=-1,a=t.length,r=e.length,o={};++i<a;){var l=i<r?e[i]:void 0;n(o,t[i],l)}return o}var _baseZipObject=baseZipObject;function zipObject(t,e){return _baseZipObject(t||[],e||[],_assignValue)}var zipObject_1=zipObject;if("function"==typeof commonjsRequire)try{lodash$1={cloneDeep:cloneDeep_1,constant:constant_1,defaults:defaults_1,each:each$1,filter:filter_1,find:find_1,flatten:flatten_1,forEach:forEach_1,forIn:forIn_1,has:has_1,isUndefined:isUndefined_1,last:last_1,map:map_1,mapValues:mapValues_1,max:max_1,merge:merge_1,min:min_1,minBy:minBy_1,now:now_1,pick:pick_1,range:range_1,reduce:reduce_1,sortBy:sortBy_1,uniqueId:uniqueId_1,values:values_1,zipObject:zipObject_1}}catch(t){}var lodash$1,lodash_1$1=lodash$1=lodash$1||window._,list=List;function List(){var t={};t._next=t._prev=t,this._sentinel=t}function unlink(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function filterOutLinks(t,e){if("_next"!==t&&"_prev"!==t)return e}List.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return unlink(e),e},List.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&unlink(t),t._next=e._next,e._next._prev=t,(e._next=t)._prev=e},List.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,filterOutLinks)),n=n._prev;return"["+t.join(", ")+"]"};var Graph$1=graphlib_1.Graph,greedyFas=greedyFAS,DEFAULT_WEIGHT_FN=lodash_1$1.constant(1);function greedyFAS(e,t){if(e.nodeCount()<=1)return[];t=buildState(e,t||DEFAULT_WEIGHT_FN),t=doGreedyFAS(t.graph,t.buckets,t.zeroIdx);return lodash_1$1.flatten(lodash_1$1.map(t,function(t){return e.outEdges(t.v,t.w)}),!0)}function doGreedyFAS(t,e,n){for(var i,a=[],r=e[e.length-1],o=e[0];t.nodeCount();){for(;i=o.dequeue();)removeNode(t,e,n,i);for(;i=r.dequeue();)removeNode(t,e,n,i);if(t.nodeCount())for(var l=e.length-2;0<l;--l)if(i=e[l].dequeue()){a=a.concat(removeNode(t,e,n,i,!0));break}}return a}function removeNode(i,a,r,t,o){var l=o?[]:void 0;return lodash_1$1.forEach(i.inEdges(t.v),function(t){var e=i.edge(t),n=i.node(t.v);o&&l.push({v:t.v,w:t.w}),n.out-=e,assignBucket(a,r,n)}),lodash_1$1.forEach(i.outEdges(t.v),function(t){var e=i.edge(t),t=t.w,t=i.node(t);t.in-=e,assignBucket(a,r,t)}),i.removeNode(t.v),l}function buildState(t,i){var a=new Graph$1,r=0,o=0,e=(lodash_1$1.forEach(t.nodes(),function(t){a.setNode(t,{v:t,in:0,out:0})}),lodash_1$1.forEach(t.edges(),function(t){var e=a.edge(t.v,t.w)||0,n=i(t);a.setEdge(t.v,t.w,e+n),o=Math.max(o,a.node(t.v).out+=n),r=Math.max(r,a.node(t.w).in+=n)}),lodash_1$1.range(o+r+3).map(function(){return new list})),n=r+1;return lodash_1$1.forEach(a.nodes(),function(t){assignBucket(e,n,a.node(t))}),{graph:a,buckets:e,zeroIdx:n}}function assignBucket(t,e,n){(n.out?n.in?t[n.out-n.in+e]:t[t.length-1]:t[0]).enqueue(n)}var acyclic={run:run,undo:undo};function run(n){var e,t="greedy"===n.graph().acyclicer?greedyFas(n,(e=n,function(t){return e.edge(t).weight})):dfsFAS(n);lodash_1$1.forEach(t,function(t){var e=n.edge(t);n.removeEdge(t),e.forwardName=t.name,e.reversed=!0,n.setEdge(t.w,t.v,e,lodash_1$1.uniqueId("rev"))})}function dfsFAS(n){var i=[],a={},r={};return lodash_1$1.forEach(n.nodes(),function e(t){lodash_1$1.has(r,t)||(r[t]=!0,a[t]=!0,lodash_1$1.forEach(n.outEdges(t),function(t){lodash_1$1.has(a,t.w)?i.push(t):e(t.w)}),delete a[t])}),i}function undo(i){lodash_1$1.forEach(i.edges(),function(t){var e,n=i.edge(t);n.reversed&&(i.removeEdge(t),e=n.forwardName,delete n.reversed,delete n.forwardName,i.setEdge(t.w,t.v,n,e))})}var Graph$2=graphlib_1.Graph,util={addDummyNode:addDummyNode,simplify:simplify,asNonCompoundGraph:asNonCompoundGraph,successorWeights:successorWeights,predecessorWeights:predecessorWeights,intersectRect:intersectRect,buildLayerMatrix:buildLayerMatrix,normalizeRanks:normalizeRanks,removeEmptyRanks:removeEmptyRanks,addBorderNode:addBorderNode,maxRank:maxRank,partition:partition$1,time:time,notime:notime};function addDummyNode(t,e,n,i){for(var a;a=lodash_1$1.uniqueId(i),t.hasNode(a););return n.dummy=e,t.setNode(a,n),a}function simplify(i){var a=(new Graph$2).setGraph(i.graph());return lodash_1$1.forEach(i.nodes(),function(t){a.setNode(t,i.node(t))}),lodash_1$1.forEach(i.edges(),function(t){var e=a.edge(t.v,t.w)||{weight:0,minlen:1},n=i.edge(t);a.setEdge(t.v,t.w,{weight:e.weight+n.weight,minlen:Math.max(e.minlen,n.minlen)})}),a}function asNonCompoundGraph(e){var n=new Graph$2({multigraph:e.isMultigraph()}).setGraph(e.graph());return lodash_1$1.forEach(e.nodes(),function(t){e.children(t).length||n.setNode(t,e.node(t))}),lodash_1$1.forEach(e.edges(),function(t){n.setEdge(t,e.edge(t))}),n}function successorWeights(n){var t=lodash_1$1.map(n.nodes(),function(t){var e={};return lodash_1$1.forEach(n.outEdges(t),function(t){e[t.w]=(e[t.w]||0)+n.edge(t).weight}),e});return lodash_1$1.zipObject(n.nodes(),t)}function predecessorWeights(n){var t=lodash_1$1.map(n.nodes(),function(t){var e={};return lodash_1$1.forEach(n.inEdges(t),function(t){e[t.v]=(e[t.v]||0)+n.edge(t).weight}),e});return lodash_1$1.zipObject(n.nodes(),t)}function intersectRect(t,e){var n,i=t.x,a=t.y,r=e.x-i,e=e.y-a,o=t.width/2,t=t.height/2;if(r||e)return t=Math.abs(e)*o>Math.abs(r)*t?(n=(t=e<0?-t:t)*r/e,t):(n=o=r<0?-o:o)*e/r,{x:i+n,y:a+t};throw new Error("Not possible to find intersection inside of the rectangle")}function buildLayerMatrix(i){var a=lodash_1$1.map(lodash_1$1.range(maxRank(i)+1),function(){return[]});return lodash_1$1.forEach(i.nodes(),function(t){var e=i.node(t),n=e.rank;lodash_1$1.isUndefined(n)||(a[n][e.order]=t)}),a}function normalizeRanks(e){var n=lodash_1$1.min(lodash_1$1.map(e.nodes(),function(t){return e.node(t).rank}));lodash_1$1.forEach(e.nodes(),function(t){t=e.node(t);lodash_1$1.has(t,"rank")&&(t.rank-=n)})}function removeEmptyRanks(n){var i=lodash_1$1.min(lodash_1$1.map(n.nodes(),function(t){return n.node(t).rank})),a=[],r=(lodash_1$1.forEach(n.nodes(),function(t){var e=n.node(t).rank-i;a[e]||(a[e]=[]),a[e].push(t)}),0),o=n.graph().nodeRankFactor;lodash_1$1.forEach(a,function(t,e){lodash_1$1.isUndefined(t)&&e%o!=0?--r:r&&lodash_1$1.forEach(t,function(t){n.node(t).rank+=r})})}function addBorderNode(t,e,n,i){var a={width:0,height:0};return 4<=arguments.length&&(a.rank=n,a.order=i),addDummyNode(t,"border",a,e)}function maxRank(e){return lodash_1$1.max(lodash_1$1.map(e.nodes(),function(t){t=e.node(t).rank;if(!lodash_1$1.isUndefined(t))return t}))}function partition$1(t,e){var n={lhs:[],rhs:[]};return lodash_1$1.forEach(t,function(t){(e(t)?n.lhs:n.rhs).push(t)}),n}function time(t,e){var n=lodash_1$1.now();try{return e()}finally{console.log(t+" time: "+(lodash_1$1.now()-n)+"ms")}}function notime(t,e){return e()}var normalize={run:run$1,undo:undo$1};function run$1(e){e.graph().dummyChains=[],lodash_1$1.forEach(e.edges(),function(t){normalizeEdge(e,t)})}function normalizeEdge(t,e){var n,i,a,r=e.v,o=t.node(r).rank,l=e.w,s=t.node(l).rank,u=e.name,d=t.edge(e),h=d.labelRank;if(s!==o+1){for(t.removeEdge(e),a=0,++o;o<s;++a,++o)d.points=[],n=util.addDummyNode(t,"edge",i={width:0,height:0,edgeLabel:d,edgeObj:e,rank:o},"_d"),o===h&&(i.width=d.width,i.height=d.height,i.dummy="edge-label",i.labelpos=d.labelpos),t.setEdge(r,n,{weight:d.weight},u),0===a&&t.graph().dummyChains.push(n),r=n;t.setEdge(r,l,{weight:d.weight},u)}}function undo$1(a){lodash_1$1.forEach(a.graph().dummyChains,function(t){var e,n=a.node(t),i=n.edgeLabel;for(a.setEdge(n.edgeObj,i);n.dummy;)e=a.successors(t)[0],a.removeNode(t),i.points.push({x:n.x,y:n.y}),"edge-label"===n.dummy&&(i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height),n=a.node(t=e)})}var util$1={longestPath:longestPath,slack:slack};function longestPath(i){var a={};lodash_1$1.forEach(i.sources(),function e(t){var n=i.node(t);if(lodash_1$1.has(a,t))return n.rank;a[t]=!0;t=lodash_1$1.min(lodash_1$1.map(i.outEdges(t),function(t){return e(t.w)-i.edge(t).minlen}));return t!==Number.POSITIVE_INFINITY&&null!=t||(t=0),n.rank=t})}function slack(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}var Graph$3=graphlib_1.Graph,slack$1=util$1.slack,feasibleTree_1=feasibleTree;function feasibleTree(t){var e,n=new Graph$3({directed:!1}),i=t.nodes()[0],a=t.nodeCount();for(n.setNode(i,{});tightTree(n,t)<a;)e=findMinSlackEdge(n,t),e=n.hasNode(e.v)?slack$1(t,e):-slack$1(t,e),shiftRanks(n,t,e);return n}function tightTree(a,r){return lodash_1$1.forEach(a.nodes(),function n(i){lodash_1$1.forEach(r.nodeEdges(i),function(t){var e=t.v,e=i===e?t.w:e;a.hasNode(e)||slack$1(r,t)||(a.setNode(e,{}),a.setEdge(i,e,{}),n(e))})}),a.nodeCount()}function findMinSlackEdge(e,n){return lodash_1$1.minBy(n.edges(),function(t){if(e.hasNode(t.v)!==e.hasNode(t.w))return slack$1(n,t)})}function shiftRanks(t,e,n){lodash_1$1.forEach(t.nodes(),function(t){e.node(t).rank+=n})}var slack$2=util$1.slack,initRank=util$1.longestPath,preorder$1=graphlib_1.alg.preorder,postorder$1=graphlib_1.alg.postorder,simplify$1=util.simplify,networkSimplex_1=networkSimplex;function networkSimplex(t){t=simplify$1(t),initRank(t);var e,n=feasibleTree_1(t);for(initLowLimValues(n),initCutValues(n,t);e=leaveEdge(n);)exchangeEdges(n,t,e,enterEdge(n,t,e))}function initCutValues(e,n){var t=(t=postorder$1(e,e.nodes())).slice(0,t.length-1);lodash_1$1.forEach(t,function(t){assignCutValue(e,n,t)})}function assignCutValue(t,e,n){var i=t.node(n).parent;t.edge(n,i).cutvalue=calcCutValue(t,e,n)}function calcCutValue(i,a,r){var o=i.node(r).parent,l=!0,t=a.edge(r,o),s=0;return t||(l=!1,t=a.edge(o,r)),s=t.weight,lodash_1$1.forEach(a.nodeEdges(r),function(t){var e=t.v===r,n=e?t.w:t.v;n!==o&&(e=e===l,t=a.edge(t).weight,s+=e?t:-t,isTreeEdge(i,r,n)&&(t=i.edge(r,n).cutvalue,s+=e?-t:t))}),s}function initLowLimValues(t,e){arguments.length<2&&(e=t.nodes()[0]),dfsAssignLowLim(t,{},1,e)}function dfsAssignLowLim(e,n,i,a,t){var r=i,o=e.node(a);return n[a]=!0,lodash_1$1.forEach(e.neighbors(a),function(t){lodash_1$1.has(n,t)||(i=dfsAssignLowLim(e,n,i,t,a))}),o.low=r,o.lim=i++,t?o.parent=t:delete o.parent,i}function leaveEdge(e){return lodash_1$1.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function enterEdge(e,n,t){var i=t.v,a=t.w,t=(n.hasEdge(i,a)||(i=t.w,a=t.v),e.node(i)),i=e.node(a),r=t,o=!1,a=(t.lim>i.lim&&(r=i,o=!0),lodash_1$1.filter(n.edges(),function(t){return o===isDescendant(e,e.node(t.v),r)&&o!==isDescendant(e,e.node(t.w),r)}));return lodash_1$1.minBy(a,function(t){return slack$2(n,t)})}function exchangeEdges(t,e,n,i){var a=n.v,n=n.w;t.removeEdge(a,n),t.setEdge(i.v,i.w,{}),initLowLimValues(t),initCutValues(t,e),updateRanks(t,e)}function updateRanks(a,r){var t=lodash_1$1.find(a.nodes(),function(t){return!r.node(t).parent}),t=(t=preorder$1(a,t)).slice(1);lodash_1$1.forEach(t,function(t){var e=a.node(t).parent,n=r.edge(t,e),i=!1;n||(n=r.edge(e,t),i=!0),r.node(t).rank=r.node(e).rank+(i?n.minlen:-n.minlen)})}function isTreeEdge(t,e,n){return t.hasEdge(e,n)}function isDescendant(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}networkSimplex.initLowLimValues=initLowLimValues,networkSimplex.initCutValues=initCutValues,networkSimplex.calcCutValue=calcCutValue,networkSimplex.leaveEdge=leaveEdge,networkSimplex.enterEdge=enterEdge,networkSimplex.exchangeEdges=exchangeEdges;var longestPath$1=util$1.longestPath,rank_1=rank;function rank(t){switch(t.graph().ranker){case"network-simplex":networkSimplexRanker(t);break;case"tight-tree":tightTreeRanker(t);break;case"longest-path":longestPathRanker(t);break;default:networkSimplexRanker(t)}}var longestPathRanker=longestPath$1;function tightTreeRanker(t){longestPath$1(t),feasibleTree_1(t)}function networkSimplexRanker(t){networkSimplex_1(t)}var parentDummyChains_1=parentDummyChains;function parentDummyChains(u){var d=postorder$2(u);lodash_1$1.forEach(u.graph().dummyChains,function(t){for(var e,n=u.node(t).edgeObj,i=findPath(u,d,n.v,n.w),a=i.path,r=i.lca,o=0,l=a[o],s=!0;t!==n.w;){if(e=u.node(t),s){for(;(l=a[o])!==r&&u.node(l).maxRank<e.rank;)o++;l===r&&(s=!1)}if(!s){for(;o<a.length-1&&u.node(l=a[o+1]).minRank<=e.rank;)o++;l=a[o]}u.setParent(t,l),t=u.successors(t)[0]}})}function findPath(t,e,n,i){for(var a,r=[],o=[],l=Math.min(e[n].low,e[i].low),s=Math.max(e[n].lim,e[i].lim),u=n;u=t.parent(u),r.push(u),u&&(e[u].low>l||s>e[u].lim););for(a=u,u=i;(u=t.parent(u))!==a;)o.push(u);return{path:r.concat(o.reverse()),lca:a}}function postorder$2(i){var a={},r=0;return lodash_1$1.forEach(i.children(),function t(e){var n=r;lodash_1$1.forEach(i.children(e),t),a[e]={low:n,lim:r++}}),a}var nestingGraph={run:run$2,cleanup:cleanup};function run$2(e){var n=util.addDummyNode(e,"root",{},"_root"),i=treeDepths(e),a=lodash_1$1.max(lodash_1$1.values(i))-1,r=2*a+1,o=(e.graph().nestingRoot=n,lodash_1$1.forEach(e.edges(),function(t){e.edge(t).minlen*=r}),sumWeights(e)+1);lodash_1$1.forEach(e.children(),function(t){dfs$1(e,n,r,o,a,i,t)}),e.graph().nodeRankFactor=r}function dfs$1(a,r,o,l,s,u,d){var h,c,t,e=a.children(d);e.length?(h=util.addBorderNode(a,"_bt"),c=util.addBorderNode(a,"_bb"),t=a.node(d),a.setParent(h,d),t.borderTop=h,a.setParent(c,d),t.borderBottom=c,lodash_1$1.forEach(e,function(t){dfs$1(a,r,o,l,s,u,t);var e=a.node(t),n=e.borderTop||t,t=e.borderBottom||t,e=e.borderTop?l:2*l,i=n!==t?1:s-u[d]+1;a.setEdge(h,n,{weight:e,minlen:i,nestingEdge:!0}),a.setEdge(t,c,{weight:e,minlen:i,nestingEdge:!0})}),a.parent(d)||a.setEdge(r,h,{weight:0,minlen:s+u[d]})):d!==r&&a.setEdge(r,d,{weight:0,minlen:o})}function treeDepths(a){var r={};return lodash_1$1.forEach(a.children(),function(t){!function e(t,n){var i=a.children(t);i&&i.length&&lodash_1$1.forEach(i,function(t){e(t,n+1)}),r[t]=n}(t,1)}),r}function sumWeights(n){return lodash_1$1.reduce(n.edges(),function(t,e){return t+n.edge(e).weight},0)}function cleanup(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,lodash_1$1.forEach(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t)})}var addBorderSegments_1=addBorderSegments;function addBorderSegments(o){lodash_1$1.forEach(o.children(),function t(e){var n=o.children(e),i=o.node(e);if(n.length&&lodash_1$1.forEach(n,t),lodash_1$1.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var a=i.minRank,r=i.maxRank+1;a<r;++a)addBorderNode$1(o,"borderLeft","_bl",e,i,a),addBorderNode$1(o,"borderRight","_br",e,i,a)}})}function addBorderNode$1(t,e,n,i,a,r){var o=a[e][r-1],n=util.addDummyNode(t,"border",{width:0,height:0,rank:r,borderType:e},n);a[e][r]=n,t.setParent(n,i),o&&t.setEdge(o,n,{weight:1})}var coordinateSystem={adjust:adjust,undo:undo$2};function adjust(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||swapWidthHeight(t)}function undo$2(t){var e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||reverseY(t),"lr"!==e&&"rl"!==e||(swapXY(t),swapWidthHeight(t))}function swapWidthHeight(e){lodash_1$1.forEach(e.nodes(),function(t){swapWidthHeightOne(e.node(t))}),lodash_1$1.forEach(e.edges(),function(t){swapWidthHeightOne(e.edge(t))})}function swapWidthHeightOne(t){var e=t.width;t.width=t.height,t.height=e}function reverseY(e){lodash_1$1.forEach(e.nodes(),function(t){reverseYOne(e.node(t))}),lodash_1$1.forEach(e.edges(),function(t){t=e.edge(t);lodash_1$1.forEach(t.points,reverseYOne),lodash_1$1.has(t,"y")&&reverseYOne(t)})}function reverseYOne(t){t.y=-t.y}function swapXY(e){lodash_1$1.forEach(e.nodes(),function(t){swapXYOne(e.node(t))}),lodash_1$1.forEach(e.edges(),function(t){t=e.edge(t);lodash_1$1.forEach(t.points,swapXYOne),lodash_1$1.has(t,"x")&&swapXYOne(t)})}function swapXYOne(t){var e=t.x;t.x=t.y,t.y=e}var initOrder_1=initOrder;function initOrder(i){var a={},t=lodash_1$1.filter(i.nodes(),function(t){return!i.children(t).length}),e=lodash_1$1.max(lodash_1$1.map(t,function(t){return i.node(t).rank})),r=lodash_1$1.map(lodash_1$1.range(e+1),function(){return[]});e=lodash_1$1.sortBy(t,function(t){return i.node(t).rank});return lodash_1$1.forEach(e,function t(e){var n;lodash_1$1.has(a,e)||(a[e]=!0,n=i.node(e),r[n.rank].push(e),lodash_1$1.forEach(i.successors(e),t))}),r}var crossCount_1=crossCount;function crossCount(t,e){for(var n=0,i=1;i<e.length;++i)n+=twoLayerCrossCount(t,e[i-1],e[i]);return n}function twoLayerCrossCount(e,t,n){for(var i=lodash_1$1.zipObject(n,lodash_1$1.map(n,function(t,e){return e})),t=lodash_1$1.flatten(lodash_1$1.map(t,function(t){return lodash_1$1.sortBy(lodash_1$1.map(e.outEdges(t),function(t){return{pos:i[t.w],weight:e.edge(t).weight}}),"pos")}),!0),a=1;a<n.length;)a<<=1;var r=2*a-1,o=(--a,lodash_1$1.map(new Array(r),function(){return 0})),l=0;return lodash_1$1.forEach(t.forEach(function(t){for(var e=t.pos+a,n=(o[e]+=t.weight,0);0<e;)e%2&&(n+=o[e+1]),o[e=e-1>>1]+=t.weight;l+=t.weight*n})),l}var barycenter_1=barycenter;function barycenter(i,t){return lodash_1$1.map(t,function(t){var e=i.inEdges(t);return e.length?{v:t,barycenter:(e=lodash_1$1.reduce(e,function(t,e){var n=i.edge(e),e=i.node(e.v);return{sum:t.sum+n.weight*e.order,weight:t.weight+n.weight}},{sum:0,weight:0})).sum/e.weight,weight:e.weight}:{v:t}})}var resolveConflicts_1=resolveConflicts;function resolveConflicts(t,e){var i={};return lodash_1$1.forEach(t,function(t,e){e=i[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};lodash_1$1.isUndefined(t.barycenter)||(e.barycenter=t.barycenter,e.weight=t.weight)}),lodash_1$1.forEach(e.edges(),function(t){var e=i[t.v],n=i[t.w];lodash_1$1.isUndefined(e)||lodash_1$1.isUndefined(n)||(n.indegree++,e.out.push(i[t.w]))}),doResolveConflicts(lodash_1$1.filter(i,function(t){return!t.indegree}))}function doResolveConflicts(n){var t=[];for(;n.length;){var e=n.pop();t.push(e),lodash_1$1.forEach(e.in.reverse(),function(e){return function(t){t.merged||(lodash_1$1.isUndefined(t.barycenter)||lodash_1$1.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&mergeEntries(e,t)}}(e)),lodash_1$1.forEach(e.out,function(e){return function(t){t.in.push(e),0==--t.indegree&&n.push(t)}}(e))}return lodash_1$1.map(lodash_1$1.filter(t,function(t){return!t.merged}),function(t){return lodash_1$1.pick(t,["vs","i","barycenter","weight"])})}function mergeEntries(t,e){var n=0,i=0;t.weight&&(n+=t.barycenter*t.weight,i+=t.weight),e.weight&&(n+=e.barycenter*e.weight,i+=e.weight),t.vs=e.vs.concat(t.vs),t.barycenter=n/i,t.weight=i,t.i=Math.min(e.i,t.i),e.merged=!0}var sort_1=sort;function sort(t,e){var t=util.partition(t,function(t){return lodash_1$1.has(t,"barycenter")}),n=t.lhs,i=lodash_1$1.sortBy(t.rhs,function(t){return-t.i}),a=[],r=0,o=0,l=0,t=(n.sort(compareWithBias(!!e)),l=consumeUnsortable(a,i,l),lodash_1$1.forEach(n,function(t){l+=t.vs.length,a.push(t.vs),r+=t.barycenter*t.weight,o+=t.weight,l=consumeUnsortable(a,i,l)}),{vs:lodash_1$1.flatten(a,!0)});return o&&(t.barycenter=r/o,t.weight=o),t}function consumeUnsortable(t,e,n){for(var i;e.length&&(i=lodash_1$1.last(e)).i<=n;)e.pop(),t.push(i.vs),n++;return n}function compareWithBias(n){return function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:n?e.i-t.i:t.i-e.i}}var sortSubgraph_1=sortSubgraph;function sortSubgraph(n,t,i,a){var e,r=n.children(t),t=n.node(t),o=t?t.borderLeft:void 0,l=t?t.borderRight:void 0,s={},t=(o&&(r=lodash_1$1.filter(r,function(t){return t!==o&&t!==l})),barycenter_1(n,r)),r=(lodash_1$1.forEach(t,function(t){var e;n.children(t.v).length&&(e=sortSubgraph(n,t.v,i,a),s[t.v]=e,lodash_1$1.has(e,"barycenter")&&mergeBarycenters(t,e))}),resolveConflicts_1(t,i)),t=(expandSubgraphs(r,s),sort_1(r,a));return o&&(t.vs=lodash_1$1.flatten([o,t.vs,l],!0),n.predecessors(o).length&&(r=n.node(n.predecessors(o)[0]),e=n.node(n.predecessors(l)[0]),lodash_1$1.has(t,"barycenter")||(t.barycenter=0,t.weight=0),t.barycenter=(t.barycenter*t.weight+r.order+e.order)/(t.weight+2),t.weight+=2)),t}function expandSubgraphs(t,e){lodash_1$1.forEach(t,function(t){t.vs=lodash_1$1.flatten(t.vs.map(function(t){return e[t]?e[t].vs:t}),!0)})}function mergeBarycenters(t,e){lodash_1$1.isUndefined(t.barycenter)?(t.barycenter=e.barycenter,t.weight=e.weight):(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight)}var Graph$4=graphlib_1.Graph,buildLayerGraph_1=buildLayerGraph;function buildLayerGraph(a,n,r){var o=createRootNode(a),l=new Graph$4({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(function(t){return a.node(t)});return lodash_1$1.forEach(a.nodes(),function(i){var t=a.node(i),e=a.parent(i);(t.rank===n||t.minRank<=n&&n<=t.maxRank)&&(l.setNode(i),l.setParent(i,e||o),lodash_1$1.forEach(a[r](i),function(t){var e=t.v===i?t.w:t.v,n=l.edge(e,i),n=lodash_1$1.isUndefined(n)?0:n.weight;l.setEdge(e,i,{weight:a.edge(t).weight+n})}),lodash_1$1.has(t,"minRank")&&l.setNode(i,{borderLeft:t.borderLeft[n],borderRight:t.borderRight[n]}))}),l}function createRootNode(t){for(var e;t.hasNode(e=lodash_1$1.uniqueId("_root")););return e}var addSubgraphConstraints_1=addSubgraphConstraints;function addSubgraphConstraints(a,r,t){var o,l={};lodash_1$1.forEach(t,function(t){for(var e,n,i=a.parent(t);i;){if((e=a.parent(i))?(n=l[e],l[e]=i):(n=o,o=i),n&&n!==i)return void r.setEdge(n,i);i=e}})}var Graph$5=graphlib_1.Graph,order_1=order;function order(t){for(var e,n=util.maxRank(t),i=buildLayerGraphs(t,lodash_1$1.range(1,n+1),"inEdges"),a=buildLayerGraphs(t,lodash_1$1.range(n-1,-1,-1),"outEdges"),r=(assignOrder(t,initOrder_1(t)),Number.POSITIVE_INFINITY),o=0,l=0;l<4;++o,++l){sweepLayerGraphs(o%2?i:a,2<=o%4);var s=util.buildLayerMatrix(t),u=crossCount_1(t,s);u<r&&(l=0,e=lodash_1$1.cloneDeep(s),r=u)}assignOrder(t,e)}function buildLayerGraphs(e,t,n){return lodash_1$1.map(t,function(t){return buildLayerGraph_1(e,t,n)})}function sweepLayerGraphs(t,e){var i=new Graph$5;lodash_1$1.forEach(t,function(n){var t=n.graph().root,t=sortSubgraph_1(n,t,i,e);lodash_1$1.forEach(t.vs,function(t,e){n.node(t).order=e}),addSubgraphConstraints_1(n,i,t.vs)})}function assignOrder(n,t){lodash_1$1.forEach(t,function(t){lodash_1$1.forEach(t,function(t,e){n.node(t).order=e})})}var Graph$6=graphlib_1.Graph,bk={positionX:positionX,findType1Conflicts:findType1Conflicts,findType2Conflicts:findType2Conflicts,addConflict:addConflict,hasConflict:hasConflict,verticalAlignment:verticalAlignment,horizontalCompaction:horizontalCompaction,alignCoordinates:alignCoordinates,findSmallestWidthAlignment:findSmallestWidthAlignment,balance:balance};function findType1Conflicts(u,t){var d={};return lodash_1$1.reduce(t,function(t,i){var r=0,o=0,l=t.length,s=lodash_1$1.last(i);return lodash_1$1.forEach(i,function(t,e){var n=findOtherInnerSegmentNode(u,t),a=n?u.node(n).order:l;!n&&t!==s||(lodash_1$1.forEach(i.slice(o,e+1),function(i){lodash_1$1.forEach(u.predecessors(i),function(t){var e=u.node(t),n=e.order;!(n<r||a<n)||e.dummy&&u.node(i).dummy||addConflict(d,t,i)})}),o=e+1,r=a)}),i}),d}function findType2Conflicts(l,t){var o={};function s(e,t,n,i,a){var r;lodash_1$1.forEach(lodash_1$1.range(t,n),function(t){r=e[t],l.node(r).dummy&&lodash_1$1.forEach(l.predecessors(r),function(t){var e=l.node(t);e.dummy&&(e.order<i||e.order>a)&&addConflict(o,t,r)})})}return lodash_1$1.reduce(t,function(n,i){var a,r=-1,o=0;return lodash_1$1.forEach(i,function(t,e){"border"===l.node(t).dummy&&(t=l.predecessors(t)).length&&(a=l.node(t[0]).order,s(i,o,e,r,a),o=e,r=a),s(i,o,i.length,a,n.length)}),i}),o}function findOtherInnerSegmentNode(e,t){if(e.node(t).dummy)return lodash_1$1.find(e.predecessors(t),function(t){return e.node(t).dummy})}function addConflict(t,e,n){n<e&&(i=e,e=n,n=i);var i=t[e];i||(t[e]=i={}),i[n]=!0}function hasConflict(t,e,n){var i;return n<e&&(i=e,e=n,n=i),lodash_1$1.has(t[e],n)}function verticalAlignment(t,e,l,s){var u={},d={},h={};return lodash_1$1.forEach(e,function(t){lodash_1$1.forEach(t,function(t,e){u[t]=t,d[t]=t,h[t]=e})}),lodash_1$1.forEach(e,function(t){var o=-1;lodash_1$1.forEach(t,function(t){var e=s(t);if(e.length)for(var n=((e=lodash_1$1.sortBy(e,function(t){return h[t]})).length-1)/2,i=Math.floor(n),a=Math.ceil(n);i<=a;++i){var r=e[i];d[t]===t&&o<h[r]&&!hasConflict(l,t,r)&&(d[r]=t,d[t]=u[t]=u[r],o=h[r])}})}),{root:u,align:d}}function horizontalCompaction(i,t,e,n,a){var r={},o=buildBlockGraph(i,t,e,a),l=a?"borderLeft":"borderRight";function s(t,e){for(var n=o.nodes(),i=n.pop(),a={};i;)a[i]?t(i):(a[i]=!0,n.push(i),n=n.concat(e(i))),i=n.pop()}return s(function(t){r[t]=o.inEdges(t).reduce(function(t,e){return Math.max(t,r[e.v]+o.edge(e))},0)},o.predecessors.bind(o)),s(function(t){var e=o.outEdges(t).reduce(function(t,e){return Math.min(t,r[e.w]-o.edge(e))},Number.POSITIVE_INFINITY),n=i.node(t);e!==Number.POSITIVE_INFINITY&&n.borderType!==l&&(r[t]=Math.max(r[t],e))},o.successors.bind(o)),lodash_1$1.forEach(n,function(t){r[t]=r[e[t]]}),r}function buildBlockGraph(r,t,o,e){var l=new Graph$6,n=r.graph(),s=sep(n.nodesep,n.edgesep,e);return lodash_1$1.forEach(t,function(t){var a;lodash_1$1.forEach(t,function(t){var e,n,i=o[t];l.setNode(i),a&&(e=o[a],n=l.edge(e,i),l.setEdge(e,i,Math.max(s(r,t,a),n||0))),a=t})}),l}function findSmallestWidthAlignment(a,t){return lodash_1$1.minBy(lodash_1$1.values(t),function(t){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return lodash_1$1.forIn(t,function(t,e){e=width(a,e)/2;n=Math.max(t+e,n),i=Math.min(t-e,i)}),n-i})}function alignCoordinates(o,l){var t=lodash_1$1.values(l),s=lodash_1$1.min(t),u=lodash_1$1.max(t);lodash_1$1.forEach(["u","d"],function(r){lodash_1$1.forEach(["l","r"],function(t){var e,n,i=r+t,a=o[i];a!==l&&(e=lodash_1$1.values(a),(n="l"===t?s-lodash_1$1.min(e):u-lodash_1$1.max(e))&&(o[i]=lodash_1$1.mapValues(a,function(t){return t+n})))})})}function balance(n,i){return lodash_1$1.mapValues(n.ul,function(t,e){return i?n[i.toLowerCase()][e]:((e=lodash_1$1.sortBy(lodash_1$1.map(n,e)))[1]+e[2])/2})}function positionX(i){var a,t=util.buildLayerMatrix(i),r=lodash_1$1.merge(findType1Conflicts(i,t),findType2Conflicts(i,t)),o={},e=(lodash_1$1.forEach(["u","d"],function(n){a="u"===n?t:lodash_1$1.values(t).reverse(),lodash_1$1.forEach(["l","r"],function(t){"r"===t&&(a=lodash_1$1.map(a,function(t){return lodash_1$1.values(t).reverse()}));var e=("u"===n?i.predecessors:i.successors).bind(i),e=verticalAlignment(i,a,r,e),e=horizontalCompaction(i,a,e.root,e.align,"r"===t);"r"===t&&(e=lodash_1$1.mapValues(e,function(t){return-t})),o[n+t]=e})}),findSmallestWidthAlignment(i,o));return alignCoordinates(o,e),balance(o,i.graph().align)}function sep(o,l,s){return function(t,e,n){var i,a=t.node(e),r=t.node(n),e=0;if(e+=a.width/2,lodash_1$1.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":i=-a.width/2;break;case"r":i=a.width/2}if(i&&(e+=s?i:-i),i=0,e=(e=(e+=(a.dummy?l:o)/2)+(r.dummy?l:o)/2)+r.width/2,lodash_1$1.has(r,"labelpos"))switch(r.labelpos.toLowerCase()){case"l":i=r.width/2;break;case"r":i=-r.width/2}return i&&(e+=s?i:-i),i=0,e}}function width(t,e){return t.node(e).width}var positionX$1=bk.positionX,position_1=position;function position(n){positionY(n=util.asNonCompoundGraph(n)),lodash_1$1.forEach(positionX$1(n),function(t,e){n.node(e).x=t})}function positionY(n){var t=util.buildLayerMatrix(n),i=n.graph().ranksep,a=0;lodash_1$1.forEach(t,function(t){var e=lodash_1$1.max(lodash_1$1.map(t,function(t){return n.node(t).height}));lodash_1$1.forEach(t,function(t){n.node(t).y=a+e/2}),a+=e+i})}var normalizeRanks$1=util.normalizeRanks,removeEmptyRanks$1=util.removeEmptyRanks,util$2=util,Graph$7=graphlib_1.Graph,layout_1$1=layout$1;function layout$1(e,t){var n=t&&t.debugTiming?util$2.time:util$2.notime;n("layout",function(){var t=n("  buildLayoutGraph",function(){return buildLayoutGraph(e)});n("  runLayout",function(){runLayout(t,n)}),n("  updateInputGraph",function(){updateInputGraph(e,t)})})}function runLayout(t,e){e("    makeSpaceForEdgeLabels",function(){makeSpaceForEdgeLabels(t)}),e("    removeSelfEdges",function(){removeSelfEdges(t)}),e("    acyclic",function(){acyclic.run(t)}),e("    nestingGraph.run",function(){nestingGraph.run(t)}),e("    rank",function(){rank_1(util$2.asNonCompoundGraph(t))}),e("    injectEdgeLabelProxies",function(){injectEdgeLabelProxies(t)}),e("    removeEmptyRanks",function(){removeEmptyRanks$1(t)}),e("    nestingGraph.cleanup",function(){nestingGraph.cleanup(t)}),e("    normalizeRanks",function(){normalizeRanks$1(t)}),e("    assignRankMinMax",function(){assignRankMinMax(t)}),e("    removeEdgeLabelProxies",function(){removeEdgeLabelProxies(t)}),e("    normalize.run",function(){normalize.run(t)}),e("    parentDummyChains",function(){parentDummyChains_1(t)}),e("    addBorderSegments",function(){addBorderSegments_1(t)}),e("    order",function(){order_1(t)}),e("    insertSelfEdges",function(){insertSelfEdges(t)}),e("    adjustCoordinateSystem",function(){coordinateSystem.adjust(t)}),e("    position",function(){position_1(t)}),e("    positionSelfEdges",function(){positionSelfEdges(t)}),e("    removeBorderNodes",function(){removeBorderNodes(t)}),e("    normalize.undo",function(){normalize.undo(t)}),e("    fixupEdgeLabelCoords",function(){fixupEdgeLabelCoords(t)}),e("    undoCoordinateSystem",function(){coordinateSystem.undo(t)}),e("    translateGraph",function(){translateGraph(t)}),e("    assignNodeIntersects",function(){assignNodeIntersects(t)}),e("    reversePoints",function(){reversePointsForReversedEdges(t)}),e("    acyclic.undo",function(){acyclic.undo(t)})}function updateInputGraph(i,a){lodash_1$1.forEach(i.nodes(),function(t){var e=i.node(t),n=a.node(t);e&&(e.x=n.x,e.y=n.y,a.children(t).length&&(e.width=n.width,e.height=n.height))}),lodash_1$1.forEach(i.edges(),function(t){var e=i.edge(t),t=a.edge(t);e.points=t.points,lodash_1$1.has(t,"x")&&(e.x=t.x,e.y=t.y)}),i.graph().width=a.graph().width,i.graph().height=a.graph().height}var graphNumAttrs=["nodesep","edgesep","ranksep","marginx","marginy"],graphDefaults={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},graphAttrs=["acyclicer","ranker","rankdir","align"],nodeNumAttrs=["width","height"],nodeDefaults={width:0,height:0},edgeNumAttrs=["minlen","weight","width","height","labeloffset"],edgeDefaults={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},edgeAttrs=["labelpos"];function buildLayoutGraph(n){var i=new Graph$7({multigraph:!0,compound:!0}),t=canonicalize(n.graph());return i.setGraph(lodash_1$1.merge({},graphDefaults,selectNumberAttrs(t,graphNumAttrs),lodash_1$1.pick(t,graphAttrs))),lodash_1$1.forEach(n.nodes(),function(t){var e=canonicalize(n.node(t));i.setNode(t,lodash_1$1.defaults(selectNumberAttrs(e,nodeNumAttrs),nodeDefaults)),i.setParent(t,n.parent(t))}),lodash_1$1.forEach(n.edges(),function(t){var e=canonicalize(n.edge(t));i.setEdge(t,lodash_1$1.merge({},edgeDefaults,selectNumberAttrs(e,edgeNumAttrs),lodash_1$1.pick(e,edgeAttrs)))}),i}function makeSpaceForEdgeLabels(e){var n=e.graph();n.ranksep/=2,lodash_1$1.forEach(e.edges(),function(t){t=e.edge(t);t.minlen*=2,"c"!==t.labelpos.toLowerCase()&&("TB"===n.rankdir||"BT"===n.rankdir?t.width+=t.labeloffset:t.height+=t.labeloffset)})}function injectEdgeLabelProxies(n){lodash_1$1.forEach(n.edges(),function(t){var e=n.edge(t);e.width&&e.height&&(e=n.node(t.v),e={rank:(n.node(t.w).rank-e.rank)/2+e.rank,e:t},util$2.addDummyNode(n,"edge-proxy",e,"_ep"))})}function assignRankMinMax(e){var n=0;lodash_1$1.forEach(e.nodes(),function(t){t=e.node(t);t.borderTop&&(t.minRank=e.node(t.borderTop).rank,t.maxRank=e.node(t.borderBottom).rank,n=lodash_1$1.max(n,t.maxRank))}),e.graph().maxRank=n}function removeEdgeLabelProxies(n){lodash_1$1.forEach(n.nodes(),function(t){var e=n.node(t);"edge-proxy"===e.dummy&&(n.edge(e.e).labelRank=e.rank,n.removeNode(t))})}function translateGraph(e){var a=Number.POSITIVE_INFINITY,r=0,o=Number.POSITIVE_INFINITY,l=0,t=e.graph(),n=t.marginx||0,i=t.marginy||0;function s(t){var e=t.x,n=t.y,i=t.width,t=t.height;a=Math.min(a,e-i/2),r=Math.max(r,e+i/2),o=Math.min(o,n-t/2),l=Math.max(l,n+t/2)}lodash_1$1.forEach(e.nodes(),function(t){s(e.node(t))}),lodash_1$1.forEach(e.edges(),function(t){t=e.edge(t);lodash_1$1.has(t,"x")&&s(t)}),a-=n,o-=i,lodash_1$1.forEach(e.nodes(),function(t){t=e.node(t);t.x-=a,t.y-=o}),lodash_1$1.forEach(e.edges(),function(t){t=e.edge(t);lodash_1$1.forEach(t.points,function(t){t.x-=a,t.y-=o}),lodash_1$1.has(t,"x")&&(t.x-=a),lodash_1$1.has(t,"y")&&(t.y-=o)}),t.width=r-a+n,t.height=l-o+i}function assignNodeIntersects(r){lodash_1$1.forEach(r.edges(),function(t){var e,n=r.edge(t),i=r.node(t.v),t=r.node(t.w),a=n.points?(e=n.points[0],n.points[n.points.length-1]):(n.points=[],e=t,i);n.points.unshift(util$2.intersectRect(i,e)),n.points.push(util$2.intersectRect(t,a))})}function fixupEdgeLabelCoords(n){lodash_1$1.forEach(n.edges(),function(t){var e=n.edge(t);if(lodash_1$1.has(e,"x"))switch("l"!==e.labelpos&&"r"!==e.labelpos||(e.width-=e.labeloffset),e.labelpos){case"l":e.x-=e.width/2+e.labeloffset;break;case"r":e.x+=e.width/2+e.labeloffset}})}function reversePointsForReversedEdges(e){lodash_1$1.forEach(e.edges(),function(t){t=e.edge(t);t.reversed&&t.points.reverse()})}function removeBorderNodes(r){lodash_1$1.forEach(r.nodes(),function(t){var e,n,i,a;r.children(t).length&&(t=r.node(t),e=r.node(t.borderTop),n=r.node(t.borderBottom),i=r.node(lodash_1$1.last(t.borderLeft)),a=r.node(lodash_1$1.last(t.borderRight)),t.width=Math.abs(a.x-i.x),t.height=Math.abs(n.y-e.y),t.x=i.x+t.width/2,t.y=e.y+t.height/2)}),lodash_1$1.forEach(r.nodes(),function(t){"border"===r.node(t).dummy&&r.removeNode(t)})}function removeSelfEdges(n){lodash_1$1.forEach(n.edges(),function(t){var e;t.v===t.w&&((e=n.node(t.v)).selfEdges||(e.selfEdges=[]),e.selfEdges.push({e:t,label:n.edge(t)}),n.removeEdge(t))})}function insertSelfEdges(a){var t=util$2.buildLayerMatrix(a);lodash_1$1.forEach(t,function(t){var i=0;lodash_1$1.forEach(t,function(t,e){var n=a.node(t);n.order=e+i,lodash_1$1.forEach(n.selfEdges,function(t){util$2.addDummyNode(a,"selfedge",{width:t.label.width,height:t.label.height,rank:n.rank,order:e+ ++i,e:t.e,label:t.label},"_se")}),delete n.selfEdges})})}function positionSelfEdges(o){lodash_1$1.forEach(o.nodes(),function(t){var e,n,i,a,r=o.node(t);"selfedge"===r.dummy&&(e=(a=o.node(r.e.v)).x+a.width/2,n=a.y,i=r.x-e,a=a.height/2,o.setEdge(r.e,r.label),o.removeNode(t),r.label.points=[{x:e+2*i/3,y:n-a},{x:e+5*i/6,y:n-a},{x:e+i,y:n},{x:e+5*i/6,y:n+a},{x:e+2*i/3,y:n+a}],r.label.x=r.x,r.label.y=r.y)})}function selectNumberAttrs(t,e){return lodash_1$1.mapValues(lodash_1$1.pick(t,e),Number)}function canonicalize(t){var n={};return lodash_1$1.forEach(t,function(t,e){n[e.toLowerCase()]=t}),n}var Graph$8=graphlib_1.Graph,debug={debugOrdering:debugOrdering};function debugOrdering(e){var t=util.buildLayerMatrix(e),n=new Graph$8({compound:!0,multigraph:!0}).setGraph({});return lodash_1$1.forEach(e.nodes(),function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)}),lodash_1$1.forEach(e.edges(),function(t){n.setEdge(t.v,t.w,{},t.name)}),lodash_1$1.forEach(t,function(t,e){n.setNode("layer"+e,{rank:"same"}),lodash_1$1.reduce(t,function(t,e){return n.setEdge(t,e,{style:"invis"}),e})}),n}var version$1="0.8.5",_dagre_0_8_5_dagre={graphlib:graphlib_1,layout:layout_1$1,debug:debug,util:{time:util.time,notime:util.notime},version:version$1},relation=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(toConsumableArray$1),o=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),l=interopRequireDefault(assertThisInitialized$1),s=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),g=interopRequireDefault(Canvax),i=interopRequireDefault(graphs),d=interopRequireDefault(global$1),h=interopRequireDefault(dataFrame),c=interopRequireDefault(zoom),f=interopRequireDefault(_dagre_0_8_5_dagre);function p(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var y=g.default._,_=g.default.event,v=g.default.Shapes.Rect,x=g.default.Shapes.Diamond,m=g.default.Shapes.Path,b=g.default.Shapes.BrokenLine,w=g.default.Shapes.Circle,k=g.default.Shapes.Arrow,C=function(t){(0,s.default)(a,t);var i=p(a);function a(t,e){var n;return(0,o.default)(this,a),(n=i.call(this,t,e)).type="relation",y.extend(!0,(0,l.default)(n),(0,tools.getDefaultProps)(a.defaultProps()),t),"dagre"===n.layout&&(y.extend(!0,t={graph:{rankdir:"TB",nodesep:10,ranksep:10,edgesep:10,acyclicer:"greedy"},node:{},edge:{labelpos:"c"}},n.layoutOpts),y.extend(!0,n.layoutOpts,t),n.rankdir?n.layoutOpts.graph.rankdir=n.rankdir:n.rankdir=n.layoutOpts.graph.rankdir),n.domContainer=e.canvax.domView,n.induce=null,n.init(),n}return(0,n.default)(a,[{key:"init",value:function(){this._initInduce(),this.nodesSp=new g.default.Display.Sprite({id:"nodesSp"}),this.nodesContentSp=new g.default.Display.Sprite({id:"nodesContentSp"}),this.edgesSp=new g.default.Display.Sprite({id:"edgesSp"}),this.arrowsSp=new g.default.Display.Sprite({id:"arrowsSp"}),this.labelsSp=new g.default.Display.Sprite({id:"labelsSp"}),this.graphsSp=new g.default.Display.Sprite({id:"graphsSp"}),this.graphsView=new g.default.Display.Sprite({id:"graphsView"}),this.graphsSp.addChild(this.edgesSp),this.graphsSp.addChild(this.nodesSp),this.graphsSp.addChild(this.nodesContentSp),this.graphsSp.addChild(this.arrowsSp),this.graphsSp.addChild(this.labelsSp),this.graphsView.addChild(this.graphsSp),this.sprite.addChild(this.graphsView),this.zoom=new c.default}},{key:"_initInduce",value:function(){var r=this,n=(this.induce=new v({id:"induce",context:{width:0,height:0,fillStyle:"#000000",globalAlpha:0}}),this.sprite.addChild(this.induce),!1),o=r.app.canvax.domView?"default":r.app.canvax.domView.style.cursor,l=null,s=0;this.induce.on(_.types.get(),function(i){var a,t,e;r.status.transform.enabled&&(i.preventDefault(),a=i.target.localToGlobal(i.point,r.sprite),"mousedown"==i.type&&(r.induce.toFront(),n=!0,r.app.canvax.domView&&(r.app.canvax.domView.style.cursor="move"),r.zoom.mouseMoveTo(a)),"mouseup"!=i.type&&"mouseout"!=i.type||(r.induce.toBack(),n=!1,r.app.canvax.domView&&(r.app.canvax.domView.style.cursor=o)),"mousemove"==i.type&&n&&(t=(e=r.zoom.move(a)).x,e=e.y,r.graphsView.context.x=parseInt(t),r.graphsView.context.y=parseInt(e)),"wheel"==i.type&&(Math.abs(i.deltaY)>Math.abs(s)&&(s=i.deltaY),l=l||setTimeout(function(){var t,e,n;"offset"==r.status.transform.wheelAction&&(n=(t=r.zoom.offset({x:-i.deltaX,y:-i.deltaY})).x,t=t.y,r.graphsView.context.x=n,r.graphsView.context.y=t),"scale"==r.status.transform.wheelAction&&(t=(n=r.zoom.wheel(i,a)).scale,e=n.x,n=n.y,r.graphsView.context.x=e,r.graphsView.context.y=n,r.graphsView.context.scaleX=t,r.graphsView.context.scaleY=t,r.status.transform.scale=t),l=null,s=0},32)))})}},{key:"draw",value:function(t){var n=this;y.extend(!0,this,t=t||{}),this._initData(t.data).then(function(t){n.data=t,n._layoutData(),n.widget(),n.induce.context.width=n.width,n.induce.context.height=n.height,n.sprite.context.x=parseInt(n.origin.x),n.sprite.context.y=parseInt(n.origin.y);var t=(n.width-n.data.size.width)/2,e=(t<0&&(t=0),(n.height-n.data.size.height)/2);e<0&&(e=0),n.graphsSp.context.x=parseInt(t),n.graphsSp.context.y=parseInt(e),n.fire("complete")})}},{key:"resetData",value:function(t,e){var n=this;this._resetData(t,e).then(function(){n.fire("complete")})}},{key:"_resetData",value:function(t,a){var r=this,o=this;return this._preData=this.data,new Promise(function(i){r._initData(t).then(function(t){var e,n;r.data=t,r._layoutData(),y.each(r._preData.nodes,function(e){var t=y.find(o.data.nodes,function(t){return e.key==t.key});t?(t.focused=e.focused,t.selected=e.selected):o._destroy(e)}),y.each(r._preData.edges,function(e){y.find(o.data.edges,function(t){return e.key.join("_")==t.key.join("_")})||o._destroy(e)}),r.widget(),a&&null!=(e=a.origin||(a.params||{}).origin)&&(t=y.find(r._preData.nodes,function(t){return t.key==e}),n=y.find(r.data.nodes,function(t){return t.key==e}),t&&n&&(t={x:parseInt(t.x)-parseInt(n.x),y:parseInt(t.y)-parseInt(n.y)},t=(n=r.zoom.offset(t)).x,n=n.y,o.graphsView.context.x=parseInt(t),o.graphsView.context.y=parseInt(n))),i()})})}},{key:"_destroy",value:function(t){t.shapeElement&&t.shapeElement.destroy(),t.contentElement.destroy?t.contentElement.destroy():this.domContainer.removeChild(t.contentElement),t.pathElement&&t.pathElement.destroy(),t.labelElement&&t.labelElement.destroy(),t.arrowElement&&t.arrowElement.destroy(),t.edgeIconElement&&t.edgeIconElement.destroy(),t.edgeIconBack&&t.edgeIconBack.destroy()}},{key:"_getDefNode",value:function(){return{type:"relation",iNode:0,rowData:null,key:"",content:"",_contentInited:!1,ctype:"canvas",contentElement:null,width:null,height:null,x:null,y:null,shapeType:null,source:null,target:null,focused:!1,selected:!1}}},{key:"_initData",value:function(s){var u=this;return new Promise(function(e){if(s&&s.nodes&&s.edges)e(s);else{var t={nodes:[],edges:[],size:{width:0,height:0}},n=u.app._data;(0,data.checkDataIsJson)(n,u.field,u.childrenField)?(u.jsonData=(0,data.jsonToArrayForRelation)(n,u,u.childrenField),u.dataFrame=u.app.dataFrame=(0,h.default)(u.jsonData,u)):"tree"==u.layout&&(u.jsonData=(0,data.arrayToTreeJsonForRelation)(JSON.parse(JSON.stringify(u.app.dataFrame.jsonOrg)),u));for(var i=0;i<u.dataFrame.length;i++){var a=u.dataFrame.getRowDataAt(i),r=y.flatten([(a[u.field]+"").split(",")]),o=u._getContent(a),l=u._getDefNode();Object.assign(l,{iNode:i,rowData:a,key:1==r.length?r[0]:r,content:o,ctype:u._checkHtml(o)?"html":"canvas"}),1==r.length?(l.shapeType=u.getProp(u.node.shapeType,l),Object.assign(l,u.layoutOpts.node),t.nodes.push(l)):(l.shapeType=u.getProp(u.line.shapeType,l),Object.assign(l,u.layoutOpts.edge),t.edges.push(l))}u._initAllDataSize(t).then(function(t){e(t)})}})}},{key:"_initAllDataSize",value:function(s){var u=this;return new Promise(function(r){var o={},l=0;s.nodes.concat(s.edges).forEach(function(a){o[a.key]=a,u._initContentAndGetSize(a).then(function(t){var e,n,i;y.extend(a,t),"diamond"==a.shapeType&&(t=a.width,i=a.height,e=u.node.includedAngle/2*Math.PI/180,n=t+i/Math.tan(e),i=i+t*Math.tan(e),a._innerRect={width:a.width,height:a.height},a.width=n,a.height=i),a._contentInited=!0,++l==s.nodes.length+s.edges.length&&(y.each(s.edges,function(t){var e=t.key;t.source=o[e[0]],t.target=o[e[1]]}),r(s))})})})}},{key:"_layoutData",value:function(){"dagre"==this.layout?this._dagreLayout(this.data):"tree"==this.layout?this._treeLayout(this.data):y.isFunction(this.layout)&&this.layout(this.data)}},{key:"_dagreLayout",value:function(t){var e=d.default.layout.dagre||f.default,n=new e.graphlib.Graph;return n.setGraph(this.layoutOpts.graph),n.setDefaultEdgeLabel(function(){return{}}),y.each(t.nodes,function(t){n.setNode(t.key,t)}),y.each(t.edges,function(t){n.setEdge.apply(n,(0,r.default)(t.key).concat([t]))}),e.layout(n),t.size.width=n.graph().width,t.size.height=n.graph().height,t}},{key:"_treeLayout",value:function(){}},{key:"widget",value:function(){this._drawEdges(),this._drawNodes()}},{key:"offset",value:function(){var t=this.zoom.offset(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{x:0,y:0}),e=t.x,t=t.y;this.graphsView.context.x=parseInt(e),this.graphsView.context.y=parseInt(t)}},{key:"setNodeToCenter",value:function(t){var e,n,t=this.getNodeDataAt(t);t&&(e=t.shapeElement.localToGlobal(),n=this.app.width/2-t.width/2,t=this.app.height/2-t.height/2,n={x:parseInt(n-e.x),y:parseInt(t-e.y)},this.offset(n))}},{key:"_drawEdges",value:function(){var p=this;y.each(this.data.edges,function(t){var e,n,i=t.key.join("_"),a=(p.line.isTree&&3==t.points.length&&p._setTreePoints(t),p._getLineShape(t,p.line.inflectionRadius)),r=a.type,o=a.path,a=a.pointList,l="path"==r?m:b,s=p.getProp(p.line.lineWidth,t),u=p.getProp(p.line.strokeStyle,t),d=p.getProp(p.line.lineType,t),h=p.getProp(p.line.cursor,t),c="edge_"+i,f=p.edgesSp.getChildById(c),d=(f?("path"==r&&(f.context.path=o),"brokenLine"==r&&(f.context.pointList=a),f.context.lineWidth=s,f.context.strokeStyle=u,f.context.lineType=d):(s={lineWidth:s,strokeStyle:u,lineType:d,cursor:h},"path"==r&&(s.path=o),"brokenLine"==r&&(s.pointList=a),(f=new l({id:c,context:s})).on(_.types.get(),function(t){var e=this.nodeData;e.__no_value=!0,t.eventInfo={trigger:p.line,nodes:[e]},p.app.fire(t.type,t)}),p.edgesSp.addChild(f)),((t.pathElement=f).nodeData=t).points.slice(-2,-1)[0]),h=("bezier"==p.line.shapeType&&("TB"!=p.rankdir&&"BT"!=p.rankdir||(d.x+=(t.source.x-t.target.x)/20),"LR"!=p.rankdir&&"RL"!=p.rankdir||(d.y+=(t.source.y-t.target.y)/20)),"label_"+i);p.getProp(p.line.edgeLabel.enabled,t)&&(o=p.getProp(p.node.content.textAlign,t),r=p.getProp(p.node.content.textBaseline,t),a=p.getProp(p.line.edgeLabel.fontSize,t),l=p.getProp(p.line.edgeLabel.fontColor,t),c=(c=p.getProp(p.line.icon.offset,t))||{x:t.x,y:t.y},(s=p.labelsSp.getChildById(h))?(s.resetText(t.content),s.context.x=c.x,s.context.y=c.y,s.context.fontSize=a,s.context.fillStyle=l,s.context.textAlign=o,s.context.textBaseline=r):((s=new g.default.Display.Text(t.content,{id:h,context:{x:c.x,y:c.y,fontSize:a,fillStyle:l,textAlign:o,textBaseline:r}})).on(_.types.get(),function(t){var e=this.nodeData;e.__no_value=!0,t.eventInfo={trigger:p.line,nodes:[e]},p.app.fire(t.type,t)}),p.labelsSp.addChild(s)),(t.labelElement=s).nodeData=t),p.getProp(p.line.icon.enabled,t)&&(f=p.getProp(p.line.icon.charCode,t),h=String.fromCharCode(parseInt(f,16)),""!=f&&(c=p.getProp(p.line.icon.lineWidth,t),a=p.getProp(p.line.icon.strokeStyle,t),l=p.getProp(p.line.icon.fontFamily,t),o=p.getProp(p.line.icon.fontSize,t),r=p.getProp(p.line.icon.fontColor,t),s=p.getProp(p.line.icon.background,t),f=p.getProp(p.line.icon.offset,t),n=p.getProp(p.line.icon.offsetX,t),e=p.getProp(p.line.icon.offsetY,t),n={x:(f=f||{x:parseInt(t.x)+n,y:parseInt(t.y)+e}).x,y:f.y-1,r:parseInt(.5*o)+2,fillStyle:s,strokeStyle:a,lineWidth:c},(s=p.labelsSp.getChildById(e="edge_item_icon_back_"+i))?Object.assign(s.context,n):(s=new w({id:e,context:n}),p.labelsSp.addChild(s)),(t.edgeIconBack=s).nodeData=t,(c=p.labelsSp.getChildById(a="edge_item_icon_"+i))?(c.resetText(h),c.context.x=f.x,c.context.y=f.y,c.context.fontSize=o,c.context.fillStyle=r,c.context.textAlign="center",c.context.textBaseline="middle",c.context.fontFamily=l):((c=new g.default.Display.Text(h,{id:a,context:{x:f.x,y:f.y,fillStyle:r,cursor:"pointer",fontSize:o,textAlign:"center",textBaseline:"middle",fontFamily:l}})).on(_.types.get(),function(t){var e=this.nodeData,n=(e.__no_value=!0,p.line);p.line.icon["on"+t.type]&&(n=p.line.icon),t.eventInfo={trigger:n,nodes:[e]},p.app.fire(t.type,t)}),p.labelsSp.addChild(c)),(t.edgeIconElement=c).nodeData=t)),p.line.arrow.enabled&&((n=p.arrowsSp.getChildById(e="arrow_"+i))?(n.context.x=p.line.arrow.offsetX,n.context.y=p.line.arrow.offsetY,n.context.fillStyle=u,n.context.control.x=d.x,n.context.control.y=d.y,n.context.point=t.points.slice(-1)[0],n.context.strokeStyle=u,n.context.fillStyle=u):(n=new k({id:e,context:{x:p.line.arrow.offsetX,y:p.line.arrow.offsetY,control:d,point:t.points.slice(-1)[0],strokeStyle:u,fillStyle:u}}),p.arrowsSp.addChild(n)),t.arrowElement=n)})}},{key:"_drawNodes",value:function(){var e=this;y.each(this.data.nodes,function(t){e._drawNode(t)})}},{key:"_drawNode",value:function(n){var i=this,t=v,e="node_"+n.key,a=i.node.cursor,r=i._getNodeStyle(n),o=r.lineWidth,l=r.fillStyle,s=r.strokeStyle,u=r.radius,d=r.shadowOffsetX,h=r.shadowOffsetY,c=r.shadowBlur,r=r.shadowColor,u={x:parseInt(n.x)-parseInt(n.width/2),y:parseInt(n.y)-parseInt(n.height/2),width:n.width,height:n.height,cursor:a,lineWidth:o,fillStyle:l,strokeStyle:s,radius:u,shadowOffsetX:d,shadowOffsetY:h,shadowBlur:c,shadowColor:r},f=("diamond"==n.shapeType&&(t=x,u={x:parseInt(n.x),y:parseInt(n.y),cursor:a,innerRect:n._innerRect,lineWidth:o,fillStyle:l,strokeStyle:s,shadowOffsetX:d,shadowOffsetY:h,shadowBlur:c,shadowColor:r}),i.nodesSp.getChildById(e));f?y.extend(f.context,u):(f=new t({id:e,hoverClone:!1,context:u}),i.nodesSp.addChild(f),f.on(_.types.get(),function(t){var e,n=this.nodeData;n.__no_value=!0,t.eventInfo={trigger:i.node,nodes:[n]},i.node.focus.enabled&&("mouseover"==t.type&&i.focusAt(this.nodeData),"mouseout"==t.type&&i.unfocusAt(this.nodeData)),i.node.select.enabled&&-1<i.node.select.triggerEventType.indexOf(t.type)&&(n=i.node.select.onbefore,e=i.node.select.onend,n&&("function"!=typeof n||!1===n.apply(i,[this.nodeData]))||(this.nodeData.selected?i.unselectAt(this.nodeData):i.selectAt(this.nodeData),e&&"function"==typeof e&&e.apply(i,[this.nodeData]))),i.app.fire(t.type,t)})),(f.nodeData=n).shapeElement=f,-1<i.node.select.list.indexOf(n.key)&&i.selectAt(n),"canvas"==n.ctype&&(n.contentElement.context.visible=!0),f.on("transform",function(){var t,e;"canvas"==n.ctype?(n.contentElement.context.x=parseInt(n.x),n.contentElement.context.y=parseInt(n.y)):"html"==n.ctype&&(t="undefined"!=typeof window?window.devicePixelRatio:1,e=(e=f.worldTransform.clone()).scale(1/t,1/t),n.contentElement.style.transform="matrix("+e.toArray().join()+")",n.contentElement.style.transformOrigin="left top","diamond"==n.shapeType&&(n.contentElement.style.left=-parseInt(n._innerRect.width/2*i.status.transform.scale)+"px",n.contentElement.style.top=-parseInt(n._innerRect.height/2*i.status.transform.scale)+"px"),n.contentElement.style.visibility="visible")})}},{key:"_getNodeStyle",value:function(t,e){var n=this,i=y.flatten([n.getProp(n.node.radius,t)]),a=n.node;return"select"==e&&(a=n.node.select),"focus"==e&&(a=n.node.focus),{lineWidth:n.getProp(a.lineWidth,t),fillStyle:n.getProp(a.fillStyle,t),strokeStyle:n.getProp(a.strokeStyle,t),radius:i,shadowOffsetX:n.getProp(a.shadow.shadowOffsetX,t),shadowOffsetY:n.getProp(a.shadow.shadowOffsetY,t),shadowBlur:n.getProp(a.shadow.shadowBlur,t),shadowColor:n.getProp(a.shadow.shadowColor,t)}}},{key:"_setNodeStyle",value:function(t,e){var e=this._getNodeStyle(t,e),n=e.lineWidth,i=e.fillStyle,a=e.strokeStyle,r=e.shadowOffsetX,o=e.shadowOffsetY,l=e.shadowBlur,e=e.shadowColor;t.shapeElement&&t.shapeElement.context&&((t=t.shapeElement.context).lineWidth=n,t.fillStyle=i,t.strokeStyle=a,t.shadowOffsetX=r,t.shadowOffsetY=o,t.shadowBlur=l,t.shadowColor=e)}},{key:"focusAt",value:function(t){t=this.getNodeDataAt(t);t&&(t.selected||this._setNodeStyle(t,"focus"),t.focused=!0)}},{key:"unfocusAt",value:function(t){t=this.getNodeDataAt(t);t&&(t.selected||this._setNodeStyle(t),t.focused=!1)}},{key:"selectAt",value:function(t){t=this.getNodeDataAt(t);t&&(this._setNodeStyle(t,"select"),t.selected=!0,-1==this.node.select.list.indexOf(t.key)&&this.node.select.list.push(t.key))}},{key:"selectAll",value:function(){var e=this;this.data.nodes.forEach(function(t){e.selectAt(t)})}},{key:"unselectAt",value:function(t){var t=this.getNodeDataAt(t);t&&(t.focused?this._setNodeStyle(t,"focus"):this._setNodeStyle(t),t.selected=!1,-1<(t=this.node.select.list.indexOf(t.key))&&this.node.select.list.splice(t,1))}},{key:"unselectAll",value:function(){var e=this;this.data.nodes.forEach(function(t){e.unselectAt(t)})}},{key:"getNodeDataAt",value:function(e){return!e.type||"relation"!=e.type&&"tree"!=e.type?"string"==typeof e?1==(n=e.split(",")).length?this.data.nodes.find(function(t){return t.key==e}):2==n.length?this.data.edges.find(function(t){return t.key.join()==n.join()}):void 0:void 0:e;var n}},{key:"_setTreePoints",value:function(t){var e=t.points;"TB"!=this.rankdir&&"BT"!=this.rankdir||(e[0]={x:t.source.x,y:t.source.y+("BT"==this.rankdir?-1:1)*t.source.height/2},e.splice(1,0,{x:t.source.x,y:e.slice(-2,-1)[0].y})),"LR"!=this.rankdir&&"RL"!=this.rankdir||(e[0]={x:t.source.x+("RL"==this.rankdir?-1:1)*t.source.width/2,y:t.source.y},e.splice(1,0,{x:e.slice(-2,-1)[0].x,y:t.source.y})),t.points=e}},{key:"_getLineShape",value:function(t,o){var l=t.points,e={type:"path",pointList:null,path:s},n=l[0],i=l.slice(-1)[0],s="M"+n.x+" "+n.y;return"bezier"==t.shapeType&&(3==l.length&&(s+=",Q"+l[1].x+" "+l[1].y+" "+i.x+" "+i.y),4==l.length&&(s+=",C"+l[1].x+" "+l[1].y+" "+l[2].x+" "+l[2].y+" "+i.x+" "+i.y),5<=l.length)?(e.type="brokenLine",e.pointList=l.map(function(t){return[t.x,t.y]})):("brokenLine"==t.shapeType&&y.each(l,function(e,t){var n,i,a,r;t&&(o&&t<l.length-1?(a=l[t-1],t=l[t+1],r=o,n=Math.max(Math.abs(a.x-e.x)/2,Math.abs(a.y-e.y)/2),i=Math.max(Math.abs(t.x-e.x)/2,Math.abs(t.y-e.y)/2),r=y.min([r,n,i]),e.x==a.x&&e.y==a.y||e.x==t.x&&e.y==t.y||Math.atan2(e.y-a.y,e.x-a.x)==Math.atan2(t.y-e.y,t.x-e.x)||(i=(n=function(t){t=Math.atan2(t.y-e.y,t.x-e.x);return{x:e.x+r*Math.cos(t),y:e.y+r*Math.sin(t)}})(a),a=n(t),s+=",L"+i.x+" "+i.y+",Q"+e.x+" "+e.y+" "+a.x+" "+a.y)):s+=",L"+e.x+" "+e.y)}),e.path=s),e}},{key:"_checkHtml",value:function(t){return/<[^>]+>/g.test(t)}},{key:"_getContent",value:function(t){var e,n=this.node.content.field;return this._isField(n)&&(e=t[n]),this.node.content.format&&y.isFunction(this.node.content.format)?e=this.node.content.format.apply(this,[e,t]):(t=this.app.getComponent({name:"coord"}).getFieldConfig(n))&&(e=t.getFormatValue(e)),e}},{key:"_isField",value:function(t){return~this.dataFrame.fields.indexOf(t)}},{key:"_initContentAndGetSize",value:function(t){var e=t.ctype;return"canvas"==(e=(e=this._isField(e)?t.rowData[e]:e)||"canvas")?this._getEleAndsetCanvasSize(t):"html"==e?this._getEleAndsetHtmlSize(t):void 0}},{key:"_getEleAndsetCanvasSize",value:function(s){var u=this,d=this;return new Promise(function(t){var e,n=s.content,i=s.rowData.width,a=s.rowData.height,r={fillStyle:d.getProp(d.node.content.fontColor,s),textAlign:d.getProp(d.node.content.textAlign,s),textBaseline:d.getProp(d.node.content.textBaseline,s)},o="content_label_"+s.key,l=d.nodesContentSp.getChildById(o);l?(l.resetText(n),y.extend(l.context,r)):((l=new g.default.Display.Text(n,{id:o,context:r})).context.visible=!1,y.isArray(s.key)||d.nodesContentSp.addChild(l)),(e=u.node.content.init&&"function"==typeof u.node.content.init?u.node.content.init(s,l):e)&&"function"==typeof e.then?e.then(function(){i=i||l.getTextWidth()+d.getProp(d.node.padding,s)*d.status.transform.scale*2,a=a||l.getTextHeight()+d.getProp(d.node.padding,s)*d.status.transform.scale*2,t({contentElement:l,width:i,height:a})}):(i=i||l.getTextWidth()+d.getProp(d.node.padding,s)*d.status.transform.scale*2,a=a||l.getTextHeight()+d.getProp(d.node.padding,s)*d.status.transform.scale*2,t({contentElement:l,width:i,height:a}))})}},{key:"_getEleAndsetHtmlSize",value:function(l){var s=this,u=this;return new Promise(function(e){var t,n=l.content,i=l.rowData.width,a=l.rowData.height,r="__content_label_"+l.key,o=s.domContainer.getElementsByClassName(r);o.length?o=o[0]:((o=document.createElement("div")).className="chartx_relation_node "+r,o.style.cssText+="; position:absolute;visibility:hidden;",s.domContainer.appendChild(o)),o.style.cssText+="; color:"+u.getProp(u.node.content.fontColor,l)+";",o.style.cssText+="; text-align:"+u.getProp(u.node.content.textAlign,l)+";",o.style.cssText+="; vertical-align:"+u.getProp(u.node.content.textBaseline,l)+";",o.innerHTML=n,(t=s.node.content.init&&"function"==typeof s.node.content.init?s.node.content.init(l,o):t)&&"function"==typeof t.then?t.then(function(t){i=i||o.offsetWidth,a=a||o.offsetHeight,e({contentElement:o,width:i,height:a})}):(i=i||o.offsetWidth,a=a||o.offsetHeight,e({contentElement:o,width:i,height:a}))})}},{key:"getNodesAt",value:function(){}},{key:"getProp",value:function(t,e){var n=t;return this._isField(t)?n=e.rowData[t]:(y.isArray(t)&&(n=t[e.iNode]),y.isFunction(t)&&(n=t.apply(this,[e]))),n}}],[{key:"defaultProps",value:function(){return{field:{detail:"key字段设置",documentation:"",default:null},childrenField:{detail:"树结构数据的关联字段",documentation:"如果是树结构的关联数据，不是行列式，那么就通过这个字段来建立父子关系",default:"children"},rankdir:{detail:"布局方向",default:null},node:{detail:"单个节点的配置",propertys:{shapeType:{detail:"节点图形，支持rect,diamond",default:"rect"},maxWidth:{detail:"节点最大的width",default:200},cursor:{detail:"节点的鼠标样式",default:"pointer"},width:{detail:"内容的width",default:null},height:{detail:"内容的height",default:null},radius:{detail:"圆角角度，对rect生效",default:6},includedAngle:{detail:"shapeType为diamond(菱形)的时候生效,x方向的夹角",default:60},fillStyle:{detail:"节点背景色",default:"#ffffff"},lineWidth:{detail:"描边宽度",default:1},strokeStyle:{detail:"描边颜色",default:"#e5e5e5"},shadow:{detail:"阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},select:{detail:"选中效果",propertys:{enabled:{detail:"是否开启选中",default:!1},list:{detail:"选中的node.key的集合,外部传入可以选中",default:[]},triggerEventType:{detail:"触发事件",default:"click,tap"},shadow:{detail:"选中效果的阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},fillStyle:{detail:"hover节点背景色",default:"#ffffff"},lineWidth:{detail:"hover描边宽度",default:1},strokeStyle:{detail:"hover描边颜色",default:"#e5e5e5"},onbefore:{detail:"执行select处理函数的前处理函数，返回false则取消执行select",default:null},onend:{detail:"执行select处理函数的后处理函数",default:null}}},focus:{detail:"hover效果",propertys:{enabled:{detail:"是否开启hover效果",default:!1},shadow:{detail:"选中效果的阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},fillStyle:{detail:"hover节点背景色",default:"#ffffff"},lineWidth:{detail:"hover描边宽度",default:1},strokeStyle:{detail:"hover描边颜色",default:"#e5e5e5"}}},padding:{detail:"node节点容器到内容的边距,节点内容是canvas的时候生效，dom节点不生效",default:10},content:{detail:"节点内容配置",propertys:{field:{detail:"内容字段",documentation:"默认content字段",default:"content"},fontColor:{detail:"内容文本颜色",default:"#666"},format:{detail:"内容格式化处理函数",default:null},textAlign:{detail:"textAlign",default:"center"},textBaseline:{detail:"textBaseline",default:"middle"},init:{detail:"内容节点的初始化完成回调",documentation:"在节点内容配置为需要异步完成的时候，比如节点内容配置为一个magix的view",default:null}}}}},line:{detail:"两个节点连线配置",propertys:{isTree:{detail:"是否树结构的连线",documentation:"非树结构启用该配置可能会有意想不到的惊喜，慎用",default:!1},inflectionRadius:{detail:"树状连线的拐点圆角半径",default:0},shapeType:{detail:"连线的图形样式 brokenLine or bezier",default:"bezier"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"连线的颜色",default:"#e5e5e5"},lineType:{detail:"连线样式（虚线等）",default:"solid"},arrow:{detail:"连线箭头配置",propertys:{enabled:{detail:"是否开启arrow设置",default:!0},offsetX:{detail:"x方向偏移",default:0},offsetY:{detail:"y方向偏移",default:0}}},edgeLabel:{detail:"连线上面的label配置",propertys:{enabled:{detail:"是否开启label设置",default:!0},fontColor:{detail:"文本颜色",default:"#ccc"},fontSize:{detail:"文本大小",default:12},offset:{detail:"label的位置，函数，参数是整个edge对象",default:null}}},icon:{detail:"连线上面的操作icon",propertys:{enabled:{detail:"是否开启线上的icon设置",default:!1},charCode:{detail:"iconfont上面对应的unicode中&#x后面的字符",default:null},lineWidth:{detail:"icon描边线宽",default:1},strokeStyle:{detail:"icon的描边颜色",default:"#e5e5e5"},fontColor:{detail:"icon的颜色",default:"#e5e5e5"},fontFamily:{detail:"font-face的font-family设置",default:"iconfont"},fontSize:{detail:"icon的字体大小",default:14},offset:{detail:"icon的位置，函数，参数是整个edge对象",default:null},offsetX:{detail:"在计算出offset后的X再次便宜量",default:1},offsetY:{detail:"在计算出offset后的Y再次便宜量",default:2},background:{detail:"icon的背景颜色，背景为圆形",default:"#fff"}}},cursor:"default"}},layout:{detail:"采用的布局引擎,比如dagre",default:"dagre"},layoutOpts:{detail:"布局引擎对应的配置,dagre详见dagre的官方wiki",propertys:{}},status:{detail:"一些开关配置",propertys:{transform:{detail:"是否启动拖拽缩放整个画布",propertys:{fitView:{detail:"自动缩放",default:""},enabled:{detail:"是否开启",default:!0},scale:{detail:"缩放值",default:1},scaleOrigin:{detail:"缩放原点",default:{x:0,y:0}},wheelAction:{detail:"滚轮触屏滑动触发的行为，可选有scale和offset，默认offset",default:"offset"}}}}}}}}]),a}(i.default);i.default.registerComponent(C,"graphs","relation"),e.default=C}),tree=(unwrapExports(relation),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),_=interopRequireDefault(Canvax),n=interopRequireDefault(relation),d=interopRequireDefault(dataFrame),v=interopRequireDefault(trigger);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=_.default._,x=_.default.event,m=(_.default.Shapes.Rect,_.default.Shapes.Diamond,_.default.Shapes.Path,_.default.Shapes.Circle),i=(_.default.Shapes.Arrow,function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="tree",e.shrinked=[],c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e}return(0,r.default)(i,[{key:"_initData",value:function(n){var u=this;return new Promise(function(e){var s,t;n&&n.nodes&&n.edges?e(n):(s={nodes:[],edges:[],size:{width:0,height:0}},t=u.app._data,(0,data.checkDataIsJson)(t,u.field,u.childrenField)?(u.jsonData=(0,data.jsonToArrayForRelation)(t,u,u.childrenField),u.dataFrame=u.app.dataFrame=(0,d.default)(u.jsonData,u)):u.jsonData=(0,data.arrayToTreeJsonForRelation)(JSON.parse(JSON.stringify(u.app.dataFrame.jsonOrg)),u),function o(t,l){t.forEach(function(t){var e,n,i=t[u.field],a=u._getContent(t),r=u._getDefNode();Object.assign(r,{type:"tree",iNode:t.__index__,rowData:t,key:i,content:a,ctype:u._checkHtml(a)?"html":"canvas"}),r.shapeType=u.getProp(u.node.shapeType,r),Object.assign(r,u.layoutOpts.node),s.nodes.push(r),l&&(a=[l[u.field],t[u.field]],r=u._getDefNode(),(e={})[u.field]=a.join(","),(e=u.dataFrame.getRowDataOf(e))&&e.length&&(e=e[0],n=u._getContent(e),Object.assign(r,{type:"tree",iNode:e.__index__,rowData:e,key:a,content:n,ctype:u._checkHtml(n)?"html":"canvas"}),r.shapeType=u.getProp(u.line.shapeType,r),Object.assign(r,u.layoutOpts.edge),s.edges.push(r))),t.children&&-1==u.shrinked.indexOf(i)&&o(t.children,t)})}(u.jsonData),u._initAllDataSize(s).then(function(t){e(t)}))})}},{key:"_drawNodes",value:function(){var g=this,y=this;c.each(this.data.nodes,function(a){var t,e,n,i,r,o,l,s,u,d,h,c,f,p;g._drawNode(a),g.node.shrink.enabled&&a.rowData.children&&a.rowData.children.length&&(t=a.key+"_shrink_icon",e=a.key+"_shrink_icon_back",n=g.node.shrink.openCharCode,-1==g.shrinked.indexOf(a.key)&&(n=g.node.shrink.closeCharCode),n=String.fromCharCode(parseInt(g.getProp(n,a),16)),i=g.getProp(g.node.shrink.fontSize,a),p=g.getProp(g.node.shrink.fontColor,a),f=g.getProp(g.node.shrink.fontFamily,a),h=g.getProp(g.node.shrink.offsetX,a),c=g.getProp(g.node.shrink.offsetY,a),r=g.getProp(g.node.shrink.tipsContent,a),o=g.getProp(g.node.shrink.background,a),l=g.getProp(g.node.shrink.lineWidth,a),s=g.getProp(g.node.shrink.strokeStyle,a),u=g.labelsSp.getChildById(t),d=g.labelsSp.getChildById(e),f={x:h=parseInt(a.x+a.width/2+h),y:(c=parseInt(a.y+c))+1,fontSize:i,fontFamily:f,fillStyle:p,textAlign:"center",textBaseline:"middle",cursor:"pointer"},p={x:h,y:c,r:parseInt(.5*i)+2,fillStyle:o,strokeStyle:s,lineWidth:l},u?(u.resetText(n),Object.assign(u.context,f),Object.assign(d.context,p)):(u=new _.default.Display.Text(n,{id:t,context:f}),d=new m({id:e,context:p}),g.labelsSp.addChild(d),g.labelsSp.addChild(u),u._shrinkIconBack=d,u.on(x.types.get(),function(t){var e=g.node.shrink;if(t.eventInfo={trigger:e,tipsContent:r,nodes:[]},d.context&&("mousedown"==t.type&&(d.context.r+=1),"mouseup"==t.type&&--d.context.r),-1<g.node.shrink.triggerEventType.indexOf(t.type)){if(-1==g.shrinked.indexOf(a.key))g.shrinked.push(a.key);else for(var n=0,i=g.shrinked.length;n<i;n++)g.shrinked[n]==a.key&&(g.shrinked.splice(n,1),n--,i--);e=new v.default(y,{origin:a.key});g.app.resetData(null,e)}g.app.fire(t.type,t)})),(u.nodeData=a).shrinkIcon=u,a.shrinkIconBack=d)})}},{key:"_destroy",value:function(t){var e;t.shapeElement&&t.shapeElement.destroy(),t.contentElement.destroy?t.contentElement.destroy():this.domContainer.removeChild(t.contentElement),t.pathElement&&t.pathElement.destroy(),t.labelElement&&t.labelElement.destroy(),t.arrowElement&&t.arrowElement.destroy(),t.edgeIconElement&&t.edgeIconElement.destroy(),t.edgeIconBack&&t.edgeIconBack.destroy(),t.shrinkIcon&&t.shrinkIcon.destroy(),t.shrinkIconBack&&t.shrinkIconBack.destroy(),Array.isArray(t.key)&&(e=t.source,this.data.edges.find(function(t){return t.key[0]==e.key})||(e.shrinkIcon&&e.shrinkIcon.destroy(),e.shrinkIconBack&&e.shrinkIconBack.destroy()))}}],[{key:"defaultProps",value:function(){return{field:{detail:"key字段设置",documentation:"",default:null},node:{detail:"单个节点的配置",propertys:{shrink:{detail:"树状图是否有节点收缩按钮",propertys:{enabled:{detail:"是否开启",default:!0},triggerEventType:{detail:"触发事件",default:"click,tap"},openCharCode:{detail:"点击后触发展开的icon chartCode，当前状态为收缩",default:""},closeCharCode:{detail:"点击后触发收缩的icon chartCode，当前状态为展开",default:""},fontSize:{detail:"icon字号大小",default:12},fontColor:{detail:"icon字体颜色",default:"#666"},fontFamily:{detail:"icon在css中的fontFamily",default:"iconfont"},tipsContent:{detail:"鼠标移动到收缩icon上面的tips内容",default:""},offsetX:{detail:"x方向偏移量",default:10},offsetY:{detail:"y方向偏移量",default:1},background:{detail:"icon的 背景色",default:"#fff"},lineWidth:{detail:"边框大小",default:1},strokeStyle:{detail:"描边颜色",default:"#667894"}}}}}}}}]),i}(n.default));n.default.registerComponent(i,"graphs","tree"),e.default=i})),base=(unwrapExports(tree),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=interopRequireDefault(defineProperty$1),o=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),l=interopRequireDefault(assertThisInitialized$1),s=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),r=interopRequireDefault(getPrototypeOf$1),g=interopRequireDefault(Canvax),u=interopRequireDefault(graphs),d=interopRequireDefault(zoom);function h(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function c(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,r.default)(n);return t=i?(t=(0,r.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var y=g.default._,_=g.default.event,p=g.default.Shapes.Rect,v=g.default.Shapes.Diamond,x=(g.default.Shapes.Line,g.default.Shapes.Path),m=g.default.Shapes.BrokenLine,b=g.default.Shapes.Circle,w=g.default.Shapes.Arrow,u=function(t){(0,s.default)(r,t);var a=c(r);function r(t,e,n){var i;return(0,o.default)(this,r),(i=a.call(this,t,e)).type="relation",y.extend(!0,(0,l.default)(i),(0,tools.getDefaultProps)(r.defaultProps()),t),i.domContainer=e.canvax.domView,i.induce=null,i.init(n),i}return(0,n.default)(r,[{key:"init",value:function(t){this._initInduce(),this.nodesSp=new g.default.Display.Sprite({id:"nodesSp"}),this.nodesContentSp=new g.default.Display.Sprite({id:"nodesContentSp"}),this.edgesSp=new g.default.Display.Sprite({id:"edgesSp"}),this.arrowsSp=new g.default.Display.Sprite({id:"arrowsSp"}),this.labelsSp=new g.default.Display.Sprite({id:"labelsSp"}),this.graphsSp=new g.default.Display.Sprite({id:"graphsSp"}),this.graphsView=new g.default.Display.Sprite({id:"graphsView"}),this.graphsSp.addChild(this.edgesSp),this.graphsSp.addChild(this.nodesSp),this.graphsSp.addChild(this.nodesContentSp),this.graphsSp.addChild(this.arrowsSp),this.graphsSp.addChild(this.labelsSp),this.graphsView.addChild(this.graphsSp),this.sprite.addChild(this.graphsView),t.zoom?(this.preGraphsSpPosition=t.graphsSpPosition,this.zoom=t.zoom,this.offset()):this.zoom=new d.default}},{key:"getDefNode",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach(function(t){(0,i.default)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:"relation",iNode:0,rowData:null,key:"",content:"",ctype:"canvas",contentElement:null,width:null,height:null,boundingClientWidth:0,x:null,y:null,shapeType:null,focused:!1,selected:!1},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}},{key:"checkNodeSizeForShapeType",value:function(t){var e,n,i,a;"diamond"==t.shapeType&&(e=this.node.includedAngle/2*Math.PI/180,n=t.boundingClientWidth,a=t.height,t._innerBound={width:n,height:a},i=a/Math.tan(e),a=a+n*Math.tan(e),t.boundingClientWidth=n+i,t.height=a)}},{key:"_initInduce",value:function(){var r=this,n=(this.induce=new p({id:"induce",context:{width:0,height:0,fillStyle:"#000000",globalAlpha:0}}),this.sprite.addChild(this.induce),!1),o=null,l=0;this.induce.on(_.types.get(),function(i){var a,t,e;!r.status.transform.enabled||(e=r.app.getComponent({name:"contextmenu"}))&&e.isShow||(i.preventDefault(),a=i.target.localToGlobal(i.point,r.sprite),"mousedown"==i.type&&(r.induce.toFront(),n=!0,r.app.canvax.domView&&(r.app.canvax.domView.style.cursor="move"),r.zoom.mouseMoveTo(a)),"mouseup"!=i.type&&"mouseout"!=i.type||(r.induce.toBack(),n=!1,r.app.canvax.domView&&(r.app.canvax.domView.style.cursor="")),"mousemove"==i.type&&n&&(t=(e=r.zoom.move(a)).x,e=e.y,r.graphsView.context.x=parseInt(t),r.graphsView.context.y=parseInt(e)),"wheel"==i.type&&(Math.abs(i.deltaY)>Math.abs(l)&&(l=i.deltaY),o=o||setTimeout(function(){var t,e,n;"offset"==r.status.transform.wheelAction&&(n={x:2*-i.deltaX,y:2*-i.deltaY},(t=parseInt(r.graphsView.context.x+r.graphsSp.context.x+r.data.viewPort.maxLeft+n.x+r.app.padding.left))<0&&(n.x=parseInt(n.x-t)),(t=parseInt(r.graphsView.context.x+r.graphsSp.context.x+r.data.viewPort.maxRight+n.x+r.app.padding.right))>=r.app.width&&(n.x=parseInt(n.x-(t-r.app.width))),(t=parseInt(r.graphsView.context.y+r.graphsSp.context.y+r.data.viewPort.maxTop+n.y+r.app.padding.top))<0&&(n.y=parseInt(n.y-t)),(t=parseInt(r.graphsView.context.y+r.graphsSp.context.y+r.data.viewPort.maxBottom+n.y+r.app.padding.bottom))>=r.app.height&&(n.y=parseInt(n.y-(t-r.app.height))),n=(t=r.zoom.offset(n)).x,t=t.y,r.graphsView.context.x=n,r.graphsView.context.y=t),"scale"==r.status.transform.wheelAction&&(t=(n=r.zoom.wheel(i,a)).scale,e=n.x,n=n.y,r.graphsView.context.x=e,r.graphsView.context.y=n,r.graphsView.context.scaleX=t,r.graphsView.context.scaleY=t,r.status.transform.scale=t),o=null,l=0},32))),i.eventInfo={trigger:r,iNode:-1},r.app.fire(i.type,i)})}},{key:"_resetData",value:function(t,a){var r=this,o=this;return this._preData=this.data,new Promise(function(i){r.initData(t,a).then(function(t){r.data=t,r.layoutData();var e,t=r._preData&&r._preData.nodes||[],n=r._preData&&r._preData.edges||[];y.each(t,function(e){var t=y.find(o.data.nodes,function(t){return e.key==t.key});t?(t.focused=e.focused,t.selected=e.selected,t.ctype==e.ctype&&(t.contentElement=e.contentElement)):o._destroy(e)}),y.each(n,function(e){y.find(o.data.edges,function(t){return e.key.join("_")==t.key.join("_")})||o._destroy(e)}),r.widget(),a&&null!=(e=a.origin||(a.params||{}).origin)&&(n=y.find(t,function(t){return t.key==e}),t=y.find(r.data.nodes,function(t){return t.key==e}),n&&t&&(n={x:parseInt(n.x)-parseInt(t.x),y:parseInt(n.y)-parseInt(t.y)},n=(t=r.zoom.offset(n)).x,t=t.y,o.graphsView.context.x=parseInt(n),o.graphsView.context.y=parseInt(t))),i()})})}},{key:"_destroy",value:function(t){}},{key:"_drawEdges",value:function(){var p=this;y.each(this.data.edges,function(t){var e,n,i=p._getLineShape(t,p.line.inflectionRadius),a=t.key.join("_"),r=i.type,o=i.path,i=i.pointList,l="path"==r?x:m,s=p.getProp(p.line.lineWidth,t),u=p.getProp(p.line.strokeStyle,t),d=p.getProp(p.line.lineType,t),h=p.getProp(p.line.cursor,t),c="edge_"+a,f=p.edgesSp.getChildById(c),d=(f?("path"==r&&(f.context.path=o),"brokenLine"==r&&(f.context.pointList=i),f.context.lineWidth=s,f.context.strokeStyle=u,f.context.lineType=d):(s={lineWidth:s,strokeStyle:u,lineType:d,cursor:h},"path"==r&&(s.path=o),"brokenLine"==r&&(s.pointList=i),(f=new l({id:c,context:s})).on(_.types.get(),function(t){var e=this.nodeData;e.__no_value=!0,t.eventInfo={trigger:p.line,nodes:[e]},p.app.fire(t.type,t)}),p.edgesSp.addChild(f)),((t.pathElement=f).nodeData=t).points.slice(-2,-1)[0]),h=("bezier"==p.line.shapeType&&("TB"!=p.rankdir&&"BT"!=p.rankdir||(d.x+=(t.source.x-t.target.x)/20),"LR"!=p.rankdir&&"RL"!=p.rankdir||(d.y+=(t.source.y-t.target.y)/20)),"label_"+a);p.getProp(p.line.edgeLabel.enabled,t)&&(o=p.getProp(p.node.content.textAlign,t),r=p.getProp(p.node.content.textBaseline,t),i=p.getProp(p.line.edgeLabel.fontSize,t),l=p.getProp(p.line.edgeLabel.fontColor,t),c=(c=p.getProp(p.line.icon.offset,t))||{x:t.x,y:t.y},(s=p.labelsSp.getChildById(h))?(s.resetText(t.content),s.context.x=c.x,s.context.y=c.y,s.context.fontSize=i,s.context.fillStyle=l,s.context.textAlign=o,s.context.textBaseline=r):((s=new g.default.Display.Text(t.content,{id:h,context:{x:c.x,y:c.y,fontSize:i,fillStyle:l,textAlign:o,textBaseline:r}})).on(_.types.get(),function(t){var e=this.nodeData;e.__no_value=!0,t.eventInfo={trigger:p.line,nodes:[e]},p.app.fire(t.type,t)}),p.labelsSp.addChild(s)),(t.labelElement=s).nodeData=t),p.getProp(p.line.icon.enabled,t)&&(f=p.getProp(p.line.icon.charCode,t),h=String.fromCharCode(parseInt(f,16)),""!=f&&(c=p.getProp(p.line.icon.lineWidth,t),i=p.getProp(p.line.icon.strokeStyle,t),l=p.getProp(p.line.icon.fontFamily,t),o=p.getProp(p.line.icon.fontSize,t),r=p.getProp(p.line.icon.fontColor,t),s=p.getProp(p.line.icon.background,t),f=p.getProp(p.line.icon.offset,t),n=p.getProp(p.line.icon.offsetX,t),e=p.getProp(p.line.icon.offsetY,t),n={x:(f=f||{x:parseInt(t.x)+n,y:parseInt(t.y)+e}).x,y:f.y-1,r:parseInt(.5*o)+2,fillStyle:s,strokeStyle:i,lineWidth:c},(s=p.labelsSp.getChildById(e="edge_item_icon_back_"+a))?Object.assign(s.context,n):(s=new b({id:e,context:n}),p.labelsSp.addChild(s)),(t.edgeIconBack=s).nodeData=t,(c=p.labelsSp.getChildById(i="edge_item_icon_"+a))?(c.resetText(h),c.context.x=f.x,c.context.y=f.y,c.context.fontSize=o,c.context.fillStyle=r,c.context.textAlign="center",c.context.textBaseline="middle",c.context.fontFamily=l):((c=new g.default.Display.Text(h,{id:i,context:{x:f.x,y:f.y,fillStyle:r,cursor:"pointer",fontSize:o,textAlign:"center",textBaseline:"middle",fontFamily:l}})).on(_.types.get(),function(t){var e=this.nodeData,n=(e.__no_value=!0,p.line);p.line.icon["on"+t.type]&&(n=p.line.icon),t.eventInfo={trigger:n,nodes:[e]},p.app.fire(t.type,t)}),p.labelsSp.addChild(c)),(t.edgeIconElement=c).nodeData=t)),p.line.arrow.enabled&&((n=p.arrowsSp.getChildById(e="arrow_"+a))?(n.context.x=p.line.arrow.offsetX,n.context.y=p.line.arrow.offsetY,n.context.fillStyle=u,n.context.control.x=d.x,n.context.control.y=d.y,n.context.point=t.points.slice(-1)[0],n.context.strokeStyle=u,n.context.fillStyle=u):(n=new w({id:e,context:{x:p.line.arrow.offsetX,y:p.line.arrow.offsetY,control:d,point:t.points.slice(-1)[0],strokeStyle:u,fillStyle:u}}),p.arrowsSp.addChild(n)),t.arrowElement=n)})}},{key:"_drawNode",value:function(t){var i=this,e=p,n="node_"+t.key,a=i.node.cursor,r=i._getNodeStyle(t),o=r.lineWidth,l=r.fillStyle,s=r.strokeStyle,u=r.radius,d=r.shadowOffsetX,h=r.shadowOffsetY,c=r.shadowBlur,r=r.shadowColor,u={x:parseInt(t.x)-parseInt(t.boundingClientWidth/2),y:parseInt(t.y)-parseInt(t.height/2),width:t.boundingClientWidth,height:t.height,cursor:a,lineWidth:o,fillStyle:l,strokeStyle:s,radius:u,shadowOffsetX:d,shadowOffsetY:h,shadowBlur:c,shadowColor:r},f=("diamond"==t.shapeType&&(e=v,u={x:parseInt(t.x),y:parseInt(t.y),cursor:a,innerRect:t._innerBound,lineWidth:o,fillStyle:l,strokeStyle:s,shadowOffsetX:d,shadowOffsetY:h,shadowBlur:c,shadowColor:r}),i.nodesSp.getChildById(n));f?(y.extend(f.context,u),f.nodeData=t,f.fire("transform")):(f=new e({id:n,hoverClone:!1,context:u}),i.nodesSp.addChild(f),f.on(_.types.get(),function(t){var e,n=this.nodeData;n.__no_value=!0,t.eventInfo={trigger:i.node,nodes:[n]},i.node.focus.enabled&&("mouseover"==t.type&&i.focusAt(this.nodeData),"mouseout"==t.type&&i.unfocusAt(this.nodeData)),i.node.select.enabled&&-1<i.node.select.triggerEventType.indexOf(t.type)&&(n=i.node.select.onbefore,e=i.node.select.onend,n&&("function"!=typeof n||!1===n.apply(i,[this.nodeData,t]))||(this.nodeData.selected?i.unselectAt(this.nodeData):i.selectAt(this.nodeData),e&&"function"==typeof e&&e.apply(i,[this.nodeData,t]))),i.app.fire(t.type,t)}),f.nodeData=t),t.shapeElement=f,-1<i.node.select.list.indexOf(t.key)&&i.selectAt(t),"canvas"==t.ctype&&(t.contentElement.context.visible=!0),f.on("transform",function(){var t,e,n=this.nodeData;"canvas"==n.ctype?(n.contentElement.context.x=parseInt(n.x-n.boundingClientWidth/2+i.node.padding+(n.preIconCharCode?20:0)),n.contentElement.context.y=parseInt(n.y)):"html"==n.ctype&&(t="undefined"!=typeof window?window.devicePixelRatio:1,e=(e=f.worldTransform.clone()).scale(1/t,1/t),n.contentElement.style.transform="matrix("+e.toArray().join()+")",n.contentElement.style.transformOrigin="left top","diamond"==n.shapeType&&(n.contentElement.style.left=-parseInt((n.boundingClientWidth-n._innerBound.width)/2*i.status.transform.scale)+"px",n.contentElement.style.top=-parseInt(n.height/2*i.status.transform.scale)+"px"),n.contentElement.style.visibility="visible")})}},{key:"_getNodeStyle",value:function(t,e){var n=this,i=y.flatten([n.getProp(n.node.radius,t)]),a=n.node;return"select"==e&&(a=n.node.select),"focus"==e&&(a=n.node.focus),{lineWidth:n.getProp(a.lineWidth,t),fillStyle:n.getProp(a.fillStyle,t),strokeStyle:n.getProp(a.strokeStyle,t),radius:i,shadowOffsetX:n.getProp(a.shadow.shadowOffsetX,t),shadowOffsetY:n.getProp(a.shadow.shadowOffsetY,t),shadowBlur:n.getProp(a.shadow.shadowBlur,t),shadowColor:n.getProp(a.shadow.shadowColor,t)}}},{key:"_setNodeStyle",value:function(t,e){var e=this._getNodeStyle(t,e),n=e.lineWidth,i=e.fillStyle,a=e.strokeStyle,r=e.shadowOffsetX,o=e.shadowOffsetY,l=e.shadowBlur,e=e.shadowColor;t.shapeElement&&t.shapeElement.context&&((t=t.shapeElement.context).lineWidth=n,t.fillStyle=i,t.strokeStyle=a,t.shadowOffsetX=r,t.shadowOffsetY=o,t.shadowBlur=l,t.shadowColor=e)}},{key:"offset",value:function(){var t=this.zoom.offset(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{x:0,y:0}),e=t.x,t=t.y;this.graphsView.context.x=parseInt(e),this.graphsView.context.y=parseInt(t)}},{key:"setNodeToCenter",value:function(t){var e,n,t=this.getNodeDataAt(t);t&&(e=t.shapeElement.localToGlobal(),n=this.app.width/2-t.width/2,t=this.app.height/2-t.height/2,n={x:parseInt(n-e.x),y:parseInt(t-e.y)},this.offset(n))}},{key:"focusAt",value:function(t){t=this.getNodeDataAt(t);t&&(t.selected||this._setNodeStyle(t,"focus"),t.focused=!0)}},{key:"unfocusAt",value:function(t){t=this.getNodeDataAt(t);t&&(t.selected||this._setNodeStyle(t),t.focused=!1)}},{key:"selectAt",value:function(t){t=this.getNodeDataAt(t);t&&(this._setNodeStyle(t,"select"),t.selected=!0,-1==this.node.select.list.indexOf(t.key)&&this.node.select.list.push(t.key))}},{key:"selectAll",value:function(){var e=this;this.data.nodes.forEach(function(t){e.selectAt(t)})}},{key:"unselectAt",value:function(t){var t=this.getNodeDataAt(t);t&&(t.focused?this._setNodeStyle(t,"focus"):this._setNodeStyle(t),t.selected=!1,-1<(t=this.node.select.list.indexOf(t.key))&&this.node.select.list.splice(t,1))}},{key:"unselectAll",value:function(){var e=this;this.data.nodes.forEach(function(t){e.unselectAt(t)}),this.node.select.list=[]}},{key:"getNodeDataAt",value:function(e){return!e.type||"relation"!=e.type&&"tree"!=e.type?"string"==typeof e?1==(n=e.split(",")).length?this.data.nodes.find(function(t){return t.key==e}):2==n.length?this.data.edges.find(function(t){return t.key.join()==n.join()}):void 0:void 0:e;var n}},{key:"_getLineShape",value:function(t,o){var l=t.points,e={type:"path",pointList:null,path:s},n=l.splice(0,1)[0],s="M"+n.x+" "+n.y,n=l[0],i=(s+=",L"+n.x+" "+n.y,l.slice(-1)[0]);return"bezier"==t.shapeType&&(3==l.length&&(s+=",Q"+l[1].x+" "+l[1].y+" "+i.x+" "+i.y),4==l.length&&(s+=",C"+l[1].x+" "+l[1].y+" "+l[2].x+" "+l[2].y+" "+i.x+" "+i.y),5<=l.length)?(e.type="brokenLine",e.pointList=l.map(function(t){return[t.x,t.y]})):("brokenLine"==t.shapeType&&(3==l.length&&l.splice(1,0,{x:l[1].x,y:n.y}),y.each(l,function(e,t){var n,i,a,r;t&&(o&&t<l.length-1?(a=l[t-1],t=l[t+1],r=o,n=Math.max(Math.abs(a.x-e.x)/2,Math.abs(a.y-e.y)/2),i=Math.max(Math.abs(t.x-e.x)/2,Math.abs(t.y-e.y)/2),r=y.min([r,n,i]),e.x==a.x&&e.y==a.y||e.x==t.x&&e.y==t.y||Math.atan2(e.y-a.y,e.x-a.x)==Math.atan2(t.y-e.y,t.x-e.x)||(i=(n=function(t){t=Math.atan2(t.y-e.y,t.x-e.x);return{x:e.x+r*Math.cos(t),y:e.y+r*Math.sin(t)}})(a),a=n(t),s+=",L"+i.x+" "+i.y+",Q"+e.x+" "+e.y+" "+a.x+" "+a.y)):s+=",L"+e.x+" "+e.y)})),"underLine"==t.target.shapeType&&(i=t.target.rowData._node.boundingClientWidth,n=parseInt(t.target.x)+parseInt(i/2),s+=",L"+n+" "+(parseInt(t.target.y)+parseInt(t.target.height/2))),e.path=s),e}},{key:"_checkHtml",value:function(t){return/<[^>]+>/g.test(t)}},{key:"_getContent",value:function(t){var e,n=this.node.content.field;return this._isField(n)&&(e=t[n]),this.node.content.format&&y.isFunction(this.node.content.format)?e=this.node.content.format.apply(this,[e,t]):(t=this.app.getComponent({name:"coord"}).getFieldConfig(n))&&(e=t.getFormatValue(e)),e}},{key:"_isField",value:function(t){return~this.dataFrame.fields.indexOf(t)}},{key:"_getEleAndsetCanvasSize",value:function(u){var d=this,h=this;return new Promise(function(t){function e(){a=a||s.getTextWidth()+h.getProp(h.node.padding,u)*h.status.transform.scale*2,r=r||s.getTextHeight()+h.getProp(h.node.padding,u)*h.status.transform.scale*2,t({contentElement:s,width:parseInt(a),height:parseInt(r)})}var n,i=u.content,a=h.getProp(h.node.width,u),r=(!a&&u.width&&(a=u.width),h.getProp(h.node.height,u)),o=(!r&&u.height&&(r=u.height),h.getProp(h.node.content.fontColor,u)),o=(u.rowData.fontColor&&(o=u.rowData.fontColor),{fillStyle:o=u.rowData.style&&u.rowData.style.fontColor?u.rowData.style.fontColor:o,textAlign:h.getProp(h.node.content.textAlign,u),textBaseline:h.getProp(h.node.content.textBaseline,u),fontSize:h.getProp(h.node.content.fontSize,u)}),l="content_label_"+u.key,s=u.contentElement||h.nodesContentSp.getChildById(l);s?(s.resetText(i),y.extend(s.context,o)):((s=new g.default.Display.Text(i,{id:l,context:o})).context.visible=!1,y.isArray(u.key)||h.nodesContentSp.addChild(s)),d.node.content.init&&"function"==typeof d.node.content.init&&(n=d.node.content.init(u,s));n&&"function"==typeof n.then?n.then(function(){e()}):e()})}},{key:"_getEleAndsetHtmlSize",value:function(s){var u=this,d=this;return new Promise(function(t){function e(){a=a||l.offsetWidth,r=r||l.offsetHeight,t({contentElement:l,width:parseInt(a),height:parseInt(r)})}var n,i=s.content,a=d.getProp(d.node.width,s),r=(!a&&d.node.rowData&&s.rowData.width&&(a=s.rowData.width),d.getProp(d.node.height,s)),o=(!r&&d.node.rowData&&s.rowData.height&&(r=s.rowData.height),"__content_label_"+s.key),l=s.contentElement||u.domContainer.getElementsByClassName(o)[0];l||((l=document.createElement("div")).className="chartx_relation_node "+o,l.style.cssText+="; position:absolute;visibility:hidden;",u.domContainer.appendChild(l)),l.style.cssText+="; color:"+d.getProp(d.node.content.fontColor,s)+";",l.style.cssText+="; text-align:"+d.getProp(d.node.content.textAlign,s)+";",l.style.cssText+="; vertical-align:"+d.getProp(d.node.content.textBaseline,s)+";",l.innerHTML=i,u.node.content.init&&"function"==typeof u.node.content.init&&(n=u.node.content.init(s,l));n&&"function"==typeof n.then?n.then(function(t){e()}):e()})}},{key:"getNodesAt",value:function(){}},{key:"getProp",value:function(t,e){var n=t;return this._isField(t)?n=e.rowData[t]:(y.isArray(t)&&(n=t[e.iNode]),y.isFunction(t)&&(n=t.apply(this,Array.prototype.slice.call(arguments).slice(1)))),n}}],[{key:"defaultProps",value:function(){return{field:{detail:"key字段设置",documentation:"",default:null},rankdir:{detail:"布局方向",default:null},ranksep:{detail:"排与排之间的距离",default:40},nodesep:{detail:"同级node之间的距离",default:20},node:{detail:"单个节点的配置",propertys:{shapeType:{detail:"节点图形，支持rect,diamond,underLine(adc用)",default:"rect"},maxWidth:{detail:"节点最大的width",default:200},cursor:{detail:"节点的鼠标样式",default:"pointer"},width:{detail:"节点的width,默认null（系统自动计算）, 也可以是个function，用户来计算每一个节点的width",default:null},height:{detail:"节点的height,默认null（系统自动计算）, 也可以是个function，用户来计算每一个节点的height",default:null},radius:{detail:"圆角角度，对rect生效",default:4},includedAngle:{detail:"shapeType为 diamond (菱形)的时候生效,x方向的夹角",default:60},fillStyle:{detail:"节点背景色",default:"#ffffff"},lineWidth:{detail:"描边宽度",default:1},strokeStyle:{detail:"描边颜色",default:"#e5e5e5"},shadow:{detail:"阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},select:{detail:"选中效果",propertys:{enabled:{detail:"是否开启选中",default:!1},list:{detail:"选中的node.key的集合,外部传入可以选中",default:[]},triggerEventType:{detail:"触发事件",default:"click,tap"},shadow:{detail:"选中效果的阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},fillStyle:{detail:"hover节点背景色",default:"#ffffff"},lineWidth:{detail:"hover描边宽度",default:1},strokeStyle:{detail:"hover描边颜色",default:"#e5e5e5"},onbefore:{detail:"执行select处理函数的前处理函数，返回false则取消执行select",default:null},onend:{detail:"执行select处理函数的后处理函数",default:null},content:{detail:"选中后节点内容配置",propertys:{fontColor:{detail:"内容文本颜色",default:"#666"},fontSize:{detail:"内容文本大小（在canvas格式下有效）",default:14},format:{detail:"内容格式化处理函数",default:null}}}}},focus:{detail:"hover效果",propertys:{enabled:{detail:"是否开启hover效果",default:!1},shadow:{detail:"选中效果的阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},fillStyle:{detail:"hover节点背景色",default:"#ffffff"},content:{detail:"hover后节点内容配置",propertys:{fontColor:{detail:"内容文本颜色",default:"#666"},fontSize:{detail:"内容文本大小（在canvas格式下有效）",default:14},format:{detail:"内容格式化处理函数",default:null}}},lineWidth:{detail:"hover描边宽度",default:1},strokeStyle:{detail:"hover描边颜色",default:"#e5e5e5"}}},padding:{detail:"node节点容器到内容的边距,节点内容是canvas的时候生效，dom节点不生效",default:10},content:{detail:"节点内容配置",propertys:{field:{detail:"内容字段",documentation:"默认content字段",default:"content"},fontColor:{detail:"内容文本颜色",default:"#666"},fontSize:{detail:"内容文本大小（在canvas格式下有效）",default:14},format:{detail:"内容格式化处理函数",default:null},textAlign:{detail:"textAlign",default:"center"},textBaseline:{detail:"textBaseline",default:"middle"},init:{detail:"内容节点的初始化完成回调",documentation:"在节点内容配置为需要异步完成的时候，比如节点内容配置为一个magix的view",default:null}}}}},line:{detail:"两个节点连线配置",propertys:{isTree:{detail:"是否树结构的连线",documentation:"非树结构启用该配置可能会有意想不到的惊喜，慎用",default:!1},inflectionRadius:{detail:"树状连线的拐点圆角半径",default:0},shapeType:{detail:"连线的图形样式 brokenLine or bezier",default:"bezier"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"连线的颜色",default:"#e5e5e5"},lineType:{detail:"连线样式（虚线等）",default:"solid"},arrow:{detail:"连线箭头配置",propertys:{enabled:{detail:"是否开启arrow设置",default:!0},offsetX:{detail:"x方向偏移",default:0},offsetY:{detail:"y方向偏移",default:0}}},edgeLabel:{detail:"连线上面的label配置",propertys:{enabled:{detail:"是否开启label设置",default:!0},fontColor:{detail:"文本颜色",default:"#ccc"},fontSize:{detail:"文本大小",default:12},offset:{detail:"label的位置，函数，参数是整个edge对象",default:null}}},icon:{detail:"连线上面的操作icon",propertys:{enabled:{detail:"是否开启线上的icon设置",default:!1},charCode:{detail:"iconfont上面对应的unicode中&#x后面的字符",default:null},lineWidth:{detail:"icon描边线宽",default:1},strokeStyle:{detail:"icon的描边颜色",default:"#e5e5e5"},fontColor:{detail:"icon的颜色",default:"#e5e5e5"},fontFamily:{detail:"font-face的font-family设置",default:"iconfont"},fontSize:{detail:"icon的字体大小",default:14},offset:{detail:"icon的位置，函数，参数是整个edge对象",default:null},offsetX:{detail:"在计算出offset后的X再次便宜量",default:1},offsetY:{detail:"在计算出offset后的Y再次便宜量",default:2},background:{detail:"icon的背景颜色，背景为圆形",default:"#fff"}}},cursor:"default"}},status:{detail:"一些开关配置",propertys:{transform:{detail:"是否启动拖拽缩放整个画布",propertys:{fitView:{detail:"自动缩放",default:""},enabled:{detail:"是否开启",default:!0},scale:{detail:"缩放值",default:1},scaleOrigin:{detail:"缩放原点",default:{x:0,y:0}},wheelAction:{detail:"滚轮触屏滑动触发的行为，可选有scale和offset，默认offset",default:"offset"}}}}}}}}]),r}(u.default);e.default=u}));function defaultSeparation(t,e){return t.parent===e.parent?1:2}function meanX(t){return t.reduce(meanXReduce,0)/t.length}function meanXReduce(t,e){return t+e.x}function maxY(t){return 1+t.reduce(maxYReduce,0)}function maxYReduce(t,e){return Math.max(t,e.y)}function leafLeft(t){for(var e;e=t.children;)t=e[0];return t}function leafRight(t){for(var e;e=t.children;)t=e[e.length-1];return t}function cluster(){var l=defaultSeparation,s=1,u=1,d=!1;function e(e){var n,i=0,t=(e.eachAfter(function(t){var e=t.children;e?(t.x=meanX(e),t.y=maxY(e)):(t.x=n?i+=l(t,n):0,t.y=0,n=t)}),leafLeft(e)),a=leafRight(e),r=t.x-l(t,a)/2,o=a.x+l(a,t)/2;return e.eachAfter(d?function(t){t.x=(t.x-e.x)*s,t.y=(e.y-t.y)*u}:function(t){t.x=(t.x-r)/(o-r)*s,t.y=(1-(e.y?t.y/e.y:1))*u})}return e.separation=function(t){return arguments.length?(l=t,e):l},e.size=function(t){return arguments.length?(d=!1,s=+t[0],u=+t[1],e):d?null:[s,u]},e.nodeSize=function(t){return arguments.length?(d=!0,s=+t[0],u=+t[1],e):d?[s,u]:null},e}function count(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;0<=--i;)e+=n[i].value;else e=1;t.value=e}function node_count(){return this.eachAfter(count)}function node_each(t){var e,n,i,a,r,o=[this];do{for(n=o.reverse(),o=[];e=n.pop();)if(t(e),i=e.children)for(a=0,r=i.length;a<r;++a)o.push(i[a])}while(o.length);return this}function node_eachBefore(t){for(var e,n,i,a=[this];e=a.pop();)if(t(e),n=e.children)for(i=n.length-1;0<=i;--i)a.push(n[i]);return this}function node_eachAfter(t){for(var e,n,i,a=this,r=[a],o=[];a=r.pop();)if(o.push(a),e=a.children)for(n=0,i=e.length;n<i;++n)r.push(e[n]);for(;a=o.pop();)t(a);return this}function node_sum(a){return this.eachAfter(function(t){for(var e=+a(t.data)||0,n=t.children,i=n&&n.length;0<=--i;)e+=n[i].value;t.value=e})}function node_sort(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function node_path(t){for(var e=this,n=leastCommonAncestor(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var a=i.length;t!==n;)i.splice(a,0,t),t=t.parent;return i}function leastCommonAncestor(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),a=null;for(t=n.pop(),e=i.pop();t===e;)a=t,t=n.pop(),e=i.pop();return a}function node_ancestors(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function node_descendants(){var e=[];return this.each(function(t){e.push(t)}),e}function node_leaves(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function node_links(){var e=this,n=[];return e.each(function(t){t!==e&&n.push({source:t.parent,target:t})}),n}function hierarchy$1(t,e){var n,i,a,r,o,l=new Node(t),s=+t.value&&(l.value=t.value),u=[l];for(null==e&&(e=defaultChildren);n=u.pop();)if(s&&(n.value=+n.data.value),(a=e(n.data))&&(o=a.length))for(n.children=new Array(o),r=o-1;0<=r;--r)u.push(i=n.children[r]=new Node(a[r])),i.parent=n,i.depth=n.depth+1;return l.eachBefore(computeHeight)}function node_copy(){return hierarchy$1(this).eachBefore(copyData)}function defaultChildren(t){return t.children}function copyData(t){t.data=t.data.data}function computeHeight(t){for(var e=0;t.height=e,(t=t.parent)&&t.height<++e;);}function Node(t){this.data=t,this.depth=this.height=0,this.parent=null}unwrapExports(base),Node.prototype=hierarchy$1.prototype={constructor:Node,count:node_count,each:node_each,eachAfter:node_eachAfter,eachBefore:node_eachBefore,sum:node_sum,sort:node_sort,path:node_path,ancestors:node_ancestors,descendants:node_descendants,leaves:node_leaves,links:node_links,copy:node_copy};var slice$1=Array.prototype.slice;function shuffle(t){for(var e,n,i=t.length;i;)n=Math.random()*i--|0,e=t[i],t[i]=t[n],t[n]=e;return t}function enclose(t){for(var e,n,i=0,a=(t=shuffle(slice$1.call(t))).length,r=[];i<a;)e=t[i],n&&enclosesWeak(n,e)?++i:(n=encloseBasis(r=extendBasis(r,e)),i=0);return n}function extendBasis(t,e){var n,i;if(enclosesWeakAll(e,t))return[e];for(n=0;n<t.length;++n)if(enclosesNot(e,t[n])&&enclosesWeakAll(encloseBasis2(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(enclosesNot(encloseBasis2(t[n],t[i]),e)&&enclosesNot(encloseBasis2(t[n],e),t[i])&&enclosesNot(encloseBasis2(t[i],e),t[n])&&enclosesWeakAll(encloseBasis3(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}function enclosesNot(t,e){var n=t.r-e.r,i=e.x-t.x,e=e.y-t.y;return n<0||n*n<i*i+e*e}function enclosesWeak(t,e){var n=t.r-e.r+1e-6,i=e.x-t.x,e=e.y-t.y;return 0<n&&i*i+e*e<n*n}function enclosesWeakAll(t,e){for(var n=0;n<e.length;++n)if(!enclosesWeak(t,e[n]))return!1;return!0}function encloseBasis(t){switch(t.length){case 1:return encloseBasis1(t[0]);case 2:return encloseBasis2(t[0],t[1]);case 3:return encloseBasis3(t[0],t[1],t[2])}}function encloseBasis1(t){return{x:t.x,y:t.y,r:t.r}}function encloseBasis2(t,e){var n=t.x,i=t.y,t=t.r,a=e.x,r=e.y,e=e.r,o=a-n,l=r-i,s=e-t,u=Math.sqrt(o*o+l*l);return{x:(n+a+o/u*s)/2,y:(i+r+l/u*s)/2,r:(u+t+e)/2}}function encloseBasis3(t,e,n){var i=t.x,a=t.y,t=t.r,r=e.x,o=e.y,e=e.r,l=n.x,s=n.y,n=n.r,u=i-r,d=i-l,h=a-o,c=a-s,f=e-t,p=n-t,g=i*i+a*a-t*t,r=g-r*r-o*o+e*e,o=g-l*l-s*s+n*n,e=d*h-u*c,g=(h*o-c*r)/(2*e)-i,l=(c*f-h*p)/e,s=(d*r-u*o)/(2*e)-a,n=(u*p-d*f)/e,c=l*l+n*n-1,h=2*(t+g*l+s*n),r=g*g+s*s-t*t,o=-(c?(h+Math.sqrt(h*h-4*c*r))/(2*c):r/h);return{x:i+g+l*o,y:a+s+n*o,r:o}}function place(t,e,n){var i,a=t.x,r=t.y,o=e.r+n.r,t=t.r+n.r,l=e.x-a,e=e.y-r,s=l*l+e*e;s?(i=.5+((t*=t)-(o*=o))/(2*s),o=Math.sqrt(Math.max(0,2*o*(t+s)-(t-=s)*t-o*o))/(2*s),n.x=a+i*l+o*e,n.y=r+i*e-o*l):(n.x=a+t,n.y=r)}function intersects(t,e){var n=e.x-t.x,i=e.y-t.y,t=t.r+e.r;return n*n+i*i<t*t-1e-6}function score(t){var e=t._,t=t.next._,n=e.r+t.r,i=(e.x*t.r+t.x*e.r)/n,t=(e.y*t.r+t.y*e.r)/n;return i*i+t*t}function Node$1(t){this._=t,this.next=null,this.previous=null}function packEnclose(t){if(!(i=t.length))return 0;var e,n,i,a,r,o,l,s,u,d,h=t[0];if(h.x=0,h.y=0,!(1<i))return h.r;if(e=t[1],h.x=-e.r,e.x=h.r,e.y=0,!(2<i))return h.r+e.r;place(e,h,n=t[2]),h=new Node$1(h),e=new Node$1(e),n=new Node$1(n),((h.next=n.previous=e).next=h.previous=n).next=e.previous=h;t:for(o=3;o<i;++o){place(h._,e._,n=t[o]),n=new Node$1(n),l=e.next,s=h.previous,u=e._.r,d=h._.r;do{if(u<=d){if(intersects(l._,n._)){e=l,(h.next=e).previous=h,--o;continue t}u+=l._.r,l=l.next}else{if(intersects(s._,n._)){((h=s).next=e).previous=h,--o;continue t}d+=s._.r,s=s.previous}}while(l!==s.next);for(n.previous=h,n.next=e,h.next=e.previous=e=n,a=score(h);(n=n.next)!==e;)(r=score(n))<a&&(h=n,a=r);e=h.next}for(h=[e._],n=e;(n=n.next)!==e;)h.push(n._);for(n=enclose(h),o=0;o<i;++o)(h=t[o]).x-=n.x,h.y-=n.y;return n.r}function siblings(t){return packEnclose(t),t}function optional(t){return null==t?null:required(t)}function required(t){if("function"!=typeof t)throw new Error;return t}function constantZero(){return 0}function constant$1(t){return function(){return t}}function defaultRadius(t){return Math.sqrt(t.value)}function index(){var e=null,n=1,i=1,a=constantZero;function r(t){return t.x=n/2,t.y=i/2,e?t.eachBefore(radiusLeaf(e)).eachAfter(packChildren(a,.5)).eachBefore(translateChild(1)):t.eachBefore(radiusLeaf(defaultRadius)).eachAfter(packChildren(constantZero,1)).eachAfter(packChildren(a,t.r/Math.min(n,i))).eachBefore(translateChild(Math.min(n,i)/(2*t.r))),t}return r.radius=function(t){return arguments.length?(e=optional(t),r):e},r.size=function(t){return arguments.length?(n=+t[0],i=+t[1],r):[n,i]},r.padding=function(t){return arguments.length?(a="function"==typeof t?t:constant$1(+t),r):a},r}function radiusLeaf(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function packChildren(o,l){return function(t){if(e=t.children){var e,n,i,a=e.length,r=o(t)*l||0;if(r)for(n=0;n<a;++n)e[n].r+=r;if(i=packEnclose(e),r)for(n=0;n<a;++n)e[n].r-=r;t.r=i+r}}}function translateChild(n){return function(t){var e=t.parent;t.r*=n,e&&(t.x=e.x+n*t.x,t.y=e.y+n*t.y)}}function roundNode(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function treemapDice(t,e,n,i,a){for(var r,o=t.children,l=-1,s=o.length,u=t.value&&(i-e)/t.value;++l<s;)(r=o[l]).y0=n,r.y1=a,r.x0=e,r.x1=e+=r.value*u}function partition$2(){var n=1,i=1,l=0,a=!1;function e(t){var r,o,e=t.height+1;return t.x0=t.y0=l,t.x1=n,t.y1=i/e,t.eachBefore((r=i,o=e,function(t){t.children&&treemapDice(t,t.x0,r*(t.depth+1)/o,t.x1,r*(t.depth+2)/o);var e=t.x0,n=t.y0,i=t.x1-l,a=t.y1-l;i<e&&(e=i=(e+i)/2),a<n&&(n=a=(n+a)/2),t.x0=e,t.y0=n,t.x1=i,t.y1=a})),a&&t.eachBefore(roundNode),t}return e.round=function(t){return arguments.length?(a=!!t,e):a},e.size=function(t){return arguments.length?(n=+t[0],i=+t[1],e):[n,i]},e.padding=function(t){return arguments.length?(l=+t,e):l},e}var keyPrefix="$",preroot={depth:-1},ambiguous={};function defaultId(t){return t.id}function defaultParentId(t){return t.parentId}function stratify(){var d=defaultId,h=defaultParentId;function e(t){for(var e,n,i,a,r,o=t.length,l=new Array(o),s={},u=0;u<o;++u)r=t[u],i=l[u]=new Node(r),null!=(a=d(r,u,t))&&(a+="")&&(s[r=keyPrefix+(i.id=a)]=r in s?ambiguous:i);for(u=0;u<o;++u)if(i=l[u],null!=(a=h(t[u],u,t))&&(a+="")){if(!(n=s[keyPrefix+a]))throw new Error("missing: "+a);if(n===ambiguous)throw new Error("ambiguous: "+a);n.children?n.children.push(i):n.children=[i],i.parent=n}else{if(e)throw new Error("multiple roots");e=i}if(!e)throw new Error("no root");if(e.parent=preroot,e.eachBefore(function(t){t.depth=t.parent.depth+1,--o}).eachBefore(computeHeight),e.parent=null,0<o)throw new Error("cycle");return e}return e.id=function(t){return arguments.length?(d=required(t),e):d},e.parentId=function(t){return arguments.length?(h=required(t),e):h},e}function defaultSeparation$1(t,e){return t.parent===e.parent?1:2}function nextLeft(t){var e=t.children;return e?e[0]:t.t}function nextRight(t){var e=t.children;return e?e[e.length-1]:t.t}function moveSubtree(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function executeShifts(t){for(var e,n=0,i=0,a=t.children,r=a.length;0<=--r;)(e=a[r]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}function nextAncestor(t,e,n){return t.a.parent===e.parent?t.a:n}function TreeNode(t,e){this._=t,this.parent=null,this.children=null,this.A=null,(this.a=this).z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function treeRoot(t){for(var e,n,i,a,r,t=new TreeNode(t,0),o=[t];e=o.pop();)if(i=e._.children)for(e.children=new Array(r=i.length),a=r-1;0<=a;--a)o.push(n=e.children[a]=new TreeNode(i[a],a)),n.parent=e;return(t.parent=new TreeNode(null,0)).children=[t],t}function tree$1(){var c=defaultSeparation$1,s=1,u=1,d=null;function e(t){var e,n,i,a,r,o,l=treeRoot(t);return l.eachAfter(h),l.parent.m=-l.z,l.eachBefore(f),d?t.eachBefore(p):((i=n=e=t).eachBefore(function(t){t.x<e.x&&(e=t),t.x>n.x&&(n=t),t.depth>i.depth&&(i=t)}),l=e===n?1:c(e,n)/2,a=l-e.x,r=s/(n.x+l+a),o=u/(i.depth||1),t.eachBefore(function(t){t.x=(t.x+a)*r,t.y=t.depth*o})),t}function h(t){var e=t.children,n=t.parent.children,i=t.i?n[t.i-1]:null;e?(executeShifts(t),e=(e[0].z+e[e.length-1].z)/2,i?(t.z=i.z+c(t._,i._),t.m=t.z-e):t.z=e):i&&(t.z=i.z+c(t._,i._)),t.parent.A=function(t,e,n){if(e){for(var i,a=t,r=t,o=e,l=a.parent.children[0],s=a.m,u=r.m,d=o.m,h=l.m;o=nextRight(o),a=nextLeft(a),o&&a;)l=nextLeft(l),(r=nextRight(r)).a=t,0<(i=o.z+d-a.z-s+c(o._,a._))&&(moveSubtree(nextAncestor(o,t,n),t,i),s+=i,u+=i),d+=o.m,s+=a.m,h+=l.m,u+=r.m;o&&!nextRight(r)&&(r.t=o,r.m+=d-u),a&&!nextLeft(l)&&(l.t=a,l.m+=s-h,n=t)}return n}(t,i,t.parent.A||n[0])}function f(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function p(t){t.x*=s,t.y=t.depth*u}return e.separation=function(t){return arguments.length?(c=t,e):c},e.size=function(t){return arguments.length?(d=!1,s=+t[0],u=+t[1],e):d?null:[s,u]},e.nodeSize=function(t){return arguments.length?(d=!0,s=+t[0],u=+t[1],e):d?[s,u]:null},e}function treemapSlice(t,e,n,i,a){for(var r,o=t.children,l=-1,s=o.length,u=t.value&&(a-n)/t.value;++l<s;)(r=o[l]).x0=e,r.x1=i,r.y0=n,r.y1=n+=r.value*u}TreeNode.prototype=Object.create(Node.prototype);var phi=(1+Math.sqrt(5))/2;function squarifyRatio(t,e,n,i,a,r){for(var o,l,s,u,d,h,c,f,p,g,y,_=[],v=e.children,x=0,m=0,b=v.length,w=e.value;x<b;){for(s=a-n,u=r-i;!(d=v[m++].value)&&m<b;);for(y=(h=c=d)*d*(g=Math.max(u/s,s/u)/(w*t)),p=Math.max(c/y,y/h);m<b;++m){if(d+=l=v[m].value,l<h&&(h=l),c<l&&(c=l),y=d*d*g,p<(f=Math.max(c/y,y/h))){d-=l;break}p=f}_.push(o={value:d,dice:s<u,children:v.slice(x,m)}),o.dice?treemapDice(o,n,i,a,w?i+=u*d/w:r):treemapSlice(o,n,i,w?n+=s*d/w:a,r),w-=d,x=m}return _}var squarify=function e(r){function t(t,e,n,i,a){squarifyRatio(r,t,e,n,i,a)}return t.ratio=function(t){return e(1<(t=+t)?t:1)},t}(phi);function index$1(){var o=squarify,e=!1,n=1,i=1,l=[0],s=constantZero,u=constantZero,d=constantZero,h=constantZero,c=constantZero;function a(t){return t.x0=t.y0=0,t.x1=n,t.y1=i,t.eachBefore(r),l=[0],e&&t.eachBefore(roundNode),t}function r(t){var e=l[t.depth],n=t.x0+e,i=t.y0+e,a=t.x1-e,r=t.y1-e;a<n&&(n=a=(n+a)/2),r<i&&(i=r=(i+r)/2),t.x0=n,t.y0=i,t.x1=a,t.y1=r,t.children&&(e=l[t.depth+1]=s(t)/2,n+=c(t)-e,i+=u(t)-e,(a-=d(t)-e)<n&&(n=a=(n+a)/2),(r-=h(t)-e)<i&&(i=r=(i+r)/2),o(t,n,i,a,r))}return a.round=function(t){return arguments.length?(e=!!t,a):e},a.size=function(t){return arguments.length?(n=+t[0],i=+t[1],a):[n,i]},a.tile=function(t){return arguments.length?(o=required(t),a):o},a.padding=function(t){return arguments.length?a.paddingInner(t).paddingOuter(t):a.paddingInner()},a.paddingInner=function(t){return arguments.length?(s="function"==typeof t?t:constant$1(+t),a):s},a.paddingOuter=function(t){return arguments.length?a.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):a.paddingTop()},a.paddingTop=function(t){return arguments.length?(u="function"==typeof t?t:constant$1(+t),a):u},a.paddingRight=function(t){return arguments.length?(d="function"==typeof t?t:constant$1(+t),a):d},a.paddingBottom=function(t){return arguments.length?(h="function"==typeof t?t:constant$1(+t),a):h},a.paddingLeft=function(t){return arguments.length?(c="function"==typeof t?t:constant$1(+t),a):c},a}function binary(t,e,n,i,a){var r,o,g=t.children,l=g.length,y=new Array(l+1);for(y[0]=o=r=0;r<l;++r)y[r+1]=o+=g[r].value;!function t(e,n,i,a,r,o,l){if(n-1<=e)return(s=g[e]).x0=a,s.y0=r,s.x1=o,void(s.y1=l);var s=y[e],u=i/2+s,d=e+1,h=n-1;for(;d<h;){var c=d+h>>>1;y[c]<u?d=1+c:h=c}u-y[d-1]<y[d]-u&&e+1<d&&--d;var s=y[d]-s,f=i-s;{var p;l-r<o-a?(t(e,d,s,a,r,p=(a*f+o*s)/i,l),t(d,n,f,p,r,o,l)):(t(e,d,s,a,r,o,p=(r*f+l*s)/i),t(d,n,f,a,p,o,l))}}(0,l,t.value,e,n,i,a)}function sliceDice(t,e,n,i,a){(1&t.depth?treemapSlice:treemapDice)(t,e,n,i,a)}var resquarify=function e(f){function t(t,e,n,i,a){if((r=t._squarify)&&r.ratio===f)for(var r,o,l,s,u,d=-1,h=r.length,c=t.value;++d<h;){for(l=(o=r[d]).children,s=o.value=0,u=l.length;s<u;++s)o.value+=l[s].value;o.dice?treemapDice(o,e,n,i,n+=(a-n)*o.value/c):treemapSlice(o,e,n,e+=(i-e)*o.value/c,a),c-=o.value}else t._squarify=r=squarifyRatio(f,t,e,n,i,a),r.ratio=f}return t.ratio=function(t){return e(1<(t=+t)?t:1)},t}(phi),d3Hierarchy=Object.freeze({__proto__:null,cluster:cluster,hierarchy:hierarchy$1,pack:index,packSiblings:siblings,packEnclose:enclose,partition:partition$2,stratify:stratify,tree:tree$1,treemap:index$1,treemapBinary:binary,treemapDice:treemapDice,treemapSlice:treemapSlice,treemapSliceDice:sliceDice,treemapSquarify:squarify,treemapResquarify:resquarify}),tree$2=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var n=Object.assign({},f,t);function e(t){var e=n[t];return"function"==typeof e?e:function(){return e}}function i(t){var i,a,r,t=l((i=o(),a=e("nodeSize"),r=e("spacing"),function(){(0,h.default)(n,i);var e=c(n);function n(t){return(0,u.default)(this,n),t=e.call(this,t),Object.assign((0,s.default)(t),{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:(0,s.default)(t),lExtRelX:0,lThr:null,rExt:(0,s.default)(t),rExtRelX:0,rThr:null}),t}return(0,d.default)(n,[{key:"size",get:function(){return a(this.data)}},{key:"spacing",value:function(t){return r(this.data,t.data)}},{key:"x",get:function(){return this.data.x},set:function(t){this.data.x=t}},{key:"y",get:function(){return this.data.y},set:function(t){this.data.y=t}},{key:"update",value:function(){return p(this),g(this),this}}]),n}()),t,function(t){return t.children});return t.update(),t.data}function o(){var i=e("nodeSize"),a=e("spacing");return function(t){(0,h.default)(n,t);var e=c(n);function n(t){return(0,u.default)(this,n),e.call(this,t)}return(0,d.default)(n,[{key:"copy",value:function(){var t=l(this.constructor,this,function(t){return t.children});return t.each(function(t){return t.data=t.data.data}),t}},{key:"size",get:function(){return i(this)}},{key:"spacing",value:function(t){return a(this,t)}},{key:"nodes",get:function(){return this.descendants()}},{key:"xSize",get:function(){return this.size[0]}},{key:"ySize",get:function(){return this.size[1]}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.ySize}},{key:"left",get:function(){return this.x-this.xSize/2}},{key:"right",get:function(){return this.x+this.xSize/2}},{key:"root",get:function(){var t=this.ancestors();return t[t.length-1]}},{key:"numChildren",get:function(){return this.hasChildren?this.children.length:0}},{key:"hasChildren",get:function(){return!this.noChildren}},{key:"noChildren",get:function(){return null===this.children}},{key:"firstChild",get:function(){return this.hasChildren?this.children[0]:null}},{key:"lastChild",get:function(){return this.hasChildren?this.children[this.numChildren-1]:null}},{key:"extents",get:function(){return(this.children||[]).reduce(function(t,e){return n.maxExtents(t,e.extents)},this.nodeExtents)}},{key:"nodeExtents",get:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}],[{key:"maxExtents",value:function(t,e){return{top:Math.min(t.top,e.top),bottom:Math.max(t.bottom,e.bottom),left:Math.min(t.left,e.left),right:Math.max(t.right,e.right)}}}]),n}(d3Hierarchy.hierarchy.prototype.constructor)}function l(a,t,r){return function e(t,n){var i=new a(t),n=(Object.assign(i,{parent:n,depth:null===n?0:n.depth+1,height:0,length:1}),r(t)||[]);return i.children=0===n.length?null:n.map(function(t){return e(t,i)}),i.children&&Object.assign(i,i.children.reduce(function(t,e){return{height:Math.max(t.height,e.height+1),length:t.length+e.length}},i)),i}(t,null)}return Object.assign(i,{nodeSize:function(t){return arguments.length?(n.nodeSize=t,i):n.nodeSize},spacing:function(t){return arguments.length?(n.spacing=t,i):n.spacing},children:function(t){return arguments.length?(n.children=t,i):n.children},hierarchy:function(t,e){e=void 0===e?n.children:e;return l(o(),t,e)},dump:function(t){var s=e("nodeSize");return function o(l){return function(t){var e=l+"  ",n=l+"    ",i=t.x,a=t.y,r=s(t),t=t.children||[],t=0===t.length?" ":",".concat(e,"children: [").concat(n).concat(t.map(o(n)).join(n)).concat(e,"],").concat(l);return"{ size: [".concat(r.join(", "),"],").concat(e,"x: ").concat(i,", y: ").concat(a).concat(t,"},")}}("\n")(t)}}),i};var r=interopRequireDefault(slicedToArray),s=interopRequireDefault(assertThisInitialized$1),u=interopRequireDefault(classCallCheck$1),d=interopRequireDefault(createClass$1),h=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),o=interopRequireDefault(getPrototypeOf$1);function c(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,o.default)(n);return t=i?(t=(0,o.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var f=Object.freeze({children:function(t){return t.children},nodeSize:function(t){return t.data.size},spacing:0});var p=function i(a){return a.y=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,(a.children||[]).reduce(function(t,e){var t=(0,r.default)(t,2),n=t[0],t=t[1],e=(i(e,a.y+a.ySize),(0===n?e.lExt:e.rExt).bottom);return 0!==n&&l(a,n,t),[n+1,k(e,n,t)]},[0,null]),n(a),w(a),a},g=function e(n,t,i){void 0===t&&(t=-n.relX-n.prelim,i=0);var a=t+n.relX;return n.relX=a+n.prelim-i,n.prelim=0,n.x=i+n.relX,(n.children||[]).forEach(function(t){return e(t,a,n.x)}),n},n=function(t){(t.children||[]).reduce(function(t,e){var t=(0,r.default)(t,2),n=t[0],t=t[1],n=n+e.shift,t=t+n+e.change;return e.relX+=t,[n,t]},[0,0])},l=function(t,e,n){for(var i=t.children[e-1],a=t.children[e],r=i,o=i.relX,l=a,s=a.relX,u=!0;r&&l;){r.bottom>n.lowY&&(n=n.next);var d=o+r.prelim-(s+l.prelim)+r.xSize/2+l.xSize/2+r.spacing(l),d=((0<d||d<0&&u)&&(s+=d,y(a,d),_(t,e,n.index,d)),u=!1,r.bottom),h=l.bottom;d<=h&&(r=x(r))&&(o+=r.relX),h<=d&&(l=v(l))&&(s+=l.relX)}!r&&l?m(t,e,l,s):r&&!l&&b(t,e,r,o)},y=function(t,e){t.relX+=e,t.lExtRelX+=e,t.rExtRelX+=e},_=function(t,e,n,i){var a=t.children[e],e=e-n;1<e&&(t.children[n+1].shift+=t=i/e,a.shift-=t,a.change-=i-t)},v=function(t){return t.hasChildren?t.firstChild:t.lThr},x=function(t){return t.hasChildren?t.lastChild:t.rThr},m=function(t,e,n,i){var a=t.firstChild,r=a.lExt,t=t.children[e],e=i-(r.lThr=n).relX-a.lExtRelX;r.relX+=e,r.prelim-=e,a.lExt=t.lExt,a.lExtRelX=t.lExtRelX},b=function(t,e,n,i){var a=t.children[e],r=a.rExt,t=t.children[e-1],e=i-(r.rThr=n).relX-a.rExtRelX;r.relX+=e,r.prelim-=e,a.rExt=t.rExt,a.rExtRelX=t.rExtRelX},w=function(t){var e,n,i;t.hasChildren&&(e=t.firstChild,n=t.lastChild,i=(e.prelim+e.relX-e.xSize/2+n.relX+n.prelim+n.xSize/2)/2,Object.assign(t,{prelim:i,lExt:e.lExt,lExtRelX:e.lExtRelX,rExt:n.rExt,rExtRelX:n.rExtRelX}))},k=function(t,e,n){for(;null!==n&&t>=n.lowY;)n=n.next;return{lowY:t,index:e,next:n}}}),compacttree=(unwrapExports(tree$2),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),m=interopRequireDefault(Canvax),i=interopRequireDefault(base),b=interopRequireDefault(trigger),y=interopRequireDefault(tree$2);function u(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var d=m.default._,w=m.default.event,k=m.default.Shapes.Circle,h=(m.default.Shapes.Rect,["collapsed","style","content"]),c=function(t){(0,l.default)(a,t);var i=u(a);function a(t,e,n){return(0,r.default)(this,a),(e=i.call(this,t,e,n)).type="compacttree",d.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(a.defaultProps()),t),e}return(0,n.default)(a,[{key:"draw",value:function(t){var e=this;d.extend(!0,this,t=t||{}),this.initData(t.data).then(function(t){e.data=t,e.layoutData(),e.widget(),e.induce.context.width=e.width,e.induce.context.height=e.height,e.sprite.context.x=parseInt(e.origin.x),e.sprite.context.y=parseInt(e.origin.y),e.preGraphsSpPosition?e.graphsSpPosition={x:e.preGraphsSpPosition.x,y:e.preGraphsSpPosition.y}:e.graphsSpPosition={x:Math.max((e.width-e.data.size.width)/2,e.app.padding.left),y:e.height/2},e.graphsSp.context.x=e.graphsSpPosition.x,e.graphsSp.context.y=e.graphsSpPosition.y,e.fire("complete")})}},{key:"resetData",value:function(t,e){var n=this;this._resetData(t,e).then(function(){n.fire("complete")})}},{key:"widget",value:function(){this._drawEdges(),this._drawNodes()}},{key:"initData",value:function(i,t){var a=this;return new Promise(function(t){var e,n;i&&i.nodes&&i.edges?t(i):(e={nodes:[],edges:[],size:{width:0,height:0},treeOriginData:null,treeData:null,nodesLength:0},n=a.app._data,e.treeOriginData=n,Array.isArray(n)&&(e.treeOriginData=a.arrayToTreeJsonForRelation(a.app.dataFrame.jsonOrg,a)),(new Date).getTime(),Object.assign(e,a._filterTreeData(e.treeOriginData)),(new Date).getTime(),a._initAllDataSize(e).then(function(){t(e)}))})}},{key:"_filterTreeData",value:function(t){var s=this,u=1,d=this.node.collapse.field,h=this.childrenField,c=[],f=[];return{treeData:function i(t,e,a,n,r){if(t){Object.assign(r,{depth:a||0,parent:e,rowInd:n});var o=r[h]||[];if(Object.assign(r,t),r.__originData=t,r[h]=[],"hidden"==(null==r||null==(e=r.style)?void 0:e.visible))return;var n=s._getContent(r),l=(r._node&&n!=r._node.content&&(r._node=null,delete r._node,r.style||(r.style={width:0,height:0}),t.style&&(!t.style||t.style.width&&t.style.height)||(r.style.width=0,r.style.height=0)),s.getDefNode({type:"tree"}));Object.assign(l,{iNode:c.length,rowData:r,key:r[s.field],content:n,ctype:s._checkHtml(n)?"html":"canvas",width:0,height:0,depth:a||0}),l.shapeType=s.getProp(s.node.shapeType,l),l.preIconCharCode=s.getProp(s.node.preIcon.charCode,l),l.icons=s.getProp(s.node.icons,l)||[],Array.isArray(l.icons)||(l.icons=[l.icons]),l.icons.forEach(function(t){var e=Object.assign({},s.node.iconsDefault,t);e.charCode=s.getProp(t.charCode,l),Object.assign(t,e)}),c.push(l),r._node=l,r[d]||(t[h]||[]).forEach(function(e,t){var n=o.find(function(t){return t[s.field]==e[s.field]})||{},t=i(e,r,a+1,t,n);t&&(r[h].push(t),u++,n=s.getDefNode({type:"tree"}),Object.assign(n,{isTree:!0,iNode:f.length,rowData:{},key:[r[s.field],t[s.field]],content:"",ctype:s._checkHtml("")?"html":"canvas",source:r._node,target:t._node,sourceTreeData:r,targetTreeData:t}),n.shapeType=s.getProp(s.line.shapeType,n),f.push(n))})}return r}(t,null,0,0,(null==(t=this.data)?void 0:t.treeData)||{}),nodesLength:u,nodes:c,edges:f}}},{key:"_syncToOrigin",value:function(t){for(var e in t)-1<h.indexOf(e)&&(t.__originData[e]=t[e])}},{key:"_eachTreeDataHandle",value:function(t,e){var n=this;e&&e(t),(t[this.childrenField]||[]).forEach(function(t){n._eachTreeDataHandle(t,e)})}},{key:"_initAllDataSize",value:function(n){var i=this,t=n.treeData,a=n.nodesLength,r=0;return new Promise(function(e){i._eachTreeDataHandle(t,function(t){i._setSize(t).then(function(){i._setNodeBoundingClientWidth(t),i.checkNodeSizeForShapeType(t._node),++r==a&&e(n)})})})}},{key:"_setNodeBoundingClientWidth",value:function(t){var e=t._node,n=e.width||0;"diamond"!=e.shapeType&&e.depth&&t.__originData[this.childrenField]&&t.__originData[this.childrenField].length&&(n+=20),e.preIconCharCode&&(n+=20),e.icons&&e.icons.length&&(n+=20*e.icons.length),e.boundingClientWidth=n}},{key:"_setSize",value:function(a){var r=this;return new Promise(function(e){var n=a._node,t=a.width||a.style&&a.style.width||r.getProp(r.node.width,a),i=a.height||a.style&&a.style.height||r.getProp(r.node.height,a);t&&i?(t={width:t,height:i,contentElement:n.contentElement},d.extend(n,t),e(t)):r._initcontentElementAndSize(a).then(function(t){d.extend(n,t),e(t)})})}},{key:"_initcontentElementAndSize",value:function(a){var r=this;return new Promise(function(e){var t,n=a._node,i=n.ctype;"canvas"==(i=(i=r._isField(i)?n.rowData[i]:i)||"canvas")&&(t=r._getEleAndsetCanvasSize),(t="html"==i?r._getEleAndsetHtmlSize:t).apply(r,[n]).then(function(t){d.extend(n,t),a.style||(a.style={}),a.style.width=n.width,a.style.height=n.height,r._syncToOrigin(a),e(t)})})}},{key:"layoutData",value:function(){d.isFunction(this.layout)?this.layout(this.data):this.treeLayout(this.data)}},{key:"treeLayout",value:function(t){var e=this,n=this.childrenField,i="LR"==this.rankdir||"RL"==this.rankdir,a=((new Date).getTime(),this.nodesep),r=this.ranksep,a=(0,y.default)({spacing:a,nodeSize:function(t){var e=t.data._node.height||0,t=t.data._node.boundingClientWidth||0;return i?[e,t+r]:[t,e+r]},children:function(t){return t[n]}}),o=a.hierarchy(t.treeData),a=a(o),l=0,s=0,u=0,d=0,h=0,c=0,f=0,p=0,g=[];a.each(function(t){var e;i&&(e=t.x,t.x=t.y,t.y=e),t.x<=l&&(h=t.x+t.data._node.boundingClientWidth),l=Math.min(l,t.x),t.x+t.data._node.boundingClientWidth>=u&&(c=t.x),u=Math.max(u,t.x+t.data._node.boundingClientWidth),t.y<=s&&(p=t.y+t.data._node.height),s=Math.min(s,t.y),t.y+t.data._node.height+r>=d&&(f=t.y),d=Math.max(d,t.y+t.data._node.height+r),t.data._node.x=t.x+t.data._node.boundingClientWidth/2,t.data._node.y=t.y+t.data._node.height/2,t.data._node.depth=t.depth,g.push(t.data._node)}),o=u-l,a=d-s-r,t.edges.forEach(function(t){e.getEdgePoints(t)}),Object.assign(t,{nodes:g,size:{width:o,height:a},extents:{left:l,top:s,right:u,bottom:d},viewPort:{maxRight:h,maxLeft:c,maxTop:f,maxBottom:p}})}},{key:"getEdgePoints",value:function(t){var e=[],n={x:parseInt(t.source.x+t.source.boundingClientWidth/2),y:parseInt(t.source.y)},n=(t.source.depth||(n.x=parseInt(t.source.x)),"underLine"==t.source.shapeType&&(n.y=parseInt(t.source.y+t.source.height/2)),e.push(n),{x:n.x+10,y:n.y}),i=(e.push(n),{x:parseInt(t.target.x-t.target.boundingClientWidth/2),y:parseInt(t.target.y)});return"underLine"==t.target.shapeType&&(i.y=parseInt(t.target.y+t.target.height/2)),e.push({x:n.x+parseInt((i.x-n.x)/2),y:i.y}),e.push(i),t.points=e}},{key:"_drawNodes",value:function(){var v=this,x=this;d.each(this.data.nodes,function(y){function t(){function d(t,e){return{iconText:String.fromCharCode(parseInt(e,16)),fontSize:x.getProp(t.fontSize,y,e),fontColor:x.getProp(t.fontColor,y,e),fontFamily:x.getProp(t.fontFamily,y,e),offsetX:x.getProp(t.offsetX,y,e),offsetY:x.getProp(t.offsetY,y,e),tipsContent:t.tipsContent}}var n,i,t,e,a,r,o,l,s,u,h,c,f,p,g;v._drawNode(y),y.depth&&v.node.collapse.enabled&&(c=_+"_collapse_icon",p=_+"_collapse_icon_back",y.rowData[v.childrenField]&&y.rowData.__originData[v.childrenField]&&y.rowData.__originData[v.childrenField].length?(l=v.node.collapse.openCharCode,y.rowData.collapsed||(l=v.node.collapse.closeCharCode),l=String.fromCharCode(parseInt(v.getProp(l,y),16)),e=v.getProp(v.node.collapse.fontSize,y),u=v.getProp(v.node.collapse.fontColor,y),s=v.getProp(v.node.collapse.fontFamily,y),f=v.getProp(v.node.collapse.offsetX,y),t=v.getProp(v.node.collapse.offsetY,y),a=v.getProp(v.node.collapse.background,y),o=v.getProp(v.node.collapse.lineWidth,y),r=v.getProp(v.node.collapse.strokeStyle,y),h=v.labelsSp.getChildById(c),n=v.labelsSp.getChildById(p),f=parseInt(y.x+y.boundingClientWidth/2+f-v.node.padding-e/4),"diamond"==y.shapeType&&(f+=v.node.padding+ +e+1),s={x:f,y:(t=parseInt(y.y+t))+1,fontSize:e,fontFamily:s,fillStyle:u,textAlign:"center",textBaseline:"middle",cursor:"pointer"},u={x:f,y:t,r:parseInt(.5*e)+2,fillStyle:a,strokeStyle:r,lineWidth:o},h?(h.resetText(l),Object.assign(h.context,s),Object.assign(n.context,u)):(h=new m.default.Display.Text(l,{id:c,context:s}),n=new k({id:p,context:u}),v.labelsSp.addChild(n),v.labelsSp.addChild(h),h._collapseIconBack=n,i=v,h.on(w.types.get(),function(t){var e=i.node.collapse;t.eventInfo={trigger:e,tipsContent:i.node.collapse.tipsContent,nodes:[y]},n.context&&("mousedown"==t.type&&(n.context.r+=1),"mouseup"==t.type&&--n.context.r),-1<i.node.collapse.triggerEventType.indexOf(t.type)&&(this.nodeData.rowData.collapsed=!this.nodeData.rowData.collapsed,i._syncToOrigin(this.nodeData.rowData),e=new b.default(i,{origin:_}),i.app.resetData(null,e)),i.app.fire(t.type,t)})),(h.nodeData=y).collapseIcon=h,y.collapseIconBack=n):((f=v.labelsSp.getChildById(c))&&f.destroy(),(t=v.labelsSp.getChildById(p))&&t.destroy())),y.preIconCharCode?(e=_+"_pre_icon",r=(a=d(v.node.preIcon,y.preIconCharCode)).iconText,o=a.fontSize,l=a.fontColor,s=a.fontFamily,u=a.offsetX,h=a.offsetY,a.tipsContent,c={x:parseInt(y.x-y.boundingClientWidth/2+v.node.padding+u),y:parseInt(y.y+h)+1,fontSize:o,fontFamily:s,fillStyle:l,textAlign:"left",textBaseline:"middle",cursor:"pointer"},(f=v.labelsSp.getChildById(e))?(f.resetText(r),Object.assign(f.context,c)):(f=new m.default.Display.Text(r,{id:e,context:c}),v.labelsSp.addChild(f)),y.preIconEl=f):y.preIconEl&&(y.preIconEl.destroy(),delete y.preIconEl),y.icons&&y.icons.length?((g=v.labelsSp.getChildById(p=_+"_icons_sp"))&&g.destroy(),g=new m.default.Display.Sprite({id:p}),v.labelsSp.addChild(g),y.icons.forEach(function(e,t){var n=d(e,e.charCode),i=n.iconText,a=n.fontSize,r=n.fontColor,o=n.fontFamily,l=n.offsetX,s=n.offsetY,u=n.tipsContent,n=parseInt(y.x-y.boundingClientWidth/2+y.width+l+(y.preIconEl?20:0)-v.node.padding/2),l=parseInt(y.y+s),s=new m.default.Display.Text(i,{context:{x:n+20*t,y:l+1,fontSize:a,fontFamily:o,fillStyle:r,textAlign:"left",textBaseline:"middle",cursor:"pointer"}});g.addChild(s),s.on(w.types.get(),function(t){t.eventInfo={trigger:e,tipsContent:u,nodes:[y]},this.context&&("mouseover"==t.type&&(this.context.fontSize+=1),"mouseout"==t.type&&--this.context.fontSize),x.app.fire(t.type,t)})}),y.iconsSp=g):y.iconsSp&&(y.iconsSp.destroy(),delete y.iconsSp)}var _=y.rowData[v.field];v._initcontentElementAndSize(y.rowData).then(function(){t()})})}},{key:"_destroy",value:function(t){var e,n=this;t.shapeElement&&t.shapeElement.destroy(),t.contentElement&&(t.contentElement.destroy?t.contentElement.destroy():this.domContainer.removeChild(t.contentElement)),t.pathElement&&t.pathElement.destroy(),t.labelElement&&t.labelElement.destroy(),t.arrowElement&&t.arrowElement.destroy(),t.edgeIconElement&&t.edgeIconElement.destroy(),t.edgeIconBack&&t.edgeIconBack.destroy(),t.collapseIcon&&t.collapseIcon.destroy(),t.collapseIconBack&&t.collapseIconBack.destroy(),t.preIconEl&&t.preIconEl.destroy(),t.iconsSp&&t.iconsSp.destroy(),Array.isArray(t[this.field])&&(e=t.source,this.data.edges.find(function(t){return t[n.field][0]==e[n.field]})||(e.collapseIcon&&e.collapseIcon.destroy(),e.collapseIconBack&&e.collapseIconBack.destroy()))}},{key:"arrayToTreeJsonForRelation",value:function(t){var r=this,o={},l={},e=(d.each(t,function(t){var e=t[r.field]+"";1==e.split(",").length?o[e]=t:l[e]=t}),[]);return d.each(o,function(t,n){var i=!0;d.each(l,function(t,e){if((e+="").split(",")[1]==n)return i=!1}),i&&(e.push(t),t.__inRelation=!0)}),function t(e){d.each(e,function(i){var a;i.__cycle||(a=i[r.field],d.each(l,function(t,e){var n;(e+="").split(",")[0]==a&&(n=o[e.split(",")[1]])&&(i[r.childrenField]||(i[r.childrenField]=[]),d.find(i[r.childrenField],function(t){return t[r.field]==n[r.field]})||i[r.childrenField].push(n),n.__inRelation&&(n.__cycle=!0))}),i[r.childrenField]&&i[r.childrenField].length&&t(i[r.childrenField]))})}(e),e.length?e[0]:null}}],[{key:"defaultProps",value:function(){return{childrenField:{detail:"树结构数据的关联字段",documentation:"如果是树结构的关联数据，不是行列式，那么就通过这个字段来建立父子关系",default:"children"},rankdir:{detail:"布局方向",default:"LR"},layout:{detail:"紧凑的树布局方案， 也可以设置为一个function，自定义布局算法",default:"tree"},layoutOpts:{detail:"布局引擎对应的配置",propertys:{}},ranksep:{detail:"排与排之间的距离",default:40},nodesep:{detail:"同级node之间的距离",default:20},node:{detail:"单个节点的配置",propertys:{content:{detail:" 内容配置",propertys:{textAlign:{detail:"左右对齐方式",default:"left"}}},collapse:{detail:"树状图是否有节点收缩按钮",propertys:{enabled:{detail:"是否开启",default:!0},field:{detail:"用来记录collapsed是否折叠的字段，在节点的数据上",default:"collapsed"},triggerEventType:{detail:"触发事件",default:"click,tap"},openCharCode:{detail:"点击后触发展开的icon chartCode，当前状态为收缩",default:""},closeCharCode:{detail:"点击后触发收缩的icon chartCode，当前状态为展开",default:""},fontSize:{detail:"icon字号大小",default:10},fontColor:{detail:"icon字体颜色",default:"#666"},fontFamily:{detail:"icon在css中的fontFamily",default:"iconfont"},tipsContent:{detail:"鼠标移动到收缩icon上面的tips内容",default:""},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0},background:{detail:"icon的 背景色",default:"#fff"},lineWidth:{detail:"边框大小",default:1},strokeStyle:{detail:"描边颜色",default:"#667894"}}},preIcon:{detail:"内容前面的一个icon，主要用来描这个node的类型",propertys:{charCode:{detail:"icon的iconfont字符串",default:""},fontSize:{detail:"icon字号大小",default:18},fontColor:{detail:"icon字体颜色",default:"#666"},fontFamily:{detail:"icon在css中的fontFamily",default:"iconfont"},tipsContent:{detail:"鼠标移动到收缩icon上面的tips内容",default:""},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0}}},icons:{detail:"相对于preIcon，跟在label后面的一组icon",default:[]},iconsDefault:{detail:"内容后面的一组icon，是个数组， 支持函数返回一组icon，单个icon的格式和preIcon保持一致",propertys:{charCode:{detail:"icon的iconfont字符串",default:""},fontSize:{detail:"icon字号大小",default:12},fontColor:{detail:"icon字体颜色",default:"#666"},fontFamily:{detail:"icon在css中的fontFamily",default:"iconfont"},tipsContent:{detail:"鼠标移动到收缩icon上面的tips内容",default:""},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0}}}}},line:{detail:"连线配置",propertys:{arrow:{detail:"箭头配置",propertys:{enabled:{detail:"是否显示",default:!1}}},edgeLabel:{detail:"连线文本",propertys:{enabled:{detail:"是否要连线的文本",default:!1}}},icon:{detail:"连线上的icon",propertys:{enabled:{detail:"是否要连线上的icon",default:!1}}}}}}}}]),a}(i.default);i.default.registerComponent(c,"graphs","compacttree"),e.default=c}));function center(r,o){var l,s=1;function e(){for(var t,e=l.length,n=0,i=0,a=0;a<e;++a)n+=(t=l[a]).x,i+=t.y;for(n=(n/e-r)*s,i=(i/e-o)*s,a=0;a<e;++a)(t=l[a]).x-=n,t.y-=i}return null==r&&(r=0),null==o&&(o=0),e.initialize=function(t){l=t},e.x=function(t){return arguments.length?(r=+t,e):r},e.y=function(t){return arguments.length?(o=+t,e):o},e.strength=function(t){return arguments.length?(s=+t,e):s},e}function tree_add(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return add$1(this.cover(e,n),e,n,t)}function add$1(t,e,n,i){if(!isNaN(e)&&!isNaN(n)){var a,r,o,l,s,u,d,h,c,f=t._root,p={data:i},g=t._x0,y=t._y0,_=t._x1,v=t._y1;if(f){for(;f.length;)if((u=e>=(r=(g+_)/2))?g=r:_=r,(d=n>=(o=(y+v)/2))?y=o:v=o,!(f=(a=f)[h=d<<1|u]))return a[h]=p,t;if(l=+t._x.call(null,f.data),s=+t._y.call(null,f.data),e===l&&n===s)p.next=f,a?a[h]=p:t._root=p;else{for(;a=a?a[h]=new Array(4):t._root=new Array(4),(u=e>=(r=(g+_)/2))?g=r:_=r,(d=n>=(o=(y+v)/2))?y=o:v=o,(h=d<<1|u)==(c=(o<=s)<<1|r<=l););a[c]=f,a[h]=p}}else t._root=p}return t}function addAll(t){for(var e,n,i=t.length,a=new Array(i),r=new Array(i),o=1/0,l=1/0,s=-1/0,u=-1/0,d=0;d<i;++d)isNaN(e=+this._x.call(null,n=t[d]))||isNaN(n=+this._y.call(null,n))||((a[d]=e)<o&&(o=e),s<e&&(s=e),(r[d]=n)<l&&(l=n),u<n&&(u=n));if(!(s<o||u<l))for(this.cover(o,l).cover(s,u),d=0;d<i;++d)add$1(this,a[d],r[d],t[d]);return this}function tree_cover(t,e){if(!isNaN(t=+t)&&!isNaN(e=+e)){var n=this._x0,i=this._y0,a=this._x1,r=this._y1;if(isNaN(n))a=(n=Math.floor(t))+1,r=(i=Math.floor(e))+1;else{for(var o,l,s=a-n||1,u=this._root;t<n||a<=t||e<i||r<=e;)switch(l=(e<i)<<1|t<n,(o=new Array(4))[l]=u,u=o,s*=2,l){case 0:a=n+s,r=i+s;break;case 1:n=a-s,r=i+s;break;case 2:a=n+s,i=r-s;break;case 3:n=a-s,i=r-s}this._root&&this._root.length&&(this._root=u)}this._x0=n,this._y0=i,this._x1=a,this._y1=r}return this}function tree_data(){var e=[];return this.visit(function(t){if(!t.length)for(;e.push(t.data),t=t.next;);}),e}function tree_extent(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Quad(t,e,n,i,a){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=a}function tree_find(t,e,n){var i,a,r,o,l,s,u,d,h=this._x0,c=this._y0,f=this._x1,p=this._y1,g=[],y=this._root;for(y&&g.push(new Quad(y,h,c,f,p)),null==n?n=1/0:(h=t-n,c=e-n,f=t+n,p=e+n,n*=n);i=g.pop();)!(y=i.node)||(l=i.x0)>f||(s=i.y0)>p||(o=i.x1)<h||(a=i.y1)<c||(y.length?(g.push(new Quad(y[3],r=(l+o)/2,u=(s+a)/2,o,a),new Quad(y[2],l,u,r,a),new Quad(y[1],r,s,o,u),new Quad(y[0],l,s,r,u)),(a=(u<=e)<<1|r<=t)&&(i=g[g.length-1],g[g.length-1]=g[g.length-1-a],g[g.length-1-a]=i)):(s=(o=t-+this._x.call(null,y.data))*o+(l=e-+this._y.call(null,y.data))*l)<n&&(h=t-(u=Math.sqrt(n=s)),c=e-u,f=t+u,p=e+u,d=y.data));return d}function tree_remove(t){if(!isNaN(r=+this._x.call(null,t))&&!isNaN(o=+this._y.call(null,t))){var e,n,i,a,r,o,l,s,u,d,h,c=this._root,f=this._x0,p=this._y0,g=this._x1,y=this._y1;if(c){if(c.length)for(;;){if((s=r>=(l=(f+g)/2))?f=l:g=l,(u=o>=(l=(p+y)/2))?p=l:y=l,!(c=(e=c)[d=u<<1|s]))return this;if(!c.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(n=e,h=d)}for(;c.data!==t;)if(!(c=(i=c).next))return this;(a=c.next)&&delete c.next,i?a?i.next=a:delete i.next:e?(a?e[d]=a:delete e[d],(c=e[0]||e[1]||e[2]||e[3])&&c===(e[3]||e[2]||e[1]||e[0])&&!c.length&&(n?n[h]=c:this._root=c)):this._root=a}}return this}function removeAll$1(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function tree_root(){return this._root}function tree_size(){var e=0;return this.visit(function(t){if(!t.length)for(;++e,t=t.next;);}),e}function tree_visit(t){var e,n,i,a,r,o,l,s=[],u=this._root;for(u&&s.push(new Quad(u,this._x0,this._y0,this._x1,this._y1));r=s.pop();)!t(u=r.node,n=r.x0,i=r.y0,a=r.x1,r=r.y1)&&u.length&&(o=(n+a)/2,l=(i+r)/2,(e=u[3])&&s.push(new Quad(e,o,l,a,r)),(e=u[2])&&s.push(new Quad(e,n,l,o,r)),(e=u[1])&&s.push(new Quad(e,o,i,a,l)),(e=u[0])&&s.push(new Quad(e,n,i,o,l)));return this}function tree_visitAfter(t){var e,n=[],i=[];for(this._root&&n.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var a,r,o,l,s,u,d,h=e.node;h.length&&(r=e.x0,o=e.y0,u=(r+(l=e.x1))/2,d=(o+(s=e.y1))/2,(a=h[0])&&n.push(new Quad(a,r,o,u,d)),(a=h[1])&&n.push(new Quad(a,u,o,l,d)),(a=h[2])&&n.push(new Quad(a,r,d,u,s)),(a=h[3])&&n.push(new Quad(a,u,d,l,s))),i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this}function defaultX(t){return t[0]}function tree_x(t){return arguments.length?(this._x=t,this):this._x}function defaultY(t){return t[1]}function tree_y(t){return arguments.length?(this._y=t,this):this._y}function quadtree(t,e,n){e=new Quadtree(null==e?defaultX:e,null==n?defaultY:n,NaN,NaN,NaN,NaN);return null==t?e:e.addAll(t)}function Quadtree(t,e,n,i,a,r){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=a,this._y1=r,this._root=void 0}function leaf_copy(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}unwrapExports(compacttree);var treeProto=quadtree.prototype=Quadtree.prototype;function constant$2(t){return function(){return t}}function jiggle(t){return 1e-6*(t()-.5)}function x$1(t){return t.x+t.vx}function y(t){return t.y+t.vy}function collide(i){var r,o,c,f=1,p=1;function e(){for(var t,e,l,s,u,d,h,n=r.length,i=0;i<p;++i)for(e=quadtree(r,x$1,y).visitAfter(g),t=0;t<n;++t)l=r[t],d=o[l.index],h=d*d,s=l.x+l.vx,u=l.y+l.vy,e.visit(a);function a(t,e,n,i,a){var r=t.data,t=t.r,o=d+t;if(!r)return s+o<e||i<s-o||u+o<n||a<u-o;r.index>l.index&&((n=(e=s-r.x-r.vx)*e+(i=u-r.y-r.vy)*i)<o*o&&(0===e&&(n+=(e=jiggle(c))*e),0===i&&(n+=(i=jiggle(c))*i),n=(o-(n=Math.sqrt(n)))/n*f,l.vx+=(e*=n)*(o=(t*=t)/(h+t)),l.vy+=(i*=n)*o,r.vx-=e*(o=1-o),r.vy-=i*o))}}function g(t){if(t.data)return t.r=o[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function n(){if(r){var t,e,n=r.length;for(o=new Array(n),t=0;t<n;++t)e=r[t],o[e.index]=+i(e,t,r)}}return"function"!=typeof i&&(i=constant$2(null==i?1:+i)),e.initialize=function(t,e){r=t,c=e,n()},e.iterations=function(t){return arguments.length?(p=+t,e):p},e.strength=function(t){return arguments.length?(f=+t,e):f},e.radius=function(t){return arguments.length?(i="function"==typeof t?t:constant$2(+t),n(),e):i},e}function index$2(t){return t.index}function find$1(t,e){t=t.get(e);if(t)return t;throw new Error("node not found: "+e)}function link(u){var d,h,r,o,c,f,l=index$2,n=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},i=constant$2(30),p=1;function e(t){for(var e=0,n=u.length;e<p;++e)for(var i,a,r,o,l,s=0;s<n;++s)i=(a=u[s]).source,r=(a=a.target).x+a.vx-i.x-i.vx||jiggle(f),o=a.y+a.vy-i.y-i.vy||jiggle(f),r*=l=((l=Math.sqrt(r*r+o*o))-h[s])/l*t*d[s],o*=l,a.vx-=r*(l=c[s]),a.vy-=o*l,i.vx+=r*(l=1-l),i.vy+=o*l}function a(){if(r){var t,e=r.length,n=u.length,i=new Map(r.map((t,e)=>[l(t,e,r),t])),a=0;for(o=new Array(e);a<n;++a)(t=u[a]).index=a,"object"!=typeof t.source&&(t.source=find$1(i,t.source)),"object"!=typeof t.target&&(t.target=find$1(i,t.target)),o[t.source.index]=(o[t.source.index]||0)+1,o[t.target.index]=(o[t.target.index]||0)+1;for(a=0,c=new Array(n);a<n;++a)t=u[a],c[a]=o[t.source.index]/(o[t.source.index]+o[t.target.index]);d=new Array(n),s(),h=new Array(n),g()}}function s(){if(r)for(var t=0,e=u.length;t<e;++t)d[t]=+n(u[t],t,u)}function g(){if(r)for(var t=0,e=u.length;t<e;++t)h[t]=+i(u[t],t,u)}return null==u&&(u=[]),e.initialize=function(t,e){r=t,f=e,a()},e.links=function(t){return arguments.length?(u=t,a(),e):u},e.id=function(t){return arguments.length?(l=t,e):l},e.iterations=function(t){return arguments.length?(p=+t,e):p},e.strength=function(t){return arguments.length?(n="function"==typeof t?t:constant$2(+t),s(),e):n},e.distance=function(t){return arguments.length?(i="function"==typeof t?t:constant$2(+t),g(),e):i},e}treeProto.copy=function(){var t,e,n=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(i)if(i.length)for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var a=0;a<4;++a)(e=i.source[a])&&(e.length?t.push({source:e,target:i.target[a]=new Array(4)}):i.target[a]=leaf_copy(e));else n._root=leaf_copy(i);return n},treeProto.add=tree_add,treeProto.addAll=addAll,treeProto.cover=tree_cover,treeProto.data=tree_data,treeProto.extent=tree_extent,treeProto.find=tree_find,treeProto.remove=tree_remove,treeProto.removeAll=removeAll$1,treeProto.root=tree_root,treeProto.size=tree_size,treeProto.visit=tree_visit,treeProto.visitAfter=tree_visitAfter,treeProto.x=tree_x,treeProto.y=tree_y;var noop$1={value:()=>{}};function dispatch(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Dispatch(i)}function Dispatch(t){this._=t}function parseTypenames(t,i){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})}function get$1(t,e){for(var n,i=0,a=t.length;i<a;++i)if((n=t[i]).name===e)return n.value}function set(t,e,n){for(var i=0,a=t.length;i<a;++i)if(t[i].name===e){t[i]=noop$1,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(t,e){var n,i=this._,a=parseTypenames(t+"",i),r=-1,o=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++r<o;)if(n=(t=a[r]).type)i[n]=set(i[n],t.name,e);else if(null==e)for(n in i)i[n]=set(i[n],t.name,null);return this}for(;++r<o;)if((n=(t=a[r]).type)&&(n=get$1(i[n],t.name)))return n},copy:function(){var t,e={},n=this._;for(t in n)e[t]=n[t].slice();return new Dispatch(e)},call:function(t,e){if(0<(n=arguments.length-2))for(var n,i,a=new Array(n),r=0;r<n;++r)a[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=0,n=(i=this._[t]).length;r<n;++r)i[r].value.apply(e,a)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],a=0,r=i.length;a<r;++a)i[a].value.apply(e,n)}};var taskHead,taskTail,frame=0,timeout=0,interval=0,pokeDelay=1e3,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function now$3(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(t,e,n){var i=new Timer;return i.restart(t,e,n),i}function timerFlush(){now$3(),++frame;for(var t,e=taskHead;e;)0<=(t=clockNow-e._time)&&e._call.call(null,t),e=e._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var t=clock.now(),e=t-clockLast;pokeDelay<e&&(clockSkew-=e,clockLast=t)}function nap(){for(var t,e,n=taskHead,i=1/0;n;)n=n._call?(i>n._time&&(i=n._time),(t=n)._next):(e=n._next,n._next=null,t?t._next=e:taskHead=e);taskTail=t,sleep(i)}function sleep(t){frame||(timeout=timeout&&clearTimeout(timeout),24<t-clockNow?(t<1/0&&(timeout=setTimeout(wake,t-clock.now()-clockSkew)),interval=interval&&clearInterval(interval)):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake)))}Timer.prototype=timer.prototype={constructor:Timer,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?now$3():+n)+(null==e?0:+e),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=t,this._time=n,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};const a=1664525,c=1013904223,m=4294967296;function lcg(){let t=1;return()=>(t=(a*t+c)%m)/m}function x$2(t){return t.x}function y$1(t){return t.y}var initialRadius=10,initialAngle=Math.PI*(3-Math.sqrt(5));function simulation(s){var r,o=1,e=.001,l=1-Math.pow(e,1/300),u=0,d=.6,h=new Map,t=timer(a),n=dispatch("tick","end"),i=lcg();function a(){c(),n.call("tick",r),o<e&&(t.stop(),n.call("end",r))}function c(t){var e,n,i=s.length;void 0===t&&(t=1);for(var a=0;a<t;++a)for(o+=(u-o)*l,h.forEach(function(t){t(o)}),e=0;e<i;++e)null==(n=s[e]).fx?n.x+=n.vx*=d:(n.x=n.fx,n.vx=0),null==n.fy?n.y+=n.vy*=d:(n.y=n.fy,n.vy=0);return r}function f(){for(var t,e,n,i=0,a=s.length;i<a;++i)(n=s[i]).index=i,null!=n.fx&&(n.x=n.fx),null!=n.fy&&(n.y=n.fy),(isNaN(n.x)||isNaN(n.y))&&(t=initialRadius*Math.sqrt(.5+i),e=i*initialAngle,n.x=t*Math.cos(e),n.y=t*Math.sin(e)),(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}function p(t){return t.initialize&&t.initialize(s,i),t}return null==s&&(s=[]),f(),r={tick:c,restart:function(){return t.restart(a),r},stop:function(){return t.stop(),r},nodes:function(t){return arguments.length?(s=t,f(),h.forEach(p),r):s},alpha:function(t){return arguments.length?(o=+t,r):o},alphaMin:function(t){return arguments.length?(e=+t,r):e},alphaDecay:function(t){return arguments.length?(l=+t,r):+l},alphaTarget:function(t){return arguments.length?(u=+t,r):u},velocityDecay:function(t){return arguments.length?(d=1-t,r):1-d},randomSource:function(t){return arguments.length?(i=t,h.forEach(p),r):i},force:function(t,e){return 1<arguments.length?(null==e?h.delete(t):h.set(t,p(e)),r):h.get(t)},find:function(t,e,n){var i,a,r,o=0,l=s.length;for(null==n?n=1/0:n*=n,o=0;o<l;++o)(i=(i=t-(a=s[o]).x)*i+(i=e-a.y)*i)<n&&(r=a,n=i);return r},on:function(t,e){return 1<arguments.length?(n.on(t,e),r):n.on(t)}}}function manyBody(){var a,s,u,d,h,i=constant$2(-30),c=1,f=1/0,p=.81;function e(t){var e,n=a.length,i=quadtree(a,x$2,y$1).visitAfter(r);for(d=t,e=0;e<n;++e)s=a[e],i.visit(o)}function n(){if(a){var t,e,n=a.length;for(h=new Array(n),t=0;t<n;++t)e=a[t],h[e.index]=+i(e,t,a)}}function r(t){var e,n,i,a,r,o=0,l=0;if(t.length){for(i=a=r=0;r<4;++r)(e=t[r])&&(n=Math.abs(e.value))&&(o+=e.value,l+=n,i+=n*e.x,a+=n*e.y);t.x=i/l,t.y=a/l}else for((e=t).x=e.data.x,e.y=e.data.y;o+=h[e.data.index],e=e.next;);t.value=o}function o(t,e,n,i){if(!t.value)return!0;var a=t.x-s.x,r=t.y-s.y,o=i-e,l=a*a+r*r;if(o*o/p<l)return l<f&&(0===a&&(l+=(a=jiggle(u))*a),0===r&&(l+=(r=jiggle(u))*r),l<c&&(l=Math.sqrt(c*l)),s.vx+=a*t.value*d/l,s.vy+=r*t.value*d/l),!0;if(!(t.length||f<=l))for(t.data===s&&!t.next||(0===a&&(l+=(a=jiggle(u))*a),0===r&&(l+=(r=jiggle(u))*r),l<c&&(l=Math.sqrt(c*l)));t.data!==s&&(o=h[t.data.index]*d/l,s.vx+=a*o,s.vy+=r*o),t=t.next;);}return e.initialize=function(t,e){a=t,u=e,n()},e.strength=function(t){return arguments.length?(i="function"==typeof t?t:constant$2(+t),n(),e):i},e.distanceMin=function(t){return arguments.length?(c=t*t,e):Math.sqrt(c)},e.distanceMax=function(t){return arguments.length?(f=t*t,e):Math.sqrt(f)},e.theta=function(t){return arguments.length?(p=t*t,e):Math.sqrt(p)},e}function radial(n,l,s){var u,d,h,i=constant$2(.1);function e(t){for(var e=0,n=u.length;e<n;++e){var i=u[e],a=i.x-l||1e-6,r=i.y-s||1e-6,o=Math.sqrt(a*a+r*r),o=(h[e]-o)*d[e]*t/o;i.vx+=a*o,i.vy+=r*o}}function a(){if(u){var t,e=u.length;for(d=new Array(e),h=new Array(e),t=0;t<e;++t)h[t]=+n(u[t],t,u),d[t]=isNaN(h[t])?0:+i(u[t],t,u)}}return"function"!=typeof n&&(n=constant$2(+n)),null==l&&(l=0),null==s&&(s=0),e.initialize=function(t){u=t,a()},e.strength=function(t){return arguments.length?(i="function"==typeof t?t:constant$2(+t),a(),e):i},e.radius=function(t){return arguments.length?(n="function"==typeof t?t:constant$2(+t),a(),e):n},e.x=function(t){return arguments.length?(l=+t,e):l},e.y=function(t){return arguments.length?(s=+t,e):s},e}function x$3(n){var a,r,o,i=constant$2(.1);function e(t){for(var e,n=0,i=a.length;n<i;++n)(e=a[n]).vx+=(o[n]-e.x)*r[n]*t}function l(){if(a){var t,e=a.length;for(r=new Array(e),o=new Array(e),t=0;t<e;++t)r[t]=isNaN(o[t]=+n(a[t],t,a))?0:+i(a[t],t,a)}}return"function"!=typeof n&&(n=constant$2(null==n?0:+n)),e.initialize=function(t){a=t,l()},e.strength=function(t){return arguments.length?(i="function"==typeof t?t:constant$2(+t),l(),e):i},e.x=function(t){return arguments.length?(n="function"==typeof t?t:constant$2(+t),l(),e):n},e}function y$2(n){var a,r,o,i=constant$2(.1);function e(t){for(var e,n=0,i=a.length;n<i;++n)(e=a[n]).vy+=(o[n]-e.y)*r[n]*t}function l(){if(a){var t,e=a.length;for(r=new Array(e),o=new Array(e),t=0;t<e;++t)r[t]=isNaN(o[t]=+n(a[t],t,a))?0:+i(a[t],t,a)}}return"function"!=typeof n&&(n=constant$2(null==n?0:+n)),e.initialize=function(t){a=t,l()},e.strength=function(t){return arguments.length?(i="function"==typeof t?t:constant$2(+t),l(),e):i},e.y=function(t){return arguments.length?(n="function"==typeof t?t:constant$2(+t),l(),e):n},e}var src=Object.freeze({__proto__:null,forceCenter:center,forceCollide:collide,forceLink:link,forceManyBody:manyBody,forceRadial:radial,forceSimulation:simulation,forceX:x$3,forceY:y$2}),force_1=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),p=interopRequireDefault(Canvax),n=interopRequireDefault(graphs),d=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==_typeof_1$1(t)&&"function"!=typeof t)return{default:t};e=h(e);if(e&&e.has(t))return e.get(t);var n,i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var r;"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&((r=a?Object.getOwnPropertyDescriptor(t,n):null)&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=t[n])}i.default=t,e&&e.set(t,i);return i}(src);function h(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(h=function(t){return t?n:e})(t)}function c(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var g=p.default._,f=p.default.event,y=p.default.Shapes.Circle,_=p.default.Display.Text,v=p.default.Shapes.Line,i=function(t){(0,l.default)(i,t);var n=c(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="force",g.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){this.nodesSp=new p.default.Display.Sprite({id:"nodesSp"}),this.edgesSp=new p.default.Display.Sprite({id:"edgesSp"}),this.graphsSp=new p.default.Display.Sprite({id:"graphsSp"}),this.graphsSp.addChild(this.edgesSp),this.graphsSp.addChild(this.nodesSp),this.sprite.addChild(this.graphsSp)}},{key:"draw",value:function(t){g.extend(!0,this,t=t||{}),this.data=t.data||this._initData(),this.widget(),this.fire("complete")}},{key:"_initData",value:function(){for(var n=this,t={nodes:[],edges:[],size:{width:this.app.width,height:this.app.height}},i={},e=0,a=0,r=0,o=0,l=0;l<this.dataFrame.length;l++){var s=this.dataFrame.getRowDataAt(l),u=g.flatten([(s[this.keyField]+"").split(",")]),d=this._getContent(s),h=1==u.length?u[0]:u,c=s[this.field],f=new p.default.Display.Sprite({id:"nodeSp_"+h}),s=(this.graphsSp.addChild(f),{type:"force",field:this.field,iNode:l,rowData:s,key:h,value:c,label:d,element:f,width:null,height:null,x:null,y:null,shapeType:null,source:null,target:null});1==u.length?(s.shapeType=this.getProp(this.node.shapeType,s),t.nodes.push(s),i[s.key]=s,null!=c&&(e=Math.min(e,c),a=Math.max(a,c))):(s.shapeType="line",t.edges.push(s),null!=c&&(r=Math.min(r,c),o=Math.max(o,c)))}return this.nodeValMin=e,this.nodeValMax=a,this.lineValMin=r,this.lineValMax=o,t.nodes.forEach(function(t){t.radius=n.node.radius?n.getProp(n.node.radius,t):n._getNodeRadius(t),t.width=t.height=2*t.radius}),t.edges.forEach(function(t){var e=t.key;t.source=i[e[0]],t.target=i[e[1]],t.distance=n.line.distance?n.getProp(n.node.distance,t):n._getLineDistance(t)}),t}},{key:"_getNodeRadius",value:function(t){var t=t.value,e=this.node.radiusMin;return t&&(e+=(this.node.radiusMax-this.node.radiusMin)/(this.nodeValMax-this.nodeValMin)*t),parseInt(e)}},{key:"_getLineDistance",value:function(t){var t=t.value,e=this.line.distanceMin;return t&&(e+=(this.line.distanceMax-this.line.distanceMin)/(this.lineValMax-this.lineValMin)*t),parseInt(e)}},{key:"widget",value:function(){var r=this,o=this,e=this.keyField,n=this.field,t=this.data.edges.map(function(t){return{source:t.source[e],target:t.target[e],value:t.rowData[n],nodeData:t}}),i=this.data.nodes.map(function(t){var e=Object.create(t);return e.id=t.key,e.nodeData=t,e}),a=this.data.size,l=a.width,a=a.height,s=d.forceSimulation(i).force("link",d.forceLink(t).id(function(t){return t.id}).distance(function(t,e,n){var i=t.nodeData.distance,t=t.source.nodeData.radius+t.target.nodeData.radius;return Math.max(i,t)})).force("charge",d.forceManyBody().distanceMin(this.line.distanceMin).distanceMax(this.line.distanceMax).strength(this.node.strength)).force("center",d.forceCenter(l/2,a/2)).force("collide",d.forceCollide().radius(function(t,e,n){return t.nodeData.radius})).force("x",d.forceX()).force("y",d.forceY()).alpha(.5);i.forEach(function(t){var e=o.getProp(o.node.fillStyle,t.nodeData),n=o.getProp(o.node.strokeStyle,t.nodeData),i=o.getProp(o.node.lineWidth,t.nodeData),a=o.getProp(o.node.nodeAlpha,t.nodeData),r=(t.nodeData.fillStyle=e,t.nodeData.radius),r=new y({context:{r:r,fillStyle:e,strokeStyle:n,lineWidth:i,globalAlpha:a,cursor:"pointer"}}),e=(t.nodeData.element.addChild(r),r.nodeData=t.nodeData,r.on(f.types.get(),function(t){t.eventInfo={trigger:"this.node",nodes:[this.nodeData]},o.app.fire(t.type,t)}),o.getProp(o.label.fontSize,t.nodeData)),n=o.getProp(o.label.fontColor,t.nodeData),i=o.getProp(o.label.textBaseline,t.nodeData),a=o.getProp(o.label.textAlign,t.nodeData),r=new _(t.nodeData.label,{context:{fontSize:e,fillStyle:n,textBaseline:i,textAlign:a,globalAlpha:.7}});t.nodeData.element.addChild(r)}),t.forEach(function(t){var e=o.getProp(o.line.lineWidth,t.nodeData),n=o.getProp(o.line.strokeStyle,t.nodeData),i=o.getProp(o.line.lineType,t.nodeData),a=o.getProp(o.line.lineAlpha,t.nodeData),e=(t.nodeData.strokeStyle=n,new v({context:{lineWidth:e,strokeStyle:n,lineType:i,start:{x:0,y:0},end:{x:0,y:0},globalAlpha:a}}));r.edgesSp.addChild(e),t.line=e}),s.on("tick",function(){s.alpha()<=.05?s.stop():(i.forEach(function(t){var e=t.nodeData.element.context;e&&(e.x=t.x,e.y=t.y)}),t.forEach(function(t){var e=t.line.context;e&&(e.start.x=t.source.x,e.start.y=t.source.y,e.end.x=t.target.x,e.end.y=t.target.y)}))})}},{key:"_checkHtml",value:function(t){return/<[^>]+>/g.test(t)}},{key:"_getContent",value:function(t){var e;return this._isField(this.label.field)&&(e=t[this.label.field]),this.label.format?g.isFunction(this.label.format)&&(e=this.label.format.apply(this,[e,t])):(t=this.app.getComponent({name:"coord"}).getFieldConfig(this.keyField))&&(e=t.getFormatValue(e)),e}},{key:"_isField",value:function(t){return~this.dataFrame.fields.indexOf(t)}},{key:"getNodesAt",value:function(){}},{key:"getProp",value:function(t,e){var n=t;return this._isField(t)&&e.rowData?n=e.rowData[t]:(g.isArray(t)&&(n=t[e.iNode]),g.isFunction(t)&&(n=t.apply(this,[e]))),n}}],[{key:"defaultProps",value:function(){return{keyField:{detail:"key字段",default:""},field:{detail:"value字段，node，link都公用这个字段",default:""},node:{detail:"单个节点的配置",propertys:{shapeType:{detail:"节点图形",default:"circle"},radiusMin:{detail:"最小节点半径",default:6},radiusMax:{detail:"最大节点半径",default:30},radius:{detail:"节点半径",default:null},fillStyle:{detail:"节点背景色",default:"#acdf7d"},strokeStyle:{detail:"描边颜色",default:"#e5e5e5"},lineWidth:{detail:"描边线宽",default:0},nodeAlpha:{detail:"节点透明度",default:1},strength:{detail:"节点之间作用力",default:-300}}},line:{detail:"两个节点连线配置",propertys:{lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"连线的颜色",default:"#e5e5e5"},lineType:{detail:"连线样式（虚线等）",default:"solid"},lineAlpha:{detail:"连线透明度",default:.6},distanceMin:{detail:"最小连线距离",default:30},distanceMax:{detail:"最大连线距离",default:200},distance:{detail:"连线距离",default:null},arrow:{detail:"是否有箭头",default:!0}}},label:{detail:"节点内容配置",propertys:{field:{detail:"内容字段",default:"label"},fontColor:{detail:"内容文本颜色",default:"#666"},format:{detail:"内容格式化处理函数",default:null},textAlign:{detail:"textAlign",default:"center"},textBaseline:{detail:"textBaseline",default:"middle"}}}}}},{key:"polyfill",value:function(t){return t.valueField&&(t.field=t.valueField,delete t.valueField),t}}]),i}(n.default);n.default.registerComponent(i,"graphs","force"),e.default=i}),projection=(unwrapExports(force_1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function g(t,e){for(var n,i=1<arguments.length&&void 0!==e?e:[],a=(d.xmin=360,d.xmax=-360,d.ymin=180,d.ymax=-180,t.features),r=0,o=a.length;r<o;r++)if(!((n=a[r]).properties.name&&-1<i.indexOf(n.properties.name)||n.properties.adcode&&-1<i.indexOf(n.properties.adcode)))switch(n.type){case"Feature":d[n.geometry.type](n.geometry.coordinates);break;case"GeometryCollection":for(var l,s=0,u=(l=n.geometries).length;s<u;s++)d[l[s].type](l[s].coordinates)}t.srcSize={left:+d.xmin.toFixed(4),top:+d.ymin.toFixed(4),width:+(d.xmax-d.xmin).toFixed(4),height:+(d.ymax-d.ymin).toFixed(4)}}var y={formatPoint:function(t){return[(t[0]<-168.5&&63.8<t[1]?t[0]+360:t[0])+168.5,90-t[1]]},makePoint:function(t){var e=this.formatPoint(t);return this._bbox.xmin>t[0]&&(this._bbox.xmin=t[0]),this._bbox.xmax<t[0]&&(this._bbox.xmax=t[0]),this._bbox.ymin>t[1]&&(this._bbox.ymin=t[1]),this._bbox.ymax<t[1]&&(this._bbox.ymax=t[1]),[(e[0]-y.offset.x)*y.scale.x+y.offset.left,(e[1]-y.offset.y)*y.scale.y+y.offset.top]},Point:function(t){return(t=this.makePoint(t)).join(",")},LineString:function(t){for(var e,n="",i=0,a=t.length;i<a;i++)i%1&&0<a||(e=y.makePoint(t[i]),n=0===i?"M"+e.join(","):n+"L"+e.join(","));return n},Polygon:function(t){for(var e="",n=0,i=t.length;n<i;n++)e=e+y.LineString(t[n])+"z";return e},MultiPoint:function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(y.Point(t[n]));return e},MultiLineString:function(t){for(var e="",n=0,i=t.length;n<i;n++)e+=y.LineString(t[n]);return e},MultiPolygon:function(t){for(var e="",n=0,i=t.length;n<i;n++)e+=y.Polygon(t[n]);return e}},d={formatPoint:y.formatPoint,makePoint:function(t){var t=this.formatPoint(t),e=t[0],t=t[1];this.xmin>e&&(this.xmin=e),this.xmax<e&&(this.xmax=e),this.ymin>t&&(this.ymin=t),this.ymax<t&&(this.ymax=t)},Point:function(t){this.makePoint(t)},LineString:function(t){for(var e=0,n=t.length;e<n;e++)e%1&&0<n||this.makePoint(t[e])},Polygon:function(t){for(var e=0,n=t.length;e<n;e++)this.LineString(t[e])},MultiPoint:function(t){for(var e=0,n=t.length;e<n;e++)this.Point(t[e])},MultiLineString:function(t){for(var e=0,n=t.length;e<n;e++)this.LineString(t[e])},MultiPolygon:function(t){for(var e=0,n=t.length;e<n;e++)this.Polygon(t[e])}};e.default={getBbox:function(t,e){return t.srcSize||g(t,e),t.srcSize},geoJson2Path:function(t,e){for(var n,i,a,r,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],l=(y.scale=null,y.offset=null,t.srcSize||g(t,o),e.offset={x:t.srcSize.left,y:t.srcSize.top,left:e.OffsetLeft||0,top:e.OffsetTop||0},y.scale=e.scale,y.offset=e.offset,t.features),s=[],u=0,d=l.length;u<d;u++)if(!((i=l[u]).properties.name&&-1<o.indexOf(i.properties.name)||i.properties.adcode&&-1<o.indexOf(i.properties.adcode)))if("Feature"==i.type)p(i.geometry,i);else if("GeometryCollection"==i.type)for(var h,c=0,f=(h=i.geometries).length;c<f;c++)p(n=h[c],n);function p(t,e){r=t.type,a=t.coordinates,y._bbox={xmin:360,xmax:-360,ymin:180,ymax:-180},r=y[r](a),s.push({path:r,cp:e.properties.cp?y.makePoint(e.properties.cp):y.makePoint([(y._bbox.xmin+y._bbox.xmax)/2,(y._bbox.ymin+y._bbox.ymax)/2]),properties:e.properties,adcode:e.properties.adcode})}return s},pos2geo:function(t,e){var e=e instanceof Array?(n=+e[0],+e[1]):(n=+e.x,+e.y),n=n/t.scale.x+t.offset.x-168.5;return[n=180<n?n-360:n,e=90-(e/t.scale.y+t.offset.y)]},geo2pos:function(t,e){return y.offset=t.offset,y.scale=t.scale,e instanceof Array?y.makePoint([+e[0],+e[1]]):y.makePoint([+e.x,+e.y])}}})),trans=(unwrapExports(projection),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return t.json=a(t.json),i(t,e,n)};var d=interopRequireDefault(projection);var i=function(t,e,n){for(var i,a=[],r=t.bbox||d.default.getBbox(t.json,n),e=h(r,e,.75),o=t.lastTransform||{scale:{}},l=(e.left!=o.left||e.top!=o.top||e.scale.x!=o.scale.x||e.scale.y!=o.scale.y?(i=d.default.geoJson2Path(t.json,e,n),o=Canvax._.clone(e)):(e=t.transform,i=t.pathArray),t.bbox=r,t.transform=e,t.lastTransform=o,t.pathArray=i,[e.left,e.top]),s=0,u=i.length;s<u;s++)a.push(c(t,i[s],l,r));return a},h=function(t,e,n){var i=e.width,e=e.height,a=t.width,t=t.height,r=i/n/a,o=e/t;return o<r?i=a*(r=o*n):(r=(o=r)*n,e=t*o),{left:0,top:0,width:i,height:e,baseScale:1,scale:{x:r,y:o}}},c=function(t,e,n,i){var a,r=e.properties.name,o=[0,0];return e.cp?a=[e.cp[0]+o[0],e.cp[1]+o[1]]:((a=l(t,[i.left+i.width/2,i.top+i.height/2]))[0]+=o[0],a[1]+=o[1]),e.name=r,e.position=n,e.textX=a[0],e.textY=a[1],e},l=function(t,e){return t.transform?d.default.geo2pos(t.transform,e):null},a=function(t){if(t.UTF8Encoding){for(var e=t.features,n=0;n<e.length;n++)for(var i=e[n],a=i.geometry.coordinates,r=i.geometry.encodeOffsets,o=0;o<a.length;o++){var l=a[o];if("Polygon"===i.geometry.type)a[o]=f(l,r[o]);else if("MultiPolygon"===i.geometry.type)for(var s=0;s<l.length;s++){var u=l[s];l[s]=f(u,r[o][s])}}t.UTF8Encoding=!1}return t},f=function(t,e){for(var n=[],i=e[0],a=e[1],r=0;r<t.length;r+=2){var o=(o=t.charCodeAt(r)-64)>>1^-(1&o),l=(l=t.charCodeAt(r+1)-64)>>1^-(1&l);o+=i,l+=a,n.push([(i=o)/1024,(a=l)/1024])}return n}})),map$1=(unwrapExports(trans),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),d=interopRequireDefault(Canvax),n=interopRequireDefault(graphs),h=interopRequireDefault(trans),c=interopRequireDefault(zoom);function f(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var p=d.default._,g=d.default.event,y=(d.default.Display.Text,d.default.Shapes.Path),_=d.default.Shapes.Rect,i=function(t){(0,l.default)(i,t);var n=f(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).type="map",e.maxValue=0,e.dataOrg=[],e.data=[],p.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.node.maxFillStyle||(e.node.maxFillStyle=e.app.getTheme(0)),e.node.beginFillStyle&&e.node.endFillStyle&&(e._gradientColors=(0,color.gradient)(e.node.endFillStyle,e.node.beginFillStyle)),e.init(),e}return(0,r.default)(i,[{key:"init",value:function(){this._pathsp=new d.default.Display.Sprite({id:"nodePathSp"}),this._textsp=new d.default.Display.Sprite({id:"textsp"}),this._marksp=new d.default.Display.Sprite({id:"markSp"}),this.mapGraphs=new d.default.Display.Sprite({id:"mapGraphs"}),this._initInduce(),this.mapGraphs.addChild(this._pathsp),this.mapGraphs.addChild(this._textsp),this.mapGraphs.addChild(this._marksp),this.sprite.addChild(this.mapGraphs),this._initZoom()}},{key:"_initZoom",value:function(){this.zoom=new c.default({scale:this.status.transform.scale,scaleMin:this.status.transform.statusMin,scaleMax:this.status.transform.statusMax});var r=this,n=!1,o=r.app.canvax.domView?r.app.canvax.domView.style.cursor:"default",l=null,s=0;this.sprite.on(g.types.get(),function(i){var a,t,e;r.status.transform.enabled&&(i.preventDefault(),a=i.target.localToGlobal(i.point,r.sprite),"mousedown"==i.type&&(n=!0,r.app.canvax.domView&&(r.app.canvax.domView.style.cursor="move"),r.zoom.mouseMoveTo(a)),"mouseup"!=i.type&&"mouseout"!=i.type||(n=!1,r.app.canvax.domView&&(r.app.canvax.domView.style.cursor=o)),"mousemove"==i.type&&n&&(t=(e=r.zoom.move(a)).x,e=e.y,r.mapGraphs.context.x=t,r.mapGraphs.context.y=e),"wheel"==i.type&&(Math.abs(i.deltaY)>Math.abs(s)&&(s=i.deltaY),l=l||setTimeout(function(){var t=r.zoom.wheel(i,a),e=t.scale,n=t.x,t=t.y;r.mapGraphs.context.x=n,r.mapGraphs.context.y=t,r.mapGraphs.context.scaleX=e,r.mapGraphs.context.scaleY=e,r.status.transform.scale=e,l=null,s=0},32)))})}},{key:"_initInduce",value:function(){var e=this;this._include=new _({context:{x:this.app.padding.left,y:this.app.padding.top,width:this.width,height:this.height,fillStyle:"rgba(0,0,0,0)"}}),this._include.on(g.types.get(),function(t){t.eventInfo={trigger:e,nodes:[]},e.app.fire(t.type,t)}),this.sprite.addChild(this._include)}},{key:"draw",value:function(t){var n=this,t=(p.extend(!0,this,t=t||{}),this.dataFrame.getFieldData(this.valueField));this.maxValue=p.max(t),this.minValue=p.min(t),this.getGeoData().then(function(t){var e;t&&(e={x:n.app.padding.left,y:n.app.padding.top,width:n.width,height:n.height},n._widget(t,e))}),this._include.context.width=this.width,this._include.context.height=this.height,this.fire("complete")}},{key:"_widget",value:function(i,a){var r=this,o=[];return(0,h.default)(i,a,this.specialArea).forEach(function(t){var e=r.dataFrame.getRowDataOf({adcode:t[r.field]}),e=(e.length&&(t.rowData=e[0]),{x:a.x+(a.width-i.transform.width)/2,y:a.y+(a.height-i.transform.height)/2,path:t.path}),e=new y({id:"path_"+t[r.field],hoverClone:!1,context:e}),n=(e.nodeData=t,e.geoData=i,t.nodeElement=e,r._setNodeStyle(e),t.color=e.context.fillStyle,r.node.drawBegin.bind(r)(t),r._pathsp.addChild(e),r.node.drawEnd.bind(r)(t),e.context&&o.push(e),r);e.context&&e.context.fillStyle&&r.node.fillAlpha&&!t.pointerEventsNone&&e.context&&(e.context.cursor="pointer",e.on(g.types.get(),function(t){t.eventInfo={trigger:n.node,nodes:[this.nodeData]},"mouseover"==t.type&&n.focusAt(this.nodeData[n.field]),"mouseout"==t.type&&n.unfocusAt(this.nodeData[n.field]),n.app.fire(t.type,t)}))}),o}},{key:"_setNodeStyle",value:function(t,e){var n,i,a,r,o,l,s,u=t.nodeData;t&&(a=(n=t.context).fillStyle,r=n.fillAlpha,o=n.strokeStyle,l=n.strokeAlpha,s=n.lineWidth,n=n.lineType,t._default={fillStyle:a,fillAlpha:r,strokeStyle:o,strokeAlpha:l,lineWidth:s,lineType:n},i=this.node[e],e||(i=this.node),e=this._getProp(i,"fillStyle",u)||a,a=this._getProp(i,"fillAlpha",u)||r,r=this._getProp(i,"strokeStyle",u)||o,o=this._getProp(i,"strokeAlpha",u)||l,l=this._getProp(i,"lineWidth",u)||s,s=this._getProp(i,"lineType",u)||n,t.context.fillStyle=e,t.context.fillAlpha=a,t.context.strokeStyle=r,t.context.strokeAlpha=o,t.context.lineWidth=l,t.context.lineType=s)}},{key:"focusAt",value:function(t){var e;!this.node.focus.enabled||(e=(t=this._pathsp.getChildById("path_"+t)).nodeData).selected||(this._setNodeStyle(t,"focus"),e.focused=!0)}},{key:"unfocusAt",value:function(t){var e;!this.node.focus.enabled||(e=(t=this._pathsp.getChildById("path_"+t)).nodeData).selected||(this._setNodeStyle(t),e.focused=!1)}},{key:"selectAt",value:function(t){var e;this.node.select.enabled&&(e=(t=this._pathsp.getChildById("path_"+t)).nodeData,this._setNodeStyle(t,"select"),e.selected=!0)}},{key:"unselectAt",value:function(t){var e,n;this.node.select.enabled&&(n=(e=this._pathsp.getChildById("path_"+t)).nodeData,this._setNodeStyle(e),n.selected=!1,n.focused&&this.focusAt(t))}},{key:"drawChildren",value:function(a){var r=this;return new Promise(function(i){r.getGeoData({mapAdcode:a}).then(function(t){var e,n;t&&(e=(n=r._pathsp.getChildById("path_"+a)).getBound(),n=n.localToGlobal(e),e.x=n.x,e.y=n.y,i(r._widget(t,e)))})})}},{key:"getGeoData",value:function(){var a=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this;return new Promise(function(n,e){var i;null!==t.mapAdcode||t.geoJsonUrl?(i=t.geoJsonUrl||a.adcodeUrlTempl.replace(new RegExp("\\{adcode\\}","gm"),t.mapAdcode),a.app.__geoDataMap||(a.app.__geoDataMap={}),a.app.__geoDataMap[i]?n(a.app.__geoDataMap[i]):fetch(i).then(function(t){t.ok?t.json().then(function(t){var e=a.geoJsonFilter(t);a.app.__geoDataMap[i]={json:e||t},n(a.app.__geoDataMap[i])}):n(null)}).catch(function(t){e(t)})):t.geoJson&&n({json:t.geoJson})})}},{key:"_getProp",value:function(t,e,n){t=t[e],t=p.isFunction(t)?t.apply(this,[n,this.dataFrame]):t;if("fillStyle"==e){n=n.rowData;if(n)if(void 0!==n[e])t=n[e];else{e=n[this.valueField];if(!isNaN(e)&&""!=e){n=this.node.minFillAlpha+(this.node.fillAlpha-this.node.minFillAlpha)/(this.maxValue-this.minValue)*(e-this.minValue);if(this._gradientColors)return this._gradientColors[100-parseInt(100*n)];t=(0,color.colorRgba)(this.node.maxFillStyle,parseFloat(n.toFixed(2))),t=(0,color.rgba2rgb)(t)}}}return t}}],[{key:"defaultProps",value:function(){return{field:{detail:"数据中的adcode字段",default:"adcode",documentation:"数据中的adcode字段，用来对应上地图中的某个区块的adcode，从而找到这个区块对应的这一条数据"},valueField:{detail:"数据中的值字段",default:"value",documentation:"作为field字段的补充，通过field字段找到数据后，用来从数据中取值"},mapAdcode:{detail:"当前绘制的地图adcode",default:null},adcodeUrlTempl:{detail:"adcode的url模板",default:"//geo.datav.aliyun.com/areas_v2/bound/{adcode}_full.json",documentation:"如果是是配置的adcode，那么和他对应的url模板"},geoJson:{detail:"要绘制的geoJson数据",default:null},geoJsonUrl:{detail:"要绘制的geoJson的url",default:null},geoJsonFilter:{detail:"geoJson的二次过滤处理",default:function(t){return t}},specialArea:{detail:"要排除掉不绘制的数据集合，可以是adcode，也可以是name",default:[]},node:{detail:"单个元素图形配置",propertys:{drawBegin:{detail:"开始绘制的钩子函数",default:function(){}},drawEnd:{detail:"开始绘制的钩子函数",default:function(){}},fillStyle:{detail:"单个区块背景色",default:null},fillAlpha:{detail:"单个区块透明度",default:1},maxFillStyle:{detail:"单个区块数据最大对应的颜色",default:null},maxFillAlpha:{detail:"单个区块最大透明度",default:1},minFillAlpha:{detail:"单个区块最小透明度",default:.4},beginFillStyle:{detail:"区域颜色的起始色",documentation:"设置区域颜色的另外一个方案，两个颜色确定一个区间的结束色",default:null},endFillStyle:{detail:"区域颜色的结束色",documentation:"设置区域颜色的另外一个方案，两个颜色确定一个区间的结束色",default:null},strokeStyle:{detail:"单个区块描边颜色",default:"#ccc"},strokeAlpha:{detail:"单个区块描边透明度",default:1},lineWidth:{detail:"单个区块描边线宽",default:1},lineType:{detail:"区块描边样式",default:"solid"},focus:{detail:"单个区块hover态设置",propertys:{enabled:{detail:"是否开启",default:!0},fillStyle:{detail:"hover态单个区块背景色",default:null},fillAlpha:{detail:"hover态单个区块透明度",default:1},strokeStyle:{detail:"hover态单个区块描边颜色",default:null},strokeAlpha:{detail:"hover态单个区块描边透明度",default:1},lineWidth:{detail:"hover态单个区块描边线宽",default:1},lineType:{detail:"hover态区块描边样式",default:null}}},select:{detail:"单个区块选中态设置",propertys:{enabled:{detail:"是否开启",default:!1},fillStyle:{detail:"选中态单个区块背景色",default:null},fillAlpha:{detail:"选中态单个区块透明度",default:1},strokeStyle:{detail:"选中态单个区块描边颜色",default:null},strokeAlpha:{detail:"选中态单个区块描边颜色",default:1},lineWidth:{detail:"选中态单个区块描边线宽",default:1},lineType:{detail:"选中态区块描边样式",default:null}}}}},label:{detail:"文本配置",propertys:{enabled:{detail:"是否开启文本",default:!0},textAlign:{detail:"文本布局位置(left,center,right)",default:"center"},textBaseline:{detail:"文本基线对齐方式",default:"middle"},format:{detail:"文本格式化处理函数",default:null},fontSize:{detail:"文本字体大小",default:12},fontColor:{detail:"文本颜色",default:"#666",documentation:"align为center的时候的颜色，align为其他属性时候取node的颜色"}}},status:{detail:"一些开关配置",propertys:{transform:{detail:"是否启动拖拽缩放整个画布",propertys:{fitView:{detail:"自动缩放",default:""},enabled:{detail:"是否开启",default:!0},scale:{detail:"缩放值",default:1},scaleMin:{detail:"缩放最小值",default:1},scaleMax:{detail:"缩放最大值",default:10},scaleOrigin:{detail:"缩放原点",default:{x:0,y:0}}}}}}}}}]),i}(n.default);n.default.registerComponent(i,"graphs","map"),e.default=i})),legend=(unwrapExports(map$1),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component),y=interopRequireDefault(Canvax),_=interopRequireDefault(trigger);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var v=y.default._,x=y.default.event,h=y.default.Shapes.Circle,c=y.default.Shapes.Rect,i=function(t){(0,l.default)(i,t);var n=d(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="legend",v.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.data=e._getLegendData(t),!t.direction&&t.position&&("left"==e.position||"right"==e.position?e.direction="v":e.direction="h"),e.sprite=new y.default.Display.Sprite({id:"LegendSprite",context:{x:e.pos.x,y:e.pos.y}}),e.app.stage.addChild(e.sprite),e.widget(),e.layout(),e}return(0,r.default)(i,[{key:"_getLegendData",value:function(t){t=t.data;return t?v.each(t,function(t,e){t.enabled=!0,t.ind=e}):t=this.app.getLegendData(),t||[]}},{key:"layout",value:function(){var t,e=this.app,n=this.width+this.margin.left+this.margin.right,i=this.height+this.margin.top+this.margin.bottom,a=e.padding.left,r=e.padding.top;return"right"==this.position&&(a=e.width-e.padding.right-n),"bottom"==this.position&&(r=e.height-e.padding.bottom-i+this.icon.height/2),"left"==this.position||"right"==this.position?(e.padding[this.position]+=n,t=n,e.height,e.padding.top,e.padding.bottom):"top"!=this.position&&"bottom"!=this.position||(e.padding[this.position]+=i,t=e.width-e.padding.right-e.padding.left,0),"center"==this.textAlign&&(a+=t/2-this.width/2),"right"==this.textAlign&&(a+=t-this.width),this.pos={x:a,y:r},this.pos}},{key:"draw",value:function(){var t=this.app.getComponent({name:"coord"});!t||"rect"!=t.type||"left"!=this.textAlign||"top"!=this.position&&"bottom"!=this.position||(this.pos.x=t.getSizeAndOrigin().origin.x+this.icon.radius),this.setPosition()}},{key:"widget",value:function(){var o=this,l=this.app.width-this.app.padding.left-this.app.padding.right,s=this.app.height-this.app.padding.top-this.app.padding.bottom,u=0,d=0,h=0,c=0,f=0,p=1,g=!1;v.each(this.data,function(e,t){if(!g){var n=o._getIconNodeEl(e,t),i=(n.on(x.types.get(),function(t){}),e.name),i=(o.label.format&&(i=o.label.format(e.name,e)),new y.default.Display.Text(i,{id:"legend_field_txt_"+t,context:{x:o.icon.radius+3,y:o.icon.height/3,textAlign:o.label.textAlign,textBaseline:o.label.textBaseline,fillStyle:o.label.fontColor,cursor:o.label.cursor}}));i.on(x.types.get(),function(t){});var a=i.getTextWidth()+2*o.icon.radius+20,r=(u=Math.max(u,a),{height:o.icon.height});if("v"==o.direction){if(f+o.icon.height>s){if(.3*l<c)return void(g=!0);c+=u,f=0}r.x=c,r.y=f,f+=o.icon.height,h=Math.max(h,f)}else{if(l<c+a){if(o.icon.height*(p+1)>.3*s)return void(g=!0);c=0,p++}r.x=c,r.y=o.icon.height*(p-1),c+=a,d=Math.max(d,c)}t=new y.default.Display.Sprite({id:"legend_field_"+t,context:r});t.addChild(n),t.addChild(i),t.context.width=a,o.sprite.addChild(t),t.on(x.types.get(),function(t){if(-1<o.triggerEventType.indexOf(t.type)&&o.activeEnabled){if(1==v.filter(o.data,function(t){return t.enabled}).length&&e.enabled)return;e.enabled=!e.enabled,n.context.fillStyle=e.enabled?e.color||"#999":"#ccc",e.enabled?o.app.show(e.field,new _.default(this,e)):o.app.hide(e.field,new _.default(this,e))}o.tipsEnabled&&("mouseover"!=t.type&&"mousemove"!=t.type||(t.eventInfo=o._getInfoHandler(t,e)),"mouseout"==t.type&&delete t.eventInfo,o.app.fire(t.type,t))})}}),"h"==this.direction?(o.width=o.sprite.context.width=d,o.height=o.sprite.context.height=o.icon.height*p):(o.width=o.sprite.context.width=c+u,o.height=o.sprite.context.height=h)}},{key:"_getIconNodeEl",value:function(t,e){var n,i=t.enabled?t.color||"#999":"#ccc";return this.icon.fillStyle&&(n=this._getProp(this.icon.fillStyle,t))&&(i=n),"line"==t.type?new c({id:"legend_field_icon_"+e,context:{x:-this.icon.radius,y:this.icon.height/3-1,fillStyle:i,width:2*this.icon.radius,height:2,cursor:"pointer"}}):"bar"==t.type?new c({id:"legend_field_icon_"+e,context:{x:-this.icon.radius,y:this.icon.height/3-this.icon.radius,fillStyle:i,width:2*this.icon.radius,height:2*this.icon.radius,radius:[3,3,3,3],cursor:"pointer"}}):new h({id:"legend_field_icon_"+e,context:{x:0,y:this.icon.height/3,fillStyle:i,r:this.icon.radius,cursor:"pointer"}})}},{key:"_getInfoHandler",value:function(t,e){return{type:"legend",triggerType:"legend",trigger:"this",tipsEnabled:this.tipsEnabled,nodes:[{name:e.name,fillStyle:e.color}]}}},{key:"_getProp",value:function(t,e){var n=t;return v.isArray(t)&&(n=t[e.ind]),n=v.isFunction(t)?t.apply(this,[e]):n}}],[{key:"defaultProps",value:function(){return{data:{detail:"图例数据",default:[],documentation:'                    数据结构为：{name: "uv", color: "#ff8533", field: "" ...}                    如果手动传入数据只需要前面这三个 enabled: true, ind: 0                    外部只需要传field和fillStyle就行了                    '},position:{detail:"图例位置",documentation:"图例所在的方向top,right,bottom,left",default:"top"},direction:{detail:"图例布局方向",default:"h",documentation:"横向 top,bottom --\x3e h left,right -- >v"},textAlign:{detail:"水平方向的对其，默认居左对其",default:"left",documentation:"可选left，center，right"},verticalAlign:{detail:"垂直方向的对其方式，默认居中（待实现）",default:"middle",documentation:"可选top，middle，bottom"},icon:{detail:"图标设置",propertys:{height:{detail:"高",default:26},width:{detail:"图标宽",default:"auto"},shapeType:{detail:"图标的图形类型，目前只实现了圆形",default:"circle"},radius:{detail:"图标（circle）半径",default:5},lineWidth:{detail:"图标描边宽度",default:1},fillStyle:{detail:"图标颜色，一般会从data里面取，这里是默认色",default:null}}},label:{detail:"文本配置",propertys:{textAlign:{detail:"水平对齐方式",default:"left"},textBaseline:{detail:"文本基线对齐方式",default:"middle"},fontColor:{detail:"文本颜色",default:"#333333"},cursor:{detail:"鼠标样式",default:"pointer"},format:{detail:"文本格式化处理函数",default:null}}},triggerEventType:{detail:"触发事件",default:"click,tap"},activeEnabled:{detail:"是否启动图例的交互事件",default:!0},tipsEnabled:{detail:"是否开启图例的tips",default:!1}}}}]),i}(n.default);n.default.registerComponent(i,"legend"),e.default=i})),datazoom=(unwrapExports(legend),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var l=interopRequireDefault(toConsumableArray$1),o=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),s=interopRequireDefault(assertThisInitialized$1),i=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),r=interopRequireDefault(getPrototypeOf$1),u=interopRequireDefault(component),d=interopRequireDefault(Canvax),h=interopRequireDefault(trigger);function c(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,r.default)(n);return t=i?(t=(0,r.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var f=d.default._,p=d.default.Shapes.Line,g=d.default.Shapes.Rect,y=d.default.Shapes.Polygon,_=function(t){(0,i.default)(r,t);var a=c(r);function r(t,e){var n,i;return(0,o.default)(this,r),(n=a.call(this,t,e)).name="dataZoom",n._cloneChart=null,n.count=1,n.dataLen=1,n.axisLayoutType=null,n.dragIng=function(){},n.dragEnd=function(){},n.disPart={},n._preRange=null,n._btnLeft=null,n._btnRight=null,n._underline=null,n.sprite=new d.default.Display.Sprite({id:"dataZoom",context:{x:n.pos.x,y:n.pos.y}}),n.sprite.noSkip=!0,n.dataZoomBg=new d.default.Display.Sprite({id:"dataZoomBg"}),n.dataZoomBtns=new d.default.Display.Sprite({id:"dataZoomBtns"}),n.sprite.addChild(n.dataZoomBg),n.sprite.addChild(n.dataZoomBtns),e.stage.addChild(n.sprite),"left"!=t.position&&"right"!=t.position||(e=t.width,i=t.height,t.height=e,t.width=i,void 0===t.width&&delete t.width,void 0===t.height&&delete t.height),f.extend(!0,(0,s.default)(n),(0,tools.getDefaultProps)(r.defaultProps()),t),"margin"in t||("bottom"==n.position&&(n.margin.top=10),"top"==n.position&&(n.margin.bottom=10)),n.axis=null,n.layout(),n}return(0,n.default)(r,[{key:"layout",value:function(){var t=this.app;"bottom"==this.position&&(this.pos.y=t.height-(this.height+t.padding.bottom+this.margin.bottom),t.padding.bottom+=this.height+this.margin.top+this.margin.bottom),"top"==this.position&&(this.pos.y=t.padding.top+this.margin.top,t.padding.top+=this.height+this.margin.top+this.margin.bottom),"left"==this.position&&(this.pos.x=-(this.width-this.height)/2+t.padding.left+this.margin.left,this.pos.y=t.height-t.padding.bottom-this.margin.bottom-this.width/2-this.height/2,t.padding.left+=this.height+this.margin.left+this.margin.right),"right"==this.position&&(this.pos.x=-(this.width-this.height)/2+t.padding.left+this.margin.left,this.pos.y=t.height-t.padding.bottom-this.margin.bottom-this.width/2-this.height/2,t.padding.right+=this.height+this.margin.left+this.margin.right)}},{key:"_getCloneChart",value:function(){var a=this,r=this.app,o=r.getCoord(),t=r.constructor,e=r.el.cloneNode(),l=(e.innerHTML="",e.id=r.el.id+"_currclone",e.style.position="absolute",e.style.width=this.width+"px",e.style.height=this.btnHeight+"px",e.style.top="-10000px",document.body.appendChild(e),[]),n=(f.each(r.getComponents({name:"graphs"}),function(t){var e,n,i=t.enabledField||t.field;f.flatten([i]).length&&((e=f.extend(!0,{},t._opt)).field=i,i={},"bar"==t.type&&(i={node:{}},a.graphStyle&&(i.node.fillStyle=a.graphStyle)),"line"==t.type&&(i={line:{lineWidth:1},node:{enabled:!1},area:{}},a.graphStyle&&(i.line.strokeStyle=a.graphStyle,i.area.fillStyle=a.graphStyle)),n=o.height||r.el.offsetHeight,n=a.btnHeight/n||1,"scat"==t.type&&(i={node:{radiusScale:n}},a.graphStyle),l.push(f.extend(!0,e,i,{label:{enabled:!1},animation:!1})))}),{coord:Object.assign({},r._opt.coord),graphs:l}),t=(n.coord.horizontal&&delete n.coord.horizontal,n.coord.enabled=!1,n.coord.padding=0,new t(e,r._data,n,r.componentModules,r.otherOptions));return t.draw(),{thumbChart:t,cloneEl:e}}},{key:"_setDataZoomOpt",value:function(){var e=this.app,t=e.getComponent({name:"coord"}).getSizeAndOrigin(),o=this,n=t.width;"left"!=this.position&&"right"!=this.position||(n=t.height||150),f.extend(!0,this,{width:this.width||parseInt(n),pos:{x:this.pos.x||t.origin.x},dragIng:function(r){var t;"proportion"==o.axisLayoutType?(t=new h.default(o,{min:r.start,max:r.end}),e.dataFrame.filters["datazoom"+o.__cid]=function(t){if(o.dragIngDataFilter)return o.dragIngDataFilter.apply(o,[t,r]);var t=t[Array.isArray(o.axis.field)?o.axis.field[0]:o.axis.field],e=Math.min.apply(Math,(0,l.default)(o.axis.dataSection)),n=Math.max.apply(Math,(0,l.default)(o.axis.dataSection)),i=o.width,a=e+(n-e)*(r.start/i),n=e+(n-e)*(r.end/i);return a<=t&&t<=n}):(t=new h.default(o,{left:e.dataFrame.range.start-r.start,right:r.end-e.dataFrame.range.end}),f.extend(e.dataFrame.range,r)),e.resetData(null,t),e.fire("dataZoomDragIng")},dragEnd:function(){e.updateChecked&&e.updateChecked(),e.fire("dataZoomDragEnd")}})}},{key:"draw",value:function(){this._setDataZoomOpt(),this._cloneChart=this._getCloneChart();var t=this._cloneChart.thumbChart.getComponent({name:"coord"}),e=t._xAxis;this.axis=e,"left"==this.position&&(this.axis=t._yAxisLeft),"right"==this.position&&(this.axis=t._yAxisRight),this.axisLayoutType=this.axis.layoutType,this._computeAttrs(),this.widget(),this._setLines(),this.setMiniGroupsMap(),this.setPosition(),"left"!=this.position&&"right"!=this.position||(e=this.app.getComponent({name:"coord"})._xAxis.height,this.sprite.context.rotation=-90,this.sprite.context.rotateOrigin={x:this.width/2,y:this.height/2},this.sprite.context.y-=e,this._opt.width||(this.sprite.context.y-=this.width/2,this.sprite.context.x-=this.width/2))}},{key:"destroy",value:function(){this.sprite.destroy()}},{key:"reset",value:function(t){var e=this.count,n=this.range.start,i=this.range.end;(t=t||{})&&f.extend(!0,this,t),this._cloneChart=this._getCloneChart(),this._computeAttrs(t),e==this.count&&(!t.range||t.range.start==n&&t.range.end==i)||(this.widget(),this._setLines()),this.setMiniGroupsMap()}},{key:"_computeAttrs",value:function(){var t=this._cloneChart.thumbChart;switch(this.dataLen=t.dataFrame.length,this.axisLayoutType){case"rule":this.count=this.dataLen-1;break;case"peak":this.count=this.dataLen;break;case"proportion":this.count=this.width}(!this._opt.range||this._opt.range&&!this._opt.range.max||this.range.max>this.count)&&(this.range.max=this.count-1),(!this._opt.range||this._opt.range&&!this._opt.range.end||this.range.end>this.dataLen-1)&&(this.range.end=this.dataLen-1,"proportion"==this.axisLayoutType&&(this.range.end=this.count-1)),this.disPart=this._getDisPart(),this.btnHeight=this.height-this.btnOut}},{key:"_getDisPart",value:function(){var t=this,e=Math.max(parseInt(t.range.min/2/t.count*t.width),23),n=parseInt((t.range.max+1)/t.count*t.width);return{min:e="peak"==this.axisLayoutType?Math.max(parseInt(t.range.min/t.count*t.width),23):e,max:n="proportion"==this.axisLayoutType?t.width:n}}},{key:"_getRangeEnd",value:function(t){return void 0===t&&(t=this.range.end),"peak"==this.axisLayoutType&&(t+=1),"proportion"==this.axisLayoutType&&(t+=1),t}},{key:"widget",value:function(){function t(){i._setLines.apply(i,arguments)}var e,n,i=this,a=(i.bg.enabled&&((a=i.bg.fillStyle)&&a.lineargradient&&a.lineargradient.length&&(e=i.ctx.createLinearGradient(0,i.btnHeight,i.width,i.btnHeight),f.each(a.lineargradient,function(t){e.addColorStop(t.position,t.color)}),a=e),a||"triangle"!=i.shapeType||(a="#e6e6e6"),r={x:0,y:0,width:i.width,height:i.btnHeight,lineWidth:i.bg.lineWidth,strokeStyle:i.bg.strokeStyle,fillStyle:a,fillAlpha:i.bg.glpha},a={x:0,y:0,pointList:[[0,i.btnHeight],[i.width,i.btnHeight],[i.width,0]],lineWidth:i.bg.lineWidth,strokeStyle:i.bg.strokeStyle,fillStyle:a,globalAlpha:i.bg.glpha},i._bgElement?i._bgElement.animate(r,{onUpdate:t}):("rect"==i.shapeType?i._bgElement=new g({context:r}):i._bgElement=new y({context:a}),i.dataZoomBg.addChild(i._bgElement))),i.underline.enabled&&(r={start:{x:i.range.start/i.count*i.width+i.btnWidth/2,y:i.btnHeight},end:{x:i._getRangeEnd()/i.count*i.width-i.btnWidth/2,y:i.btnHeight},lineWidth:i.underline.lineWidth,strokeStyle:i.underline.strokeStyle||i.color},i._underline?i._underline.animate(r,{onUpdate:t}):(i._underline=i._addLine(r),i.dataZoomBg.addChild(i._underline))),{x:i.range.start/i.count*i.width,y:-i.btnOut/2+1,width:i.btnWidth,height:i.btnHeight+i.btnOut,fillStyle:i.left.fillStyle||i.color,cursor:i.left.eventEnabled&&"move"}),r=(i._btnLeft?i._btnLeft.animate(a,{onUpdate:t}):(i._btnLeft=new g({id:"btnLeft",dragEnabled:i.left.eventEnabled,hoverClone:!1,context:a}),i._btnLeft.on("draging",function(){this.context.y=-i.btnOut/2+1,this.context.x<0&&(this.context.x=0),this.context.x>i._btnRight.context.x-i.btnWidth&&(this.context.x=i._btnRight.context.x-i.btnWidth),i._btnRight.context.x+i.btnWidth-this.context.x>i.disPart.max&&(this.context.x=i._btnRight.context.x+i.btnWidth-i.disPart.max-1),i._btnRight.context.x+i.btnWidth-this.context.x<i.disPart.min&&(this.context.x=i._btnRight.context.x+i.btnWidth-i.disPart.min),"rect"==i.shapeType&&(i._rangeElement.context.width=i._btnRight.context.x-this.context.x-i.btnWidth,i._rangeElement.context.x=this.context.x+i.btnWidth),"triangle"==i.shapeType&&(i._rangeElement.context.pointList=i._getRangeTrianglePoints()),i._setRange()}),i._btnLeft.on("dragend",function(){i.dragEnd(i.range)}),this.dataZoomBtns.addChild(this._btnLeft)),{x:i._getRangeEnd()/i.count*i.width-i.btnWidth+1,y:-i.btnOut/2+1,width:i.btnWidth,height:i.btnHeight+i.btnOut,fillStyle:i.right.fillStyle||i.color,cursor:i.right.eventEnabled&&"move"}),r=(i._btnRight?i._btnRight.animate(r,{onUpdate:t}):(i._btnRight=new g({id:"btnRight",dragEnabled:i.right.eventEnabled,hoverClone:!1,context:r}),i._btnRight.on("draging",function(){this.context.y=-i.btnOut/2+1,this.context.x>i.width-i.btnWidth&&(this.context.x=i.width-i.btnWidth+1),this.context.x+i.btnWidth-i._btnLeft.context.x>i.disPart.max&&(this.context.x=i.disPart.max-(i.btnWidth-i._btnLeft.context.x)+1),this.context.x+i.btnWidth-i._btnLeft.context.x<i.disPart.min&&(this.context.x=i.disPart.min-i.btnWidth+i._btnLeft.context.x),"rect"==i.shapeType&&(i._rangeElement.context.width=this.context.x-i._btnLeft.context.x-i.btnWidth,i._rangeElement.context.x=i._btnLeft.context.x+i.btnWidth),"triangle"==i.shapeType&&(i._rangeElement.context.pointList=i._getRangeTrianglePoints()),i._setRange()}),i._btnRight.on("dragend",function(){i.dragEnd(i.range)}),this.dataZoomBtns.addChild(this._btnRight)),r.x-a.x+i.btnWidth),o=this.btnHeight-1,a=a.x,l=i.range.fillStyle,r=(l&&l.lineargradient&&l.lineargradient.length&&(n=i.ctx.createLinearGradient(0,i.btnHeight,i.width,i.btnHeight),f.each(l.lineargradient,function(t){n.addColorStop(t.position,t.color)}),l=n),{x:a,y:1,width:r,height:o,fillStyle:l,fillAlpha:i.range.alpha,cursor:"move"}),o={x:a,y:1,pointList:i._getRangeTrianglePoints(),fillStyle:l,fillAlpha:i.range.alpha,cursor:"move"};this._rangeElement?this._rangeElement.animate(r,{onUpdate:t}):("rect"==this.shapeType?(this._rangeElement=new g({id:"btnRange",dragEnabled:!0,hoverClone:!1,context:r}),this._rangeElement.on("draging",function(){this.context.y=1,this.context.x<0&&(this.context.x=0),this.context.x>i.width-this.context.width&&(this.context.x=i.width-this.context.width),i._btnLeft.context.x=this.context.x,i._btnRight.context.x=this.context.x+this.context.width-i.btnWidth,i._setRange("btnRange")}),this._rangeElement.on("dragend",function(){i.dragEnd(i.range)})):this._rangeElement=new y({id:"btnRange",context:o}),this.dataZoomBtns.addChild(this._rangeElement,0)),this.linesLeft||(this.linesLeft=new d.default.Display.Sprite({id:"linesLeft"}),this.left.eventEnabled&&this._addLines({sprite:this.linesLeft}),this.dataZoomBtns.addChild(this.linesLeft)),this.linesRight||(this.linesRight=new d.default.Display.Sprite({id:"linesRight"}),this.right.eventEnabled&&this._addLines({sprite:this.linesRight}),this.dataZoomBtns.addChild(this.linesRight)),this.linesCenter||"rect"!=this.shapeType||(this.linesCenter=new d.default.Display.Sprite({id:"linesCenter"}),this._addLines({count:3,sprite:this.linesCenter,strokeStyle:this.color}),this.dataZoomBtns.addChild(this.linesCenter))}},{key:"_getRangeTrianglePoints",value:function(){var t=this._btnLeft.context,e=this._btnRight.context,n=t.x,e=e.x-t.x+this.btnWidth,t=this.btnHeight-1,i=this.width;return[[n,t],[n+e,t],[n+e,t*(1-(n+e)/i)],[n,t*(1-n/i)]]}},{key:"_setRange",value:function(t){var e=this,n=e._getRangeEnd(),i=n-e.range.start,a=e._btnLeft.context.x/e.width*e.count,r=(e._btnRight.context.x+e.btnWidth)/e.width*e.count,r="peak"==this.axisLayoutType?(a=Math.round(a),Math.round(r)):(this.axisLayoutType,a=parseInt(a),parseInt(r));"btnRange"==t&&r-a!=i&&(r=a+i),a==e.range.start&&r==n||(e.range.start=a,"peak"==e.axisLayoutType&&--r,e.range.end=r,e.dragIng(e.range)),e._setLines()}},{key:"_setRange_bak",value:function(t){var e=this,n=e._preRange?e._preRange.start:0,i=e._preRange?e._preRange.end:0,a=e._preRange?i-e._preRange.start:0,r=e._btnLeft.context.x/e.width*e.count,o=(e._btnRight.context.x+e.btnWidth)/e.width*e.count,o="peak"==this.axisLayoutType?(r=Math.round(r),Math.round(o)):(this.axisLayoutType,r=parseInt(r),parseInt(o));"btnRange"==t&&e._preRange&&o-r!=a&&(o=r+a),e._preRange&&r==n&&o==i||(e.range.start=r,"peak"==e.axisLayoutType&&--o,e.range.end=o,e.dragIng(e.range),e._preRange=Object.assign({},e.range)),e._setLines()}},{key:"_setLines",value:function(){var t=this.linesLeft,e=this.linesRight,n=this._btnLeft,i=this._btnRight;t.context.x=n.context.x+(n.context.width-t.context.width)/2,t.context.y=n.context.y+(n.context.height-t.context.height)/2,e.context.x=i.context.x+(i.context.width-e.context.width)/2,e.context.y=i.context.y+(i.context.height-e.context.height)/2,"rect"==this.shapeType&&(n=this.linesCenter,i=this._rangeElement,n.context.x=i.context.x+(i.context.width-n.context.width)/2,n.context.y=i.context.y+(i.context.height-n.context.height)/2),this.underline.enabled&&(this._underline.context.start.x=t.context.x+this.btnWidth/2,this._underline.context.end.x=e.context.x+this.btnWidth/2)}},{key:"_addLines",value:function(t){for(var e=t.count||2,n=t.sprite,i=t.dis||2,a=0;a<e;a++)n.addChild(this._addLine({x:a*i,strokeStyle:t.strokeStyle||""}));n.context.width=a*i-1,n.context.height=6}},{key:"_addLine",value:function(t){t=t||{};return new p({id:t.id||"",context:{x:t.x||0,y:t.y||0,start:{x:t.start?t.start.x:0,y:t.start?t.start.y:0},end:{x:t.end?t.end.x:0,y:t.end?t.end.y:6},lineWidth:t.lineWidth||1,strokeStyle:t.strokeStyle||"#ffffff"}})}},{key:"setMiniGroupsMap",value:function(){var t,e;"triangle"!=this.shapeType&&(this.__graphssp&&this.__graphssp.destroy(),(t=this._cloneChart.thumbChart.graphsSprite).setEventEnable(!1),e=this._cloneChart.thumbChart.getComponent({name:"coord"}),t.id=t.id+"_datazoomthumbChartbg",t.context.x=-e.origin.x,t.context.scaleY=this.btnHeight/e.height,t.context.scaleX=this.width/e.width,t.context.globalAlpha=this.graphAlpha,this.dataZoomBg.addChild(t,0),this.__graphssp=t,this._cloneChart.thumbChart.destroy(),this._cloneChart.cloneEl.parentNode.removeChild(this._cloneChart.cloneEl))}}],[{key:"defaultProps",value:function(){return{position:{detail:"位置，默认bottom,其他可选left,right,top",default:"bottom"},height:{detail:"高",default:24},width:{detail:"宽",default:0},color:{detail:"拖拽轴的主题颜色，比如其他按钮如果没有单独设置颜色，就继承该值",default:"#809fff"},shapeType:{detail:"背景的图形形状,可选rect，triangle",default:"rect"},range:{detail:"范围设置",propertys:{start:{detail:"开始位置",default:0},end:{detail:"结束位置，默认为null，表示到最后",default:null},max:{detail:"最多可以选择多大的数据区间",default:null},min:{detail:"最少可以选择多大的数据区间",default:1},eventEnabled:{detail:"是否响应事件",default:!0},fillStyle:{detail:"填充色",default:"#000000"},alpha:{detail:"透明度",default:.015}}},left:{detail:"左边按钮",propertys:{eventEnabled:{detail:"是否响应事件",default:!0},fillStyle:{detail:"颜色，默认取组件.color",default:""}}},right:{detail:"右边按钮",propertys:{eventEnabled:{detail:"是否响应事件",default:!0},fillStyle:{detail:"颜色，默认取组件.color",default:""}}},bg:{detail:"背景设置",propertys:{enabled:{detail:"是否开启",default:!0},fillStyle:{detail:"填充色",default:""},alpha:{detail:"透明度",default:.5},strokeStyle:{detail:"边框色",default:"#e6e6e6"},lineWidth:{detail:"线宽",default:1}}},graphAlpha:{detail:"图形的透明度",default:.6},graphStyle:{detail:"图形的颜色",default:"#dddddd"},underline:{detail:"underline",propertys:{enabled:{detail:"是否开启",default:!0},strokeStyle:{detail:"线条色",default:null},lineWidth:{detail:"线宽",default:2}}},btnOut:{detail:"left,right按钮突出的大小",default:4},btnHeight:{detail:"left,right按钮高",default:20,documentation:"left,right按钮的高，不在left，right下面，统一在这个属性里， 以为要强制保持一致"},btnWidth:{detail:"left,right按钮的宽",default:9,documentation:"left,right按钮的宽，不在left，right下面，统一在这个属性里， 以为要强制保持一致"}}}}]),r}(u.default);u.default.registerComponent(_,"dataZoom"),e.default=_})),markline=(unwrapExports(datazoom),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component),i=interopRequireDefault(Canvax);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var h=i.default._,c=i.default.Shapes.BrokenLine,f=i.default.Display.Sprite,p=i.default.Display.Text,i=function(t){(0,l.default)(i,t);var n=d(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="markLine",e._yAxis=null,e.line={y:0,list:[]},e._txt=null,e._line=null,e.sprite=new f,e.app.graphsSprite.addChild(e.sprite),h.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e}return(0,r.default)(i,[{key:"draw",value:function(){this._calculateProps(),this.setPosition(),this.widget()}},{key:"_calculateProps",value:function(){var i,t,e,n,a=this._opt,r=a.markTo,o=this.app.getComponent({name:"coord"});r&&-1==h.indexOf(this.app.dataFrame.fields,r)||(i=o._yAxis[0],r&&h.each(o._yAxis,function(t,e){var n=h.flatten([t.field]);0<=h.indexOf(n,r)&&(i=t)}),a.yAxisAlign&&(i=o._yAxis["left"==a.yAxisAlign?0:1]),t=void 0!==a.y&&null!==a.y?Number(a.y):void 0!==a.yVal&&null!==a.yVal?Number(a.yVal):function(){var t=this.app.dataFrame.getFieldData(r),e=0;return h.each(t,function(t){Number(t)&&(e+=t)}),e/t.length},isNaN(t)||i.addValToSection(t),e="#777",(n=o.getFieldConfig(r))&&(e=n.color),n=a.line&&a.line.strokeStyle||e,a=a.label&&a.label.fontColor||e,this._yAxis=i,this.width=o.width,this.height=o.height,this.yVal=t,this.pos={x:o.origin.x,y:o.origin.y},this.line.list=[[0,0],[this.width,0]],this.label.fontColor=a,n&&(this.line.strokeStyle=n))}},{key:"widget",value:function(){var t=this,e=this._getYPos(),n=new c({id:"line",context:{y:e,pointList:t.line.list,strokeStyle:t.line.strokeStyle,lineWidth:t.line.lineWidth,lineType:t.line.lineType}});t.sprite.addChild(n),t._line=n,t.label.enabled&&(n={fillStyle:t.label.fontColor,fontSize:t.label.fontSize},n=new p(t._getLabel(),{context:n}),this._txt=n,t.sprite.addChild(n),t._setTxtPos(e)),this.line.y=e}},{key:"reset",value:function(t){t&&h.extend(!0,this,t);var e=this,t=this._getYPos();t!=this.line.y&&this._line.animate({y:t},{duration:300,onUpdate:function(t){e.label.enabled&&(e._txt.resetText(e._getLabel()),e._setTxtPos(t.y))}}),this._line.context.strokeStyle=this.line.strokeStyle,this.line.y=t}},{key:"_setTxtPos",value:function(t){var e=this._txt;if(!this._yAxis)return 0;"left"==this._yAxis.align?e.context.x=5:e.context.x=this.width-e.getTextWidth()-5,h.isNumber(this.label.y)?e.context.y=this.label.y:e.context.y=t-e.getTextHeight()}},{key:"_getYVal",value:function(t){var e=t=t||this.yVal;return e=h.isFunction(t)?t.apply(this):e}},{key:"_getYPos",value:function(){return this._opt.yPixel?-this._opt.yPixel:this._yAxis?-this._yAxis.getPosOfVal(this._getYVal()):0}},{key:"_getLabel",value:function(){var t=this._getYVal(),t=h.isFunction(this.label.format)?this.label.format(t,this):h.isString(this.label.text)?this.label.text:t;return t}}],[{key:"defaultProps",value:function(){return{markTo:{detail:"标准哪个目标字段",default:null},yVal:{detail:"组件的值",default:0,documentation:"可能是个function，均值计算就是个function"},yPixel:{detail:"组件指定的具体y像素值",default:0},line:{detail:"线的配置",propertys:{strokeStyle:{detail:"线的颜色",default:"#999999"},lineWidth:{detail:"线宽",default:1},lineType:{detail:"线样式",default:"dashed"}}},label:{detail:"文本",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本字体颜色",default:"#666"},fontSize:{detail:"文本字体大小",default:12},text:{detail:"文本内容",default:null},format:{detail:"文本格式化函数",default:null}}}}}}]),i}(n.default);n.default.registerComponent(i,"markLine"),e.default=i})),tips=(unwrapExports(markline),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=interopRequireDefault(_typeof_1$1),r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),i=interopRequireDefault(component),u=interopRequireDefault(Canvax);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var f=u.default._,h=u.default.Shapes.Rect,p=u.default.Shapes.Line,g=function(t){(0,l.default)(a,t);var i=d(a);function a(t,e){(0,r.default)(this,a),(e=i.call(this,t,e)).name="tips",e.cW=0,e.cH=0,e.dW=0,e.dH=0,e._tipDom=null,e._tipsPointer=null,e.eventInfo=null,e.sprite=null,e.sprite=new u.default.Display.Sprite({id:"TipSprite"}),e.app.stage.addChild(e.sprite);var n=(0,o.default)(e);return e.sprite.on("destroy",function(){n._removeContent()}),f.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(a.defaultProps()),t),e.tipDomContainer=null,document&&(e.containerIsBody?e.tipDomContainer=document.body:e.tipDomContainer=e.app.canvax.domView),e}return(0,n.default)(a,[{key:"show",value:function(e){var t,n=this;this.enabled&&(e.eventInfo?(this.eventInfo=e.eventInfo,(t=e.target.getStage())?(this.cW=t.context.width,this.cH=t.context.height):"canvax"==e.target.type&&(this.cW=e.target.width,this.cH=e.target.height),this._setContent(e).then(function(t){t?(n._setPosition(e),n.sprite.toFront()):n._hideDialogTips(e)})):this._hideDialogTips(e),this._tipsPointerShow(e),this.onshow.apply(this,[e]))}},{key:"move",value:function(e){var n=this;this.enabled&&(e.eventInfo&&(this.eventInfo=e.eventInfo,this._setContent(e).then(function(t){t?n._setPosition(e):n._hideDialogTips()})),this._tipsPointerMove(e),this.onmove.apply(this,[e]))}},{key:"hide",value:function(t){this._hide(t),this.onhide.apply(this,[t])}},{key:"_hide",value:function(t){this.enabled&&(this._hideDialogTips(t),this._tipsPointerHide(t))}},{key:"_hideDialogTips",value:function(){this.eventInfo&&(this.eventInfo=null,this.sprite.removeAllChildren(),this._removeContent())}},{key:"_setPosition",value:function(t){var e,n,i,a;this.enabled&&this._tipDom&&(e=(n=this.app.canvax.el.getBoundingClientRect()).x||n.left,n=n.y||n.top,this.containerIsBody?(a=t.target.localToGlobal(t.point),i=this._checkX(a.x+e+this.offsetX),a=this._checkY(a.y+n+this.offsetY)):(i=this._checkX(t.offsetX+e+this.offsetX),a=this._checkY(t.offsetY+n+this.offsetY),i-=e,a-=n),this._tipDom.style.cssText+=";visibility:visible;left:"+i+"px;top:"+a+"px;","left"==this.positionOfPoint&&(this._tipDom.style.left=this._checkX(t.x-this.offsetX-this._tipDom.offsetWidth)+"px"))}},{key:"_creatTipDom",value:function(t){if(document)return this._tipDom=document.createElement("div"),this._tipDom.className="chart-tips",this._tipDom.style.cssText+="; border-radius:"+this.borderRadius+"px;background:"+this.fillStyle+";border:1px solid "+this.strokeStyle+";visibility:hidden;position:"+(this.containerIsBody?"fixed":"absolute")+";z-index:99999999;enabled:inline-block;*enabled:inline;*zoom:1;padding:6px;color:"+this.fontColor+";line-height:1.5",this._tipDom.style.cssText+="; box-shadow:1px 1px 3px "+this.strokeStyle+";",this._tipDom.style.cssText+="; border:none;white-space:nowrap;word-wrap:normal;",this._tipDom.style.cssText+="; text-align:left;pointer-events:none;",this._tipDom.style.cssText+="; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;",this.tipDomContainer&&this.tipDomContainer.appendChild(this._tipDom),this._tipDom}},{key:"_removeContent",value:function(){this._tipDom&&(this.tipDomContainer&&this.tipDomContainer.removeChild(this._tipDom),this._tipDom=null)}},{key:"_setContent",value:function(n){var i=this;return new Promise(function(e){var t=i._getContent(n);t||0===t?(i._tipDom||(i._tipDom=i._creatTipDom(n)),i._tipDom&&(t.then?t.then(function(t){i._tipDom.innerHTML=t,i.dW=i._tipDom.offsetWidth,i.dH=i._tipDom.offsetHeight,e(t)}):(i._tipDom.innerHTML=t,i.dW=i._tipDom.offsetWidth,i.dH=i._tipDom.offsetHeight,e(t)))):e("")})}},{key:"_getContent",value:function(t){var e="";return e=(e=t.eventInfo.tipsContent?f.isFunction(t.eventInfo.tipsContent)?t.eventInfo.tipsContent(t.eventInfo,t):t.eventInfo.tipsContent:e)||(this.content?f.isFunction(this.content)?this.content(t.eventInfo,t):this.content:this._getDefaultContent(t.eventInfo))}},{key:"_getDefaultContent",value:function(s){var u,d=this.app.getComponent({name:"coord"}),h="";return s.nodes.length&&(u=!1,s.nodes.length&&(h+="<table >",void 0!==s.title&&null!==s.title&&""!==s.title&&(h=(h+="<tr><td colspan='2' style='text-align:left;padding-left:3px;'>")+"<span style='font-size:12px;padding:4px;color:#333;'>"+s.title+"</span></td></tr>",u=!0),f.each(s.nodes,function(t,e){var n,i,a,r=t.color||t.fillStyle||t.strokeStyle,o=d.getFieldConfig(t.field),l=t.name||t.label||(o||{}).name||t.content||t.field||"";h+="<tr>","object"==(0,c.default)(t.value)?(t.value&&t.value.x&&(a=(n=d.getFieldConfig(s.xAxis.field))&&n.name||s.xAxis.field,n=n?n.getFormatValue(t.value.x):t.value.x,h+="<td style='padding:0px 6px;'>"+a+"：<span style='color:"+r+"'>"+n+"</span></td>",u=!0),t.value&&t.value.y&&(i=o?o.getFormatValue(t.value.y):t.value.y,h+="<td style='padding:0px 6px;'>"+l+"：<span style='color:"+r+"'>"+i+"</span></td>",u=!0)):(i=o?o.getFormatValue(t.value):t.value,(a=t.value||0===t.value)||t.__no_value||(r="#ddd",i="--"),t.__no__name||(h+="<td style='padding:0px 6px;color:"+(a||t.__no_value?"#a0a0a0;":"#ddd")+"'>"+l+"</td>",u=!0),t.__no_value||(h=h+"<td style='padding:0px 6px;font-weight:bold;'><span style='color:"+r+"'>"+i+"</span>",t.subValue&&(h+="<span style='padding-left:6px;font-weight:normal;'>"+t.subValue+"</span>",u=!0),h+="</td>")),h+="</tr>"}),h+="</table>"),u||(h="")),h}},{key:"_checkX",value:function(t){var e=this.dW+2,n=document.documentElement.clientWidth;return t<0?t=0:n<t+e&&(t=n-e),t}},{key:"_checkY",value:function(t){var e=this.dH+2,n=document.documentElement.clientHeight;return t<0?t=0:n<t+e&&(t=n-e),t}},{key:"_tipsPointerShow",value:function(t){var e,n,i,a,r,o=this;t.eventInfo&&t.eventInfo.xAxis&&((e=this.app.getComponent({name:"coord"}))&&"rect"==e.type&&this.pointer&&(t.eventInfo.nodes.forEach(function(t){"bar"==t.type&&(o.pointer="region")}),r=this._tipsPointer,n=e.origin.y-e.height,i=0,"line"==this.pointer&&(i=e.origin.x+t.eventInfo.xAxis.x),"region"==this.pointer&&(a=e._xAxis.getCellLengthOfPos(t.eventInfo.xAxis.x),i=e.origin.x+t.eventInfo.xAxis.x-a/2,t.eventInfo.xAxis.ind<0&&(i=e.origin.x)),r?this.pointerAnim&&"proportion"!=e._xAxis.layoutType?(r.__animation&&r.__animation.stop(),r.__animation=r.animate({x:i,y:n},{duration:200})):(r.context.x=i,r.context.y=n):("line"==this.pointer&&(r=new p({context:{x:i,y:n,start:{x:0,y:0},end:{x:0,y:e.height},lineWidth:this.pointerLineWidth,strokeStyle:this.pointerColor}})),"region"==this.pointer&&(a=e._xAxis.getCellLengthOfPos(i),r=new h({context:{width:a,height:e.height,x:i,y:n,fillStyle:this.pointerColor,globalAlpha:this.pointerRegionAlpha}})),this.app.graphsSprite.addChild(r,0),this._tipsPointer=r)))}},{key:"_tipsPointerHide",value:function(t){t.eventInfo&&t.eventInfo.xAxis&&((t=this.app.getComponent({name:"coord"}))&&"rect"==t.type&&this.pointer&&this._tipsPointer&&(this._tipsPointer.destroy(),this._tipsPointer=null))}},{key:"_tipsPointerMove",value:function(t){var e,n,i,a;t.eventInfo&&t.eventInfo.xAxis&&((e=this.app.getComponent({name:"coord"}))&&"rect"==e.type&&this.pointer&&this._tipsPointer&&(n=this._tipsPointer,i=e.origin.x+t.eventInfo.xAxis.x,"region"==this.pointer&&(a=e._xAxis.getCellLengthOfPos(t.eventInfo.xAxis.x),i=e.origin.x+t.eventInfo.xAxis.x-a/2,t.eventInfo.xAxis.ind<0&&(i=e.origin.x)),a=e.origin.y-e.height,i!=n.__targetX&&(this.pointerAnim&&"proportion"!=e._xAxis.layoutType?(n.__animation&&n.__animation.stop(),n.__targetX=i,n.__animation=n.animate({x:i,y:a},{duration:200,onComplete:function(){delete n.__targetX,delete n.__animation}})):(n.context.x=i,n.context.y=a))))}}],[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启Tips",default:!0},content:{detail:"自定义tips的内容（html）",default:null},containerIsBody:{detail:"tips的html内容是否放到body下面，默认true，false则放到图表自身的容器内",default:!0},borderRadius:{detail:"tips的边框圆角半径",default:5},strokeStyle:{detail:"tips边框颜色",default:"#ccc"},fillStyle:{detail:"tips背景色",default:"rgba(255,255,255,0.95)"},fontColor:{detail:"tips文本颜色",default:"#999999"},positionOfPoint:{detail:"tips在触发点的位置，默认在右侧",default:"right"},offsetX:{detail:"tips内容到鼠标位置的偏移量x",default:10},offsetY:{detail:"tips内容到鼠标位置的偏移量y",default:10},positionInRange:{detail:"tip的浮层是否限定在画布区域(废弃)",default:!1},pointer:{detail:"触发tips的时候的指针样式",default:"line",documentation:'tips的指针,默认为直线，可选为："line" | "region"(柱状图中一般用region)'},pointerColor:{detail:"tips指针样式的颜色",default:"#ccc"},pointerLineWidth:{detail:"pointer为line的时候，设置指针line的线宽，默认1.5",default:1},pointerRegionAlpha:{detail:"pointer为region的时候，设置指针region的透明度",default:.38},pointerAnim:{detail:"tips移动的时候，指针是否开启动画",default:!0},linkageName:{detail:"tips的多图表联动，相同的图表会执行事件联动，这个属性注意要保证y轴的width是一致的",default:null},onshow:{detail:"show的时候的事件",default:function(){}},onmove:{detail:"move的时候的事件",default:function(){}},onhide:{detail:"hide的时候的事件",default:function(){}}}}}]),a}(i.default);i.default.registerComponent(g,"tips"),e.default=g})),contextmenu=(unwrapExports(tips),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=interopRequireDefault(classCallCheck$1),n=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),a=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),i=interopRequireDefault(component),u=interopRequireDefault(Canvax);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,a.default)(this,t)}}var h=u.default._,c=function(t){(0,l.default)(a,t);var i=d(a);function a(t,e){(0,r.default)(this,a),(e=i.call(this,t,e)).name="contextmenu",e.cW=0,e.cH=0,e.dW=0,e.dH=0,e._tipDom=null,e._tipsPointer=null,e.eventInfo=null,e.sprite=null,e.sprite=new u.default.Display.Sprite({id:"contextMenuSprite"}),e.app.stage.addChild(e.sprite);var n=(0,o.default)(e);return e.sprite.on("destroy",function(){n._removeContent()}),e.isShow=!1,h.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(a.defaultProps()),t),e.tipDomContainer=document?document.body:null,e}return(0,n.default)(a,[{key:"show",value:function(t){var e;this.enabled&&(t.eventInfo?(this.eventInfo=t.eventInfo,(e=t.target.getStage())?(this.cW=e.context.width,this.cH=e.context.height):"canvax"==t.target.type&&(this.cW=t.target.width,this.cH=t.target.height),this._setContent(t)?(this._setPosition(t),this.sprite.toFront()):this._hideDialogMenus(t)):this._hideDialogMenus(t),this.onshow.apply(this,[t]),this.isShow=!0)}},{key:"hide",value:function(t){this.enabled&&(this._hideDialogMenus(t),this.onhide.apply(this,[t]),this.isShow=!1)}},{key:"_hideDialogMenus",value:function(){this.eventInfo&&(this.eventInfo=null,this.sprite.removeAllChildren(),this._removeContent())}},{key:"_setPosition",value:function(t){var e,n,i,a;this.enabled&&this._tipDom&&(e=(n=this.app.canvax.el.getBoundingClientRect()).x||n.left,n=n.y||n.top,this.containerIsBody?(a=t.target.localToGlobal(t.point),i=this._checkX(a.x+e+this.offsetX),a=this._checkY(a.y+n+this.offsetY)):(i=this._checkX(t.offsetX+e+this.offsetX),a=this._checkY(t.offsetY+n+this.offsetY),i-=e,a-=n),this._tipDom.style.cssText+=";visibility:visible;left:"+i+"px;top:"+a+"px;","left"==this.positionOfPoint&&(this._tipDom.style.left=this._checkX(t.x-this.offsetX-this._tipDom.offsetWidth)+"px"))}},{key:"_creatMenuDom",value:function(t){var e=this;if(document)return this._tipDom=document.createElement("div"),this._tipDom.className="context-menu-tips",this._tipDom.style.cssText+="; border-radius:"+this.borderRadius+"px;background:"+this.fillStyle+";border:1px solid "+this.strokeStyle+";visibility:hidden;position:"+(this.containerIsBody?"fixed":"absolute")+";z-index:99999999;enabled:inline-block;*enabled:inline;*zoom:1;color:"+this.fontColor+";line-height:1.5",this._tipDom.style.cssText+="; box-shadow:1px 1px 3px "+this.strokeStyle+";",this._tipDom.style.cssText+="; border:none;white-space:nowrap;word-wrap:normal;",this._tipDom.style.cssText+="; text-align:left;",this._tipDom.style.cssText+="; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;",this._tipDom.onclick=function(){e.hide()},this.tipDomContainer&&this.tipDomContainer.appendChild(this._tipDom),this._tipDom}},{key:"_removeContent",value:function(){this._tipDom&&(this.tipDomContainer&&this.tipDomContainer.removeChild(this._tipDom),this._tipDom=null)}},{key:"_setContent",value:function(t){var e=this._getContent(t);if(e||0===e)return this._tipDom||(this._tipDom=this._creatMenuDom(t)),this._tipDom&&(this._tipDom.innerHTML=e,this.dW=this._tipDom.offsetWidth,this.dH=this._tipDom.offsetHeight),e}},{key:"_getContent",value:function(t){t=this.content?h.isFunction(this.content)?this.content(t.eventInfo,t):this.content:"";return t}},{key:"_checkX",value:function(t){var e=this.dW+2,n=document.documentElement.clientWidth;return t<0?t=0:n<t+e&&(t=n-e),t}},{key:"_checkY",value:function(t){var e=this.dH+2,n=document.documentElement.clientHeight;return t<0?t=0:n<t+e&&(t=n-e),t}}],[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启右键菜单",default:!0},content:{detail:"自定义tips的内容（html）",default:null},containerIsBody:{detail:"tips的html内容是否放到body下面，默认true，false则放到图表自身的容器内",default:!0},borderRadius:{detail:"tips的边框圆角半径",default:5},strokeStyle:{detail:"tips边框颜色",default:"#ccc"},fillStyle:{detail:"tips背景色",default:"rgba(255,255,255,0.95)"},fontColor:{detail:"tips文本颜色",default:"#999999"},positionOfPoint:{detail:"tips在触发点的位置，默认在右侧",default:"right"},offsetX:{detail:"tips内容到鼠标位置的偏移量x",default:10},offsetY:{detail:"tips内容到鼠标位置的偏移量y",default:10},onshow:{detail:"show的时候的事件",default:function(){}},onmove:{detail:"move的时候的事件",default:function(){}},onhide:{detail:"hide的时候的事件",default:function(){}}}}}]),a}(i.default);i.default.registerComponent(c,"contextmenu"),e.default=c})),bartgi=(unwrapExports(contextmenu),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component),d=interopRequireDefault(Canvax);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=d.default.Shapes.Line,f=d.default._,i=function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="barTgi",e.data=null,e.barDatas=null,e._yAxis=null,e.sprite=null,e.pos={x:0,y:0},f.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e._yAxis=e.app.getComponent({name:"coord"})._yAxis["left"==e.yAxisAlign?0:1],e.sprite=new d.default.Display.Sprite,e.app.graphsSprite.addChild(e.sprite),e}return(0,r.default)(i,[{key:"reset",value:function(t){f.extend(!0,this,t),this.barDatas=null,this.data=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var a=this,t=this.app.getComponent({name:"coord"});this.pos={x:t.origin.x,y:t.origin.y},this.setPosition(),f.each(a.app.getComponents({name:"graphs"}),function(t){if("bar"==t.type&&t.data[a.barField])return a.barDatas=t.data[a.barField],!1}),this.data=f.flatten(a.app.dataFrame.getDataOrg(a.field)),this.barDatas&&f.each(this.data,function(t,e){var n=-a._yAxis.getPosOfVal(t),i=a.barDatas[e],i=new c({context:{start:{x:i.x,y:n},end:{x:i.x+i.width,y:n},lineWidth:2,strokeStyle:a._getProp(a.line.strokeStyle,t,e)}});a.sprite.addChild(i)})}},{key:"_getProp",value:function(t,e,n){var i=t;return i=f.isFunction(t)?t.apply(this,[e,n]):i}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},barField:{detail:"这个bartgi组件对应的bar Graph 的field",default:null},yAxisAlign:{detail:"这个bartgi组件回到到哪个y轴",default:"left"},standardVal:{detail:"tgi标准线",default:100},line:{detail:"bar对应的tgi线配置",propertys:{lineWidth:{detail:"线宽",default:3},strokeStyle:{detail:"线颜色",default:function(t){return t>=this.standardVal?"#43cbb5":"#ff6060"}}}}}}}]),i}(n.default);n.default.registerComponent(i,"barTgi"),e.default=i})),barguide=(unwrapExports(bartgi),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component),d=interopRequireDefault(Canvax);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=d.default._,i=function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="barGuide",e.data=null,e.barDatas=null,e._yAxis=null,e.sprite=null,c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e._yAxis=e.app.getComponent({name:"coord"})._yAxis["left"==e.yAxisAlign?0:1],e.sprite=new d.default.Display.Sprite,e.app.graphsSprite.addChild(e.sprite),e}return(0,r.default)(i,[{key:"reset",value:function(t){c.extend(!0,this,t),this.barDatas=null,this.data=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var r=this,t=this.app.getComponent({name:"coord"});this.pos={x:t.origin.x,y:t.origin.y},this.setPosition(),c.each(r.app.getComponents({name:"graphs"}),function(t){if("bar"==t.type&&t.data[r.barField])return r.barDatas=t.data[r.barField],!1}),this.data=c.flatten(r.app.dataFrame.getDataOrg(r.field)),this.barDatas&&c.each(this.data,function(t,e){var n=-r._yAxis.getPosOfVal(t),e=r.barDatas[e],i=new d.default.Shapes.Circle({context:{x:e.x+e.width/2,y:n,r:r.node.radius,fillStyle:r.node.fillStyle,strokeStyle:r.node.strokeStyle,lineWidth:r.node.lineWidth}}),a=t,t=(c.isFunction(r.label.format)&&(a=r.label.format(t,e)),new d.default.Display.Text(a,{context:{x:e.x+e.width/2,y:n-r.node.radius-1,fillStyle:r.label.fontColor,lineWidth:r.label.lineWidth,strokeStyle:r.label.strokeStyle,fontSize:r.label.fontSize,textAlign:r.label.textAlign,textBaseline:r.label.verticalAlign}}));r.sprite.addChild(i),r.sprite.addChild(t)})}},{key:"_getProp",value:function(t,e,n){var i=t;return i=c.isFunction(t)?t.apply(this,[e,n]):i}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},barField:{detail:"这个guide对应的bar Graph 的field",default:null},yAxisAlign:{detail:"这个guide组件回到到哪个y轴",default:"left"},node:{detail:"单个节点配置",propertys:{shapeType:{detail:"节点绘制的图形类型",default:"circle"},lineWidth:{detail:"图表描边线宽",default:3},radius:{detail:"图形半径",default:6},fillStyle:{detail:"填充色",default:"#19dea1"},strokeStyle:{detail:"描边色",default:"#fff"}}},label:{detail:"文本配置",propertys:{fontSize:{detail:"字体大小",default:12},fontColor:{detail:"字体颜色",default:"#19dea1"},verticalAlign:{detail:"垂直对齐方式",default:"bottom"},textAlign:{detail:"水平对齐方式",default:"center"},strokeStyle:{detail:"文本描边颜色",default:"#fff"},lineWidth:{detail:"文本描边线宽",default:0},format:{detail:"文本格式处理函数",default:null}}}}}}]),i}(n.default);n.default.registerComponent(i,"barGuide"),e.default=i})),theme=(unwrapExports(barguide),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(inherits$1),l=interopRequireDefault(possibleConstructorReturn$1),s=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component);function u(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,s.default)(n);return t=i?(t=(0,s.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,l.default)(this,t)}}var i=function(t){(0,o.default)(i,t);var n=u(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="theme",e.colors=t||[],e}return(0,r.default)(i,[{key:"set",value:function(t){return this.colors=t,this.colors}},{key:"get",value:function(t){var e=this.colors;return e=Canvax._.isArray(e)?e:[e]}},{key:"mergeTo",value:function(t){t=t||[];for(var e=0,n=this.colors.length;e<n;e++)t[e]?t[e]=this.colors[e]:t.push(this.colors[e]);return t}}]),i}(n.default);n.default.registerComponent(i,"theme"),e.default=i})),watermark=(unwrapExports(theme),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),d=interopRequireDefault(Canvax),n=interopRequireDefault(component);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=d.default._,i=function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="waterMark",e.width=e.app.width,e.height=e.app.height,c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.spripte=new d.default.Display.Sprite({id:"watermark"}),e.app.stage.addChild(e.spripte),e.draw(),e}return(0,r.default)(i,[{key:"draw",value:function(){for(var t=new d.default.Display.Text(this.text,{context:{fontSize:this.fontSize,fillStyle:this.fontColor}}),e=t.getTextWidth(),n=t.getTextHeight(),i=parseInt(this.height/(5*n))+1,a=parseInt(this.width/(1.5*e))+1,r=0;r<i;r++)for(var o=0;o<a;o++){var l=new d.default.Display.Text(this.text,{context:{rotation:this.rotation,fontSize:this.fontSize,fillStyle:this.fontColor,globalAlpha:this.alpha}});l.context.x=1.5*e*o+.25*e,l.context.y=5*n*r,this.spripte.addChild(l)}}}],[{key:"defaultProps",value:function(){return{text:{detail:"水印内容",default:"chartx"},fontSize:{detail:"字体大小",default:20},fontColor:{detail:"水印颜色",default:"#cccccc"},alpha:{detail:"水印透明度",default:.2},rotation:{detail:"水印旋转角度",default:45}}}}]),i}(n.default);n.default.registerComponent(i,"waterMark"),e.default=i})),cross=(unwrapExports(watermark),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component),d=interopRequireDefault(Canvax);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=d.default._,x=d.default.Shapes.Line,m=d.default.Shapes.Rect,b=d.default.Shapes.Arrow,w=d.default.Display.Text,i=function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="cross",c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e._yAxis=e.app.getComponent({name:"coord"})._yAxis["left"==e.yAxisAlign?0:1],e.sprite=new d.default.Display.Sprite,e.app.graphsSprite.addChild(e.sprite,0),e}return(0,r.default)(i,[{key:"draw",value:function(){this._widget()}},{key:"reset",value:function(t){t&&c.extend(!0,this,t),this._widget()}},{key:"_widget",value:function(){for(var i=this,t=this.app.getComponent({name:"coord"}),a=(this.pos={x:t.origin.x,y:t.origin.y},this.setPosition(),t.width),r=t.height,e=this.aimPoint.xVal,o=0,o=null==e?parseInt(a/2):t._xAxis.getPosOfVal(e),n=this.aimPoint.yVal,l=0,l=null==e?parseInt(r/2):t._yAxis[0].getPosOfVal(n),s=0;s<4;s++){var u=0,d=0,h=0,c=0,f=void 0,p={},g={};switch(s){case 0:h=a-o,c=r-l,u=o,f="rightTop",p={x:a-8,y:(d=-r)+4,textAlign:"right",textBaseline:"top"},g={x:a,y:d};break;case 1:h=o,c=r-l,f="leftTop",p={x:(u=0)+8,y:(d=-r)+4,textAlign:"left",textBaseline:"top"},g={x:u,y:d};break;case 2:h=o,d=-(c=l),f="leftBottom",p={x:8,y:-4,textAlign:"left",textBaseline:"bottom"},g={x:u=0,y:0};break;case 3:h=a-o,u=o,d=-(c=l),f="rightBottom",p={x:a-8,y:-4,textAlign:"right",textBaseline:"bottom"},g={x:a,y:0}}var y=this.quadrant[f],_={width:h,height:c,x:u,y:d,fillStyle:y.fillStyle,fillAlpha:y.fillAlpha},v="_quadrant_"+s,_=(this[v]?Object.assign(this[v].context,_):(this[v]=new m({id:v,context:_}),i.sprite.addChild(this[v])),!0),v=(h&&c&&y.label.text||(_=!1),p.fillStyle=y.label.fontColor,p.fontSize=y.label.fontSize,p.visible=_,"_quadrant_text"+s);switch(this[v]?Object.assign(this[v].context,p):(this[v]=new w(y.label.text,{id:v,context:p}),i.sprite.addChild(this[v])),g.fillStyle=y.label.fillStyle,g.fillAlpha=y.label.fillAlpha,g.visible=_,Object.assign(g,{width:this[v].getTextWidth()+16,height:this[v].getTextHeight()+8}),s){case 0:g.x=g.x-g.width;break;case 1:break;case 2:g.y=g.y-g.height;break;case 3:g.x=g.x-g.width,g.y=g.y-g.height}y="_quadrant_text_background_"+s;this[y]?Object.assign(this[y].context,g):(this[y]=new m({id:y,context:g}),i.sprite.addChild(this[y]),this[y].toBack(1))}e={start:{x:0,y:-l},end:{x:a,y:-l},strokeStyle:i.line.strokeStyle,lineWidth:i.line.lineWidth,lineType:i.line.lineType},i._hLineElement?(i._hLineElement.context.start.y=e.start.y,i._hLineElement.context.end.y=e.end.y):(i._hLineElement=new x({context:e}),i.sprite.addChild(i._hLineElement)),t={x:0,y:0,control:{x:e.end.x-10,y:e.end.y},point:{x:e.end.x,y:e.end.y},strokeStyle:e.strokeStyle,fillStyle:e.strokeStyle},i._hLineElementArrow?(Object.assign(i._hLineElementArrow.context.control,t.control),Object.assign(i._hLineElementArrow.context.point,t.point)):(i._hLineElementArrow=new b({id:"_hArrow",context:t}),i.sprite.addChild(i._hLineElementArrow)),["begin","end"].forEach(function(t){var e={x:"begin"==t?4:a-4,y:-l-4,fillStyle:i.line.hLabel[t].fontColor,fontSize:i.line.hLabel[t].fontSize,textAlign:"begin"==t?"left":"right",textBaseline:"bottom"},n=i["_hLineLabel"+t+"Ctx"];n?Object.assign(n.context,e):(n=i["_hLineLabel"+t+"Ctx"]=new w(i.line.hLabel[t].text,{context:e}),i.sprite.addChild(n))}),n={start:{x:o,y:0},end:{x:o,y:-r},strokeStyle:i.line.strokeStyle,lineWidth:i.line.lineWidth,lineType:i.line.lineType},i._vLineElement?(i._vLineElement.context.start.x=n.start.x,i._vLineElement.context.end.x=n.end.x):(i._vLineElement=new x({context:n}),i.sprite.addChild(i._vLineElement)),e={x:0,y:0,control:{x:n.end.x,y:n.end.y+10},point:{x:n.end.x,y:n.end.y},strokeStyle:n.strokeStyle,fillStyle:n.strokeStyle};i._vLineElementArrow?(Object.assign(i._vLineElementArrow.context.control,e.control),Object.assign(i._vLineElementArrow.context.point,e.point)):(i._vLineElementArrow=new b({id:"_vArrow",context:e}),i.sprite.addChild(i._vLineElementArrow)),["begin","end"].forEach(function(t){var e={x:o-4,y:"begin"==t?-4:4-r,fillStyle:i.line.vLabel[t].fontColor,fontSize:i.line.vLabel[t].fontSize,textAlign:"right",textBaseline:"begin"==t?"bottom":"top"},n=i["_vLineLabel"+t+"Ctx"];n?Object.assign(n.context,e):(n=i["_vLineLabel"+t+"Ctx"]=new w(i.line.vLabel[t].text,{context:e}),i.sprite.addChild(n))})}}],[{key:"defaultProps",value:function(){return{aimPoint:{detail:"准心位置",propertys:{xVal:{detail:"准心x轴value",default:null},yVal:{detail:"准心y轴value",default:null}}},line:{detail:"线配置",propertys:{strokeStyle:{detail:"线颜色",default:"#cccccc"},lineWidth:{detail:"线宽",default:1},lineType:{detail:"线样式类型",default:"solid"},showArrow:{detail:"是否显示箭头",default:!0},vLabel:{detail:"纵向线方向的label",propertys:{begin:{detail:"开始点label",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"文本大小",default:12}}},end:{detail:"结束点label",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"文本大小",default:12}}}}},hLabel:{detail:"横向线方向的label",propertys:{begin:{detail:"开始点label",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"文本大小",default:12}}},end:{detail:"结束点label",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"文本大小",default:12}}}}}}},quadrant:{detail:"4象限设置",propertys:{rightTop:{detail:"第一象限",propertys:{fillStyle:{detail:"象限区块背景色",default:"#fff"},fillAlpha:{detail:"象限区块背透明度",default:.1},label:{detail:"象限文本设置",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#666"},fontSize:{detail:"文本字体大小",default:14},fillStyle:{detail:"文本矩形背景色",default:"#e9e9f8"},fillAlpha:{detail:"文本矩形背景透明度",default:.5}}}}},leftTop:{detail:"第二象限",propertys:{fillStyle:{detail:"象限区块背景色",default:"#fff"},fillAlpha:{detail:"象限区块背透明度",default:.1},label:{detail:"象限文本设置",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#666"},fontSize:{detail:"文本字体大小",default:14},fillStyle:{detail:"文本矩形背景色",default:"#e9e9f8"},fillAlpha:{detail:"文本矩形背景透明度",default:.5}}}}},leftBottom:{detail:"第三象限",propertys:{fillStyle:{detail:"象限区块背景色",default:"#fff"},fillAlpha:{detail:"象限区块背透明度",default:.1},label:{detail:"象限文本设置",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#666"},fontSize:{detail:"文本字体大小",default:14},fillStyle:{detail:"文本矩形背景色",default:"#e9e9f8"},fillAlpha:{detail:"文本矩形背景透明度",default:.5}}}}},rightBottom:{detail:"第四象限",propertys:{fillStyle:{detail:"象限区块背景色",default:"#fff"},fillAlpha:{detail:"象限区块背透明度",default:.1},label:{detail:"象限文本设置",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#666"},fontSize:{detail:"文本字体大小",default:14},fillStyle:{detail:"文本矩形背景色",default:"#e9e9f8"},fillAlpha:{detail:"文本矩形背景透明度",default:.5}}}}}}}}}}]),i}(n.default);n.default.registerComponent(i,"cross"),e.default=i})),lineschedu=(unwrapExports(cross),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component),d=interopRequireDefault(Canvax);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=d.default._,i=function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="lineSchedu",c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.lineDatas=null,e.sprite=new d.default.Display.Sprite,e.app.graphsSprite.addChild(e.sprite),e}return(0,r.default)(i,[{key:"reset",value:function(t){c.extend(!0,this,t),this.lineDatas=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var t,e,n,i,a,r,o,l=this,s=this.app.getComponent({name:"coord"}),u=(this.pos={x:s.origin.x,y:s.origin.y},this.setPosition(),l.app.getComponent({name:"graphs",type:"line",field:l.lineField})),u=(l.lineDatas=u.data[l.lineField].data,this.app.getComponent({name:"coord"}).getAxis({type:"xAxis"}).getIndexOfVal(this.time));-1!=u&&null!=(u=this.lineDatas[u]).y&&(t=l._getNodeY(u,s),e=u.x,n=new d.default.Display.Sprite({context:{x:e-20}}),this.sprite.addChild(n),i=0,r=new d.default.Display.Text(l.time,{context:{fillStyle:this.timeFontColor||this.style,fontSize:this.timeFontSize}}),n.addChild(r),i=r.getTextHeight(),a=r.getTextWidth(),o=new d.default.Display.Text(c.flatten([l.list]).join("\n"),{context:{y:i,fillStyle:this.listFontColor||this.style,fontSize:this.listFontSize}}),n.addChild(o),i+=o.getTextHeight(),(a=Math.max(a,o.getTextWidth()))+e-20>s.width+l.app.padding.right&&(n.context.x=s.width+l.app.padding.right,r.context.textAlign="right",o.context.textAlign="right"),a=0,"online"==l.status?(a=t-(this.radius+3)-i,Math.abs(a)>s.origin.y&&(a=-s.origin.y,t=-(s.origin.y-(this.radius+3)-i))):0<(a=t+(this.radius+3))+i&&(a=-i,t=-(this.radius+3)-i),n.context.y=a,r=new d.default.Shapes.BrokenLine({context:{pointList:[[e,t],[e,u.y]],strokeStyle:l.style,lineWidth:l.lineWidth}}),l.sprite.addChild(r),o=new d.default.Shapes.Circle({context:{x:e,y:t,r:l.radius,fillStyle:l.fillStyle,strokeStyle:l.style,lineWidth:l.lineWidth}}),l.sprite.addChild(o))}},{key:"_getNodeY",value:function(t,e){var n=this.app.height,e=(e.height,t.y);return"online"==this.status?e-=Math.min(50,.3*(n-Math.abs(e))):e+=Math.min(50,.3*Math.abs(e)),e}}],[{key:"defaultProps",value:function(){return{lineField:{detail:"对应的line字段",default:null},style:{detail:"默认色",default:"#3995ff"},fillStyle:{detail:"节点填充色",default:"#ffffff"},lineWidth:{detail:"线宽",default:2},radius:{detail:"圆点半径",default:6},timeFontSize:{detail:"时间文本大小",default:14},timeFontColor:{detail:"时间文本颜色",default:"#606060"},listFontSize:{detail:"列表信息文本大小",default:12}}}}]),i}(n.default);n.default.registerComponent(i,"lineSchedu"),e.default=i})),markcloumn=(unwrapExports(lineschedu),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component),d=interopRequireDefault(Canvax);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=d.default._,f=d.default.event,p=d.default.Shapes.Line,g=d.default.Shapes.Circle,y=d.default.Display.Text,i=function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="markcloumn",c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.sprite=new d.default.Display.Sprite,e.app.graphsSprite.addChild(e.sprite),e._line=null,e._lineSp=new d.default.Display.Sprite,e.sprite.addChild(e._lineSp),e.nodes=[],e._nodes=new d.default.Display.Sprite,e.sprite.addChild(e._nodes),e._labels=new d.default.Display.Sprite,e.sprite.addChild(e._labels),e}return(0,r.default)(i,[{key:"draw",value:function(t){this.width=(t=t||{}).width,this.height=t.height,this.origin=t.origin,this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this._widget()}},{key:"reset",value:function(t){t&&c.extend(!0,this,t),this._widget()}},{key:"_widget",value:function(){var i,a,r,o=this,t=this.app.getComponent({name:"coord"})._xAxis;null!=this.xVal&&(i=t.getNodeInfoOfVal(this.xVal)),(i=null!=this.xPixel?t.getNodeInfoOfX(this.xPixel):i)&&(o.nodes=[],o.on("complete",function(){o._drawLine(i),o._drawNodes(i),o._drawLabels(i)}),a=0,r=this.app.getGraphs(),c.each(r,function(n){function t(){var t,e;a++,o.markTo&&-1==c.flatten([n.field]).indexOf(o.markTo)||(t=n.getNodesOfPos(i.x),o.markTo?(e=c.find(t,function(t){return t.field==o.markTo}))&&(o.nodes=[e]):o.nodes=o.nodes.concat(t)),a==r.length&&o.fire("complete")}n.inited?t():n.on("complete",function(){t()})}))}},{key:"_drawLine",value:function(t){var e,n=this;n.line.enabled&&(t=c.extend(!0,{x:parseInt(t.x),start:{x:0,y:0},end:{x:0,y:-n.height},lineWidth:1,strokeStyle:"#cccccc"},this.line),null!=n.line.endY&&(e=0,c.isNumber(n.line.endY)&&(e=n.line.endY),"auto"==n.line.endY&&c.each(n.nodes,function(t){e=Math.min(t.y,e)}),t.end.y=e),this._line?c.extend(this._line.context,t):(this._line=new p({context:t}),this._lineSp.addChild(this._line),this._line.on(f.types.get(),function(t){t.eventInfo={xAxis:{},nodes:n.nodes},null!=n.xVal&&(t.eventInfo.xAxis.value=n.xVal,t.eventInfo.xAxis.text=n.xVal+"",t.eventInfo.title=n.xVal+""),n.app.fire(t.type,t)})))}},{key:"_drawNodes",value:function(){var n=this;n.node.enabled&&(n._nodes.removeAllChildren(),c.each(n.nodes,function(e){var t=c.extend({x:e.x,y:e.y,cursor:"pointer",r:n.node.radius,lineWidth:n.node.lineWidth||e.lineWidth,strokeStyle:n.node.strokeStyle||e.color,fillStyle:n.node.fillStyle||e.fillStyle}),t=new g({context:t});t.nodeData=e,t.on(f.types.get(),function(t){t.eventInfo={xAxis:{},nodes:[e]},null!=n.xVal&&(t.eventInfo.xAxis.value=n.xVal,t.eventInfo.xAxis.text=n.xVal+"",t.eventInfo.title=n.xVal+""),n.app.fire(t.type,t)}),n._nodes.addChild(t)}))}},{key:"_drawLabels",value:function(){var i=this;i.node.enabled&&(i._labels.removeAllChildren(),c.each(i.nodes,function(t){var e={x:t.x,y:t.y-i.node.radius-2,fillStyle:i.label.fontColor||t.color,fontSize:i.label.fontSize,textAlign:"center",textBaseline:"bottom"},n=i.label.text;(n=c.isFunction(n)?n.apply(i,[t]):n)&&(t=new y(n,{context:e}),i._labels.addChild(t),t.localToGlobal().x+t.getTextWidth()/2>i.app.width&&(t.context.x=i.app.width-t.getTextWidth()/2-t.parent.localToGlobal().x))}))}}],[{key:"defaultProps",value:function(){return{xVal:{detail:"x的value值",default:null},xPixel:{detail:"x方向的具体像素值",default:null},markTo:{detail:"标准哪个目标字段，主要用作折线图",documentation:"如果设置了这个字段，那么line的起点将是这个graphs上的node节点",default:null},line:{detail:"线的配置",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"线宽",default:2},strokeStyle:{detail:"线的颜色",default:"#d5d5d5"},lineType:{detail:"线的样式，虚线(dashed)实线(solid)",default:"solid"},startY:{detail:"startY",default:0},endY:{detail:"startY",default:null}}},node:{detail:"数据图形节点",propertys:{enabled:{detail:"是否开启",default:!0},radius:{detail:"节点半径",default:5},fillStyle:{detail:"节点图形的背景色",default:"#ffffff"},strokeStyle:{detail:"节点图形的描边色，默认和line.strokeStyle保持一致",default:null},lineWidth:{detail:"节点图形边宽大小",default:2}}},label:{detail:"文本",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本字体颜色",default:null},fontSize:{detail:"文本字体大小",default:12},text:{detail:"文本内容",documentation:"可以是函数",default:null},format:{detail:"文本格式化函数",default:null}}}}}}]),i}(n.default);n.default.registerComponent(i,"markcloumn"),e.default=i})),vec2=(unwrapExports(markcloumn),createCommonjsModule(function(l){!function t(e,n,i){function a(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(t,e){if(!(this instanceof r))return new r(t,e);a(t)?(e=t[1],t=t[0]):"object"==typeof t&&t&&(e=t.y,t=t.x),this.x=r.clean(t||0),this.y=r.clean(e||0)}r.prototype={change:function(t){if("function"==typeof t)this.observers?this.observers.push(t):this.observers=[t];else if(this.observers&&this.observers.length)for(var e=this.observers.length-1;0<=e;e--)this.observers[e](this,t);return this},ignore:function(t){if(this.observers)if(t)for(var e=this.observers,n=e.length;n--;)e[n]===t&&e.splice(n,1);else this.observers=[];return this},set:function(t,e,n){if("number"!=typeof t&&(n=e,e=t.y,t=t.x),this.x===t&&this.y===e)return this;var i=null;return!1!==n&&this.observers&&this.observers.length&&(i=this.clone()),this.x=r.clean(t),this.y=r.clean(e),!1!==n?this.change(i):void 0},zero:function(){return this.set(0,0)},clone:function(){return new this.constructor(this.x,this.y)},negate:function(t){return t?new this.constructor(-this.x,-this.y):this.set(-this.x,-this.y)},add:function(t,e,n){return"number"!=typeof t&&(n=e,t=a(t)?(e=t[1],t[0]):(e=t.y,t.x)),t+=this.x,e+=this.y,n?new this.constructor(t,e):this.set(t,e)},subtract:function(t,e,n){return"number"!=typeof t&&(n=e,t=a(t)?(e=t[1],t[0]):(e=t.y,t.x)),t=this.x-t,e=this.y-e,n?new this.constructor(t,e):this.set(t,e)},multiply:function(t,e,n){return"number"!=typeof t?(n=e,t=a(t)?(e=t[1],t[0]):(e=t.y,t.x)):"number"!=typeof e&&(n=e,e=t),t*=this.x,e*=this.y,n?new this.constructor(t,e):this.set(t,e)},rotate:function(t,e,n){var i=this.x,a=this.y,r=Math.cos(t),t=Math.sin(t),o=r*i-(e=e?-1:1)*t*a,e=e*t*i+r*a;return n?new this.constructor(o,e):this.set(o,e)},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},lengthSquared:function(){var t=this.x,e=this.y;return t*t+e*e},distance:function(t){var e=this.x-t.x,t=this.y-t.y;return Math.sqrt(e*e+t*t)},nearest:function(t){for(var e,n=Number.MAX_VALUE,i=null,a=t.length-1;0<=a;a--)(e=this.distance(t[a]))<=n&&(n=e,i=t[a]);return i},normalize:function(t){var e=this.length(),e=e<Number.MIN_VALUE?0:1/e;return t?new this.constructor(this.x*e,this.y*e):this.set(this.x*e,this.y*e)},equal:function(t,e){return"number"!=typeof t&&(t=a(t)?(e=t[1],t[0]):(e=t.y,t.x)),r.clean(t)===this.x&&r.clean(e)===this.y},abs:function(t){var e=Math.abs(this.x),n=Math.abs(this.y);return t?new this.constructor(e,n):this.set(e,n)},min:function(t,e){var n=this.x,i=this.y,a=t.x,t=t.y,n=n<a?n:a,a=i<t?i:t;return e?new this.constructor(n,a):this.set(n,a)},max:function(t,e){var n=this.x,i=this.y,a=t.x,t=t.y,n=a<n?n:a,a=t<i?i:t;return e?new this.constructor(n,a):this.set(n,a)},clamp:function(t,e,n){e=this.min(e,!0).max(t);return n?e:this.set(e.x,e.y)},lerp:function(t,e,n){return this.add(t.subtract(this,!0).multiply(e),n)},skew:function(t){return t?new this.constructor(-this.y,this.x):this.set(-this.y,this.x)},dot:function(t){return r.clean(this.x*t.x+t.y*this.y)},perpDot:function(t){return r.clean(this.x*t.y-this.y*t.x)},angleTo:function(t){return Math.atan2(this.perpDot(t),this.dot(t))},divide:function(t,e,n){if("number"!=typeof t?(n=e,t=a(t)?(e=t[1],t[0]):(e=t.y,t.x)):"number"!=typeof e&&(n=e,e=t),0===t||0===e)throw new Error("division by zero");if(isNaN(t)||isNaN(e))throw new Error("NaN detected");return n?new this.constructor(this.x/t,this.y/e):this.set(this.x/t,this.y/e)},isPointOnLine:function(t,e){return(t.y-this.y)*(t.x-e.x)==(t.y-e.y)*(t.x-this.x)},toArray:function(){return[this.x,this.y]},fromArray:function(t){return this.set(t[0],t[1])},toJSON:function(){return{x:this.x,y:this.y}},toString:function(){return"("+this.x+", "+this.y+")"},constructor:r},r.fromArray=function(t,e){return new(e||r)(t[0],t[1])},r.precision=n||8;var o=Math.pow(10,r.precision);return r.clean=e||function(t){if(isNaN(t))throw new Error("NaN detected");if(isFinite(t))return Math.round(t)===t?t:Math.round(t*o)/o;throw new Error("Infinity detected")},r.inject=t,e||(r.fast=t(function(t){return t}),l.exports=r),r}()})),intersect=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.lineLine=l,e.lineRect=function(t,e,n){var i=new o.default(n.x,n.y),a=new o.default(n.x,n.yMax),r=new o.default(n.xMax,n.yMax),n=new o.default(n.xMax,n.y);return!!l(t,e,i,a)||(!!l(t,e,a,r)||(!!l(t,e,r,n)||!!l(t,e,n,i)))};var o=interopRequireDefault(vec2);function l(t,e,n,i){var a=(i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x),r=(e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x),i=(i.y-n.y)*(e.x-t.x)-(i.x-n.x)*(e.y-t.y);if(0!=i){n=a/i,e=r/i;if(0<=n&&n<=1&&0<=e&&e<=1)return!0}return!1}}),intersect_1$1=(unwrapExports(intersect),intersect.lineLine),intersect_2=intersect.lineRect,relation_backline=createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component),d=interopRequireDefault(Canvax);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=d.default._,f=d.default.event,p=d.default.Shapes.BrokenLine,g=d.default.Shapes.Arrow,y=d.default.Display.Text,_=d.default.Shapes.Circle,i=function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="relation_backline",c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.pointList=null,e.sprite=new d.default.Display.Sprite,e._line=null,e._arrow=null,e._label=null,e._icon=null,e}return(0,r.default)(i,[{key:"draw",value:function(t){this.width=(t=t||{}).width,this.height=t.height,this.origin=t.origin,this._widget()}},{key:"reset",value:function(t){t&&c.extend(!0,this,t),this._widget()}},{key:"_widget",value:function(){var t,e=this,n=this.app.getGraphs();n.length&&(t=n[0]).on("complete",function(){e._setPoints(t),e._drawLine(),e._drawArrow(),e._drawIcon(),t.graphsSp.addChild(e.sprite)})}},{key:"_setPoints",value:function(e){var n,t,r,o,i,a,l,s,u,d,h,c,f;this.line.pointList?this.pointList=this.line.pointList:(n=this.key,f={x:(f=e.data.nodes.find(function(t){return t.key==n.split(",")[0]})).x-f.width/2,y:f.y-f.height/2,width:f.width,height:f.height},s={x:(s=e.data.nodes.find(function(t){return t.key==n.split(",")[1]})).x-s.width/2,y:s.y-s.height/2,width:s.width,height:s.height},t=[f.x+f.width,f.y+f.height/2],r=[f.x+f.width+20,f.y+f.height/2],c=[o=s.x+s.width/2,s.y],i=[o,s.y+s.height],a=c,l=function(t){var i=r[1]+t,a=0;return e.data.nodes.forEach(function(t){var e=t.x-t.width/2,n=t.y-t.height/2,e={x:e,y:n,xMax:e+t.width,yMax:n+t.height};(0,intersect.lineRect)({x:r[0],y:i},{x:o,y:i},e)&&a++}),a},d=[],null==this.line.dissY?(u=-(r[1]-(Math.min(s.y,f.y)-6)),d.push({dissY:u,throughNodesNum:l(u),endPoint:c,type:"n"}),20<s.y-(f.y+f.height)&&(u=f.y+f.height+(s.y-(f.y+f.height))/2-r[1],d.push({dissY:u,throughNodesNum:l(u),endPoint:c,type:"down_z"})),s=i[1],u=Math.max(s,f.y+f.height)+6-r[1],d.push({dissY:u,throughNodesNum:l(u),endPoint:i,type:"u"}),20<f.y-s&&(u=s+(f.y-s)/2-r[1],d.push({dissY:u,throughNodesNum:l(u),endPoint:i,type:"up_z"})),d=d.sort(function(t,e){return t.throughNodesNum-e.throughNodesNum}),h=[],d.forEach(function(t){t.throughNodesNum==d[0].throughNodesNum&&h.push(t)}),u=(h=h.sort(function(t,e){return Math.abs(t.dissY)-Math.abs(e.dissY)}))[0].dissY,a=h[0].endPoint):u=this.line.dissY,c=[r[0],r[1]+u],f=[a[0],r[1]+u],this.pointList=[t,r,c,f,a])}},{key:"_drawLine",value:function(){var t;this.line.enabled&&(t={pointList:this.pointList,lineWidth:this.line.lineWidth,strokeStyle:this.line.strokeStyle,lineType:this.line.lineType},this._line?c.extend(this._line.context,t):(this._line=new p({context:t}),this.sprite.addChild(this._line)))}},{key:"_drawArrow",value:function(){var t=this.pointList,e=2,n=t[t.length-1],t=t[t.length-2],i=(t[1]<n[1]&&(e=-2),this.line.strokeStyle),e={y:e,control:{x:t[0],y:t[1]},point:{x:n[0],y:n[1]},strokeStyle:i,fillStyle:i};this._arrow?c.extend(!0,this._arrow.context,e):(this._arrow=new g({context:e}),this.sprite.addChild(this._arrow))}},{key:"_drawIcon",value:function(){var t,e,n,i,a,r,o,l,s,u,d,h=this;this.icon.enabled&&(e=this._getProp(this.icon.charCode,this),t=String.fromCharCode(parseInt(e,16)),""!=e&&(e=this.pointList[1],n=this._getProp(this.icon.lineWidth,this),i=this._getProp(this.icon.strokeStyle,this),a=this._getProp(this.icon.fontFamily,this),r=this._getProp(this.icon.fontSize,this),o=this._getProp(this.icon.fontColor,this),l=this._getProp(this.icon.background,this),u=this._getProp(this.icon.offset,this),d=this._getProp(this.icon.offsetX,this),s=this._getProp(this.icon.offsetY,this),d={x:(u=u||{x:e[0]+d,y:e[1]+s}).x,y:u.y-1,r:parseInt(.5*r)+2,fillStyle:l,strokeStyle:i,lineWidth:n},this._iconBack?Object.assign(this._iconBack.context,d):(this._iconBack=new _({context:d}),this.sprite.addChild(this._iconBack)),this._icon?(this._icon.resetText(t),this._icon.context.x=u.x,this._icon.context.y=u.y,this._icon.context.fontSize=r,this._icon.context.fillStyle=o,this._icon.context.textAlign="center",this._icon.context.textBaseline="middle",this._icon.context.fontFamily=a,this._icon.context.lineWidth=n,this._icon.context.strokeStyle=i):(this._icon=new y(t,{context:{x:u.x,y:u.y,fillStyle:o,cursor:"pointer",fontSize:r,textAlign:"center",textBaseline:"middle",fontFamily:a,lineWidth:n,strokeStyle:i}}),this._icon.on(f.types.get(),function(t){var e=h.line;h.icon["on"+t.type]&&(e=h.icon),t.eventInfo={trigger:e,nodes:[{name:h.key}]},h.app.fire(t.type,t)}),h.sprite.addChild(this._icon))))}},{key:"_getProp",value:function(t,e){var n=t;return n=c.isFunction(t)?t.apply(this,[e]):n}}],[{key:"defaultProps",value:function(){return{key:{detail:"和relation的line保持一致，用逗号分割",default:null},line:{detail:"线的配置",propertys:{enabled:{detail:"是否开启",default:!0},pointList:{detail:"回链线的points",default:null},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线的颜色",default:"#e5e5e5"},lineType:{detail:"线的样式，虚线(dashed)实线(solid)",default:"solid"},dissY:{detail:"拐点和起始节点的距离",default:null}}},icon:{detail:"line上面的icon",propertys:{enabled:{detail:"是否开启线上的icon设置",default:!0},charCode:{detail:"iconfont上面对应的unicode中&#x后面的字符",default:null},lineWidth:{detail:"icon描边线宽",default:1},strokeStyle:{detail:"icon的描边颜色",default:"#e5e5e5"},fontColor:{detail:"icon的颜色",default:"#e5e5e5"},fontFamily:{detail:"font-face的font-family设置",default:"iconfont"},fontSize:{detail:"icon的字体大小",default:14},offset:{detail:"icon的位置，函数，参数是整个edge对象",default:null},offsetX:{detail:"在计算出offset后的X再次便宜量",default:1},offsetY:{detail:"在计算出offset后的Y再次便宜量",default:2},background:{detail:"icon的背景颜色，背景为圆形",default:"#fff"}}}}}}]),i}(n.default);n.default.registerComponent(i,"relation_backline"),e.default=i}),title=(unwrapExports(relation_backline),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component),d=interopRequireDefault(Canvax);interopRequireDefault(trigger);function h(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var c=d.default._,i=(d.default.event,function(t){(0,l.default)(i,t);var n=h(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="title",c.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.sprite=new d.default.Display.Sprite({id:"titleSprite",context:{}}),e.app.stage.addChild(e.sprite),e.widget(),e.layout(),e}return(0,r.default)(i,[{key:"widget",value:function(){if(this.text){var t,e=this._getProp(this.textStyle)||{},n=new d.default.Display.Text(this.text,{id:"title_txt",context:{x:this.margin.left,y:this.margin.top,fillStyle:e.fontColor||this.text.fontColor,fontSize:this.text.fontSize,textAlign:"left",textBaseline:"bottom"}});for(t in e)t in n.context&&(n.context[t]=e[t]);this.sprite.addChild(n),this.width+=n.getTextWidth()+6,this.height+=n.getTextHeight(),n.context.y=this.height}if(this.desc){var i,a=this._getProp(this.descStyle)||{},r=new d.default.Display.Text(this.desc,{id:"title_txt",context:{x:this.width+this.margin.left,y:this.height,fillStyle:a.fontColor||this.text.fontColor,fontSize:this.text.fontSize,textAlign:"left",textBaseline:"bottom"}});for(i in a)i in r.context&&(r.context[i]=a[i]);this.sprite.addChild(r),this.width+=r.getTextWidth(),this.height=Math.max(r.getTextHeight(),this.height),r.context.y=this.height}}},{key:"layout",value:function(){var t=this.app,e=this.height+this.margin.top+this.margin.bottom,n=t.padding.left,i=t.padding.top;return"top-left"==this.position&&(n=t.padding.left),"top-right"==this.position&&(n=t.width-t.padding.right-this.margin.right-this.width),t.padding.top+=e,this.pos={x:n,y:i},this.pos}},{key:"draw",value:function(){var t=this.app.getComponent({name:"coord"});t&&"rect"==t.type&&"top-right"!=this.position&&(this.pos.x=t.getSizeAndOrigin().origin.x),this.setPosition()}},{key:"_getProp",value:function(t,e){var n=t;return c.isArray(t)&&(n=t[e.ind]),n=c.isFunction(t)?t.apply(this,[e]):n}}],[{key:"defaultProps",value:function(){return{position:{detail:"图例位置",documentation:"默认top-left,可选top-right",default:"top-left"},text:{detail:"标题内容",default:""},textStyle:{detail:"主标题样式",propertys:{fontColor:{detail:"字体颜色",default:"#666"},fontSize:{detail:"字体大小",default:"14"},style:{detail:"样式集合",default:null}}},desc:{detail:"描述内容",default:""},descStyle:{detail:"描述的样式",propertys:{fontColor:{detail:"字体颜色",default:"#999"},fontSize:{detail:"字体大小",default:"12"},style:{detail:"样式集合",default:null}}},margin:{propertys:{bottom:{default:10}}}}}}]),i}(n.default));n.default.registerComponent(i,"title"),e.default=i})),linemarkpoint=(unwrapExports(title),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=interopRequireDefault(classCallCheck$1),r=interopRequireDefault(createClass$1),o=interopRequireDefault(assertThisInitialized$1),l=interopRequireDefault(inherits$1),s=interopRequireDefault(possibleConstructorReturn$1),u=interopRequireDefault(getPrototypeOf$1),n=interopRequireDefault(component),c=interopRequireDefault(Canvax);function d(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=(0,u.default)(n);return t=i?(t=(0,u.default)(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),(0,s.default)(this,t)}}var h=c.default._,f=c.default.Shapes.Rect,i=function(t){(0,l.default)(i,t);var n=d(i);function i(t,e){return(0,a.default)(this,i),(e=n.call(this,t,e)).name="lineMarkPoint",h.extend(!0,(0,o.default)(e),(0,tools.getDefaultProps)(i.defaultProps()),t),e.lineDatas=null,e.sprite=new c.default.Display.Sprite,e.app.graphsSprite.addChild(e.sprite),e}return(0,r.default)(i,[{key:"reset",value:function(t){h.extend(!0,this,t),this.lineDatas=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var t,e,n,i,a,r,o,l,s,u=this,d=this.app.getComponent({name:"coord"}),h=(this.pos={x:d.origin.x,y:d.origin.y},this.setPosition(),u.app.getComponent({name:"graphs",type:"line",field:u.lineField})),h=(u.lineDatas=h.data[u.lineField].data,this.app.getComponent({name:"coord"}).getAxis({type:"xAxis"}).getIndexOfVal(this.xValue));-1!=h&&(t=this.lineDatas[h],e=h?this.lineDatas[h-1]:null,h=h==u.lineDatas.length?null:this.lineDatas[h+1],null!=t.y&&(r=t.x,n=new c.default.Display.Sprite({context:{x:r}}),this.sprite.addChild(n),i=0,o=new c.default.Display.Text(u.label.text,{context:{fillStyle:this.label.fontColor,fontSize:this.label.fontSize,textAlign:"center",textBaseline:"top"}}),n.addChild(o),i=o.getTextHeight(),s=o.getTextWidth(),a=0,this.label.background.enabled&&(i+=2*(a=this.label.background.padding),s+=2*a,n.context.x-=a,o.context.x+=a,o.context.y+=a,l=u.label.background.radius,l=new f({context:{x:-s/2+a,width:s,height:i,radius:[l,l,l,l],fillStyle:u.label.background.fillStyle,strokeStyle:u.label.background.strokeStyle,lineWidth:u.label.background.lineWidth}}),n.addChild(l,0)),s/2+r>d.width&&(n.context.x=d.width,o.context.textAlign="right",l&&(l.context.x-=s/2-a)),r-s/2<0&&(n.context.x=0,o.context.textAlign="left",l&&(l.context.x+=s/2-a)),o=(r=u._getNodeYandLinePointList(t,e,h,d,i)).y,l=r.pointList,n.context.y=o,u.line.enabled&&(s=new c.default.Shapes.BrokenLine({context:{pointList:l,strokeStyle:u.line.strokeStyle,lineWidth:u.line.lineWidth}}),u.sprite.addChild(s,0))))}},{key:"_getNodeYandLinePointList",value:function(t,e,n,i,a){this.app.height;var i=i.height,r=t.y,o=this.line.enabled?this.line.lineLength:3,l=this.line.lineDis,s="online",e=("auto"==this.position?"offline"==(s="online"==(s=e&&e.y<t.y||n&&n.y<t.y?"offline":s)&&Math.abs(r)+o+l+a>i?"offline":s)&&Math.abs(r)<o+a+l&&(s="online"):s=this.position,0),e="online"==s?r-o-l-a:r+l+o,n=[[t.x,e],[t.x,t.y+l]];return{y:e,pointList:n="online"==s?[[t.x,e+a],[t.x,t.y-l]]:n}}}],[{key:"defaultProps",value:function(){return{lineField:{detail:"对应的line字段",default:null},xValue:{detail:"在lineFile字段的折线上对应点的x轴的值",default:null},line:{detail:"line的配置",propertys:{enabled:{detail:"是否要指示线",default:!0},lineWidth:{detail:"线宽",default:2},strokeStyle:{detail:"线颜色",default:"#ccc"},lineLength:{detail:"线的长度，也就是label到line的距离",default:8},lineDis:{detail:"line到折线上面node的距离",default:3}}},label:{detail:"markpoint标注的文本配置",propertys:{text:{detail:"label内容",default:""},fontSize:{detail:"label的文本大小",default:12},fontColor:{detail:"文本颜色",default:"#666"},background:{detail:"label的background配置",propertys:{enabled:{detail:"label是否需要背景",default:!0},fillStyle:{detail:"label的背景颜色",default:"#f5f5f6"},radius:{detail:"label的背景圆角",default:6},strokeStyle:{detail:"label的背景边框颜色",default:"#f5f5f6"},lineWidth:{detail:"背景描边",default:1},padding:{detail:"background和label之间的距离",default:6}}}}},position:{detail:"在线的方向，online（线上边） or offline（线下方），默认自动计算",default:"auto"}}}}]),i}(n.default);n.default.registerComponent(i,"lineMarkPoint"),e.default=i})),dist=(unwrapExports(linemarkpoint),createCommonjsModule(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=interopRequireDefault(global$1),a=[],r=(a.length&&i.default.setGlobalTheme(a),{version:"1.1.153",options:{}});for(n in i.default)r[n]=i.default[n];e.default=r})),index$3=unwrapExports(dist);module.exports=index$3;
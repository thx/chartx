"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e){return t(e={exports:{}},e.exports),e.exports}var i=n((function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.__esModule=!0,t.exports.default=t.exports}));function a(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e){return t(e={exports:{}},e.exports),e.exports}e(i);var o=a(r((function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0}))),l=a(r((function(t){function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t},t.exports.default=t.exports,t.exports.__esModule=!0}))),s=r((function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.default=t.exports,t.exports.__esModule=!0})),u=a(s),d=r((function(t){function e(n,i){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.default=t.exports,t.exports.__esModule=!0,e(n,i)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0}));a(d);var h,f=a(r((function(t){t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)},t.exports.default=t.exports,t.exports.__esModule=!0}))),c=r((function(t){function e(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0})),p=a(c),g=r((function(t){var e=c.default;t.exports=function(t,n){return!n||"object"!==e(n)&&"function"!=typeof n?s(t):n},t.exports.default=t.exports,t.exports.__esModule=!0})),y=a(g),v=r((function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.default=t.exports,t.exports.__esModule=!0,e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0})),x=a(v),_={},m={},b=Array.prototype,w=Object.prototype,k=b.push,S=b.slice,A=b.concat,P=w.toString,C=w.hasOwnProperty,D=b.forEach,O=b.map,T=b.filter,M=b.every,E=b.some,R=b.indexOf,I=Array.isArray,L=Object.keys,F=Math.pow(2,53)-1,N=(h="length",function(t){return null==t?void 0:t[h]}),B=function(t){var e=N(t);return"number"==typeof e&&e>=0&&e<=F};_.values=function(t){for(var e=_.keys(t),n=e.length,i=new Array(n),a=0;a<n;a++)i[a]=t[e[a]];return i},_.keys=L||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)_.has(t,n)&&e.push(n);return e},_.has=function(t,e){return C.call(t,e)};var j=_.each=_.forEach=function(t,e,n){if(null!=t)if(D&&t.forEach===D)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,a=t.length;i<a;i++)if(e.call(n,t[i],i,t)===m)return}else{var r=_.keys(t);for(i=0,a=r.length;i<a;i++)if(e.call(n,t[r[i]],r[i],t)===m)return}};_.compact=function(t){return _.filter(t,_.identity)},_.filter=_.select=function(t,e,n){var i=[];return null==t?i:T&&t.filter===T?t.filter(e,n):(j(t,(function(t,a,r){e.call(n,t,a,r)&&i.push(t)})),i)},j(["Arguments","Function","String","Number","Date","RegExp"],(function(t){_["is"+t]=function(e){return P.call(e)=="[object "+t+"]"}})),_.isArguments=function(t){return!(!t||!_.has(t,"callee"))},"function"!=typeof/./&&(_.isFunction=function(t){return"function"==typeof t}),_.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&t!=+t},_.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==P.call(t)},_.isNull=function(t){return null===t},_.isEmpty=function(t){if(null==t)return!0;if(_.isArray(t)||_.isString(t))return 0===t.length;for(var e in t)if(_.has(t,e))return!1;return!0},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=I||function(t){return"[object Array]"==P.call(t)},_.isObject=function(t){return t===Object(t)},_.identity=function(t){return t},_.indexOf=function(t,e,n){if(null==t)return-1;var i=0,a=t.length;if(n){if("number"!=typeof n)return t[i=_.sortedIndex(t,e)]===e?i:-1;i=n<0?Math.max(0,a+n):n}if(R&&t.indexOf===R)return t.indexOf(e,n);for(;i<a;i++)if(t[i]===e)return i;return-1},_.isWindow=function(t){return null!=t&&t==t.window};var z=function t(e,n,i){return n&&_.every(e,_.isArray)?A.apply(i,e):(j(e,(function(e){_.isArray(e)||_.isArguments(e)?n?k.apply(i,e):t(e,n,i):i.push(e)})),i)};_.flatten=function(t,e){return z(t,e,[])},_.every=_.all=function(t,e,n){e||(e=_.identity);var i=!0;return null==t?i:M&&t.every===M?t.every(e,n):(j(t,(function(t,a,r){if(!(i=i&&e.call(n,t,a,r)))return m})),!!i)},_.min=function(t,e,n){if(!e&&_.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&_.isEmpty(t))return 1/0;var i={computed:1/0,value:1/0};return j(t,(function(t,a,r){var o=e?e.call(n,t,a,r):t;o<i.computed&&(i={value:t,computed:o})})),i.value},_.max=function(t,e,n){if(!e&&_.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&_.isEmpty(t))return-1/0;var i={computed:-1/0,value:-1/0};return j(t,(function(t,a,r){var o=e?e.call(n,t,a,r):t;o>i.computed&&(i={value:t,computed:o})})),i.value},_.find=_.detect=function(t,e,n){var i;return W(t,(function(t,a,r){if(e.call(n,t,a,r))return i=t,!0})),i};var W=_.some=_.any=function(t,e,n){e||(e=_.identity);var i=!1;return null==t?i:E&&t.some===E?t.some(e,n):(j(t,(function(t,a,r){if(i||(i=e.call(n,t,a,r)))return m})),!!i)};_.without=function(t){return _.difference(t,S.call(arguments,1))},_.difference=function(t){var e=A.apply(b,S.call(arguments,1));return _.filter(t,(function(t){return!_.contains(e,t)}))},_.uniq=_.unique=function(t,e,n,i){_.isFunction(e)&&(i=n,n=e,e=!1);var a=n?_.map(t,n,i):t,r=[],o=[];return j(a,(function(n,i){(e?i&&o[o.length-1]===n:_.contains(o,n))||(o.push(n),r.push(t[i]))})),r},_.map=_.collect=function(t,e,n){var i=[];return null==t?i:O&&t.map===O?t.map(e,n):(j(t,(function(t,a,r){i.push(e.call(n,t,a,r))})),i)},_.contains=_.include=function(t,e){return null!=t&&(R&&t.indexOf===R?-1!=t.indexOf(e):W(t,(function(t){return t===e})))},_.pluck=function(t,e){return _.map(t,(function(t){return t[e]}))},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.shuffle=function(t){return _.sample(t,1/0)},_.sample=function(t,e,n){if(null==e||n)return B(t)||(t=_.values(t)),t[_.random(t.length-1)];var i=B(t)?_.clone(t):_.values(t),a=N(i);e=Math.max(Math.min(e,a),0);for(var r=a-1,o=0;o<e;o++){var l=_.random(o,r),s=i[o];i[o]=i[l],i[l]=s}return i.slice(0,e)},_.extend=function(){var t,e,n,i,a=arguments[0]||{},r=1,o=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[1]||{},r=2),"object"===p(a)||_.isFunction(a)||(a={}),o===r&&(a=this,--r);r<o;r++)if(null!=(t=arguments[r]))for(e in t)n=a[e],a!==(i=t[e])&&void 0!==i&&(l&&i&&_.isObject(i)&&i.constructor===Object?a[e]=_.extend(l,n,i):a[e]=i);return a},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend(!0,{},t):t},_.euclideanModulo=function(t,e){return(t%e+e)%e},_.DEG2RAD=Math.PI/180,_.RAD2DEG=180/Math.PI,_.degToRad=function(t){return t*_.DEG2RAD},_.radToDeg=function(t){return t*_.RAD2DEG};var V={RESOLUTION:1,TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,FILTER_RESOLUTION:1,SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@(.+)x/,RENDER_OPTIONS:{view:null,antialias:!0,forceFXAA:!1,autoResize:!1,transparent:!0,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION:"mediump"},G=function(t,e){if(document){if(document[t]){return function e(n,i,a){if(n.length)for(var r=0;r<n.length;r++)e(n[r],i,a);else n[t](i,a,!1)}}return function t(n,i,a){if(n.length)for(var r=0;r<n.length;r++)t(n[r],i,a);else n[e]("on"+i,(function(){return a.call(n,window.event)}))}}},H={query:function(t){if(t)return _.isString(t)?document.getElementById(t):1==t.nodeType?t:t.length?t[0]:null},offset:function(t){if(!t)return{top:0,left:0};var e=t.getBoundingClientRect(),n=t.ownerDocument,i=n.body,a=n.documentElement,r=a.clientTop||i.clientTop||0,o=a.clientLeft||i.clientLeft||0,l=1;if(i.getBoundingClientRect){var s=i.getBoundingClientRect();l=(s.right-s.left)/i.clientWidth}return l>1&&(r=0,o=0),{top:e.top/l+(window.pageYOffset||a&&a.scrollTop/l||i.scrollTop/l)-r,left:e.left/l+(window.pageXOffset||a&&a.scrollLeft/l||i.scrollLeft/l)-o}},addEvent:G("addEventListener","attachEvent"),removeEvent:G("removeEventListener","detachEvent"),pageX:function(t){return t.pageX?t.pageX:t.clientX?t.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):null},pageY:function(t){return t.pageY?t.pageY:t.clientY?t.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):null},createCanvas:function(t,e,n){if(document){var i=document.createElement("canvas");return i.style.position="absolute",i.style.width=t+"px",i.style.height=e+"px",i.style.left=0,i.style.top=0,i.setAttribute("width",t*V.RESOLUTION),i.setAttribute("height",e*V.RESOLUTION),i.setAttribute("id",n),i}},createView:function(t,e,n){var i=document.createElement("div");i.className="canvax-view",i.style.cssText+="position:relative;width:100%;height:100%;";var a=document.createElement("div");a.style.cssText+="position:absolute;width:"+t+"px;height:"+e+"px;";var r=document.createElement("div");return r.style.cssText+="position:absolute;width:"+t+"px;height:"+e+"px;",i.appendChild(a),i.appendChild(r),{view:i,stageView:a,domView:r}}},Y={mainFrameRate:60,now:0,_pixelCtx:null,__emptyFunc:function(){},_UID:0,getUID:function(){return this._UID++},createId:function(t){var e=t.charCodeAt(t.length-1);return e>=48&&e<=57&&(t+="_"),t+Y.getUID()},canvasSupport:function(){return!!document.createElement("canvas").getContext},initElement:function(t){if(window)return window.FlashCanvas&&FlashCanvas.initElement&&FlashCanvas.initElement(t),t},getCssOrderArr:function(t){var e,n,i,a;return"number"==typeof t?e=n=i=a=t:t instanceof Array?1===t.length?e=n=i=a=t[0]:2===t.length?(e=i=t[0],n=a=t[1]):3===t.length?(e=t[0],n=a=t[1],i=t[2]):(e=t[0],n=t[1],i=t[2],a=t[3]):e=n=i=a=0,[e,n,i,a]},isWebGLSupported:function(){var t={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);return!(!n||!n.getContextAttributes().stencil)}catch(t){return!1}},checkOpt:function(t){return t?t.context||(t.context={}):t={context:{}},t}},X=Y.initElement(H.createCanvas(1,1,"_pixelCanvas"));Y._pixelCtx=X&&X.getContext("2d");var U=function(t){var e="CanvaxEvent";_.isString(t)&&(e=t),_.isObject(t)&&t.type&&(e=t.type,_.extend(this,t)),this.target=null,this.currentTarget=null,this.type=e,this.point=null;var n=this;this._stopPropagation=!1,this.stopPropagation=function(){n._stopPropagation=!0,_.isObject(t)&&(t._stopPropagation=!0)},this._preventDefault=!1,this.preventDefault=function(){n._preventDefault=!0,_.isObject(t)&&(t._preventDefault=!0)}},q="mousedown mouseup mouseover mousemove mouseout click dblclick wheel keydown keypress keyup",$={_types:q.split(/,| /),register:function(t){t&&(_.isString(t)&&(t=t.split(/,| /)),this._types=q.split(/,| /).concat(t))},get:function(){return this._types}},J=function(){this._eventMap={}};function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}J.prototype={_setEventEnable:function(){if(!this.children){var t=!1;for(var e in this._eventMap)_.indexOf($.get(),e)>-1&&(t=!0);this._eventEnabled=t}},_addEventListener:function(t,e){if("function"!=typeof e)return!1;var n=!0,i=this,a=t;return _.isString(t)&&(a=t.split(/,| /)),_.each(a,(function(t){var a=i._eventMap[t];return a?-1==_.indexOf(a,e)?(a.push(e),i._setEventEnable(),!0):void(n=!1):((a=i._eventMap[t]=[]).push(e),i._setEventEnable(),!0)})),n},_removeEventListener:function(t,e){if(1==arguments.length)return this.removeEventListenerByType(t);var n=this._eventMap[t];if(!n)return!1;for(var i=0;i<n.length;i++){if(n[i]===e)return n.splice(i,1),0==n.length&&(delete this._eventMap[t],this._setEventEnable()),!0}return!1},_removeEventListenerByType:function(t){return!this._eventMap[t]&&(delete this._eventMap[t],this._setEventEnable(),!0)},_removeAllEventListeners:function(){this._eventMap={},this._eventEnabled=!1},_dispatchEvent:function(t){var e=this._eventMap[t.type];if(e){t.target||(t.target=this),t.currentTarget||(t.currentTarget=this),e=e.slice();for(var n=0;n<e.length;n++){var i=e[n];"function"==typeof i&&i.call(this,t)}}return t._stopPropagation||this.parent&&(t.currentTarget=this.parent,this.parent._dispatchEvent(t)),!0},_hasEventListener:function(t){var e=this._eventMap[t];return null!=e&&e.length>0}};var Q=function(t){f(n,J);var e=Z(n);function n(){return o(this,n),e.call(this)}return l(n,[{key:"on",value:function(t,e){return this._addEventListener(t,e),this}},{key:"addEventListener",value:function(t,e){return this._addEventListener(t,e),this}},{key:"un",value:function(t,e){return this._removeEventListener(t,e),this}},{key:"removeEventListener",value:function(t,e){return this._removeEventListener(t,e),this}},{key:"removeEventListenerByType",value:function(t){return this._removeEventListenerByType(t),this}},{key:"removeAllEventListeners",value:function(){return this._removeAllEventListeners(),this}},{key:"fire",value:function(t,e){var n=new U(t);if(e)for(var i in e)"type"!=i&&(n[i]=e[i]);var a=this;return _.each(t.split(" "),(function(t){n.currentTarget=a,a.dispatchEvent(n)})),this}},{key:"dispatchEvent",value:function(t){if(this.children&&t.point){var e=this.getObjectsUnderPoint(t.point,1)[0];e&&e.dispatchEvent(t)}else{if(!this.context||"mouseover"!=t.type){if(this._dispatchEvent(t),this.context&&"mouseout"==t.type&&this._hoverClass&&this.hoverClone){a=this.getStage().parent;this._hoverClass=!1,a._bufferStage.removeChildById(this.id),this._globalAlpha&&(this.context.globalAlpha=this._globalAlpha,delete this._globalAlpha)}return this}var n=this._heartBeatNum,i=this.context.$model.globalAlpha;if(this._dispatchEvent(t),n!=this._heartBeatNum&&(this._hoverClass=!0,this.hoverClone)){var a=this.getStage().parent,r=this.clone(!0);r._transform=this.getConcatenatedMatrix(),a._bufferStage.addChildAt(r,0),this._globalAlpha=i,this.context.globalAlpha=0}}}},{key:"hasEvent",value:function(t){return this._hasEventListener(t)}},{key:"hasEventListener",value:function(t){return this._hasEventListener(t)}},{key:"hover",value:function(t,e){return this.on("mouseover",t),this.on("mouseout",e),this}},{key:"once",value:function(t,e){var n=this;return this.on(t,(function i(){e.apply(n,arguments),this.un(t,i)})),this}}]),n}(),K=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.canvax=t,this.curPoints=[{x:0,y:0}],this.curPointsTarget=[],this._touching=!1,this._draging=!1,this._cursor="default",this.target=this.canvax.view,this.drag={start:"panstart",move:"panmove",end:"panend"},this._opt=e,_.extend(!0,this,e)},tt=document&&document.compareDocumentPosition?function(t,e){return!!e&&!!(16&t.compareDocumentPosition(e))}:function(t,e){return!!e&&(e!=e&&(!t.contains||t.contains(e)))};K.prototype={init:function(){var t=this;this._opt.events&&$.register(this._opt.events),t.target&&(t.target.nodeType,H.addEvent(t.target,"contextmenu",(function(t){t&&t.preventDefault?t.preventDefault():window.event.returnValue=!1})),_.each($.get(),(function(e){1==t.target.nodeType?H.addEvent(t.target,e,(function(e){t.__mouseHandler(e)})):t.target.on(e,(function(e){t.__libHandler(e)}))})))},bindEventHandle:function(t,e){"mouse"==e?this.__mouseHandler.apply(this,[t]):this.__libHandler.apply(this,[t])},__mouseHandler:function(t){var e=this,n=e.canvax;n.updateViewOffset(),e.curPoints=[{x:H.pageX(t)-n.viewOffset.left,y:H.pageY(t)-n.viewOffset.top}];var i=e.curPoints[0],a=e.curPointsTarget[0];if(_.indexOf(["mousedown","mouseover","click"],t.type)>-1&&!a){if(!a){var r=n.getObjectsUnderPoint(i,1)[0];r&&(e.curPointsTarget=[r])}a=e.curPointsTarget[0]}if("mousedown"==t.type&&a&&a.dragEnabled&&(e._touching=!0),("mouseup"==t.type||"mouseout"==t.type&&!tt(n.view,t.toElement||t.relatedTarget))&&(1==e._draging&&(e._dragEnd(t,a,0),a.fire("dragend")),e._draging=!1,e._touching=!1),"mouseout"==t.type)tt(n.view,t.toElement||t.relatedTarget)||e.__getcurPointsTarget(t,i,!0);else if("mousemove"==t.type)if(e._touching&&"mousemove"==t.type&&a){if(e._draging)e._dragIngHander(t,a,0);else a.fire("dragstart"),a._globalAlpha||(a._globalAlpha=a.context.$model.globalAlpha),a.context.globalAlpha=0,e._clone2hoverStage(a,0).context.globalAlpha=a._globalAlpha;e._draging=!0}else e.__getcurPointsTarget(t,i);else{var o=a;o||(o=n),e.__dispatchEventInChilds(t,[o]),e._cursorHander(o)}(n.preventDefault||t._preventDefault)&&(t&&t.preventDefault?t.preventDefault():window.event.returnValue=!1)},__getcurPointsTarget:function(t,e,n){var i=this,a=i.canvax,r=i.curPointsTarget[0];if(r&&!r.context&&(r=null),"mousemove"==(t=new U(t)).type&&r&&r._hoverClass&&r.hoverClone&&r.pointChkPriority&&r.getChildInPoint(e))return t.target=t.currentTarget=r,t.point=r.globalToLocal(e),void r.dispatchEvent(t);var o=n?null:a.getObjectsUnderPoint(e,1)[0];(r&&r!=o||"mouseout"==t.type)&&r&&r.context&&(i.curPointsTarget[0]=null,t.type="mouseout",t.toTarget=o,t.target=t.currentTarget=r,t.point=r.globalToLocal(e),r.dispatchEvent(t)),o&&r!=o&&(i.curPointsTarget[0]=o,t.type="mouseover",t.fromTarget=r,t.target=t.currentTarget=o,t.point=o.globalToLocal(e),o.dispatchEvent(t)),"mousemove"==t.type&&o&&(t.target=t.currentTarget=r,t.point=r.globalToLocal(e),r.dispatchEvent(t)),i._cursorHander(o,r)},_cursorHander:function(t,e){t||e||this._setCursor("default"),t&&e!=t&&t.context&&this._setCursor(t.context.$model.cursor)},_setCursor:function(t){this._cursor!=t&&(this.canvax.view.style.cursor=t,this._cursor=t)},__libHandler:function(t){var e=this,n=e.canvax;n.updateViewOffset(),e.curPoints=e.__getCanvaxPointInTouchs(t),e._draging||(e.curPointsTarget=e.__getChildInTouchs(e.curPoints)),e.curPointsTarget.length>0?(e.drag.start.indexOf(t.type)>-1&&_.each(e.curPointsTarget,(function(t,n){if(t&&t.dragEnabled)return e._draging=!0,t._globalAlpha||(t._globalAlpha=t.context.$model.globalAlpha),e._clone2hoverStage(t,n),t.context.globalAlpha=0,t.fire("dragstart"),!1})),e.drag.move.indexOf(t.type)>-1&&e._draging&&_.each(e.curPointsTarget,(function(n,i){n&&n.dragEnabled&&e._dragIngHander(t,n,i)})),e.drag.end.indexOf(t.type)>-1&&e._draging&&(_.each(e.curPointsTarget,(function(n,i){n&&n.dragEnabled&&(e._dragEnd(t,n,0),n.fire("dragend"))})),e._draging=!1),e.__dispatchEventInChilds(t,e.curPointsTarget)):e.__dispatchEventInChilds(t,[n])},__getCanvaxPointInTouchs:function(t){var e=this.canvax,n=[];return _.each(t.point||t.touches,(function(t){n.push({x:"x"in t?t.x:H.pageX(t)-e.viewOffset.left,y:"y"in t?t.y:H.pageY(t)-e.viewOffset.top})})),n},__getChildInTouchs:function(t){var e=this.canvax,n=[];return _.each(t,(function(t){n.push(e.getObjectsUnderPoint(t,1)[0])})),n},__dispatchEventInChilds:function(t,e){if(!e&&!("length"in e))return!1;var n=this;_.each(e,(function(e,i){if(e){var a=new U(t);a.stagePoint=n.curPoints[i],a.point=e.globalToLocal(a.stagePoint),e.dispatchEvent(a)}}))},_clone2hoverStage:function(t,e){var n=this.canvax,i=n._bufferStage.getChildById(t.id);return i||((i=t.clone(!0))._transform=t.getConcatenatedMatrix(),n._bufferStage.addChildAt(i,0)),i.context.globalAlpha=t._globalAlpha,t._dragPoint=t.globalToLocal(this.curPoints[e]),i},_dragIngHander:function(t,e,n){var i=this.canvax,a=e.globalToLocal(this.curPoints[n]);e._noHeart=!0;var r=e.moveing;e.moveing=!0,e.context.x+=a.x-e._dragPoint.x,e.context.y+=a.y-e._dragPoint.y,e.fire("draging"),e.moveing=r,e._noHeart=!1;var o=i._bufferStage.getChildById(e.id);o._transform=e.getConcatenatedMatrix(),o.worldTransform=null,o.heartBeat()},_dragEnd:function(t,e,n){var i=this.canvax._bufferStage.getChildById(e.id);i&&i.destroy(),e.context.globalAlpha=e._globalAlpha}};var et={Event:U,Dispatcher:Q,Handler:K,Manager:J,types:$},nt=function(t,e,n,i,a,r){this.a=null!=t?t:1,this.b=null!=e?e:0,this.c=null!=n?n:0,this.d=null!=i?i:1,this.tx=null!=a?a:0,this.ty=null!=r?r:0,this.array=null};nt.prototype={concat:function(t){var e=this.a,n=this.c,i=this.tx;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d,this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this},concatTransform:function(t,e,n,i,a){var r=1,o=0;if(a%360){var l=a*Math.PI/180;r=Math.cos(l),o=Math.sin(l)}return this.concat(new nt(r*n,o*n,-o*i,r*i,t,e)),this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,a=this.c,r=this.tx;if(t>0)this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=a*e-this.d*n,this.d=a*n+this.d*e,this.tx=r*e-this.ty*n,this.ty=r*n+this.ty*e;else{var o=Math.sin(Math.abs(t)),l=Math.cos(Math.abs(t));this.a=i*l+this.b*o,this.b=-i*o+this.b*l,this.c=a*l+this.d*o,this.d=-a*o+l*this.d,this.tx=l*r+o*this.ty,this.ty=l*this.ty-o*r}return this},scale:function(t,e){return this.a*=t,this.d*=e,this.tx*=t,this.ty*=e,this},translate:function(t,e){return this.tx+=t,this.ty+=e,this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},invert:function(){var t=this.a,e=this.b,n=this.c,i=this.d,a=this.tx,r=t*i-e*n;return this.a=i/r,this.b=-e/r,this.c=-n/r,this.d=t/r,this.tx=(n*this.ty-i*a)/r,this.ty=-(t*this.ty-e*a)/r,this},clone:function(){return new nt(this.a,this.b,this.c,this.d,this.tx,this.ty)},toArray:function(t,e){if(0==arguments.length)return isNaN(this.a)||isNaN(this.b)||isNaN(this.c)||isNaN(this.d)||isNaN(this.tx)||isNaN(this.ty)?null:[this.a,this.b,this.c,this.d,this.tx,this.ty];this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},mulVector:function(t){var e=this.a,n=this.c,i=this.tx,a=this.b,r=this.d,o=this.ty,l=[0,0];return l[0]=t[0]*e+t[1]*n+i,l[1]=t[0]*a+t[1]*r+o,l}};var it,at=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(o(this,t),1==arguments.length&&"object"==p(arguments[0])){var i=arguments[0];if("x"in i&&"y"in i)this.x=1*i.x,this.y=1*i.y;else{var a=0;for(var r in i){if(0!=a){this.y=1*i[r];break}this.x=1*i[r],a++}}}else this.x=1*e,this.y=1*n}return l(t,[{key:"toArray",value:function(){return[this.x,this.y]}}]),t}(),rt={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-rt.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*rt.Bounce.In(2*t):.5*rt.Bounce.Out(2*t-1)+.5}}};it="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};var ot,lt,st=it,ut=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map((function(e){return t._tweens[e]}))},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,e){void 0===t&&(t=st()),void 0===e&&(e=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var a=this._tweens[n[i]],r=!e;a&&!1===a.update(t,r)&&!e&&delete this._tweens[n[i]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),dt={Linear:function(t,e){var n=t.length-1,i=n*e,a=Math.floor(i),r=dt.Utils.Linear;return e<0?r(t[0],t[1],i):e>1?r(t[n],t[n-1],n-i):r(t[a],t[a+1>n?n:a+1],i-a)},Bezier:function(t,e){for(var n=0,i=t.length-1,a=Math.pow,r=dt.Utils.Bernstein,o=0;o<=i;o++)n+=a(1-e,i-o)*a(e,o)*t[o]*r(i,o);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,a=Math.floor(i),r=dt.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(a=Math.floor(i=n*(1+e))),r(t[(a-1+n)%n],t[a],t[(a+1)%n],t[(a+2)%n],i-a)):e<0?t[0]-(r(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(r(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):r(t[a?a-1:0],t[a],t[n<a+1?n:a+1],t[n<a+2?n:a+2],i-a)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=dt.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n=1;if(t[e])return t[e];for(var i=e;i>1;i--)n*=i;return t[e]=n,n}}(),CatmullRom:function(t,e,n,i,a){var r=.5*(n-t),o=.5*(i-e),l=a*a;return(2*e-2*n+r+o)*(a*l)+(-3*e+3*n-2*r-o)*l+r*a+e}}},ht=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),ft=new ut,ct=function(){function t(t,e){void 0===e&&(e=ft),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=rt.Linear.None,this._interpolationFunction=dt.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=ht.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},t.prototype.duration=function(t){return this._duration=t,this},t.prototype.start=function(t){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==t?"string"==typeof t?st()+parseFloat(t):t:st(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},t.prototype._setupProperties=function(t,e,n,i){for(var a in n){var r=t[a],o=Array.isArray(r),l=o?"array":typeof r,s=!o&&Array.isArray(n[a]);if("undefined"!==l&&"function"!==l){if(s){var u=n[a];if(0===u.length)continue;u=u.map(this._handleRelativeValue.bind(this,r)),n[a]=[r].concat(u)}if("object"!==l&&!o||!r||s)void 0===e[a]&&(e[a]=r),o||(e[a]*=1),i[a]=s?n[a].slice().reverse():e[a]||0;else{for(var d in e[a]=o?[]:{},r)e[a][d]=r[d];i[a]=o?[]:{},this._setupProperties(r,e[a],n[a],i[a])}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(t){return void 0===t&&(t=st()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},t.prototype.resume=function(t){return void 0===t&&(t=st()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},t.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},t.prototype.group=function(t){return this._group=t,this},t.prototype.delay=function(t){return this._delayTime=t,this},t.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},t.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},t.prototype.yoyo=function(t){return this._yoyo=t,this},t.prototype.easing=function(t){return this._easingFunction=t,this},t.prototype.interpolation=function(t){return this._interpolationFunction=t,this},t.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},t.prototype.onStart=function(t){return this._onStartCallback=t,this},t.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},t.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},t.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},t.prototype.onStop=function(t){return this._onStopCallback=t,this},t.prototype.update=function(t,e){if(void 0===t&&(t=st()),void 0===e&&(e=!0),this._isPaused)return!0;var n,i,a=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>a)return!1;e&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(t-this._startTime)/this._duration,i=0===this._duration||i>1?1:i;var r=this._easingFunction(i);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,r),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1===i){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,l=this._chainedTweens.length;o<l;o++)this._chainedTweens[o].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(t,e,n,i){for(var a in n)if(void 0!==e[a]){var r=e[a]||0,o=n[a],l=Array.isArray(t[a]),s=Array.isArray(o);!l&&s?t[a]=this._interpolationFunction(o,i):"object"==typeof o&&o?this._updateProperties(t[a],r,o,i):"number"==typeof(o=this._handleRelativeValue(r,o))&&(t[a]=r+(o-r)*i)}},t.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},t.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],n=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof n?this._valuesStartRepeat[t]+parseFloat(n):this._valuesEnd[t],this._valuesEnd[t]=e},t}(),pt=ht.nextId,gt=ft,yt=gt.getAll.bind(gt),vt=gt.removeAll.bind(gt),xt=gt.add.bind(gt),_t=gt.remove.bind(gt),mt=gt.update.bind(gt),bt={Easing:rt,Group:ut,Interpolation:dt,now:st,Sequence:ht,nextId:pt,Tween:ct,VERSION:"18.6.4",getAll:yt,removeAll:vt,add:xt,remove:_t,update:mt},wt=0,kt=!0;if("undefined"!=typeof window){ot=window.requestAnimationFrame,lt=window.cancelAnimationFrame;for(var St=["ms","moz","webkit","o"],At=0;At<St.length&&!window.requestAnimationFrame;++At)ot=window.requestAnimationFrame=window[St[At]+"RequestAnimationFrame"],lt=window.cancelAnimationFrame=window[St[At]+"CancelAnimationFrame"]||window[St[At]+"CancelRequestAnimationFrame"]}ot||(ot=function(t,e){var n=(new Date).getTime(),i=Math.max(0,16-(n-wt)),a=setTimeout((function(){t(n+i)}),i);return wt=n+i,a}),lt||(lt=function(t){clearTimeout(t)});var Pt=[],Ct=null;function Dt(t){if(t)return Pt.push(t),Ct||(Ct=ot((function(){bt.update();var t=Pt;for(Pt=[],Ct=null;t.length>0;)t.shift().task()}))),Ct}function Ot(t){for(var e=!1,n=0,i=Pt.length;n<i;n++)Pt[n].id===t.id&&(e=!0,Pt.splice(n,1),n--,i--);return 0==Pt.length&&(lt(Ct),Ct=null),e}function Tt(){return kt}var Mt={setAnimationEnabled:function(t){kt=t},getAnimationEnabled:Tt,registFrame:Dt,destroyFrame:Ot,registTween:function(t){var e=_.extend({from:null,to:null,duration:500,onStart:function(){},onUpdate:function(){},onComplete:function(){},onStop:function(){},repeat:0,delay:0,easing:"Linear.None",desc:""},t);Tt()||(e.duration=0,e.delay=0);var n={},i="tween_"+Y.getUID();if(e.id&&(i=i+"_"+e.id),e.from&&e.to){(n=new bt.Tween(e.from).to(e.to,e.duration).onStart((function(){e.onStart(e.from)})).onUpdate((function(){e.onUpdate(e.from)})).onComplete((function(){Ot({id:i}),n._isCompleteed=!0,e.onComplete(e.from)})).onStop((function(){Ot({id:i}),n._isStoped=!0,e.onStop(e.from)})).repeat(e.repeat).delay(e.delay).easing(bt.Easing[e.easing.split(".")[0]][e.easing.split(".")[1]])).id=i,n.start(),function t(){n._isCompleteed||n._isStoped?n=null:Dt({id:i,task:t,desc:e.desc,tween:n})}()}return n},destroyTween:function(t,e){t.stop()},Tween:bt,taskList:Pt};function Et(t){var e=!0,n={},i={},a=["$watch","$model"],r={},o=a;function l(t,l){-1===_.indexOf(a,t)&&(r[t]=l);var s=p(l);if(!(_.indexOf(o,t)>-1))if("function"===s)o.push(t);else{var u=function(i){var a,o=r[t],l=o;if(!arguments.length)return!o||"object"!==s||o instanceof Array||o.$model||o.addColorStop||((o=Et(o)).$watch=n.$watch,r[t]=o),o;var u=p(i);e||o!==i&&(!i||"object"!==u||i instanceof Array||i.addColorStop?o=i:a=(o=i.$model?i:Et(i)).$model,r[t]=a||o,s!=u&&(s=u),n.$watch&&n.$watch.call(n,t,o,l))};i[t]={set:u,get:u,enumerable:!0}}}for(var s in t)l(s,t[s]);return n=It(n,i,o),_.forEach(o,(function(e){t[e]&&("function"==typeof t[e]?n[e]=function(){t[e].apply(this,arguments)}:n[e]=t[e])})),n.$model=r,n.hasOwnProperty=function(t){return t in n.$model},e=!1,n}var Rt=Object.defineProperty;try{Rt({},"_",{value:"x"});var It=Object.defineProperties}catch(t){"__defineGetter__"in Object&&(Rt=function(t,e,n){return"value"in n&&(t[e]=n.value),"get"in n&&t.__defineGetter__(e,n.get),"set"in n&&t.__defineSetter__(e,n.set),t},It=function(t,e){for(var n in e)e.hasOwnProperty(n)&&Rt(t,n,e[n]);return t})}var Lt=0,Ft=2,Nt={POLY:0,RECT:1,CIRC:2,ELIP:3},Bt=["x","y","scaleX","scaleY","rotation","scaleOrigin","rotateOrigin"],jt=["lineWidth","strokeAlpha","strokeStyle","fillStyle","fillAlpha","globalAlpha","shadowOffsetX","shadowOffsetY","shadowColor","shadowBlur"],zt=function(t,e,n,i){var a=t[0],r=t[1],o=t[2],l=t[3],s=Math.max(i,3),u=0,d=a;return!(n>r+s&&n>l+s||n<r-s&&n<l-s||e>a+s&&e>o+s||e<a-s&&e<o-s)&&(a===o?Math.abs(e-a)<=s/2:((u=(r-l)/(a-o))*e-n+(d=(a*l-o*r)/(a-o)))*(u*e-n+d)/(u*u+1)<=s/2*s/2)};function Wt(t,e,n,i){for(var a=t.shape.points,r=t.lineWidth,o=!1,l=0;l<a.length&&!(o=zt(a.slice(l,l+4),e,n,r));++l)l+=1;return o}function Vt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Gt=function(t){f(n,et.Dispatcher);var e=Vt(n);function n(t){var i;o(this,n),(i=e.call(this,t))._transform=null,i.worldTransform=null,i._transformChange=!1,i._heartBeatNum=0,i.stage=null,i.parent=null,i.xyToInt=!("xyToInt"in t)||t.xyToInt,i.moveing=!1,i.clip=null,i.context=i._createContext(t),i.type=t.type||"DisplayObject",i.id=t.id||Y.createId(i.type),i._trackList=[],i.init.apply(u(i),arguments),i._updateTransform(),i._tweens=[];var a=u(i);return i.on("destroy",(function(){a.cleanAnimates()})),i}return l(n,[{key:"init",value:function(){}},{key:"clipTo",value:function(t){this.clip=t,t.isClip=!0}},{key:"_createContext",value:function(t){var e=this,n=t.context||{},i={width:n.width||0,height:n.height||0,x:n.x||0,y:n.y||0,scaleX:n.scaleX||1,scaleY:n.scaleY||1,scaleOrigin:n.scaleOrigin||{x:0,y:0},rotation:n.rotation||0,rotateOrigin:n.rotateOrigin||{x:0,y:0},visible:n.visible||!0,globalAlpha:n.globalAlpha||1};return _.extend(!0,i,t.context),e._notWatch=!1,e._noHeart=!1,i.$watch=function(t,n,i){var a=e;a.context&&("globalGalpha"==t&&(a._globalAlphaChange=!0),_.indexOf(Bt,t)>-1&&(a._updateTransform(),a._transformChange=!0),a._notWatch||(a.$watch&&(a._notWatch=!0,a.$watch(t,n,i),a._notWatch=!1),a._noHeart||a.heartBeat({convertType:"context",shape:a,name:t,value:n,preValue:i})))},Et(i)}},{key:"track",value:function(t){-1==_.indexOf(this._trackList,t)&&this._trackList.push(t)}},{key:"untrack",value:function(t){var e=_.indexOf(this._trackList,t);e>-1&&this._trackList.splice(e,1)}},{key:"clone",value:function(t){var e,n={id:this.id,context:_.clone(this.context.$model),isClone:!0};return(e="text"==this.type?new this.constructor(this.text,n):new this.constructor(n)).id=n.id,this.children&&(e.children=this.children),this.graphics&&(e.graphics=this.graphics.clone()),t||(e.id=Y.createId(e.type)),e}},{key:"heartBeat",value:function(t){var e=this.getStage();e&&(this._heartBeatNum++,e.heartBeat&&e.heartBeat(t))}},{key:"getCurrentWidth",value:function(){return Math.abs(this.context.$model.width*this.context.$model.scaleX)}},{key:"getCurrentHeight",value:function(){return Math.abs(this.context.$model.height*this.context.$model.scaleY)}},{key:"getStage",value:function(){if(this.stage)return this.stage;var t=this;if("stage"!=t.type){for(;t.parent&&"stage"!=(t=t.parent).type;);if("stage"!==t.type)return!1}return this.stage=t,t}},{key:"localToGlobal",value:function(t,e){!t&&(t=new at(0,0));var n=this.getConcatenatedMatrix(e);if(null==n)return at(0,0);var i=new nt(1,0,0,1,t.x,t.y);return i.concat(n),new at(i.tx,i.ty)}},{key:"globalToLocal",value:function(t,e){if(!t&&(t=new at(0,0)),"stage"==this.type)return t;var n=this.getConcatenatedMatrix(e);if(null==n)return new at(0,0);n.invert();var i=new nt(1,0,0,1,t.x,t.y);return i.concat(n),new at(i.tx,i.ty)}},{key:"localToTarget",value:function(t,e){var n=localToGlobal(t);return e.globalToLocal(n)}},{key:"getConcatenatedMatrix",value:function(t){for(var e=new nt,n=this;null!=n;n=n.parent)if(e.concat(n._transform),!n.parent||t&&n.parent&&n.parent==t||n.parent&&"stage"==n.parent.type)return e;return e}},{key:"setEventEnable",value:function(t){return!!_.isBoolean(t)&&(this._eventEnabled=t,!0)}},{key:"getIndex",value:function(){if(this.parent)return _.indexOf(this.parent.children,this)}},{key:"toBack",value:function(t){if(this.parent){var e=this.getIndex(),n=0;if(_.isNumber(t)){if(0==t)return;n=e-t}var i=this.parent.children.splice(e,1)[0];n<0&&(n=0),this.parent.addChildAt(i,n)}}},{key:"toFront",value:function(t){if(this.parent){var e=this.getIndex(),n=this.parent.children.length,i=n;if(_.isNumber(t)){if(0==t)return;i=e+t+1}var a=this.parent.children.splice(e,1)[0];i>n&&(i=n),this.parent.addChildAt(a,i-1)}}},{key:"_updateTransform",value:function(){var t=new nt;t.identity();var e=this.context;if(1!==e.scaleX||1!==e.scaleY){var n=new at(e.scaleOrigin);t.translate(-n.x,-n.y),t.scale(e.scaleX,e.scaleY),t.translate(n.x,n.y)}var i=e.rotation;if(i){n=new at(e.rotateOrigin);t.translate(-n.x,-n.y),t.rotate(i%360*Math.PI/180),t.translate(n.x,n.y)}if(this.xyToInt&&!this.moveing){var a=parseInt(e.x),r=parseInt(e.y);parseInt(e.lineWidth,10)%2==1&&e.strokeStyle&&(a+=.5,r+=.5)}else a=e.x,r=e.y;return 0==a&&0==r||t.translate(a,r),this._transform=t,t}},{key:"setWorldTransform",value:function(){var t=new nt;return t.concat(this._transform),this.parent&&t.concat(this.parent.worldTransform),this.worldTransform=t,this.worldTransform}},{key:"getChildInPoint",value:function(t){var e=!1,n=t.x,i=t.y;if(this.worldTransform){var a=this.worldTransform.clone().invert(),r=[n*V.RESOLUTION,i*V.RESOLUTION];n=(r=a.mulVector(r))[0],i=r[1]}if(this.graphics&&(e=this.containsPoint({x:n,y:i})),"text"==this.type){var o=this.getRect();return!(!o.width||!o.height)&&(e=n>=o.x&&n<=o.x+o.width&&(o.height>=0&&i>=o.y&&i<=o.y+o.height||o.height<0&&i<=o.y&&i>=o.y+o.height))}return e}},{key:"containsPoint",value:function(t){for(var e=!1,n=0;n<this.graphics.graphicsData.length;++n){var i=this.graphics.graphicsData[n];if(i.shape){if(i.hasFill()&&i.shape.contains(t.x,t.y)&&(e=!0))break;if(i.hasLine()&&i.shape.points&&(e=Wt(i,t.x,t.y)))break}}return e}},{key:"animate",value:function(t,e,n){if(n||(n=this.context),n){var i=t,a=null;for(var r in i)_.isObject(i[r])?this.animate(i[r],_.extend({},e),n[r]):isNaN(i[r])&&""!==i[r]&&null!==i[r]?(n[r]=i[r],delete i[r]):(a||(a={}),a[r]=n[r]);if(a){!e&&(e={}),e.from=a,e.to=i;var o,l=this,s=function(){};e.onUpdate&&(s=e.onUpdate),e.onUpdate=function(t){if(!n&&o)return Mt.destroyTween(o),void(o=null);for(var e in t)n[e]=t[e];s.apply(l,[t])};var u=function(){};return e.onComplete&&(u=e.onComplete),e.onComplete=function(t){u.apply(l,arguments),l._removeTween(o)},e.onStop=function(){l._removeTween(o)},e.desc="tweenType:DisplayObject.animate__id:"+this.id+"__objectType:"+this.type,o=Mt.registTween(e),this._tweens.push(o),o}}}},{key:"_removeTween",value:function(t){for(var e=0;e<this._tweens.length;e++)if(t==this._tweens[e]){this._tweens.splice(e,1);break}}},{key:"removeAnimate",value:function(t){t.stop(),this._removeTween(t)}},{key:"cleanAnimates",value:function(){this._cleanAnimates()}},{key:"_cleanAnimates",value:function(){for(;this._tweens.length;)this._tweens.shift().stop()}},{key:"remove",value:function(){this.parent&&(this.parent.removeChild(this),this.parent=null)}},{key:"destroy",value:function(){this._destroy()}},{key:"_destroy",value:function(){this.remove(),this.fire("destroy"),this.context=null,delete this.context}}]),n}();function Ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Yt=function(t){f(n,Gt);var e=Ht(n);function n(t){var i;return o(this,n),(i=e.call(this,t)).children=[],i._eventEnabled=!0,i}return l(n,[{key:"addChild",value:function(t,e){if(t)return-1!=this.getChildIndex(t)?(t.parent=this,t):(t.parent&&t.parent.removeChild(t),void 0===e&&(e=this.children.length),this.children.splice(e,0,t),t.parent=this,this.heartBeat&&this.heartBeat({convertType:"children",target:t,src:this}),this._afterAddChild&&this._afterAddChild(t),t)}},{key:"addChildAt",value:function(t,e){return this.addChild(t,e)}},{key:"removeChild",value:function(t){return this.removeChildAt(_.indexOf(this.children,t))}},{key:"removeChildAt",value:function(t){if(t<0||t>this.children.length-1)return!1;var e=this.children[t];return null!=e&&(e.parent=null),this.children.splice(t,1),this.heartBeat&&this.heartBeat({convertType:"children",target:e,src:this}),this._afterDelChild&&this._afterDelChild(e,t),e}},{key:"removeChildById",value:function(t){for(var e=0,n=this.children.length;e<n;e++)if(this.children[e].id==t)return this.removeChildAt(e);return!1}},{key:"removeAllChildren",value:function(){for(;this.children.length>0;)this.removeChildAt(0)}},{key:"destroy",value:function(){for(var t=0,e=this.children.length;t<e;t++)this.getChildAt(t).destroy(),t--,e--;this._destroy()}},{key:"cleanAnimates",value:function(){for(var t=0,e=this.children.length;t<e;t++)this.getChildAt(t).cleanAnimates();this._cleanAnimates()}},{key:"getChildById",value:function(t,e){if(e)return null;for(var n=0,i=this.children.length;n<i;n++)if(this.children[n].id==t)return this.children[n];return null}},{key:"getChildAt",value:function(t){return t<0||t>this.children.length-1?null:this.children[t]}},{key:"getChildIndex",value:function(t){return _.indexOf(this.children,t)}},{key:"setChildIndex",value:function(t,e){if(t.parent==this){var n=_.indexOf(this.children,t);e!=n&&(this.children.splice(n,1),this.children.splice(e,0,t))}}},{key:"getNumChildren",value:function(){return this.children.length}},{key:"getObjectsUnderPoint",value:function(t,e){for(var i=[],a=this.children.length-1;a>=0;a--){var r=this.children[a];if(null!=r&&r.context.$model.visible)if(r instanceof n){if(!r._eventEnabled)continue;if(r.getNumChildren()>0){var o=r.getObjectsUnderPoint(t);o.length>0&&(i=i.concat(o))}}else{if(!r._eventEnabled&&!r.dragEnabled)continue;if(r.getChildInPoint(t)&&(i.push(r),null!=e&&!isNaN(e)&&i.length==e))return i}}return i}}]),n}();function Xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Ut=function(t){f(n,Yt);var e=Xt(n);function n(t){var i;return o(this,n),t.type="stage",(i=e.call(this,t)).canvas=null,i.ctx=t.ctx||null,i.stageRending=!1,i._isReady=!1,i}return l(n,[{key:"initStage",value:function(t,e,n){var i=this;i.canvas=t;var a=i.context;a.width=e,a.height=n,a.scaleX=V.RESOLUTION,a.scaleY=V.RESOLUTION,i._isReady=!0}},{key:"heartBeat",value:function(t){this._isReady&&(t||(t={}),t.stage=this,this.parent&&this.parent.heartBeat(t))}}]),n}(),qt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lt,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(o(this,t),this.type=e,this.app=n,i)for(var a in V.RENDER_OPTIONS)void 0===i[a]&&(i[a]=V.RENDER_OPTIONS[a]);else i=V.RENDER_OPTIONS;this.options=i,this.requestAid=null,this._heartBeat=!1,this._preRenderTime=0}return l(t,[{key:"startEnter",value:function(){var t=this;t.requestAid||(t.requestAid=Mt.registFrame({id:"enterFrame",task:function(){t.enterFrame.apply(t)}}))}},{key:"enterFrame",value:function(){var t=this;t.requestAid=null,Y.now=(new Date).getTime(),t._heartBeat&&(this.app.children.length&&t.render(this.app),t._heartBeat=!1,t._preRenderTime=(new Date).getTime())}},{key:"_convertCanvax",value:function(t){_.each(this.app.children,(function(e){e.context[t.name]=t.value}))}},{key:"heartBeat",value:function(t){var e=this;if(t){if("context"==t.convertType){var n=t.stage,i=t.shape;t.name,t.value,t.preValue;if("canvax"==i.type)e._convertCanvax(t);else if(e.app.convertStages[n.id]||(e.app.convertStages[n.id]={stage:n,convertShapes:{}}),i){if(e.app.convertStages[n.id].convertShapes[i.id])return;e.app.convertStages[n.id].convertShapes[i.id]={shape:i,convertType:t.convertType}}}if("children"==t.convertType){var a=t.target;((n=t.src.getStage())||"stage"==a.type)&&(n=n||a,e.app.convertStages[n.id]||(e.app.convertStages[n.id]={stage:n,convertShapes:{}}))}if(!t.convertType){n=t.stage;e.app.convertStages[n.id]||(e.app.convertStages[n.id]={stage:n,convertShapes:{}})}}else _.each(e.app.children,(function(t,n){e.app.convertStages[t.id]={stage:t,convertShapes:{}}}));e._heartBeat?e._heartBeat=!0:(e._heartBeat=!0,e.startEnter())}}]),t}(),$t=r((function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.default=t.exports,t.exports.__esModule=!0}));a($t);var Jt=r((function(t){t.exports=function(t){if(Array.isArray(t))return $t(t)},t.exports.default=t.exports,t.exports.__esModule=!0}));a(Jt);var Zt=r((function(t){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)},t.exports.default=t.exports,t.exports.__esModule=!0}));a(Zt);var Qt=r((function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return $t(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$t(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0}));a(Qt);var Kt=r((function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0}));a(Kt);var te=a(r((function(t){t.exports=function(t){return Jt(t)||Zt(t)||Qt(t)||Kt()},t.exports.default=t.exports,t.exports.__esModule=!0}))),ee=function(){function t(e){o(this,t),this.renderer=e}return l(t,[{key:"render",value:function(t,e,n,i){this.renderer;for(var a=t.graphics.graphicsData,r=e.ctx,o=0;o<a.length;o++){var l=a[o],s=l.shape,u=l.fillStyle;if(u&&"object"==p(u)){var d=u.linearGradient||u.lineargradient;d&&u.points&&function(){var t=r.createLinearGradient.apply(r,te(u.points));d.forEach((function(e){t.addColorStop(e.position,e.color)})),u=t}()}var h=l.strokeStyle;if(h&&"object"==p(h)){var f=h.linearGradient||h.lineargradient;f&&h.points&&function(){var t=r.createLinearGradient.apply(r,te(h.points));f.forEach((function(e){t.addColorStop(e.position,e.color)})),h=t}()}var c=l.hasFill()&&l.fillAlpha&&!i,g=l.hasLine()&&l.strokeAlpha&&!i;if(r.lineWidth=l.lineWidth,r.shadowColor=l.shadowColor,r.shadowBlur=l.shadowBlur,r.shadowOffsetX=l.shadowOffsetX,r.shadowOffsetY=l.shadowOffsetY,r.lineCap=l.lineCap,r.lineJoin=l.lineJoin,"miter"==r.lineJoin&&(r.miterLimit=l.miterLimit),l.type===Nt.POLY)r.beginPath(),this.renderPolygon(s.points,s.closed,r,i),c&&(r.globalAlpha=l.fillAlpha*n,r.fillStyle=u,r.fill()),g&&(r.globalAlpha=l.strokeAlpha*n,r.strokeStyle=h,c&&l.shadowBlur&&(r.shadowBlur=0),r.stroke());else if(l.type===Nt.RECT)i&&r.rect(s.x,s.y,s.width,s.height),c&&(r.globalAlpha=l.fillAlpha*n,r.fillStyle=u,r.fillRect(s.x,s.y,s.width,s.height)),g&&(r.globalAlpha=l.strokeAlpha*n,r.strokeStyle=h,c&&l.shadowBlur&&(r.shadowBlur=0),r.strokeRect(s.x,s.y,s.width,s.height));else if(l.type===Nt.CIRC)r.beginPath(),r.arc(s.x,s.y,s.radius,0,2*Math.PI),r.closePath(),c&&(r.globalAlpha=l.fillAlpha*n,r.fillStyle=u,r.fill()),g&&(r.globalAlpha=l.strokeAlpha*n,r.strokeStyle=h,c&&l.shadowBlur&&(r.shadowBlur=0),r.stroke());else if(l.type===Nt.ELIP){var y=2*s.width,v=2*s.height,x=s.x-y/2,_=s.y-v/2;r.beginPath();var m=.5522848,b=y/2*m,w=v/2*m,k=x+y,S=_+v,A=x+y/2,P=_+v/2;r.moveTo(x,P),r.bezierCurveTo(x,P-w,A-b,_,A,_),r.bezierCurveTo(A+b,_,k,P-w,k,P),r.bezierCurveTo(k,P+w,A+b,S,A,S),r.bezierCurveTo(A-b,S,x,P+w,x,P),r.closePath(),c&&(r.globalAlpha=l.fillAlpha*n,r.fillStyle=u,r.fill()),g&&(r.globalAlpha=l.strokeAlpha*n,r.strokeStyle=h,c&&l.shadowBlur&&(r.shadowBlur=0),r.stroke())}}}},{key:"renderPolygon",value:function(t,e,n,i){n.moveTo(t[0],t[1]);for(var a=1;a<t.length/2;++a)n.lineTo(t[2*a],t[2*a+1]);(e||i)&&n.closePath()}}]),t}();function ne(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var ie=function(t){f(n,qt);var e=ne(n);function n(t){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,n),(i=e.call(this,Ft,t,a)).renderType="canvas",i.CGR=new ee(u(i)),i}return l(n,[{key:"render",value:function(t){var e=this;e.app=t,_.each(_.values(t.convertStages),(function(t){e.renderStage(t.stage)})),t.convertStages={}}},{key:"renderStage",value:function(t){t.ctx||(t.ctx=t.canvas.getContext("2d")),t.stageRending=!0,t.setWorldTransform(),this._clear(t),this._render(t,t,t.context.globalAlpha),t.stageRending=!1}},{key:"_render",value:function(t,e,n){var i=t.ctx;if(i){var a=e.context.$model;if(e.worldTransform||e.fire("render"),(!e.worldTransform||e._transformChange||e.parent&&e.parent._transformChange)&&(e.setWorldTransform(),e.fire("transform"),e._transformChange=!0),n*=a.globalAlpha,a.visible&&!e.isClip){var r=e.worldTransform.toArray();if(r){i.setTransform.apply(i,r);var o=!1;if(e.clip&&e.clip.graphics){var l=e.clip;i.save(),i.beginPath(),o=!0,(!l.worldTransform||l._transformChange||l.parent._transformChange)&&(l.setWorldTransform(),l._transformChange=!0),i.setTransform.apply(i,l.worldTransform.toArray()),l.graphics.graphicsData.length||l._draw(l.graphics),this.CGR.render(l,t,n,o),l._transformChange=!1,i.clip()}if(e.graphics&&(e.graphics.graphicsData.length||e._draw(e.graphics),n&&(i.setLineDash([]),a.lineType&&"solid"!=a.lineType&&i.setLineDash(a.lineDash),this.CGR.render(e,t,n))),"text"==e.type&&e.render(i,n),e.children)for(var s=0,u=e.children.length;s<u;s++)this._render(t,e.children[s],n);e._transformChange=!1,o&&(i.closePath(),i.restore()),i.draw&&i.draw(!0)}}}}},{key:"_clear",value:function(t){var e=t.ctx;e.setTransform.apply(e,t.worldTransform.toArray()),e.clearRect(0,0,this.app.width,this.app.height)}}]),n}();function ae(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var re=function(t){f(n,ie);var e=ae(n);function n(t){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,n),(i=e.call(this,t,a)).renderType="alipayMini",i}return n}();function oe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var le=function(t){f(n,Yt);var e=oe(n);function n(t){var i;if(o(this,n),t.type="canvax",(i=e.call(this,t)).uid=t.uid||(new Date).getTime()+"_"+Math.floor(100*Math.random()),V.RESOLUTION=t.devicePixelRatio||("undefined"!=typeof window?window.devicePixelRatio:1),i.el=H.query(t.el),i.width=t.width||parseInt("width"in t||i.el.offsetWidth,10),i.height=t.height||parseInt("height"in t||i.el.offsetHeight,10),i.el){var a=H.createView(i.width,i.height,i.uid);i.view=a.view,i.stageView=a.stageView,i.domView=a.domView,i.el.innerHTML="",i.el.appendChild(i.view)}return i.viewOffset=t.viewOffset||H.offset(i.view),i.lastGetRO=0,i.renderer=function(t,e){return"alipayMini"==e.renderer?new re(t,e):new ie(t,e)}(u(i),t),i.event=null,i.convertStages={},i.context.$model.width=i.width,i.context.$model.height=i.height,i._bufferStage=i._creatHoverStage(t),i.worldTransform=(new nt).identity(),i}return l(n,[{key:"registEvent",value:function(t){return this.event=new et.Handler(this,t),this.event.init(),this.event}},{key:"destroy",value:function(){for(var t=0,e=this.children.length;t<e;t++){var n=this.children[t];n.destroy(),n.canvas=null,n.ctx=null,n=null,t--,e--}try{this.view.removeChild(this.stageView),this.view.removeChild(this.domView),this.el.removeChild(this.view)}catch(t){}this.el&&(this.el.innerHTML=""),this.event=null,this._bufferStage=null}},{key:"resize",value:function(t){this.width=parseInt(t&&"width"in t||this.el.offsetWidth,10),this.height=parseInt(t&&"height"in t||this.el.offsetHeight,10),this.view&&(this.viewOffset=H.offset(this.view)),this.context.$model.width=this.width,this.context.$model.height=this.height;var e=this;_.each(this.children,(function(t,n){var i;t.context.$model.width=e.width,t.context.$model.height=e.height,(i=t.canvas).style.width=e.width+"px",i.style.height=e.height+"px",i.setAttribute("width",e.width*V.RESOLUTION),i.setAttribute("height",e.height*V.RESOLUTION)})),this.stageView.style.width=this.width+"px",this.stageView.style.height=this.height+"px",this.domView.style.width=this.width+"px",this.domView.style.height=this.height+"px",this.heartBeat()}},{key:"getHoverStage",value:function(){return this._bufferStage}},{key:"_creatHoverStage",value:function(t){return this._bufferStage=new Ut({id:"activCanvas"+(new Date).getTime(),ctx:t.activCanvas||null}),this._bufferStage._eventEnabled=!1,this.addChild(this._bufferStage),this._bufferStage}},{key:"updateViewOffset",value:function(t){var e=(new Date).getTime();e-this.lastGetRO>1e3&&(this.viewOffset=t||H.offset(this.view),this.lastGetRO=e)}},{key:"_afterAddChild",value:function(t,e){var n;n=t.canvas?t.canvas:H.createCanvas(this.context.$model.width,this.context.$model.height,t.id),this.stageView&&(1==this.children.length?this.stageView.appendChild(n):this.children.length>1&&(void 0===e?this.stageView.insertBefore(n,this._bufferStage.canvas):e>=this.children.length-1?this.stageView.appendChild(n):this.stageView.insertBefore(n,this.children[e].canvas))),Y.initElement(n),t.initStage(n,this.context.$model.width,this.context.$model.height)}},{key:"_afterDelChild",value:function(t){try{this.stageView&&t.canvas&&this.stageView.removeChild(t.canvas)}catch(t){}}},{key:"heartBeat",value:function(t){this.children.length>0&&this.renderer.heartBeat(t)}},{key:"toDataURL",value:function(){var t=H.createCanvas(this.width,this.height,"curr_base64_canvas"),e=t.getContext("2d");return _.each(this.children,(function(t){e.drawImage(t.canvas,0,0)})),t.toDataURL()}},{key:"setPixelCtx",value:function(t){Y._pixelCtx=t}}]),n}();function se(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var ue=function(t){f(n,Yt);var e=se(n);function n(t){return o(this,n),(t=Y.checkOpt(t)).type="sprite",e.call(this,t)}return n}(),de=function(){function t(e,n,i,a,r,l,s,u,d,h,f,c,p){o(this,t),this.lineWidth=e,this.strokeStyle=n,this.strokeAlpha=i,this.fillStyle=a,this.fillAlpha=r,this.shadowOffsetX=l,this.shadowOffsetY=s,this.shadowBlur=u,this.shadowColor=d,this.lineCap=h,this.lineJoin=f,this.miterLimit=c,this.shape=p,this.type=p.type,this.holes=[],this.fill=!0,this.line=!0}return l(t,[{key:"clone",value:function(){var e=new t(this.lineWidth,this.strokeStyle,this.strokeAlpha,this.fillStyle,this.fillAlpha,this.shadowOffsetX,this.shadowOffsetY,this.shadowBlur,this.shadowColor,this.lineCap,this.lineJoin,this.miterLimit,this.shape);return e.fill=this.fill,e.line=this.line,e}},{key:"addHole",value:function(t){this.holes.push(t)}},{key:"synsStyle",value:function(t){this.line&&(this.lineWidth=t.lineWidth,this.strokeStyle=t.strokeStyle,this.strokeAlpha=t.strokeAlpha),this.fill&&(this.fillStyle=t.fillStyle,this.fillAlpha=t.fillAlpha),this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor,this.lineCap=t.lineCap,this.lineJoin=t.lineJoin,this.miterLimit=t.miterLimit}},{key:"hasFill",value:function(){return this.fillStyle&&this.fill&&void 0!==this.shape.closed&&this.shape.closed}},{key:"hasLine",value:function(){return this.strokeStyle&&this.lineWidth&&this.line}},{key:"destroy",value:function(){this.shape=null,this.holes=null}}]),t}(),he={},fe={},ce=Array.prototype.join;function pe(t,e,n,i,a,r,o){var l=ce.call(arguments);if(he[l])return he[l];var s=Math.PI,u=o*s/180,d=Math.sin(u),h=Math.cos(u),f=0,c=0,p=-h*t*.5-d*e*.5,g=-h*e*.5+d*t*.5,y=(n=Math.abs(n))*n,v=(i=Math.abs(i))*i,x=g*g,_=p*p,m=y*v-y*x-v*_,b=0;if(m<0){var w=Math.sqrt(1-m/(y*v));n*=w,i*=w}else b=(a===r?-1:1)*Math.sqrt(m/(y*x+v*_));var k=b*n*g/i,S=-b*i*p/n,A=h*k-d*S+.5*t,P=d*k+h*S+.5*e,C=ye(1,0,(p-k)/n,(g-S)/i),D=ye((p-k)/n,(g-S)/i,(-p-k)/n,(-g-S)/i);0===r&&D>0?D-=2*s:1===r&&D<0&&(D+=2*s);for(var O=Math.ceil(Math.abs(D/s*2)),T=[],M=D/O,E=8/3*Math.sin(M/4)*Math.sin(M/4)/Math.sin(M/2),R=C+M,I=0;I<O;I++)T[I]=ge(C,R,h,d,n,i,A,P,E,f,c),f=T[I][4],c=T[I][5],C=R,R+=M;return he[l]=T,T}function ge(t,e,n,i,a,r,o,l,s,u,d){var h=ce.call(arguments);if(fe[h])return fe[h];var f=Math.cos(t),c=Math.sin(t),p=Math.cos(e),g=Math.sin(e),y=n*a*p-i*r*g+o,v=i*a*p+n*r*g+l,x=u+s*(-n*a*c-i*r*f),_=d+s*(-i*a*c+n*r*f),m=y+s*(n*a*g+i*r*p),b=v+s*(i*a*g-n*r*p);return fe[h]=[x,_,m,b,y,v],fe[h]}function ye(t,e,n,i){var a=Math.atan2(e,t),r=Math.atan2(i,n);return r>=a?r-a:2*Math.PI-(a-r)}var ve=function(t,e,n,i){for(var a=i[0],r=i[1],o=i[2],l=i[3],s=i[4],u=[[],[],[],[]],d=pe(i[5]-e,i[6]-n,a,r,l,s,o),h=0,f=d.length;h<f;h++)u[h][0]=d[h][0]+e,u[h][1]=d[h][1]+n,u[h][2]=d[h][2]+e,u[h][3]=d[h][3]+n,u[h][4]=d[h][4]+e,u[h][5]=d[h][5]+n,t.bezierCurveTo.apply(t,u[h])},xe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;o(this,t),this.x=e,this.y=n,this.width=i,this.height=a,this.type=Nt.RECT,this.closed=!0}return l(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}},{key:"contains",value:function(t,e){return!(this.height*e<0||this.width*t<0)&&(t>=this.x&&t<=this.x+this.width&&(this.height>=0&&e>=this.y&&e<=this.y+this.height||this.height<0&&e<=this.y&&e>=this.y+this.height))}}]),t}(),_e=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;o(this,t),this.x=e,this.y=n,this.radius=i,this.type=Nt.CIRC,this.closed=!0}return l(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.radius)}},{key:"contains",value:function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,i=this.x-t,a=this.y-e;return(i*=i)+(a*=a)<=n}},{key:"getBounds",value:function(){return new xe(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}]),t}(),me=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;o(this,t),this.x=e,this.y=n,this.width=i,this.height=a,this.type=Nt.ELIP,this.closed=!0}return l(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"contains",value:function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,i=(e-this.y)/this.height;return(n*=n)+(i*=i)<=1}},{key:"getBounds",value:function(){return new xe(this.x-this.width,this.y-this.height,this.width,this.height)}}]),t}(),be=function(){function t(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];o(this,t);var a=n[0];if(Array.isArray(a)&&(n=a),a&&"x"in a&&"y"in a){for(var r=[],l=0,s=n.length;l<s;l++)r.push(n[l].x,n[l].y);n=r}this.closed=!0,this.points=n,this.type=Nt.POLY}return l(t,[{key:"clone",value:function(){return new t(this.points.slice())}},{key:"close",value:function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1]),this.closed=!0}},{key:"contains",value:function(t,e){return this._isInsidePolygon_WindingNumber(t,e)}},{key:"_isInsidePolygon_WindingNumber",value:function(t,e){for(var n,i=this.points,a=0,r=i[1]>e,o=3;o<i.length;o+=2)if((n=r)!=(r=i[o]>e)){var l=(n?1:0)-(r?1:0);l*((i[o-3]-t)*(i[o-0]-e)-(i[o-2]-e)*(i[o-1]-t))>0&&(a+=l)}return a}}]),t}();var we=function(){function t(e){o(this,t),this.lineWidth=1,this.strokeStyle=null,this.strokeAlpha=1,this.fillStyle=null,this.fillAlpha=1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0,this.shadowColor="black",this.lineCap="round",this.lineJoin="round",this.miterLimit=null,this.graphicsData=[],this.currentPath=null,this.dirty=0,this.clearDirty=0,this._webGL={},this.worldAlpha=1,this.tint=16777215,this.Bound={x:0,y:0,width:0,height:0}}return l(t,[{key:"setStyle",value:function(t){var e=t.$model;this.lineWidth=e.lineWidth,this.strokeStyle=e.strokeStyle,this.strokeAlpha=e.strokeAlpha*e.globalAlpha,this.fillStyle=e.fillStyle,this.fillAlpha=e.fillAlpha*e.globalAlpha,this.shadowOffsetX=e.shadowOffsetX,this.shadowOffsetY=e.shadowOffsetY,this.shadowBlur=e.shadowBlur,this.shadowColor=e.shadowColor,this.lineCap=e.lineCap,this.lineJoin=e.lineJoin,this.miterLimit=e.miterLimit;var n=this;this.graphicsData.length&&_.each(this.graphicsData,(function(t,e){t.synsStyle(n)}))}},{key:"clone",value:function(){var e=new t;e.dirty=0;for(var n=0;n<this.graphicsData.length;++n)e.graphicsData.push(this.graphicsData[n].clone());return e.currentPath=e.graphicsData[e.graphicsData.length-1],e}},{key:"moveTo",value:function(t,e){var n=new be([t,e]);return n.closed=!1,this.drawShape(n),this}},{key:"lineTo",value:function(t,e){return this.currentPath?(this.currentPath.shape.points.push(t,e),this.dirty++):this.moveTo(0,0),this}},{key:"quadraticCurveTo",value:function(t,e,n,i){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var a=this.currentPath.shape.points,r=0,o=0;0===a.length&&this.moveTo(0,0);for(var l=a[a.length-2],s=a[a.length-1],u=1;u<=20;++u){var d=u/20;r=l+(t-l)*d,o=s+(e-s)*d,a.push(r+(t+(n-t)*d-r)*d,o+(e+(i-e)*d-o)*d)}return this.dirty++,this}},{key:"bezierCurveTo",value:function(t,e,n,i,a,r){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var o=this.currentPath.shape.points,l=o[o.length-2],s=o[o.length-1];return o.length-=2,function(t,e,n,i,a,r,o,l){var s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],u=0,d=0,h=0,f=0,c=0;s.push(t,e);for(var p=1,g=0;p<=20;++p)h=(d=(u=1-(g=p/20))*u)*u,c=(f=g*g)*g,s.push(h*t+3*d*g*n+3*u*f*a+c*o,h*e+3*d*g*i+3*u*f*r+c*l)}(l,s,t,e,n,i,a,r,o),this.dirty++,this}},{key:"arcTo",value:function(t,e,n,i,a){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var r=this.currentPath.shape.points,o=r[r.length-2],l=r[r.length-1]-e,s=o-t,u=i-e,d=n-t,h=Math.abs(l*d-s*u);if(h<1e-8||0===a)r[r.length-2]===t&&r[r.length-1]===e||r.push(t,e);else{var f=l*l+s*s,c=u*u+d*d,p=l*u+s*d,g=a*Math.sqrt(f)/h,y=a*Math.sqrt(c)/h,v=g*p/f,x=y*p/c,_=g*d+y*s,m=g*u+y*l,b=s*(y+v),w=l*(y+v),k=d*(g+x),S=u*(g+x),A=Math.atan2(w-m,b-_),P=Math.atan2(S-m,k-_);this.arc(_+t,m+e,a,A,P,s*u>d*l)}return this.dirty++,this}},{key:"arc",value:function(t,e,n,i,a){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(i===a)return this;!r&&a<=i?a+=2*Math.PI:r&&i<=a&&(i+=2*Math.PI);var o=a-i,l=48*Math.ceil(Math.abs(o)/(2*Math.PI));if(0===o)return this;var s=t+Math.cos(i)*n,u=e+Math.sin(i)*n,d=this.currentPath?this.currentPath.shape.points:null;d?d[d.length-2]===s&&d[d.length-1]===u||d.push(s,u):(this.moveTo(s,u),d=this.currentPath.shape.points);for(var h=o/(2*l),f=2*h,c=Math.cos(h),p=Math.sin(h),g=l-1,y=g%1/g,v=0;v<=g;++v){var x=h+i+f*(v+y*v),_=Math.cos(x),m=-Math.sin(x);d.push((c*_+p*m)*n+t,(c*-m+p*_)*n+e)}return this.dirty++,this}},{key:"drawRect",value:function(t,e,n,i){return this.drawShape(new xe(t,e,n,i)),this}},{key:"drawCircle",value:function(t,e,n){return this.drawShape(new _e(t,e,n)),this}},{key:"drawEllipse",value:function(t,e,n,i){return this.drawShape(new me(t,e,n,i)),this}},{key:"drawPolygon",value:function(t){var e=t,n=!0;if(e instanceof be&&(n=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var i=0;i<e.length;++i)e[i]=arguments[i]}var a=new be(e);return a.closed=n,this.drawShape(a),this}},{key:"clear",value:function(){return this.graphicsData.length>0&&(this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this}},{key:"drawShape",value:function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.beginPath();var e=new de(this.lineWidth,this.strokeStyle,this.strokeAlpha,this.fillStyle,this.fillAlpha,this.shadowOffsetX,this.shadowOffsetY,this.shadowBlur,this.shadowColor,this.lineCap,this.lineJoin,this.miterLimit,t);return this.graphicsData.push(e),e.type===Nt.POLY&&(e.shape.closed=e.shape.closed,this.currentPath=e),this.dirty++,e}},{key:"beginPath",value:function(){this.currentPath=null}},{key:"closePath",value:function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this}},{key:"updateLocalBounds",value:function(){var t=1/0,e=-1/0,n=1/0,i=-1/0;if(this.graphicsData.length)for(var a=0,r=0,o=0,l=0,s=0,u=0;u<this.graphicsData.length;u++){var d=this.graphicsData[u],h=d.type,f=d.lineWidth;if(a=d.shape,h===Nt.RECT||h===Nt.RREC)r=a.x-f/2,o=a.y-f/2,t=r<t?r:t,e=r+(l=a.width+f)>e?r+l:e,n=o<n?o:n,i=o+(s=a.height+f)>i?o+s:i;else if(h===Nt.CIRC)r=a.x,o=a.y,t=r-(l=a.radius+f/2)<t?r-l:t,e=r+l>e?r+l:e,n=o-(s=a.radius+f/2)<n?o-s:n,i=o+s>i?o+s:i;else if(h===Nt.ELIP)r=a.x,o=a.y,t=r-(l=a.width+f/2)<t?r-l:t,e=r+l>e?r+l:e,n=o-(s=a.height+f/2)<n?o-s:n,i=o+s>i?o+s:i;else for(var c=a.points,p=0,g=0,y=0,v=0,x=0,_=0,m=0,b=0,w=0;w+2<c.length;w+=2)r=c[w],o=c[w+1],p=c[w+2],g=c[w+3],y=Math.abs(p-r),v=Math.abs(g-o),s=f,(l=Math.sqrt(y*y+v*v))<1e-9||(t=(m=(p+r)/2)-(x=(s/l*v+y)/2)<t?m-x:t,e=m+x>e?m+x:e,n=(b=(g+o)/2)-(_=(s/l*y+v)/2)<n?b-_:n,i=b+_>i?b+_:i)}else t=0,e=0,n=0,i=0;return this.Bound={x:t,y:n,width:e-t,height:i-n},this}},{key:"getBound",value:function(){return this.updateLocalBounds().Bound}},{key:"destroy",value:function(t){for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();for(var n in this._webGL)for(var i=0;i<this._webGL[n].data.length;++i)this._webGL[n].data[i].destroy();this.graphicsData=null,this.currentPath=null,this._webGL=null}}]),t}();function ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Se=function(t){f(n,Gt);var e=ke(n);function n(t){var i;o(this,n);var a={cursor:(t=Y.checkOpt(t)).context.cursor||"default",fillAlpha:t.context.fillAlpha||1,fillStyle:t.context.fillStyle||null,lineCap:t.context.lineCap||"round",lineJoin:t.context.lineJoin||"round",miterLimit:t.context.miterLimit||null,strokeAlpha:t.context.strokeAlpha||1,strokeStyle:t.context.strokeStyle||null,lineType:t.context.lineType||"solid",lineDash:t.context.lineDash||[5,2],lineWidth:t.context.lineWidth||null,shadowOffsetX:t.context.shadowOffsetX||0,shadowOffsetY:t.context.shadowOffsetY||0,shadowBlur:t.context.shadowBlur||0,shadowColor:t.context.shadowColor||"#000000"},r=_.extend(!0,a,t.context);return t.context=r,void 0===t.id&&void 0!==t.type&&(t.id=Y.createId(t.type)),(i=e.call(this,t))._hoverClass=!1,i.hoverClone=!0,i.pointChkPriority=!0,i._eventEnabled=!1,i.dragEnabled=t.dragEnabled||!1,i._dragDuplicate=null,i.type=i.type||"shape",i.initCompProperty(t),i.isClone?i.graphics=null:(i.graphics=new we,i._draw(i.graphics)),i}return l(n,[{key:"_draw",value:function(t){0==t.graphicsData.length&&(t.setStyle(this.context),this.draw(t))}},{key:"draw",value:function(){}},{key:"clearGraphicsData",value:function(){this.graphics.clear()}},{key:"$watch",value:function(t,e,n){_.indexOf(jt,t)>-1&&this.graphics.setStyle(this.context),this.watch(t,e,n)}},{key:"initCompProperty",value:function(t){for(var e in t)"id"!=e&&"context"!=e&&(this[e]=t[e])}},{key:"getBound",value:function(){return this.graphics.updateLocalBounds().Bound}}]),n}();function Ae(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Pe=function(t){f(n,Gt);var e=Ae(n);function n(t,i){var a;return o(this,n),i.type="text",null==t&&(t=""),i.context=_.extend({font:"",fontSize:13,fontWeight:"normal",fontFamily:"微软雅黑,sans-serif",textBaseline:"top",textAlign:"left",textDecoration:null,fillStyle:"blank",strokeStyle:null,lineWidth:0,lineHeight:1.2,backgroundColor:null,textBackgroundColor:null},i.context),(a=e.call(this,i))._reNewline=/\r?\n/,a.fontProperts=["fontStyle","fontVariant","fontWeight","fontSize","fontFamily"],a.context.font=a._getFontDeclaration(),a.text=t.toString(),a.context.width=a.getTextWidth(),a.context.height=a.getTextHeight(),a}return l(n,[{key:"$watch",value:function(t,e,n){_.indexOf(this.fontProperts,t)>=0&&(this.context[t]=e,this.context.font=this._getFontDeclaration(),this.context.width=this.getTextWidth(),this.context.height=this.getTextHeight())}},{key:"_setContextStyle",value:function(t,e,n){for(var i in e)"textBaseline"!=i&&i in t&&(e[i]||_.isNumber(e[i]))&&("globalAlpha"==i?t.globalAlpha=n:t[i]=e[i])}},{key:"render",value:function(t,e){this._renderText(t,this._getTextLines(),e)}},{key:"resetText",value:function(t){this.text=t.toString(),this.heartBeat()}},{key:"getTextWidth",value:function(){var t=0;return Y._pixelCtx&&(Y._pixelCtx.save(),Y._pixelCtx.font=this.context.$model.font,t=this._getTextWidth(Y._pixelCtx,this._getTextLines()),Y._pixelCtx.restore()),t}},{key:"getTextHeight",value:function(){return this._getTextHeight(this._getTextLines())}},{key:"_getTextLines",value:function(){return this.text.split(this._reNewline)}},{key:"_renderText",value:function(t,e,n){t&&(t.save(),this._setContextStyle(t,this.context.$model,n),this._renderTextStroke(t,e),this._renderTextFill(t,e),t.restore())}},{key:"_getFontDeclaration",value:function(){var t=this,e=[];return _.each(this.fontProperts,(function(n){var i=t.context[n];"fontSize"==n&&(i=parseFloat(i)+"px"),i&&e.push(i)})),e.join(" ")}},{key:"_renderTextFill",value:function(t,e){if(this.context.$model.fillStyle){this._boundaries=[];for(var n=0,i=0,a=e.length;i<a;i++){n+=this._getHeightOfLine(t,i,e),this._renderTextLine("fillText",t,e[i],0,this._getTopOffset()+n,i)}}}},{key:"_renderTextStroke",value:function(t,e){if(t&&this.context.$model.strokeStyle&&this.context.$model.lineWidth){var n=0;t.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),supportsLineDash&&t.setLineDash(this.strokeDashArray)),t.beginPath();for(var i=0,a=e.length;i<a;i++){n+=this._getHeightOfLine(t,i,e),this._renderTextLine("strokeText",t,e[i],0,this._getTopOffset()+n,i)}t.closePath(),t.restore()}}},{key:"_renderTextLine",value:function(t,e,n,i,a,r){if(a-=this._getHeightOfLine()/4,"justify"===this.context.$model.textAlign){var o=e.measureText(n).width,l=this.context.$model.width;if(l>o)for(var s=n.split(/\s+/),u=(l-e.measureText(n.replace(/\s+/g,"")).width)/(s.length-1),d=0,h=0,f=s.length;h<f;h++)this._renderChars(t,e,s[h],i+d,a,r),d+=e.measureText(s[h]).width+u;else this._renderChars(t,e,n,i,a,r)}else this._renderChars(t,e,n,i,a,r)}},{key:"_renderChars",value:function(t,e,n,i,a){e[t](n,0,a)}},{key:"_getHeightOfLine",value:function(){return this.context.$model.fontSize*this.context.$model.lineHeight}},{key:"_getTextWidth",value:function(t,e){for(var n=t.measureText(e[0]||"|").width,i=1,a=e.length;i<a;i++){var r=t.measureText(e[i]).width;r>n&&(n=r)}return n}},{key:"_getTextHeight",value:function(t){return this.context.$model.fontSize*t.length*this.context.$model.lineHeight}},{key:"_getTopOffset",value:function(){var t=0;switch(this.context.$model.textBaseline){case"top":t=0;break;case"middle":t=-this.context.$model.height/2;break;case"bottom":t=-this.context.$model.height}return t}},{key:"getRect",value:function(){var t=this.context,e=0,n=0;return"center"==t.textAlign&&(e=-t.width/2),"right"==t.textAlign&&(e=-t.width),"middle"==t.textBaseline&&(n=-t.height/2),"bottom"==t.textBaseline&&(n=-t.height),{x:e,y:n,width:t.width,height:t.height}}}]),n}();function Ce(t,e){var n=0,i=0;if(1==arguments.length&&_.isObject(t)){var a=arguments[0];_.isArray(a)?(n=a[0],i=a[1]):a.hasOwnProperty("x")&&a.hasOwnProperty("y")&&(n=a.x,i=a.y)}this._axes=[n,i]}function De(t,e,n,i,a,r,o,l){(isNaN(l)||null==l)&&(l=.25);var s=(n-t)*l,u=(i-e)*l;return(2*(e-n)+s+u)*o+(-3*(e-n)-2*s-u)*r+s*a+e}Ce.prototype={distance:function(t){var e=this._axes[0]-t._axes[0],n=this._axes[1]-t._axes[1];return Math.sqrt(e*e+n*n)}};var Oe={sin:{},cos:{}},Te=Math.PI/180;function Me(t,e,n){var i={points:t,curvature:n};_.isFunction(e)&&(i.smoothFilter=e);var a=function(t){var e=t.points,n=t.isLoop,i=t.smoothFilter,a=t.curvature,r=e.length;if(1==r)return e;for(var o=[],l=0,s=new Ce(e[0]),u=null,d=1;d<r;d++)u=new Ce(e[d]),l+=s.distance(u),s=u;s=null,u=null;var h=l/6;for(h=h<r?r:h,d=0;d<h;d++){var f,c,p,g=d/(h-1)*(n?r:r-1),y=Math.floor(g),v=g-y,x=e[y%r];n?(f=e[(y-1+r)%r],c=e[(y+1)%r],p=e[(y+2)%r]):(f=e[0===y?y:y-1],c=e[y>r-2?r-1:y+1],p=e[y>r-3?r-1:y+2]);var m=v*v,b=v*m,w=[De(f[0],x[0],c[0],p[0],v,m,b,a),De(f[1],x[1],c[1],p[1],v,m,b,a)];_.isFunction(i)&&i(w),o.push(w)}return o}(i);return t&&t.length>0&&a.push(t[t.length-1]),a}function Ee(t){return!t||_.isArray(t)&&t.length>=2&&(!_.isNumber(t[0])||!_.isNumber(t[1]))||"x"in t&&!_.isNumber(t.x)||"y"in t&&!_.isNumber(t.y)}var Re={PI:Math.PI,sin:function(t,e){return t=(e?t*Te:t).toFixed(4),void 0===Oe.sin[t]&&(Oe.sin[t]=Math.sin(t)),Oe.sin[t]},cos:function(t,e){return t=(e?t*Te:t).toFixed(4),void 0===Oe.cos[t]&&(Oe.cos[t]=Math.cos(t)),Oe.cos[t]},degreeToRadian:function(t){return t*Te},radianToDegree:function(t){return t/Te},degreeTo360:function(t){var e=(360+t%360)%360;return 0==e&&0!==t&&(e=360),e},getIsgonPointList:function(t,e){for(var n=[],i=2*Math.PI/t,a=-Math.PI/2,r=0,o=t;r<o;r++)n.push([e*Math.cos(a),e*Math.sin(a)]),a+=i;return n},getSmoothPointList:function(t,e,n){var i=[],a=t.length,r=[];return _.each(t,(function(t,o){Ee(t)?(r.length&&(i=i.concat(Me(r,e,n)),r=[]),i.push(t)):r.push(t),o==a-1&&r.length&&(i=i.concat(Me(r,e,n)),r=[])})),i},isNotValibPoint:Ee,isValibPoint:function(t){return!Ee(t)}};function Ie(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Le=Math.min,Fe=Math.max,Ne=function(t){f(n,Se);var e=Ie(n);function n(t){o(this,n),t=Y.checkOpt(t);var i=_.extend(!0,{lineType:null,smooth:!1,smoothMonotone:"none",pointList:[]},t.context);return!0!==i.smooth&&"true"!==i.smooth||(i.smooth=.5),t.context=i,t.type="brokenline",e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){["pointList","smooth","lineType","smoothMonotone"].indexOf(t)>-1&&(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.pointList;return this.drawGraphics(t,e,this.context.smooth,this.context.smoothMonotone),this}},{key:"drawGraphics",value:function(t){for(var e,n,i,a,r,o,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,d=l.length,h=0,f=!1,c=0;c<d;c++){var p=l[h];if(Re.isValibPoint(p)){var g=p[0],y=p[1];if(f){var v=g-e,x=y-n;if(v*v+x*x<.5){h+=1;continue}if(s>0){for(var _=h+1,m=l[_],b=m?m[0]:null,w=m?m[1]:null;b===g&&w===y&&c<d;)c++,h+=1,b=(m=l[_+=1])?m[0]:null,w=m?m[1]:null,v=(g=l[h][0])-e,x=(y=l[h][1])-n;var k=.5,S=0,A=0,P=void 0,C=void 0;if(c+1>=d||!Re.isValibPoint({x:b,y:w}))r=g,o=y;else{S=b-e,A=w-n;var D=g-e,O=b-g,T=y-n,M=w-y,E=void 0,R=void 0;if("x"===u){var I=S>0?1:-1;r=g-I*(E=Math.abs(D))*s,o=y,P=g+I*(R=Math.abs(O))*s,C=y}else if("y"===u){var L=A>0?1:-1;r=g,o=y-L*(E=Math.abs(T))*s,P=g,C=y+L*(R=Math.abs(M))*s}else E=Math.sqrt(D*D+T*T),r=g-S*s*(1-(k=(R=Math.sqrt(O*O+M*M))/(R+E))),o=y-A*s*(1-k),C=y+A*s*k,P=Le(P=g+S*s*k,Fe(b,g)),C=Le(C,Fe(w,y)),P=Fe(P,Le(b,g)),o=y-(A=(C=Fe(C,Le(w,y)))-y)*E/R,r=Le(r=g-(S=P-g)*E/R,Fe(e,g)),o=Le(o,Fe(n,y)),P=g+(S=g-(r=Fe(r,Le(e,g))))*R/E,C=y+(A=y-(o=Fe(o,Le(n,y))))*R/E}t.bezierCurveTo(i,a,r,o,g,y),i=P,a=C}else t.lineTo(g,y)}else t.moveTo(g,y),i=g,a=y;e=g,n=y,h+=1,f=!0}else h+=1,f=!1}return c}}]),n}();function Be(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var je=function(t){f(n,Se);var e=Be(n);function n(t){return o(this,n),t=_.extend(!0,{type:"circle",xyToInt:!1,context:{r:0}},Y.checkOpt(t)),e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){"r"==t&&(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.$model.r;e<0&&(e=0),t.drawCircle(0,0,e)}}]),n}();function ze(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var We=function(t){f(n,Se);var e=ze(n);function n(t){o(this,n);var i=_.extend(!0,{pointList:[],path:""},t.context);return t.context=i,t.__parsePathData=null,t.type="path",e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){"path"==t&&(this.graphics.clear(),this.draw(this.graphics))}},{key:"_parsePathData",value:function(t){if(this.__parsePathData)return this.__parsePathData;if(!t)return[];this.__parsePathData=[];var e=_.compact(t.replace(/[Mm]/g,"\\r$&").split("\\r")),n=this;return _.each(e,(function(t){n.__parsePathData.push(n._parseChildPathData(t))})),this.__parsePathData}},{key:"_parseChildPathData",value:function(t){var e,n=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];for(n=(n=(n=(n=n.replace(/  /g," ")).replace(/ /g,",")).replace(/(\d)-/g,"$1,-")).replace(/,,/g,","),e=0;e<i.length;e++)n=n.replace(new RegExp(i[e],"g"),"|"+i[e]);var a=n.split("|"),r=[],o=0,l=0;for(e=1;e<a.length;e++){var s=a[e],u=s.charAt(0),d=(s=(s=s.slice(1)).replace(new RegExp("e,-","g"),"e-")).split(",");d.length>0&&""===d[0]&&d.shift();for(var h=0;h<d.length;h++)d[h]=parseFloat(d[h]);for(;d.length>0&&!isNaN(d[0]);){var f,c,p,g=null,y=[],v=o,x=l;switch(u){case"l":o+=d.shift(),l+=d.shift(),g="L",y.push(o,l);break;case"L":o=d.shift(),l=d.shift(),y.push(o,l);break;case"m":o+=d.shift(),l+=d.shift(),g="M",y.push(o,l),u="l";break;case"M":o=d.shift(),l=d.shift(),g="M",y.push(o,l),u="L";break;case"h":o+=d.shift(),g="L",y.push(o,l);break;case"H":o=d.shift(),g="L",y.push(o,l);break;case"v":l+=d.shift(),g="L",y.push(o,l);break;case"V":l=d.shift(),g="L",y.push(o,l);break;case"C":y.push(d.shift(),d.shift(),d.shift(),d.shift()),o=d.shift(),l=d.shift(),y.push(o,l);break;case"c":y.push(o+d.shift(),l+d.shift(),o+d.shift(),l+d.shift()),o+=d.shift(),l+=d.shift(),g="C",y.push(o,l);break;case"S":f=o,c=l,"C"===(p=r[r.length-1]).command&&(f=o+(o-p.points[2]),c=l+(l-p.points[3])),y.push(f,c,d.shift(),d.shift()),o=d.shift(),l=d.shift(),g="C",y.push(o,l);break;case"s":f=o,c=l,"C"===(p=r[r.length-1]).command&&(f=o+(o-p.points[2]),c=l+(l-p.points[3])),y.push(f,c,o+d.shift(),l+d.shift()),o+=d.shift(),l+=d.shift(),g="C",y.push(o,l);break;case"Q":y.push(d.shift(),d.shift()),o=d.shift(),l=d.shift(),y.push(o,l);break;case"q":y.push(o+d.shift(),l+d.shift()),o+=d.shift(),l+=d.shift(),g="Q",y.push(o,l);break;case"T":f=o,c=l,"Q"===(p=r[r.length-1]).command&&(f=o+(o-p.points[0]),c=l+(l-p.points[1])),o=d.shift(),l=d.shift(),g="Q",y.push(f,c,o,l);break;case"t":f=o,c=l,"Q"===(p=r[r.length-1]).command&&(f=o+(o-p.points[0]),c=l+(l-p.points[1])),o+=d.shift(),l+=d.shift(),g="Q",y.push(f,c,o,l);break;case"A":v=o,x=l,g="A",y=[d.shift(),d.shift(),d.shift(),d.shift(),d.shift(),o=d.shift(),l=d.shift(),v,x];break;case"a":v=o,x=l,g="A",y=[d.shift(),d.shift(),d.shift(),d.shift(),d.shift(),o+=d.shift(),l+=d.shift(),v,x]}r.push({command:g||u,points:y})}"z"!==u&&"Z"!==u||r.push({command:"z",points:[]})}return r}},{key:"draw",value:function(t){this.__parsePathData=null,this.context.$model.pointList=[];for(var e=this._parsePathData(this.context.$model.path),n=0,i=e.length;n<i;n++)for(var a=0,r=e[n].length;a<r;a++){var o=e[n][a].command,l=e[n][a].points;switch(o){case"L":t.lineTo(l[0],l[1]);break;case"M":t.moveTo(l[0],l[1]);break;case"C":t.bezierCurveTo(l[0],l[1],l[2],l[3],l[4],l[5]);break;case"Q":t.quadraticCurveTo(l[0],l[1],l[2],l[3]);break;case"A":ve(t,l[7],l[8],l);break;case"z":t.closePath()}}return this}}]),n}();function Ve(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Ge=function(t){f(n,We);var e=Ve(n);function n(t){var i;o(this,n),t=_.extend(!0,{type:"droplet",context:{hr:0,vr:0}},Y.checkOpt(t));i=e.call(this,t);return i.context.$model.path=i.createPath(),i}return l(n,[{key:"watch",value:function(t,e,n){"hr"!=t&&"vr"!=t||(this.context.$model.path=this.createPath())}},{key:"createPath",value:function(){var t=this.context.$model,e="M 0 "+t.hr+" C "+t.hr+" "+t.hr+" "+3*t.hr/2+" "+-t.hr/3+" 0 "+-t.vr;return e+=" C "+3*-t.hr/2+" "+-t.hr/3+" "+-t.hr+" "+t.hr+" 0 "+t.hr+"z"}}]),n}();function He(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Ye=function(t){f(n,Se);var e=He(n);function n(t){return o(this,n),t=_.extend(!0,{type:"ellipse",context:{hr:0,vr:0}},Y.checkOpt(t)),e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){"hr"!=t&&"vr"!=t||(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){t.drawEllipse(0,0,2*this.context.$model.hr,2*this.context.$model.vr)}}]),n}();function Xe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Ue=function(t){f(n,Se);var e=Xe(n);function n(t){o(this,n);var i=_.extend(!0,{lineType:null,smooth:!1,pointList:[],smoothFilter:Y.__emptyFunc},t.context);if(!t.isClone){i.pointList[0];var a=i.pointList.slice(-1)[0];i.smooth&&(i.pointList.unshift(a),i.pointList=Re.getSmoothPointList(i.pointList))}return t.context=i,t.type="polygon",e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){"pointList"!=t&&"smooth"!=t&&"lineType"!=t||(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.pointList;if(!(e.length<2)){t.moveTo(e[0][0],e[0][1]);for(var n=1,i=e.length;n<i;n++)t.lineTo(e[n][0],e[n][1]);t.closePath()}}}]),n}();function qe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var $e=function(t){f(n,Ue);var e=qe(n);function n(t){o(this,n);var i=_.extend(!0,{pointList:[],r:0,n:0},t.context);return i.pointList=Re.getIsgonPointList(i.n,i.r),t.context=i,t.type="isogon",e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){"r"!=t&&"n"!=t||(this.context.$model.pointList=Re.getIsgonPointList(this.context.$model.n,this.context.$model.r)),"pointList"!=t&&"smooth"!=t&&"lineType"!=t||this.graphics.clear()}}]),n}();function Je(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Ze=function(t){f(n,Se);var e=Je(n);function n(t){o(this,n);var i=_.extend(!0,{start:{x:0,y:0},end:{x:0,y:0}},t.context);return t.context=i,t.type="line",e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){"x"!=t&&"y"!=t||(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.$model;return t.moveTo(e.start.x,e.start.y),t.lineTo(e.end.x,e.end.y),this}}]),n}();function Qe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var Ke=function(t){f(n,Se);var e=Qe(n);function n(t){o(this,n);var i=_.extend(!0,{width:0,height:0,radius:[]},t.context);return t.context=i,t.type="rect",e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){"width"!=t&&"height"!=t&&"radius"!=t||(this.graphics.clear(),this.draw(this.graphics))}},{key:"_buildRadiusPath",value:function(t){var e=this.context.$model,n=e.width,i=e.height,a=Y.getCssOrderArr(e.radius),r=t,o=1;i>=0&&(o=-1),r.moveTo(parseInt(0+a[0]),parseInt(i)),r.lineTo(parseInt(0+n-a[1]),parseInt(i)),0!==a[1]&&r.quadraticCurveTo(0+n,i,parseInt(0+n),parseInt(i+a[1]*o)),r.lineTo(parseInt(0+n),parseInt(0-a[2]*o)),0!==a[2]&&r.quadraticCurveTo(0+n,0,parseInt(0+n-a[2]),parseInt(0)),r.lineTo(parseInt(0+a[3]),parseInt(0)),0!==a[3]&&r.quadraticCurveTo(0,0,parseInt(0),parseInt(0-a[3]*o)),r.lineTo(parseInt(0),parseInt(0+i+a[0]*o)),0!==a[0]&&r.quadraticCurveTo(0,0+i,parseInt(0+a[0]),parseInt(0+i))}},{key:"draw",value:function(t){var e=this.context.$model;e.radius.length?this._buildRadiusPath(t):t.drawRect(0,0,e.width,e.height),t.closePath()}}]),n}();function tn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var en=function(t){f(n,Se);var e=tn(n);function n(t){o(this,n);var i=_.extend(!0,{pointList:[],r0:0,r:0,startAngle:0,endAngle:0,clockwise:!1},t.context);return t.context=i,t.regAngle=[],t.isRing=!1,t.type="sector",e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){"r0"!=t&&"r"!=t&&"startAngle"!=t&&"endAngle"!=t&&"clockwise"!=t||(this.isRing=!1,this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.$model,n=void 0===e.r0?0:e.r0,i=e.r,a=Re.degreeTo360(e.startAngle),r=Re.degreeTo360(e.endAngle);e.startAngle!=e.endAngle&&Math.abs(e.startAngle-e.endAngle)%360==0&&(this.isRing=!0,a=0,r=360),a=Re.degreeToRadian(a),r=Re.degreeToRadian(r);var o=t;this.isRing?0==e.r0?o.drawCircle(0,0,e.r):(e.fillStyle&&e.fillAlpha&&(o.beginPath(),o.arc(0,0,i,a,r,e.clockwise),0==e.r0?o.lineTo(0,0):o.arc(0,0,n,r,a,!e.clockwise),o.closePath(),o.currentPath.lineWidth=0,o.currentPath.strokeStyle=null,o.currentPath.strokeAlpha=0,o.currentPath.line=!1),e.lineWidth&&e.strokeStyle&&e.strokeAlpha&&(o.beginPath(),o.arc(0,0,i,a,r,e.clockwise),o.closePath(),o.currentPath.fillStyle=null,o.currentPath.fill=!1,o.beginPath(),o.arc(0,0,n,r,a,!e.clockwise),o.closePath(),o.currentPath.fillStyle=null,o.currentPath.fill=!1)):(o.beginPath(),o.arc(0,0,i,a,r,e.clockwise),0==e.r0?o.lineTo(0,0):o.arc(0,0,n,r,a,!e.clockwise),o.closePath())}}]),n}();function nn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var an=function(t){f(n,Se);var e=nn(n);function n(t){o(this,n);var i=_.extend(!0,{control:{x:0,y:0},point:{x:0,y:0},angle:null,theta:30,headlen:6,lineWidth:1,strokeStyle:"#666",fillStyle:null},t.context);return t.context=i,t.type="arrow",e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){"x"!=t&&"y"!=t&&"theta"!=t&&"headlen"!=t&&"angle"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model,n=e.control.x,i=e.control.y,a=e.point.x,r=e.point.y,o=null!=e.angle?e.angle-180:180*Math.atan2(i-r,n-a)/Math.PI,l=(o+e.theta)*Math.PI/180,s=(o-e.theta)*Math.PI/180,u=e.headlen*Math.cos(l),d=e.headlen*Math.sin(l),h=e.headlen*Math.cos(s),f=e.headlen*Math.sin(s),c=a+u,p=r+d;return t.moveTo(c,p),t.lineTo(a,r),t.lineTo(a+h,r+f),e.fillStyle&&(t.lineTo(c,p),t.closePath()),this}}]),n}();function rn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(e){var a=x(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return y(this,n)}}var on=function(t){f(n,Se);var e=rn(n);function n(t){o(this,n);var i=_.extend(!0,{innerRect:{width:0,height:0},includedAngle:60},t.context);return t.context=i,t.type="diamond",e.call(this,t)}return l(n,[{key:"watch",value:function(t,e,n){["includedAngle"].indexOf(t)>-1&&(this.graphics.clear(),this.draw(this.graphics))}},{key:"draw",value:function(t){var e=this.context.$model,n=e.innerRect,i=e.includedAngle/2*Math.PI/180,a=n.height/Math.tan(i),r=n.width*Math.tan(i),o=n.width+a,l=n.height+r;return t.moveTo(0,l/2),t.lineTo(o/2,0),t.lineTo(0,-l/2),t.lineTo(-o/2,0),t.lineTo(0,l/2),t.closePath(),this}}]),n}(),ln={version:"2.0.86",_:_,$:H,event:et,App:le};ln.Display={DisplayObject:Gt,DisplayObjectContainer:Yt,Stage:Ut,Sprite:ue,Shape:Se,Point:at,Text:Pe},ln.Shapes={BrokenLine:Ne,Circle:je,Droplet:Ge,Ellipse:Ye,Isogon:$e,Line:Ze,Path:We,Polygon:Ue,Rect:Ke,Sector:en,Arrow:an,Diamond:on},ln.AnimationFrame=Mt,ln.utils=Y;var sn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={_eval:function(t,e,n,i){return n?new Function(n,t+"; return ".concat(e,";"))(i):new Function(t+"; return ".concat(e,";"))()},parse:function(t,e,n,i){try{if(!(e&&e.length&&2===e.length&&e[1]>e[0]))return this._eval(t,"options");var a=this._eval(t,"variables");"function"==typeof a&&(a=a(n)||{});var r={};void 0!==i&&(r="function"==typeof i?i(n):i),r=ln._.extend(!0,{},a,r);var o=t.slice(0,e[0])+t.slice(e[1]);return this._eval(o,"options","variables",r)}catch(t){return{}}}};e.default=n}));e(sn);var un=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={padding:20}}));e(un);var dn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(ln),a=i(sn),r=i(un),o=n.default._,l=n.default.$,s=n.default.AnimationFrame,u=["#ff8533","#73ace6","#82d982","#e673ac","#cd6bed","#8282d9","#c0e650","#e6ac73","#6bcded","#73e6ac","#ed6bcd","#9966cc"],d={},h={chartxVersion:"1.1.142",create:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=null,r=this,o=function(){r.instances[a.id]=null,delete r.instances[a.id]},s=t.id||l.query(t).getAttribute("chart_id");if(null!=s){var u=r.instances[s];u&&(u.destroy(),u.off&&u.off("destroy",o)),delete r.instances[s]}var d=r._getComponentModules(),h=r._getComponentModule("chart");return(a=new h(t,e,this._optionsHandle(n),d,i))&&(a.draw(),r.instances[a.id]=a,a.on("destroy",o)),a},setGlobalTheme:function(t){u=t},getGlobalTheme:function(){return u},parse:a.default,instances:{},getChart:function(t){return this.instances[t]},resize:function(){for(var t in this.instances)this.instances[t].resize()},getOptionsOld:function(t){var e,n="[[JSON_FUN_PREFIX_",i="_JSON_FUN_SUFFIX]]";return e=decodeURIComponent(this.options[t]||"%7B%7D"),JSON.parse(e,(function(t,e){return"string"==typeof e&&e.indexOf(i)>0&&0==e.indexOf(n)?new Function("return "+e.replace(n,"").replace(i,""))():e}))||{}},getOptionsNew:function(t,e,n){var i=this.options[t],r=decodeURIComponent(i.code),o=i.range;return a.default.parse(r,o,e,n)},getOptions:function(t,e,n,i){if(!this.options[t])return e||{};var a="string"==typeof this.options[t]?this.getOptionsOld(t):this.getOptionsNew(t,n||[],i||{});return e&&(a=o.extend(!0,a,e)),this._optionsHandle(a)},_optionsHandle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var e in t){var n=t[e];if(Array.isArray(n)){for(var i=0,a=n.length;i<a;i++){n[i]||(n.splice(i,1),i--,a--)}n.length||delete t[e]}else n||delete t[e]}return t},calculateOptions:function(t,e,n){return this.getOptions(t,void 0,e,n)},_getComponentModules:function(){var t=d;return t.modules||(t.modules={}),t.get||(t.get=function(e,n){n||(n="empty"),e=e.toLowerCase(),n=n.toLowerCase();var i=t.modules[e];if(i&&i[n])return i[n]}),t},registerComponent:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"empty",i=this._getComponentModules().modules;e=e.toLowerCase(),n=n.toLowerCase();var a=i[e];return a||(a=i[e]={}),a[n]||(a[n]=t),i},_getComponentModule:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"empty";t=t.toLowerCase(),e=e.toLowerCase();var n=this._getComponentModules().modules[t];return n?n[e]:void 0},setAnimationEnabled:function(t){return s.setAnimationEnabled(t)},getAnimationEnabled:function(t){return s.getAnimationEnabled()},layout:{},registerLayout:function(t,e){this.layout[t]=e},props:{},getProps:function(){var t={},e=this._getComponentModules().modules,n=function(n){if("chart"==n)return"continue";t[n]={detail:n,propertys:{}};var i=void 0;"graphs"==n&&(i=o.map(e.graphs,(function(t,e){return e})),t.graphs.documentation="可选的graphs类型有：\n"+i.join("\n"));var a={},r=null;for(var l in e[n]){if(r)break;r=e[n][l].prototype}!function t(e){var n=e.constructor.__proto__;if(n._isComponentRoot||t(n.prototype),n.defaultProps&&o.isFunction(n.defaultProps)){var i=n.defaultProps();o.extend(a,i)}}(r),t[n].propertys=o.extend(a,t[n].propertys);var s=function(r){var l=e[n][r],s=l.defaultProps?l.defaultProps():{};!function t(e){if(e._props){var n=o.isArray(e._props);for(var i in e._props){n||(e[i]={detail:i,propertys:{}});var a=e._props[i];a.defaultProps&&function(){var r=a.defaultProps(),l={};!function e(n){if(n.__proto__.__proto__&&e(n.__proto__),n.defaultProps&&o.isFunction(n.defaultProps)){var i=n.defaultProps();i._props&&t(i),i&&o.extend(l,i)}}(a.__proto__),r=o.extend(l,r),n?o.extend(e,r):(e[i].propertys=r,t(e[i].propertys))}()}}}(s),s=o.extend({},a,s),a.type?(t[n].typeMap||(t[n].typeMap={}),"graphs"==n&&(s.type.values=i,s.type.documentation="可选的graphs类型有：\n"+i.join("\n")),t[n].typeMap[r]=s):o.extend(t[n].propertys,s)};for(var u in e[n])s(u)};for(var i in e)n(i);return this.props=t,this.props},setPadding:function(t){r.default.padding=t},canvax:n.default};e.default=h}));e(dn);var hn=n((function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports}));e(hn);var fn=n((function(t){function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports}));e(fn);var cn=n((function(t){function e(n,i){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}));e(cn);var pn=n((function(t){t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cn(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports}));e(pn);var gn=n((function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}));e(gn);var yn=n((function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports}));e(yn);var vn=n((function(t){var e=gn.default;t.exports=function(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return yn(t)},t.exports.__esModule=!0,t.exports.default=t.exports}));e(vn);var xn=n((function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}));e(xn);var _n=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n={length:0,org:[],jsonOrg:[],data:[],getRowDataAt:r,getRowDataOf:function(t){!t&&(t={});var e=[],i=0;for(var a in t)i++;if(i)for(var o=function(a){var o=0;ln._.each(n.data,(function(e){e.field in t&&e.data[a]==t[e.field]&&o++})),o==i&&e.push(r(a))},l=n.range.start;l<=n.range.end;l++)o(l);return e},getFieldData:function(t){var e=[],i=ln._.find(n.data,(function(e){return e.field==t}));return i&&(e=i.data),e},getDataOrg:function t(e,n,i,r){r||(r=0);var o=i||a();if(!o)return;n||(n=function(t){return t});function l(t){for(var e=0,i=t.length;e<i;e++)t[e]=n(t[e]);return t}ln._.isArray(e)||(e=[e]);for(var s=[],u=0,d=e.length;u<d;u++)if(ln._.isArray(e[u]))s.push(t(e[u],n,i,r+1));else{var h=s;r||(h=[]);for(var f=0,c=o.length;f<c;f++)if(e[u]==o[f].field){h.push(l(o[f].data));break}r||s.push(h)}return s},resetData:function(t){if(t){n.org=[],n.jsonOrg=[],n.fields=[],n.data=[];var r=ln._.extend(!0,{},n.range),o=n.length;i(t),n.data=a(),0!==o&&e&&e.dataZoom&&e.dataZoom.range&&(ln._.extend(!0,n.range,r),n.range.end>n.length-1&&(n.range.end=n.length-1),(n.range.start>n.length-1||n.range.start>n.range.end)&&(n.range.start=0))}else n.data=a()},fields:[],range:{start:0,end:0},filters:{}};function i(t){if(Array.isArray(t)||(t=[t]),!t||0==t.length)return n;if(t.length>0&&!ln._.isArray(t[0])?(n.jsonOrg=t,t=function(t){null==t&&(t=[]);if(t.length>0&&!ln._.isArray(t[0])){for(var e=[],n=[],i=0,a=0,r=t.length;a<r;a++){var o=t[a];if(0==a){for(var l in o)n.push(l);e.push(n),i=n.length}for(var s=[],u=0;u<i;u++)s.push(o[n[u]]);e.push(s)}return e}return t}(t),n.org=t):(n.org=t,n.jsonOrg=function(t){var e=t;if(t.length>0&&ln._.isArray(t[0])){e=[];for(var n=t[0],i=n.length,a=1,r=t.length;a<r;a++){for(var o={},l=0;l<i;l++)o[n[l]]=t[a][l];e.push(o)}return e}}(t)),n.range.end=t.length-1-1,e){var i=e.dataZoom||e.datazoom;i&&i.range&&ln._.extend(n.range,i.range)}if(t.length&&t[0].length&&!~t[0].indexOf("__index__"))for(var a=0,r=t.length;a<r;a++)a?(t[a].push(a-1),n.jsonOrg[a-1].__index__=a-1):t[0].push("__index__");return n.fields=t[0]?t[0]:[],n}function a(){for(var t=[],i=0,a=n.fields.length;i<a;i++){var r={};r.field=n.fields[i],r.index=i,r.data=[],t.push(r)}var o,l,s=(o=function(i){ln._.each(n.fields,(function(n){var a=i[n];e&&e.coord&&(e.coord.xAxis&&n==e.coord.xAxis.field&&"proportion"!=e.coord.xAxis.layoutType||e.coord.aAxis&&n==e.coord.aAxis.field)||isNaN(a)||""===a||null===a||(a=Number(a));var r=ln._.find(t,(function(t){return t.field==n}));r&&r.data.push(a)}))},l=[],ln._.each(n.jsonOrg.slice(n.range.start,n.range.end+1),(function(t){var e=!0;ln._.keys(n.filters).length&&ln._.each(n.filters,(function(n){if(ln._.isFunction(n)&&!n(t))return e=!1,!1})),e&&(o&&o(t),l.push(t))})),l);return n.length=s.length,t}function r(t){for(var e={},i=n.data,a=0;a<i.length;a++)e[i[a].field]=i[a].data[t];return e}return i(t),n.data=a(),n}}));e(_n);var mn=n((function(t){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports}));e(mn);var bn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaultProps=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var i in e)i.indexOf("_")&&(e[i]&&e[i].propertys?(n[i]={},t(e[i].propertys,n[i])):!ln._.isObject(e[i])||ln._.isFunction(e[i])||ln._.isArray(e[i])?n[i]=e[i]:n[i]=e[i].default);return n},e.getDisMinATArr=function(t,e){for(var n=0,i=Math.abs(t-e[0]),a=1,r=e.length;a<r;a++)i>Math.abs(t-e[a])&&(i=Math.abs(t-e[a]),n=a);return n}}));e(bn);bn.getDefaultProps,bn.getDisMinATArr;var wn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(dn),d=i(ln);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default.event,c=d.default._,p=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),o=e.call(this,t,a),c.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.name="component",o.type=null,o._opt=t,o.app=a,o.width=0,o.height=0,o.pos={x:0,y:0},o.margin={top:0,right:0,bottom:0,left:0},o.__cid=d.default.utils.createId("comp_"),o.ctx=a.stage.ctx||a.stage.canvas.getContext("2d"),o}return(0,a.default)(i,[{key:"init",value:function(t,e){}},{key:"draw",value:function(){}},{key:"destroy",value:function(){}},{key:"reset",value:function(){}},{key:"setPosition",value:function(t){!t&&(t=this.pos),t.x&&(this.sprite.context.x=t.x),t.y&&(this.sprite.context.y=t.y)}},{key:"layout",value:function(){}}],[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启该组件",default:!1}}}},{key:"registerComponent",value:function(t,e,n){return u.default.registerComponent(t,e,n)}},{key:"_isComponentRoot",value:function(){return!0}},{key:"polyfill",value:function(t){return t}}]),i}(f.Dispatcher);e.default=p}));e(wn);var kn=n((function(e){
/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */
!function(t,n){e.exports?e.exports=n():t.numeral=n()}(t,(function(){var t,e,n={},i={},a={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},r={currentLocale:a.currentLocale,zeroFormat:a.zeroFormat,nullFormat:a.nullFormat,defaultFormat:a.defaultFormat,scalePercentBy100:a.scalePercentBy100};function o(t,e){this._input=t,this._value=e}return(t=function(i){var a,l,s,u;if(t.isNumeral(i))a=i.value();else if(0===i||void 0===i)a=0;else if(null===i||e.isNaN(i))a=null;else if("string"==typeof i)if(r.zeroFormat&&i===r.zeroFormat)a=0;else if(r.nullFormat&&i===r.nullFormat||!i.replace(/[^0-9]+/g,"").length)a=null;else{for(l in n)if((u="function"==typeof n[l].regexps.unformat?n[l].regexps.unformat():n[l].regexps.unformat)&&i.match(u)){s=n[l].unformat;break}a=(s=s||t._.stringToNumber)(i)}else a=Number(i)||null;return new o(i,a)}).version="2.0.6",t.isNumeral=function(t){return t instanceof o},t._=e={numberToFormat:function(e,n,a){var r,o,l,s,u,d,h,f,c=i[t.options.currentLocale],p=!1,g=!1,y="",v=1e12,x=1e9,_=1e6,m="",b=!1;if(e=e||0,l=Math.abs(e),t._.includes(n,"(")?(p=!0,n=n.replace(/[\(|\)]/g,"")):(t._.includes(n,"+")||t._.includes(n,"-"))&&(d=t._.includes(n,"+")?n.indexOf("+"):e<0?n.indexOf("-"):-1,n=n.replace(/[\+|\-]/g,"")),t._.includes(n,"a")&&(o=!!(o=n.match(/a(k|m|b|t)?/))&&o[1],t._.includes(n," a")&&(y=" "),n=n.replace(new RegExp(y+"a[kmbt]?"),""),l>=v&&!o||"t"===o?(y+=c.abbreviations.trillion,e/=v):l<v&&l>=x&&!o||"b"===o?(y+=c.abbreviations.billion,e/=x):l<x&&l>=_&&!o||"m"===o?(y+=c.abbreviations.million,e/=_):(l<_&&l>=1e3&&!o||"k"===o)&&(y+=c.abbreviations.thousand,e/=1e3)),t._.includes(n,"[.]")&&(g=!0,n=n.replace("[.]",".")),s=e.toString().split(".")[0],u=n.split(".")[1],h=n.indexOf(","),r=(n.split(".")[0].split(",")[0].match(/0/g)||[]).length,u?(t._.includes(u,"[")?(u=(u=u.replace("]","")).split("["),m=t._.toFixed(e,u[0].length+u[1].length,a,u[1].length)):m=t._.toFixed(e,u.length,a),s=m.split(".")[0],m=t._.includes(m,".")?c.delimiters.decimal+m.split(".")[1]:"",g&&0===Number(m.slice(1))&&(m="")):s=t._.toFixed(e,0,a),y&&!o&&Number(s)>=1e3&&y!==c.abbreviations.trillion)switch(s=String(Number(s)/1e3),y){case c.abbreviations.thousand:y=c.abbreviations.million;break;case c.abbreviations.million:y=c.abbreviations.billion;break;case c.abbreviations.billion:y=c.abbreviations.trillion}if(t._.includes(s,"-")&&(s=s.slice(1),b=!0),s.length<r)for(var w=r-s.length;w>0;w--)s="0"+s;return h>-1&&(s=s.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+c.delimiters.thousands)),0===n.indexOf(".")&&(s=""),f=s+m+(y||""),p?f=(p&&b?"(":"")+f+(p&&b?")":""):d>=0?f=0===d?(b?"-":"+")+f:f+(b?"-":"+"):b&&(f="-"+f),f},stringToNumber:function(t){var e,n,a,o=i[r.currentLocale],l=t,s={thousand:3,million:6,billion:9,trillion:12};if(r.zeroFormat&&t===r.zeroFormat)n=0;else if(r.nullFormat&&t===r.nullFormat||!t.replace(/[^0-9]+/g,"").length)n=null;else{for(e in n=1,"."!==o.delimiters.decimal&&(t=t.replace(/\./g,"").replace(o.delimiters.decimal,".")),s)if(a=new RegExp("[^a-zA-Z]"+o.abbreviations[e]+"(?:\\)|(\\"+o.currency.symbol+")?(?:\\))?)?$"),l.match(a)){n*=Math.pow(10,s[e]);break}n*=(t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1,t=t.replace(/[^0-9\.]+/g,""),n*=Number(t)}return n},isNaN:function(t){return"number"==typeof t&&isNaN(t)},includes:function(t,e){return-1!==t.indexOf(e)},insert:function(t,e,n){return t.slice(0,n)+e+t.slice(n)},reduce:function(t,e){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,i=Object(t),a=i.length>>>0,r=0;if(3===arguments.length)n=arguments[2];else{for(;r<a&&!(r in i);)r++;if(r>=a)throw new TypeError("Reduce of empty array with no initial value");n=i[r++]}for(;r<a;r++)r in i&&(n=e(n,i[r],r,i));return n},multiplier:function(t){var e=t.toString().split(".");return e.length<2?1:Math.pow(10,e[1].length)},correctionFactor:function(){return Array.prototype.slice.call(arguments).reduce((function(t,n){var i=e.multiplier(n);return t>i?t:i}),1)},toFixed:function(t,e,n,i){var a,r,o,l,s=t.toString().split("."),u=e-(i||0);return a=2===s.length?Math.min(Math.max(s[1].length,u),e):u,o=Math.pow(10,a),l=(n(t+"e+"+a)/o).toFixed(a),i>e-a&&(r=new RegExp("\\.?0{1,"+(i-(e-a))+"}$"),l=l.replace(r,"")),l}},t.options=r,t.formats=n,t.locales=i,t.locale=function(t){return t&&(r.currentLocale=t.toLowerCase()),r.currentLocale},t.localeData=function(t){if(!t)return i[r.currentLocale];if(t=t.toLowerCase(),!i[t])throw new Error("Unknown locale : "+t);return i[t]},t.reset=function(){for(var t in a)r[t]=a[t]},t.zeroFormat=function(t){r.zeroFormat="string"==typeof t?t:null},t.nullFormat=function(t){r.nullFormat="string"==typeof t?t:null},t.defaultFormat=function(t){r.defaultFormat="string"==typeof t?t:"0.0"},t.register=function(t,e,n){if(e=e.toLowerCase(),this[t+"s"][e])throw new TypeError(e+" "+t+" already registered.");return this[t+"s"][e]=n,n},t.validate=function(e,n){var i,a,r,o,l,s,u,d;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",e)),(e=e.trim()).match(/^\d+$/))return!0;if(""===e)return!1;try{u=t.localeData(n)}catch(e){u=t.localeData(t.locale())}return r=u.currency.symbol,l=u.abbreviations,i=u.delimiters.decimal,a="."===u.delimiters.thousands?"\\.":u.delimiters.thousands,(null===(d=e.match(/^[^\d]+/))||(e=e.substr(1),d[0]===r))&&((null===(d=e.match(/[^\d]+$/))||(e=e.slice(0,-1),d[0]===l.thousand||d[0]===l.million||d[0]===l.billion||d[0]===l.trillion))&&(s=new RegExp(a+"{2}"),!e.match(/[^\d.,]/g)&&(!((o=e.split(i)).length>2)&&(o.length<2?!!o[0].match(/^\d+.*\d$/)&&!o[0].match(s):1===o[0].length?!!o[0].match(/^\d+$/)&&!o[0].match(s)&&!!o[1].match(/^\d+$/):!!o[0].match(/^\d+.*\d$/)&&!o[0].match(s)&&!!o[1].match(/^\d+$/)))))},t.fn=o.prototype={clone:function(){return t(this)},format:function(e,i){var a,o,l,s=this._value,u=e||r.defaultFormat;if(i=i||Math.round,0===s&&null!==r.zeroFormat)o=r.zeroFormat;else if(null===s&&null!==r.nullFormat)o=r.nullFormat;else{for(a in n)if(u.match(n[a].regexps.format)){l=n[a].format;break}o=(l=l||t._.numberToFormat)(s,u,i)}return o},value:function(){return this._value},input:function(){return this._input},set:function(t){return this._value=Number(t),this},add:function(t){var n=e.correctionFactor.call(null,this._value,t);return this._value=e.reduce([this._value,t],(function(t,e,i,a){return t+Math.round(n*e)}),0)/n,this},subtract:function(t){var n=e.correctionFactor.call(null,this._value,t);return this._value=e.reduce([t],(function(t,e,i,a){return t-Math.round(n*e)}),Math.round(this._value*n))/n,this},multiply:function(t){return this._value=e.reduce([this._value,t],(function(t,n,i,a){var r=e.correctionFactor(t,n);return Math.round(t*r)*Math.round(n*r)/Math.round(r*r)}),1),this},divide:function(t){return this._value=e.reduce([this._value,t],(function(t,n,i,a){var r=e.correctionFactor(t,n);return Math.round(t*r)/Math.round(n*r)})),this},difference:function(e){return Math.abs(t(this._value).subtract(e).value())}},t.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$"}}),t.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(e,n,i){var a,r=t._.includes(n," BPS")?" ":"";return e*=1e4,n=n.replace(/\s?BPS/,""),a=t._.numberToFormat(e,n,i),t._.includes(a,")")?((a=a.split("")).splice(-1,0,r+"BPS"),a=a.join("")):a=a+r+"BPS",a},unformat:function(e){return+(1e-4*t._.stringToNumber(e)).toFixed(15)}}),function(){var e={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},n={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},i=e.suffixes.concat(n.suffixes.filter((function(t){return e.suffixes.indexOf(t)<0}))).join("|");i="("+i.replace("B","B(?!PS)")+")",t.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(i)},format:function(i,a,r){var o,l,s,u=t._.includes(a,"ib")?n:e,d=t._.includes(a," b")||t._.includes(a," ib")?" ":"";for(a=a.replace(/\s?i?b/,""),o=0;o<=u.suffixes.length;o++)if(l=Math.pow(u.base,o),s=Math.pow(u.base,o+1),null===i||0===i||i>=l&&i<s){d+=u.suffixes[o],l>0&&(i/=l);break}return t._.numberToFormat(i,a,r)+d},unformat:function(i){var a,r,o=t._.stringToNumber(i);if(o){for(a=e.suffixes.length-1;a>=0;a--){if(t._.includes(i,e.suffixes[a])){r=Math.pow(e.base,a);break}if(t._.includes(i,n.suffixes[a])){r=Math.pow(n.base,a);break}}o*=r||1}return o}})}(),t.register("format","currency",{regexps:{format:/(\$)/},format:function(e,n,i){var a,r,o=t.locales[t.options.currentLocale],l={before:n.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:n.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(n=n.replace(/\s?\$\s?/,""),a=t._.numberToFormat(e,n,i),e>=0?(l.before=l.before.replace(/[\-\(]/,""),l.after=l.after.replace(/[\-\)]/,"")):e<0&&!t._.includes(l.before,"-")&&!t._.includes(l.before,"(")&&(l.before="-"+l.before),r=0;r<l.before.length;r++)switch(l.before[r]){case"$":a=t._.insert(a,o.currency.symbol,r);break;case" ":a=t._.insert(a," ",r+o.currency.symbol.length-1)}for(r=l.after.length-1;r>=0;r--)switch(l.after[r]){case"$":a=r===l.after.length-1?a+o.currency.symbol:t._.insert(a,o.currency.symbol,-(l.after.length-(1+r)));break;case" ":a=r===l.after.length-1?a+" ":t._.insert(a," ",-(l.after.length-(1+r)+o.currency.symbol.length-1))}return a}}),t.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(e,n,i){var a=("number"!=typeof e||t._.isNaN(e)?"0e+0":e.toExponential()).split("e");return n=n.replace(/e[\+|\-]{1}0/,""),t._.numberToFormat(Number(a[0]),n,i)+"e"+a[1]},unformat:function(e){var n=t._.includes(e,"e+")?e.split("e+"):e.split("e-"),i=Number(n[0]),a=Number(n[1]);return a=t._.includes(e,"e-")?a*=-1:a,t._.reduce([i,Math.pow(10,a)],(function(e,n,i,a){var r=t._.correctionFactor(e,n);return e*r*(n*r)/(r*r)}),1)}}),t.register("format","ordinal",{regexps:{format:/(o)/},format:function(e,n,i){var a=t.locales[t.options.currentLocale],r=t._.includes(n," o")?" ":"";return n=n.replace(/\s?o/,""),r+=a.ordinal(e),t._.numberToFormat(e,n,i)+r}}),t.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(e,n,i){var a,r=t._.includes(n," %")?" ":"";return t.options.scalePercentBy100&&(e*=100),n=n.replace(/\s?\%/,""),a=t._.numberToFormat(e,n,i),t._.includes(a,")")?((a=a.split("")).splice(-1,0,r+"%"),a=a.join("")):a=a+r+"%",a},unformat:function(e){var n=t._.stringToNumber(e);return t.options.scalePercentBy100?.01*n:n}}),t.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(t,e,n){var i=Math.floor(t/60/60),a=Math.floor((t-60*i*60)/60),r=Math.round(t-60*i*60-60*a);return i+":"+(a<10?"0"+a:a)+":"+(r<10?"0"+r:r)},unformat:function(t){var e=t.split(":"),n=0;return 3===e.length?(n+=60*Number(e[0])*60,n+=60*Number(e[1]),n+=Number(e[2])):2===e.length&&(n+=60*Number(e[0]),n+=Number(e[1])),Number(n)}}),t}))})),Sn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(gn),a=i(mn),r=i(hn),o=i(fn),l=i(yn),s=i(pn),u=i(vn),d=i(xn),h=i(wn),f=i(ln),c=i(kn);function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){(0,a.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,d.default)(t);if(e){var a=(0,d.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,u.default)(this,n)}}var v=f.default._,x=function(t){(0,s.default)(i,t);var e=y(i);function i(t,n){var a;return(0,r.default)(this,i),a=e.call(this,t,n),v.extend(!0,(0,l.default)(a),(0,bn.getDefaultProps)(i.defaultProps())),a.name="coord",a._opt=t,a.app=n,a.dataFrame=a.app.dataFrame,a.sprite=new f.default.Display.Sprite({name:"coord_"+t.type}),a.app.coordSprite.addChild(a.sprite),a.graphsFieldsMap=null,a.induce=null,a._axiss=[],a}return(0,o.default)(i,[{key:"init",value:function(){this.graphsFieldsMap=this.setGraphsFieldsMap()}},{key:"draw",value:function(){var t=this.app.padding;this.width=this.app.width-t.left-t.right,this.height=this.app.height-t.top-t.bottom,this.origin.x=t.left,this.origin.y=t.top}},{key:"setGraphsFieldsMap",value:function(t){var e=this,n=0,i=[];t&&v.each(this.getAxiss(t),(function(t){t.field&&(i=i.concat(t.field))}));var a=this.app._opt.graphs?v.flatten([this.app._opt.graphs]):[];return a.forEach((function(t){if(t.field){var e=v.flatten([t.field]);e.length&&-1==v.flatten(i).indexOf(e[0])&&(i=i.concat(t.field))}})),function i(r){v.isString(r)&&(r=[r]);for(var o=v.clone(r),l=0,s=r.length;l<s;l++){var u=r[l];v.isString(u)&&function(){for(var i=e.app.getTheme(n),r=void 0,s=void 0,d=void 0,h=0,f=a.length;h<f;h++)if(r=a[h],(s=v.flatten([r.field]).indexOf(u))>-1){d=r.color;break}d&&("string"==typeof d&&(i=d),Array.isArray(d)&&(i=d[s]),"function"==typeof d&&(i=d.apply(e.app,[r])));var c=e.fieldsConfig[u],p=g({field:u,name:u,type:r.type,enabled:!0,color:i,ind:n++},e.fieldsConfig[u]||{});p.getFormatValue=function(t){return e.getFormatValue(t,c,p)};var y=t?t.type||"yAxis":null;y&&(p[y]=e.getAxis({type:y,field:u})),o[l]=p}(),v.isArray(u)&&(o[l]=i(u))}return o}(i)}},{key:"getFormatValue",value:function(t,e){if(e&&e.format)"string"==typeof e.format&&(t=(0,c.default)(t).format(e.format)),"function"==typeof e.format&&(t=e.format.apply(this,arguments));else if("object"==(0,n.default)(t))t=JSON.stringify(t);else if(!isNaN(t)&&""!==t&&null!==t){var i=t.toString().split(".");t=(0,c.default)(i[0]).format("0,0"),i.length>1&&(t+="."+i[1])}return t}},{key:"setFieldEnabled",value:function(t){!function e(n){v.each(n,(function(n){v.isArray(n)?e(n):n.field&&n.field==t&&(n.enabled=!n.enabled)}))}(this.graphsFieldsMap)}},{key:"getFieldConfig",value:function(t){var e=this,n=null;if(function e(i){v.each(i,(function(i){if(v.isArray(i))e(i);else if(i.field&&i.field==t)return n=i,!1}))}(e.graphsFieldsMap),!n){var i=(this._opt.fieldsConfig||{})[t];i&&(i.getFormatValue=function(t){return e.getFormatValue(t,i,i)},n=i)}return n}},{key:"getEnabledFieldsOf",value:function(t){var e=[],n=t?t.type:"yAxis";return v.each(this.graphsFieldsMap,(function(i){if(v.isArray(i)){var a=[];v.each(i,(function(e){e[n]===t&&e.field&&e.enabled&&a.push(e.field)})),a.length&&e.push(a)}else i[n]===t&&i.field&&i.enabled&&e.push(i.field)})),e}},{key:"filterEnabledFields",value:function(t){var e=this,n=[];return v.isArray(t)||(t=[t]),v.each(t,(function(t){if(v.isArray(t)){var i=[];v.each(t,(function(t){e.getFieldConfig(t).enabled&&i.push(t)})),i.length&&n.push(i)}else e.getFieldConfig(t).enabled&&n.push(t)})),n}},{key:"getAxisDataFrame",value:function(t){return{field:t,org:this.dataFrame.getDataOrg(t,(function(t){return null==t||""==t||isNaN(Number(t))?t:Number(t)}))}}},{key:"getTipsInfoHandler",value:function(t){var e={nodes:[]};return t.eventInfo&&v.extend(!0,e,t.eventInfo),e}},{key:"hide",value:function(t){this.changeFieldEnabled(t)}},{key:"show",value:function(t){this.changeFieldEnabled(t)}},{key:"getSizeAndOrigin",value:function(){return{width:this.width,height:this.height,origin:this.origin}}},{key:"getPoint",value:function(){}},{key:"getAxisOriginPoint",value:function(){}},{key:"getOriginPos",value:function(){}},{key:"resetData",value:function(){}},{key:"getAxis",value:function(t){return this.getAxiss(t)[0]}},{key:"getAxiss",value:function(t){var e=[],n=Object.keys(t).length;return v.each(this._axiss,(function(i){var a=0;for(var r in t)"field"==r?function(){var e=v.flatten([i[r]]),n=v.flatten([t[r]]),o=!0;v.each(n,(function(t){-1==v.indexOf(e,t)&&(o=!1)})),o&&a++}():JSON.stringify(i[r])==JSON.stringify(t[r])&&a++;n==a&&e.push(i)})),e}},{key:"resetGraphsOfAxis",value:function(t){this.app.getGraphs()}}],[{key:"defaultProps",value:function(){return{type:{detail:"坐标系组件",documentation:"坐标系组件，可选值有'rect'（二维直角坐标系）,'polar'（二维极坐标系）,'box'（三维直角坐标系） ",insertText:"type: ",default:"",values:["rect","polar","box","polar3d"]},width:{detail:"坐标系width",default:0},height:{detail:"坐标系height",default:0},origin:{detail:"坐标系原点",propertys:{x:{detail:"原点x位置",default:0},y:{detail:"原点x位置",default:0}}},fieldsConfig:{detail:'字段的配置信息({uv:{name:"",format:""}})，包括中文名称和格式化单位，内部使用numeral做格式化',default:{}}}}}]),i}(h.default);h.default.registerComponent(x,"coord");var _=x;e.default=_}));e(Sn);var An=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(pn),o=i(vn),l=i(xn),s=i(dn),u=i(ln),d=i(_n),h=i(un),f=i(Sn);function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,l.default)(t);if(e){var a=(0,l.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,o.default)(this,n)}}var p=u.default._,g=u.default.$,y=u.default.event;y.types.register("contextmenu");var v=function(t){(0,r.default)(i,t);var e=c(i);function i(t,a,r,o,l){var s;return(0,n.default)(this,i),(s=e.call(this)).otherOptions=l,s.componentModules=o,s._node=t,a||(a=[]),s.otherOptions.noDataClone||(a=JSON.parse(JSON.stringify(a,(function(t,e){return void 0===e?null:e})))),s._data=a,s._opt=s.polyfill(r),s.dataFrame=s._initDataFrame(s._data,s._opt),s.padding=null,s.el=g.query(t),s.width=t.width||parseInt(s.el.offsetWidth),s.height=t.height||parseInt(s.el.offsetHeight),t.canvax?(s.canvax=t.canvax,s.stage=t.stage):(s.canvax=new u.default.App({el:s.el,webGL:!1}),s.canvax.registEvent(),s.id="chartx_"+s.canvax.id,s.el.setAttribute("chart_id",s.id),s.stage=new u.default.Display.Stage({id:"main-chart-stage"}),s.canvax.addChild(s.stage)),s.setCoord_Graphs_Sp(),s.__highModules=["theme","coord","graphs"],s.components=[],s.inited=!1,s.init(),s}return(0,a.default)(i,[{key:"polyfill",value:function(t){var e=this,n=function(n){p.flatten([t[n]]).forEach((function(t){var i=e.componentModules.get(n,t.type);i&&i.polyfill(t)}))};for(var i in t)n(i);return t}},{key:"init",value:function(){var t=this,e=this,n=this._opt;if(this.padding=this._getPadding(),this._initPadding=JSON.parse(JSON.stringify(this.padding)),!n.coord){var i=new f.default({},e);i.init(),e.components.push(i)}p.each(this.__highModules,(function(t){if(n[t]){var i=p.flatten([n[t]]);"theme"==t&&(i=[i]),p.each(i,(function(n){if("graphs"!=t||(n.field||n.keyField||n.adcode||n.geoJson||n.geoJsonUrl)&&(!("enabled"in n)||n.enabled)){var i=e.componentModules.get(t,n.type);if(i){var a=(e._preComponents||[]).find((function(t){return t.type==n.type&&t.field==n.field})),r=new i(n,e,a||{});"coord"!=t||n.type||r.init(),e.components.push(r)}}}))}}));var a=function(n){if(-1==p.indexOf(t.__highModules,n)){var i=t._opt[n];p.isArray(i)||(i=[i]),p.each(i,(function(t){var i=e.componentModules.get(n,t.type);if(i&&(!("enabled"in t)||t.enabled)){var a=new i(t,e);e.components.push(a)}}))}};for(var r in this._opt)a(r)}},{key:"draw",value:function(t){var e=this,n=Object.assign({},t||{}),i=this.getComponent({name:"coord"});i&&i.horizontal&&this._drawBeginHorizontal();var a=this.width-this.padding.left-this.padding.right,r=this.height-this.padding.top-this.padding.bottom,o={x:this.padding.left,y:this.padding.top};i&&(i.draw(n),a=i.width,r=i.height,o=i.origin);var l=this.getComponents({name:"graphs"}),s=l.length,u=0;n=p.extend(n,{width:a,height:r,origin:o}),this.dataFrame.length>0&&p.each(l,(function(t){t.on("complete",(function(n){++u==s&&e.fire("complete"),t.inited=!0})),t.draw(n)}));for(var d=0,h=this.components.length;d<h;d++){var f=this.components[d];-1==p.indexOf(this.__highModules,f.name)&&f.draw(n)}this._bindEvent(),i&&i.horizontal&&this._drawEndHorizontal()}},{key:"_drawBeginHorizontal",value:function(){var t=this.padding,e=t.top;t.top=t.right,t.right=t.bottom,t.bottom=t.left,t.left=e}},{key:"_drawEndHorizontal",value:function(){var t=this.graphsSprite.context;t.x+=(this.width-this.height)/2,t.y+=(this.height-this.width)/2,t.rotation=90,t.rotateOrigin={x:this.height/2,y:this.width/2},this._horizontalGraphsText()}},{key:"_horizontalGraphsText",value:function(){function t(e){if(e.children&&p.each(e.children,(function(e){t(e)})),"text"==e.type&&!e.__horizontal){var n=e.context;n.rotation=n.rotation-90,e.__horizontal=!0}}p.each(this.getComponents({name:"graphs"}),(function(e){t(e.sprite)}))}},{key:"_getPadding",value:function(){var t=h.default.padding;this._opt.coord&&"padding"in this._opt.coord&&(p.isObject(this._opt.coord.padding)||(t=this._opt.coord.padding));var e={top:t,right:t,bottom:t,left:t};return this._opt.coord&&"padding"in this._opt.coord&&p.isObject(this._opt.coord.padding)&&(e=p.extend(e,this._opt.coord.padding)),e}},{key:"getTheme",value:function(t){var e=s.default.getGlobalTheme(),n=this.getComponent({name:"theme"});return n&&(e=n.get()),null!=t?e[t%e.length]||"#ccc":e}},{key:"setCoord_Graphs_Sp",value:function(){this.coordSprite=new u.default.Display.Sprite({id:"coordSprite"}),this.stage.addChild(this.coordSprite),this.graphsSprite=new u.default.Display.Sprite({id:"graphsSprite"}),this.stage.addChild(this.graphsSprite)}},{key:"destroy",value:function(){this.clean(),this.el&&(this.el.removeAttribute("chart_id"),this.el.removeAttribute("chartx_version"),this.canvax.destroy(),this.el=null),this._destroy&&this._destroy(),this.fire("destroy")}},{key:"clean",value:function(){for(var t=0,e=this.canvax.children.length;t<e;t++)for(var n=this.canvax.getChildAt(t),i=0,a=n.children.length;i<a;i++)n.getChildAt(i).destroy(),i--,a--;this.setCoord_Graphs_Sp(),this._preComponents=this.components,this.components=[],this.canvax.domView&&(this.canvax.domView.innerHTML=""),this.canvax.event&&(this.canvax.event.curPointsTarget=[]),this.padding=this._initPadding}},{key:"resize",value:function(){var t=parseInt(this.el.offsetWidth),e=parseInt(this.el.offsetHeight);t==this.width&&e==this.height||(this.width=t,this.height=e,this.canvax.resize(),this.inited=!1,this.clean(),this.init(),this.draw({resize:!0}),this.inited=!0)}},{key:"reset",value:function(t,e){(t=s.default._optionsHandle(t))&&(this._opt=this.polyfill(t)),1==arguments.length?e=this._data:e||(e=[]),this.otherOptions.noDataClone||(e=JSON.parse(JSON.stringify(e,(function(t,e){return void 0===e?null:e})))),this._data=e,this.dataFrame=this._initDataFrame(this._data,this._opt),this.clean(),this.init(),this.draw()}},{key:"resetData",value:function(t,e){var n=this,i=this.dataFrame.org.length;e&&e.comp?this.dataFrame.resetData():(t||(t=[]),this.otherOptions.noDataClone||(t=JSON.parse(JSON.stringify(t,(function(t,e){return void 0===e?null:e})))),this._data=t,this.dataFrame.resetData(this._data));var a=this.getComponents({name:"graphs"}),r=!0;if(p.each(a,(function(t){if(!t.resetData&&r)return r=!1,!1})),!i||!r)return this.clean(),this.init(),this.draw(this._opt),void this.fire("resetData");var o=this.getComponent({name:"coord"}),l=o.width,s=o.height,u=o.origin;o&&o.resetData(this.dataFrame,e),p.each(a,(function(t){t.resetData(n.dataFrame,e,{origin:u,width:l,height:s})})),this.componentsReset(e,u),o&&o.horizontal&&this._horizontalGraphsText(),this.fire("resetData")}},{key:"_initDataFrame",value:function(){return d.default.apply(this,arguments)}},{key:"componentsReset",value:function(t){var e=this;p.each(this.components,(function(n,i){-1==p.indexOf(e.__highModules,n.name)&&(t&&t.comp&&t.comp.__cid==n.__cid||n.reset&&n.reset(e[n.type]||{},e.dataFrame))}))}},{key:"getComponentById",value:function(t){var e;return p.each(this.components,(function(n){if(n.id&&n.id==t)return e=n,!1})),e}},{key:"getComponent",value:function(t){return this.getComponents(t)[0]}},{key:"getComponents",value:function(t,e){var n=[],i=0;for(var a in e||(e=this.components),t)i++;return i?(p.each(e,(function(e){var a=0;for(var r in t)JSON.stringify(e[r])==JSON.stringify(t[r])&&a++;i==a&&n.push(e)})),n):e}},{key:"getGraph",value:function(t){return this.getGraphs(t)[0]}},{key:"getGraphs",value:function(t){return this.getComponents(t,this.getComponents({name:"graphs"}))}},{key:"getGraphById",value:function(t){var e;return p.each(this.getComponents({name:"graphs"}),(function(n){if(n.id==t)return e=n,!1})),e}},{key:"getCoord",value:function(t){return this.getComponent(p.extend(!0,{name:"coord"},t))}},{key:"getLegendData",value:function(){var t=this,e=[];if(p.each(this.getComponents({name:"graphs"}),(function(t){p.each(t.getLegendData(),(function(t){if(!p.find(e,(function(e){return e.name==t.name}))){var n=p.extend(!0,{enabled:!0},t);n.color=t.fillStyle||t.color||t.style,e.push(n)}}))})),e.length)return e;var n=t.getComponent({name:"coord"});return p.each(p.flatten(n.graphsFieldsMap),(function(n,i){var a=!1;p.each(t._opt.graphs,(function(t){if(p.indexOf(p.flatten([t.field]),n.field)>-1)return a=!0,!1})),a&&e.push({enabled:n.enabled,name:n.name||n.field,field:n.field,ind:n.ind,color:n.color,type:n.type,yAxis:n.yAxis})})),e}},{key:"show",value:function(t,e){var n=this.getComponent({name:"coord"});n&&n.show(t,e),p.each(this.getComponents({name:"graphs"}),(function(n){n.show(t,e)})),this.componentsReset(e)}},{key:"hide",value:function(t,e){var n=this.getComponent({name:"coord"});n&&n.hide(t,e),p.each(this.getComponents({name:"graphs"}),(function(n){n.hide(t,e)})),this.componentsReset(e)}},{key:"triggerEvent",value:function(t){t.eventInfo&&this.getGraphs().forEach((function(e){e.triggerEvent(t)}));var e=this.getComponent({name:"tips"}),n=this.getComponent({name:"coord"});e&&(this._setGraphsTipsInfo.apply(this,[t]),"mouseover,mousedown,tap,longTap".indexOf(t.type)>-1&&(e.show(t),this._tipsPointerAtAllGraphs(t)),"mousemove,touchMove".indexOf(t.type)>-1&&(e.move(t),this._tipsPointerAtAllGraphs(t)),"mouseout".indexOf(t.type)>-1&&!(t.toTarget&&n&&n.induce&&n.induce.containsPoint(n.induce.globalToLocal(t.target.localToGlobal(t.point))))&&(e.hide(t),this._tipsPointerHideAtAllGraphs(t)));var i=this.getComponent({name:"contextmenu"});i&&("mousedown,click".indexOf(t.type)>-1&&i.hide(t),"contextmenu"==t.type&&i.show(t))}},{key:"_bindEvent",value:function(){var t=this;this.__bindEvented||(this.on(y.types.get(),(function(e){t.triggerEvent(e);var n=t.getComponent({name:"tips"});if(n&&n.linkageName)for(var i in s.default.instances){var a=s.default.instances[i];if(a!=t){var r=a.getComponent({name:"tips"});r&&r.linkageName&&r.linkageName==n.linkageName&&(e.eventInfo&&e.eventInfo.nodes&&(e.eventInfo.nodes=[]),e.eventInfo.isLinkageTrigger=!0,a.triggerEvent.apply(a,[e]))}}})),this.__bindEvented=!0)}},{key:"_setGraphsTipsInfo",value:function(t){t.eventInfo||(t.eventInfo={});var e=this.getComponent({name:"coord"});if(e&&(t.eventInfo=e.getTipsInfoHandler(t)),"tipsEnabled"in t.eventInfo||(t.eventInfo.tipsEnabled=!0),!t.eventInfo.nodes||!t.eventInfo.nodes.length){var n=[],i=t.eventInfo.iNode;p.each(this.getComponents({name:"graphs"}),(function(e){if(e.getNodesAt&&void 0!==i){var a=e.getNodesAt(i,t);if(!a||!a.length)return;Array.isArray(a)||(a=[a]),n=n.concat(a)}})),t.eventInfo.nodes=n}}},{key:"_tipsPointerAtAllGraphs",value:function(t){p.each(this.getComponents({name:"graphs"}),(function(e){e.tipsPointerOf(t)}))}},{key:"_tipsPointerHideAtAllGraphs",value:function(t){p.each(this.getComponents({name:"graphs"}),(function(e){e.tipsPointerHideOf(t)}))}}]),i}(y.Dispatcher);s.default.registerComponent(v,"chart");var x=v;e.default=x}));e(An);var Pn=n((function(t,e){function n(t){return parseFloat(t.toPrecision(14))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={section:function(t,e,i){return ln._.uniq(function(t,e,i){t=ln._.without(t,void 0,null,"");var a=i&&i.scale?parseFloat(i.scale):1,r=i&&i.isInt?1:0;isNaN(a)&&(a=1);var o=ln._.max(t),l=o;o*=a;var s=ln._.min(t);if(s==o)return o>0?[s=0,o]:o<0?[o,0]:[0,o=1];var u=o-s;if(u){var d=s;(s-=.05*u)<0&&d>=0&&(s=0),o+=.05*u}var h=.3*(o-s);h=function(t,e){var n,i=[1,2,5,10];n=t/e;for(var a=0;a<i.length&&(t=i[a],!(n<=(i[a]+(i[a+1]||i[a]))/2));a++);return t*e}(h,Math.pow(10,Math.floor(Math.log(h)/Math.LN10))),r&&(h=Math.ceil(h));var f,c,p=n(Math.floor(s/h)*h),g=n(Math.ceil(o/h)*h),y=[];for(f=p;f<=g&&(y.push(f),(f=n(f+h))!==c);)c=f;return y.length>=3&&y[y.length-2]>=l&&y.pop(),y}(t,0,i))}},a=i;e.default=a}));e(Pn);var Cn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(Pn),o=function(){function t(e,i){(0,n.default)(this,t),this._opt=ln._.clone(e),this.dataOrg=i||[],this._dataSectionLayout=[],this._cellCount=null,this._cellLength=null,this._dataSectionGroup=[],this.originPos=0,this._originTrans=0,this._min=null,this._max=null,ln._.extend(!0,this,(0,bn.getDefaultProps)(t.defaultProps()),e)}return(0,a.default)(t,[{key:"resetDataOrg",value:function(t){this.dataSection=[],this._dataSectionGroup=[],this.dataOrg=t,this._cellCount=null,this._cellLength=null}},{key:"setAxisLength",value:function(t){this.axisLength=t,this.calculateProps()}},{key:"calculateProps",value:function(){var t=this;"proportion"==this.layoutType&&(this._min=ln._.min(this.dataSection),this._max=ln._.max(this.dataSection),"origin"in this._opt||(this.origin=0,ln._.max(this.dataSection)<0&&(this.origin=ln._.max(this.dataSection)),ln._.min(this.dataSection)>0&&(this.origin=ln._.min(this.dataSection))),this._originTrans=this._getOriginTrans(this.origin),this.originPos=this.getPosOfVal(this.origin)),this._dataSectionLayout=[],ln._.each(this.dataSection,(function(e,n){var i=n;"proportion"==t.layoutType&&(i=t.getIndexOfVal(e));var a=parseInt(t.getPosOf({ind:n,val:e}),10);t._dataSectionLayout.push({val:e,ind:i,pos:a})}))}},{key:"getDataSection",value:function(){return this.dataSection}},{key:"setDataSection",value:function(){if(Array.isArray(this._opt.dataSection)&&this._opt.dataSection.length)this.dataSection=this._opt.dataSection,this._dataSectionGroup=[this.dataSection];else if("proportion"==this.layoutType){var t=this._getDataSection();if("origin"in this._opt&&t.push(this._opt.origin),1==t.length){var e=t[0];t=Math.abs(e)>10?[e-1,e,e+1]:Math.abs(e)>=1&&Math.abs(e)<=10?[e-.1,e,e+.1]:[.5*e,e,2*e]}if(Array.isArray(this.verniers)&&this.verniers.length&&(t=t.concat(this.verniers)),this.symmetric){var n=ln._.min(t),i=ln._.max(t);Math.abs(n)>Math.abs(i)?t.push(Math.abs(n)):t.push(-Math.abs(i))}for(var a=0,o=t.length;a<o;a++)t[a]=Number(t[a]),isNaN(t[a])&&(t.splice(a,1),a--,o--);if(ln._.isFunction(this.sectionHandler)&&(this.dataSection=this.sectionHandler(t)),this.dataSection&&this.dataSection.length||(this.dataSection=r.default.section(t,3)),this.symmetric){var l=ln._.min(this.dataSection),s=ln._.max(this.dataSection);Math.abs(l)>Math.abs(s)?this.dataSection.push(Math.abs(l)):this.dataSection.unshift(-Math.abs(s))}0==this.dataSection.length&&(this.dataSection=[0]),this._dataSectionGroup=[ln._.clone(this.dataSection)],this._middleweight(),this._sort()}else this.dataSection=ln._.flatten(this.dataOrg),this._dataSectionGroup=[this.dataSection];this._middleWeightPos()}},{key:"_getDataSection",value:function(){var t=1;return ln._.each(this.dataOrg,(function(e){t=Math.max(e.length,t)})),1==t?this._oneDimensional():t>1?this._twoDimensional():void 0}},{key:"_oneDimensional",value:function(){for(var t=ln._.flatten(this.dataOrg),e=[],n=0,i=t.length;n<i;n++)null!=t[n]&&null!=t[n]&&""!=t[n]&&e.push(t[n]);return ln._.unique(e)}},{key:"_twoDimensional",value:function(){var t,e=this.dataOrg,n=[];return ln._.each(e,(function(e){if(e.length)if(ln._.isArray(e[0])){for(var i=[],a=e[0].length,r=e.length,o=0;o<a;o++){for(var l=0,s=0,u=0,d=0,h=0;h<r;h++){var f=e[h][o];(f||0===f)&&(null==t&&(t=f),t=Math.min(t,f),f>=0?(l+=f,s++):(u+=f,d++))}s&&i.push(l),d&&i.push(u)}n.push(i)}else n.push(e)})),n.push(t),ln._.flatten(n)}},{key:"_addValToSection",value:function(t){this.addVerniers(t),this.setDataSection(),this.calculateProps()}},{key:"addVerniers",value:function(t){-1==this.verniers.indexOf(t)&&this.verniers.push(t)}},{key:"_sort",value:function(){this.sort&&("desc"==this._getSortType()&&(this.dataSection.reverse(),ln._.each(this._dataSectionGroup,(function(t){t.reverse()})),this._dataSectionGroup.reverse()))}},{key:"_getSortType",value:function(){var t;return ln._.isString(this.sort)&&(t=this.sort),t||(t="asc"),t}},{key:"_middleweight",value:function(){if(this.middleWeight){ln._.isArray(this.middleWeight)||(this.middleWeight=[this.middleWeight]);for(var t=ln._.min(this.dataSection),e=ln._.max(this.dataSection),n=[t],i=[],a=0,r=this.middleWeight.length;a<r;a++){var o=t;a>0&&(o=this.middleWeight[a-1]);var l=o+parseInt((this.middleWeight[a]-o)/2);n.push(l),n.push(this.middleWeight[a]),i.push([o,l,this.middleWeight[a]])}var s=this.middleWeight.slice(-1)[0];e>s&&(n.push(s+(e-s)/2),n.push(e),i.push([s,s+(e-s)/2,e])),this.dataSection=n,this._dataSectionGroup=i}}},{key:"_middleWeightPos",value:function(){var t=this;if(this.middleWeightPos){ln._.isArray(this.middleWeightPos)||(this.middleWeightPos=[this.middleWeightPos]);var e=0;ln._.each(this.middleWeightPos,(function(t){e+=t})),e<1&&this.middleWeightPos.push(1-e),e>1&&(this.middleWeightPos=null)}if(this.middleWeight){if(!this.middleWeightPos){this.middleWeightPos=[];var n=0;ln._.each(this.middleWeight,(function(){var e=1/(t.middleWeight.length+1);n+=e,t.middleWeightPos.push(e)})),this.middleWeightPos.push(1-n)}}else this.middleWeightPos=[1]}},{key:"_getOriginTrans",value:function(t){for(var e=this,n=0,i=this,a=this._dataSectionGroup.length,r=this.axisLength/a,o=function(a,o){var l=e._dataSectionGroup[a];r=e.axisLength*e.middleWeightPos[a];var s=0;if(ln._.each(e.middleWeightPos,(function(t,e){e<a&&(s+=i.axisLength*t)})),"proportion"==e.layoutType){var u=ln._.min(l),d=ln._.max(l),h=Math.abs(d-u);if(t>=u&&t<=d)return n=(t-u)/h*r+s,"break"}},l=0,s=a;l<s;l++){if("break"===o(l))break}return"desc"==this.sort&&(n=-(r-n)),parseInt(n)}},{key:"_getLayoutDataOf",value:function(t){var e,n;return ln._.each(["val","ind","pos"],(function(n){n in t&&(e=n)})),ln._.each(this._dataSectionLayout,(function(i){i[e]===t[e]&&(n=i)})),n||{}}},{key:"getPosOfVal",value:function(t){return this.getPosOf({val:t})}},{key:"getPosOfInd",value:function(t){var e=this._getLayoutDataOf({ind:t}).pos;return null!=e?e:this.getPosOf({ind:t})}},{key:"getPosOf",value:function(t){var e,n=this,i=this,a=this._getCellCount();if("proportion"==this.layoutType)for(var r=function(a,r){var o=n._dataSectionGroup[a],l=n.axisLength*n.middleWeightPos[a],s=0;ln._.each(n.middleWeightPos,(function(t,e){e<a&&(s+=i.axisLength*t)}));var u=ln._.min(o),d=ln._.max(o),h="val"in t?t.val:n.getValOfInd(t.ind),f=n.origin,c=!(f<u||f>d);if(c||(f=u),h>=u&&h<=d){var p=Math.max(Math.abs(d-f),Math.abs(f-u)),g=Math.abs(d-u);e=(h-f)/p*(p/g*l)+s,isNaN(e)&&(e=parseInt(s)),c&&(e+=n._originTrans)}else h>d&&a==r-1&&(e=i.axisLength),h<u&&0==a&&(e=0)},o=0,l=this._dataSectionGroup.length;o<l;o++)r(o,l);else if(1==a)e=this.axisLength/2;else{var s="ind"in t?t.ind:this.getIndexOfVal(t.val);if(-1!=s&&("rule"==this.layoutType&&(e=s/(a-1)*this.axisLength),"peak"==this.layoutType)){var u=this.getCellLength();e=u*(s+1)-u/2}}return!e&&(e=0),e=Number(e.toFixed(1)),Math.abs(e)}},{key:"getValOfPos",value:function(t){var e=this._getLayoutDataOf({pos:t}).val;return null!=e?e:this._getValOfInd(this.getIndexOfPos(t))}},{key:"getValOfInd",value:function(t){var e=this._getLayoutDataOf({ind:t}).val;return null!=e?e:this._getValOfInd(t)}},{key:"_getValOfInd",value:function(t){var e,n=this,i=ln._.flatten(this.dataOrg);return"proportion"==this.layoutType?ln._.each(this._dataSectionGroup,(function(i,a){var r=n.axisLength*n.middleWeightPos[a],o=0;if(ln._.each(n.middleWeightPos,(function(t,e){e<a&&(o+=n.axisLength*t)})),parseInt(t/r)==a||a==n._dataSectionGroup.length-1){var l=ln._.min(i),s=ln._.max(i);return e=l+(s-l)/r*(t-o),!1}})):e=i[t],e}},{key:"getIndexOfPos",value:function(t){var e=this._getLayoutDataOf({pos:t}).ind;if(null!=e)return e;var n=0,i=this.getCellLengthOfPos(t),a=this._getCellCount();return"proportion"==this.layoutType?t:("peak"==this.layoutType&&(n=parseInt(t/i))==a&&(n=a-1),"rule"==this.layoutType&&(n=parseInt((t+i/2)/i),1==a&&(n=0)),n)}},{key:"getIndexOfVal",value:function(t){var e=-1;if("proportion"==this.layoutType){var n=this._getLayoutDataOf({val:t}).ind;if(null!=n)return n;e=this.getPosOfVal(t)}else ln._.each(this.dataOrg,(function(n){ln._.each(n,(function(n){var i=ln._.indexOf(n,t);-1!=i&&(e=i)}))}));return e}},{key:"getCellLength",value:function(){if(null!==this._cellLength)return this._cellLength;var t=this.axisLength,e=t,n=this._getCellCount();return n&&("proportion"==this.layoutType?e=1:(e=t/n,"rule"==this.layoutType&&(e=1==n?t/2:t/(n-1)),this.posParseToInt&&(e=parseInt(e)))),this._cellLength=e,e}},{key:"getCellLengthOfPos",value:function(){return this.getCellLength()}},{key:"getCellLengthOfInd",value:function(){return this.getCellLength()}},{key:"_getCellCount",value:function(){if(null!==this._cellCount)return this._cellCount;var t=0;return"proportion"==this.layoutType?t=this.axisLength:this.dataOrg.length&&this.dataOrg[0].length&&this.dataOrg[0][0].length&&(t=this.dataOrg[0][0].length),this._cellCount=t,t}}],[{key:"defaultProps",value:function(){return{layoutType:{detail:"布局方式",default:"proportion"},axisLength:{detail:"轴长度",default:1},dataSection:{detail:"轴数据集",default:[]},sectionHandler:{detail:"自定义dataSection的计算公式",default:null},verniers:{detail:"设定的游标，dataSection的区间一定会覆盖这些值",default:[]},middleWeight:{detail:"区间分隔线",default:null,documentation:"如果middleweight有设置的话 _dataSectionGroup 为被middleweight分割出来的n个数组>..[ [0,50 , 100],[100,500,1000] ]"},middleWeightPos:{detail:"区间分隔线的物理位置，百分比,默认 0.5 ",default:null},symmetric:{detail:"自动正负对称",default:!1,documentation:"proportion下，是否需要设置数据为正负对称的数据，比如 [ 0,5,10 ] = > [ -10, 0 10 ]，象限坐标系的时候需要"},origin:{detail:"轴的起源值",default:null,documentation:"                    1，如果数据中又正数和负数，则默认为0 <br />                    2，如果dataSection最小值小于0，则baseNumber为最小值<br />                    3，如果dataSection最大值大于0，则baseNumber为最大值<br />                    4，也可以由用户在第2、3种情况下强制配置为0，则section会补充满从0开始的刻度值                "},sort:{detail:"排序",default:null},posParseToInt:{detail:"是否位置计算取整",default:!1,documentation:"比如在柱状图中，有得时候需要高精度的能间隔1px的柱子，那么x轴的计算也必须要都是整除的"}}}}]),t}(),l=o;e.default=l}));e(Cn);var Dn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var d=function(t){(0,o.default)(i,t);var e=u(i);function i(t,a){var o;return(0,n.default)(this,i),o=e.call(this,t,a),ln._.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps())),o}return(0,a.default)(i,[{key:"addValToSection",value:function(t){var e=this;if(Array.isArray(t)||(t=[t]),"proportion"==this.layoutType){var n=!0;if(t.forEach((function(t){t>=e._min&&t<=e._max||(n=!1)})),n)return}this.dataSection=[],t.forEach((function(t){e._addValToSection(t)})),this._initHandle(),this.draw(),this._coord.resetGraphsOfAxis(this)}}],[{key:"defaultProps",value:function(){return{field:{detail:"轴字段配置",documentation:"目前x轴的field只支持单维度设置，也就是说只支持一条x轴",default:[]},layoutType:{detail:"布局方式",default:"rule"},width:{detail:"轴宽",default:0},height:{detail:"轴高",default:0},enabled:{detail:"是否显示轴",default:!0},animation:{detail:"是否开启动画",default:!0},title:{detail:"轴名称",propertys:{shapeType:"text",textAlign:{detail:"水平对齐方式",default:"center"},textBaseline:{detail:"基线对齐方式",default:"middle"},strokeStyle:{detail:"文本描边颜色",default:null},lineHeight:{detail:"行高",default:0},text:{detail:"轴名称的内容",default:""},fontColor:{detail:"颜色",default:"#999"},fontSize:{detail:"字体大小",default:12}}},tickLine:{detail:"刻度线",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"刻度线宽",default:1},lineLength:{detail:"刻度线长度",default:4},distance:{detail:"和前面一个元素的距离",default:2},strokeStyle:{detail:"描边颜色",default:"#e6e6e6"}}},axisLine:{detail:"轴线配置",propertys:{enabled:{detail:"是否有轴线",default:!0},position:{detail:"轴线的位置",documentation:'default在align的位置（left，right），可选 "center" 和 具体的值',default:"default"},lineWidth:{detail:"轴线宽度",default:1},strokeStyle:{detail:"轴线的颜色",default:"#e6e6e6"}}},label:{detail:"刻度文本",propertys:{enabled:{detail:"是否显示刻度文本",default:!0},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"字体大小",default:10},rotation:{detail:"旋转角度",default:0},format:{detail:"label文本的格式化处理函数",default:null},distance:{detail:"和轴线之间的间距",default:2},textAlign:{detail:"水平方向对齐方式",default:"center"},lineHeight:{detail:"文本的行高",default:1},evade:{detail:"是否开启逃避算法,目前的逃避只是隐藏",default:!0},alpha:{detail:"透明度",default:1}}},filter:{detail:"过滤函数",documentation:"可以用来过滤哪些yaxis 的 节点是否显示已经颜色之类的",default:null},trimLayout:{detail:"自定义的显示规则函数",documentation:"如果用户有手动的 trimLayout ，那么就全部visible为true，然后调用用户自己的过滤程序",default:null}}}}]),i}(i(Cn).default);e.default=d}));e(Dn);var On=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(kn),h=i(Dn);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var c=u.default._,p=u.default.Shapes.Line,g=function(t){(0,o.default)(i,t);var e=f(i);function i(t,a,o){var l;return(0,n.default)(this,i),(l=e.call(this,t,a.org)).type="xAxis",l._coord=o||{},l._title=null,l._axisLine=null,l._formatTextSection=[],l._textElements=[],l.pos={x:0,y:0},l.layoutData=[],l.sprite=null,l.isH=!1,c.extend(!0,(0,r.default)(l),(0,bn.getDefaultProps)(i.defaultProps()),t),l.init(t),l}return(0,a.default)(i,[{key:"init",value:function(t){this._setField(),this._initHandle(t),this.sprite=new u.default.Display.Sprite({id:"xAxisSprite_"+(new Date).getTime()}),this.rulesSprite=new u.default.Display.Sprite({id:"xRulesSprite_"+(new Date).getTime()}),this.sprite.addChild(this.rulesSprite)}},{key:"_initHandle",value:function(t){var e=this;t&&(!t.isH||t.label&&void 0!==t.label.rotaion||(this.label.rotation=90)),this.setDataSection(),e._formatTextSection=[],e._textElements=[],c.each(e.dataSection,(function(t,n){e._formatTextSection[n]=e._getFormatText(t,n);var i=new u.default.Display.Text(e._formatTextSection[n],{context:{fontSize:e.label.fontSize}});e._textElements[n]=i})),0!=this.label.rotation&&(this.label.textAlign="right"),this._getTitle(),this._setXAxisHeight()}},{key:"_setField",value:function(t){t&&(this.field=t),this.field=c.flatten([this.field])[0]}},{key:"draw",value:function(t){t&&c.extend(!0,this,t),this.setAxisLength(this.width),this._trimXAxis(),this._widget(t),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"resetData",value:function(t,e){e&&c.extend(!0,this,e),this._setField(t.field),this.resetDataOrg(t.org),this._initHandle(),this.draw(e)}},{key:"setX",value:function(t){this.sprite.context.x=t,this.pos.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t,this.pos.y=t}},{key:"_getTitle",value:function(){this.title.text&&(this._title?this._title.resetText(this.title.text||""):this._title=new u.default.Display.Text(this.title.text,{context:{fontSize:this.title.fontSize,textAlign:this.title.textAlign,textBaseline:this.title.textBaseline,fillStyle:this.title.fontColor,strokeStyle:this.title.strokeStyle,lineWidth:this.title.lineWidth,rotation:this.isH?-180:0}}))}},{key:"_setXAxisHeight",value:function(){var t=this;if(t.enabled){var e=0;this.label.enabled&&c.each(t.dataSection,(function(n,i){var a=t._textElements[i],r=a.getTextWidth(),o=a.getTextHeight();if(t.label.rotation)if(90==t.label.rotation)o=r;else{var l=Math.sin(Math.abs(t.label.rotation)*Math.PI/180);o=parseInt(l*r)}e=Math.max(e,o)})),this.height=e+this.tickLine.lineLength+this.tickLine.distance+this.label.distance,this._title&&(this.height+=this._title.getTextHeight())}else t.height=0}},{key:"getNodeInfoOfX",value:function(t){var e=this.getIndexOfPos(t),n=this.getValOfInd(e),i=this.getPosOf({ind:e,val:n});return this._getNodeInfo(e,n,i)}},{key:"getNodeInfoOfVal",value:function(t){var e=this.getIndexOfVal(t),n=this.getPosOf({ind:e,val:t});return this._getNodeInfo(e,t,n)}},{key:"_getNodeInfo",value:function(t,e,n){return{ind:t,value:e,text:this._getFormatText(e,t),x:n,field:this.field,layoutType:this.layoutType}}},{key:"_trimXAxis",value:function(){for(var t=[],e=this.dataSection,n=0,i=e.length;n<i;n++){var a=this._formatTextSection[n],r=this._textElements[n],o={ind:n,value:e[n],text:a,x:this.getPosOf({val:e[n],ind:n}),textWidth:r.getTextWidth(),field:this.field,visible:null};t.push(o)}return this.layoutData=t,this._trimLayoutData(),t}},{key:"_getFormatText",value:function(t,e){if(this.label.format)c.isFunction(this.label.format)&&(t=this.label.format.apply(this,arguments)),"string"==typeof this.label.format&&(t=(0,d.default)(t).format(this.label.format));else{var n=this._coord.fieldsConfig[this.field];n&&(t=this._coord.getFormatValue(t,n,e))}return t}},{key:"_widget",value:function(t){var e=this,n=this;if(!t&&(t={}),n.enabled){for(var i=n.layoutData,a=0,r=function(r,o){c.isFunction(n.filter)&&n.filter({layoutData:i,index:r});var l=i[r];if(!l.visible)return"continue";var s=l.x,d=n.tickLine.lineLength+n.tickLine.distance+n.label.distance,h=n.rulesSprite.getChildAt(a),f=function(t){var n=t;return c.isFunction(t)&&(n=t.apply(e,[l,i,r])),n},g={x:l._text_x||l.x,y:d,fillStyle:f(e.label.fontColor),fontSize:f(e.label.fontSize),rotation:-Math.abs(e.label.rotation),textAlign:f(e.label.textAlign),lineHeight:f(e.label.lineHeight),textBaseline:e.label.rotation?"middle":"top",globalAlpha:f(e.label.alpha)};e.label.rotation&&90!=e.label.rotation&&(g.x+=5,g.y+=3);var y={x:s,y:e.tickLine.distance,end:{x:0,y:e.tickLine.lineLength},lineWidth:e.tickLine.lineWidth,strokeStyle:e.tickLine.strokeStyle},v=300;Math.min(1e3/i.length,25);n.animation&&!t.resize||(v=0),h?(h._tickLine&&n.tickLine.enabled&&h._tickLine.animate(y,{duration:v,id:h._tickLine.id}),h._txt&&n.label.enabled&&(h._txt.animate(g,{duration:v,id:h._txt.id}),h._txt.resetText(l.text||""))):(h=new u.default.Display.Sprite({id:"xNode"+a}),n.tickLine.enabled&&(h._tickLine=new p({id:"xAxis_tickline_"+a,context:y}),h.addChild(h._tickLine)),n.label.enabled&&(h._txt=new u.default.Display.Text(l.text,{id:"xAxis_txt_"+a,context:g}),h.addChild(h._txt)),n.rulesSprite.addChild(h)),a++},o=0,l=i.length;o<l;o++)r(o);if(this.rulesSprite.children.length>=a)for(var s=a,d=this.rulesSprite.children.length;s<d;s++)this.rulesSprite.getChildAt(s).remove(),s--,d--;if(this.axisLine.enabled){var h={start:{x:0,y:0},end:{x:this.width,y:0},lineWidth:this.axisLine.lineWidth,strokeStyle:this.axisLine.strokeStyle};if(this._axisLine)this._axisLine.animate(h);else{var f=new p({context:h});this.sprite.addChild(f),this._axisLine=f}}this._title&&(this._title.context.y=this.height-this._title.getTextHeight()/2,this._title.context.x=this.width/2,this.sprite.addChild(this._title))}else n.height=0}},{key:"_trimLayoutData",value:function(){var t=this,e=this.layoutData.length;this.enabled&&e&&("proportion"==t.layoutType&&this._checkOver(),"peak"==t.layoutType&&this._checkOver(),"rule"==t.layoutType&&this._checkOver())}},{key:"_getRootPR",value:function(){var t=0;return this._coord.app&&(t=this._coord.app.padding.right),t}},{key:"_checkOver",value:function(){var t=this,e=t.layoutData,n=e.length,i=t.label.textAlign;if(this.label.evade&&!t.trimLayout)!function a(r){var o=e[r];if(void 0!==o){o.visible=!0;for(var l=r;l<n-1;l++){var s=e[l+1],u=s.textWidth,d=o.textWidth;t.label.rotation&&(u=Math.min(u,22),d=Math.min(d,22));var h=s.x,f=o.x+d;if("center"==i&&(h=s.x-u/2,f=o.x+d/2),"right"==i&&(h=s.x-u,f=o.x),l==n-2&&h+u>t.width+t._getRootPR()&&("center"==i&&s.x+u/2>t.width&&(h=t.width-u,s._text_x=t.width-u/2+t._getRootPR()),"left"==i&&s.x+u>t.width&&(h=t.width-u,s._text_x=t.width-u)),!(h-f<1)){a(l+1);break}if(l==n-2)return s.visible=!0,void(o.visible=!1);s.visible=!1}}}(0);else{var a;c.each(e,(function(t){t.visible=!0})),t.trimLayout&&t.trimLayout(e);for(var r=n-1;r>=0&&!a;r--)e[r].visible&&(a=e[r]);a&&("center"==i&&a.x+a.textWidth/2>t.width&&(a._text_x=t.width-a.textWidth/2+t._getRootPR()),"left"==i&&a.x+a.textWidth>t.width&&(a._text_x=t.width-a.textWidth))}}}],[{key:"defaultProps",value:function(){return{}}}]),i}(h.default);e.default=g}));e(On);var Tn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Dn),h=i(kn);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var c=u.default._,p=u.default.Shapes.Line,g=function(t){(0,o.default)(i,t);var e=f(i);function i(t,a,o){var l;return(0,n.default)(this,i),(l=e.call(this,t,a.org)).type="yAxis",l._coord=o||{},l._title=null,l._axisLine=null,l.maxW=0,l.pos={x:0,y:0},l.yMaxHeight=0,l.layoutData=[],l.sprite=null,l.isH=!1,c.extend(!0,(0,r.default)(l),(0,bn.getDefaultProps)(i.defaultProps()),t),l.init(t),l}return(0,a.default)(i,[{key:"init",value:function(t){this._setField(),this._initHandle(t),this.sprite=new u.default.Display.Sprite({id:"yAxisSprite_"+(new Date).getTime()}),this.rulesSprite=new u.default.Display.Sprite({id:"yRulesSprite_"+(new Date).getTime()}),this.sprite.addChild(this.rulesSprite)}},{key:"_initHandle",value:function(t){t&&(!t.isH||t.label&&void 0!==t.label.rotaion||(this.label.rotation=90),t.label&&t.label.textAlign||(this.label.textAlign="left"==this.align?"right":"left")),this.setDataSection(),this._getTitle(),this._setYaxisWidth()}},{key:"_setField",value:function(t){t&&(this.field=t),c.isArray(this.field)||(this.field=[this.field])}},{key:"draw",value:function(t){c.extend(!0,this,t||{}),this.height=parseInt(this.yMaxHeight-this._getYAxisDisLine()),this.setAxisLength(this.height),this.sprite.cleanAnimates(),this._trimYAxis(),this._widget(t),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"resetData",value:function(t){"width"in this._opt||(this.width=0),this._setField(t.field),this.resetDataOrg(t.org),this._initHandle(),this.draw()}},{key:"setX",value:function(t){this.sprite.context.x=t,this.pos.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t,this.pos.y=t}},{key:"_getTitle",value:function(){if(this.title.text)if(this._title)this._title.resetText(this.title.text);else{var t=0;"left"==this.align?t=-90:(t=90,this.isH&&(t=270)),this._title=new u.default.Display.Text(this.title.text,{context:{fontSize:this.title.fontSize,textAlign:this.title.textAlign,textBaseline:this.title.textBaseline,fillStyle:this.title.fontColor,strokeStyle:this.title.strokeStyle,lineWidth:this.title.lineWidth,rotation:t}})}}},{key:"_setYaxisWidth",value:function(){}},{key:"_trimYAxis",value:function(){for(var t=[],e=0,n=this.dataSection.length;e<n;e++){var i={value:this.dataSection[e],y:-Math.abs(this.getPosOf({val:this.dataSection[e],ind:e})),visible:!0,text:""};i.text=this._getFormatText(i.value,e),t.push(i)}for(var a=0,r=0,o=t.length;r<o;r++)0!=r&&(0==a?t[r].text==t[a].text?t[r].visible=!1:a=r:(t[r].text==t[a].text&&(t[a].visible=!1),a=r));this.layoutData=t,this.trimLayout&&this.trimLayout(t)}},{key:"_getFormatText",value:function(t,e){if(this.label.format)c.isFunction(this.label.format)&&(t=this.label.format.apply(this,arguments)),"string"==typeof this.label.format&&(t=(0,h.default)(t).format(this.label.format));else{for(var n,i=c.flatten([this.field]),a=0,r=i.length;a<r&&!(n=this._coord.fieldsConfig[i[a]]);a++);n&&(t=this._coord.getFormatValue(t,n,e))}return t}},{key:"_getYAxisDisLine",value:function(){var t=0;return t=(t=0+this.yMaxHeight%this.dataSection.length)>0?0:t}},{key:"resetWidth",value:function(t){var e=this;e.width=t,"left"==e.align&&(e.rulesSprite.context.x=e.width)}},{key:"_widget",value:function(t){var e=this;if(!t&&(t={}),e.enabled){var n=this.layoutData,i=0;e.maxW=0;for(var a=0,r=n.length;a<r;a++){c.isFunction(e.filter)&&e.filter({layoutData:n,index:a});var o=n[a];if(o.visible){var l=o.y,s=e.label.textAlign,d=l+(0==a?-3:0)+(a==n.length-1?3:0);90!=e.label.rotation&&-90!=e.label.rotation||(s="center",a==n.length-1&&(d=l-2,s="right"),0==a&&(d=l));var h=16;o.value==e.origin&&(h=0),o.value<e.origin&&(h=-16);var f=0,g=void 0;e.tickLine.enabled&&(g={x:f="left"==e.align?-e.tickLine.lineLength-e.tickLine.distance:e.tickLine.distance,y:l,end:{x:e.tickLine.lineLength,y:0},lineWidth:e.tickLine.lineWidth,strokeStyle:e._getStyle(e.tickLine.strokeStyle)});var y=void 0;if(e.label.enabled){var v="left"==e.align?f-e.label.distance:f+e.tickLine.lineLength+e.label.distance;this.isH&&(v+=4*("left"==e.align?-1:1)),y={x:v,y:d,fillStyle:e._getStyle(e.label.fontColor),fontSize:e.label.fontSize,rotation:-Math.abs(e.label.rotation),textAlign:s,textBaseline:"middle",lineHeight:e.label.lineHeight,globalAlpha:1}}var x=300;e.animation&&!t.resize||(x=0);var _=this.rulesSprite.getChildAt(i);_?(_._tickLine&&e.tickLine.enabled&&_._tickLine.animate(g,{duration:x,id:_._tickLine.id}),_._txt&&e.label.enabled&&(_._txt.animate(y,{duration:x,id:_._txt.id}),_._txt.resetText(o.text))):(_=new u.default.Display.Sprite({id:"_node"+i}),e.tickLine.enabled&&(_._tickLine=new p({id:"yAxis_tickline_"+i,context:g}),_.addChild(_._tickLine)),e.label.enabled&&(_._txt=new u.default.Display.Text(o.text,{id:"yAxis_txt_"+i,context:y}),_.addChild(_._txt),e.animation&&!t.resize&&(_._txt.context.y=l+h,_._txt.context.globalAlpha=0,_._txt.animate({y:y.y,globalAlpha:1},{duration:300,id:_._txt.id}))),e.rulesSprite.addChild(_)),e.label.enabled&&(90==e.label.rotation||-90==e.label.rotation?e.maxW=Math.max(e.maxW,_._txt.getTextHeight()):e.maxW=Math.max(e.maxW,_._txt.getTextWidth())),i++}}if(e.rulesSprite.children.length>=i)for(var m=i,b=e.rulesSprite.children.length;m<b;m++)e.rulesSprite.getChildAt(m).remove(),m--,b--;if(!("width"in e._opt)){e.width;e.width=parseInt(e.maxW+e.label.distance),e.tickLine.enabled&&(e.width+=parseInt(e.tickLine.lineLength+e.tickLine.distance)),e._title&&(e.width+=e._title.getTextHeight()),e.width}var w=0;if("left"==e.align&&(e.rulesSprite.context.x=e.width,w=e.width),e.axisLine.enabled){var k={start:{x:w,y:0},end:{x:w,y:-e.height},lineWidth:e.axisLine.lineWidth,strokeStyle:e._getStyle(e.axisLine.strokeStyle)};if(this._axisLine)this._axisLine.animate(k);else{var S=new p({context:k});this.sprite.addChild(S),this._axisLine=S}}this._title&&(this._title.context.y=-this.height/2,this._title.context.x=this._title.getTextHeight()/2,"right"==this.align&&(this._title.context.x=this.width-this._title.getTextHeight()/2),this.sprite.addChild(this._title))}else e.width=0}},{key:"_getStyle",value:function(t){var e=t;return c.isFunction(t)&&(e=t.call(this,this)),t||(e="#999"),e}}],[{key:"defaultProps",value:function(){return{align:{detail:"左右轴设置",default:"left"},layoutType:{detail:"布局方式",default:"proportion"}}}}]),i}(d.default);e.default=g}));e(Tn);var Mn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var h=u.default._,f=u.default.event,c=u.default.Shapes.Line,p=u.default.Shapes.Rect,g=function(t){(0,o.default)(i,t);var e=d(i);function i(t,a){var o;return(0,n.default)(this,i),o=e.call(this,t,a),h.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps())),o.width=0,o.height=0,o._coord=a,o.pos={x:0,y:0},o.sprite=null,o.xAxisSp=null,o.yAxisSp=null,o.init(t),o}return(0,a.default)(i,[{key:"init",value:function(t){h.extend(!0,this,t),this.sprite=new u.default.Display.Sprite}},{key:"setX",value:function(t){this.sprite.context.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t}},{key:"draw",value:function(t){h.extend(!0,this,t),this._widget(),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"clean",value:function(){this.sprite.removeAllChildren()}},{key:"reset",value:function(t){this.sprite.removeAllChildren(),this.draw(t)}},{key:"_widget",value:function(){var t=this;if(this.enabled){var e=t._coord._yAxis[0],n=t._coord._xAxis;this.fillSp=new u.default.Display.Sprite,this.sprite.addChild(this.fillSp),h.each([t.fill.xDimension,t.fill.yDimension],(function(i,a){var r=a?e:n,o=[];if(i.enabled){o=i.splitVals?h.flatten([i.splitVals]):r.dataSection;var l=[];if(o.length){o=h.uniq(o);for(var s=[0],d=function(e,n){var i=o[e],a=r.getPosOf({val:i});if(1==s.length){if(!a&&"xAxis"==r.type&&"rule"==r.layoutType){var u=t._coord.app.dataFrame,d=h.find(u.jsonOrg,(function(t){return t[r.field]==i}));if(d){var f=d.__index__;f<=u.range.start&&(a=0),f>=u.range.end&&(a=t.width)}}s.push(a),l.push(s);var c=s[1];s=[c]}},f=0,c=o.length;f<c;f++)d(f);h.each(l,(function(e,n){if(!(!e||e&&e.length&&e[1]==e[0])){var r={fillStyle:t.getProp(i.fillStyle,n,"#000"),fillAlpha:t.getProp(i.alpha,n,n%2*.02)};a?(r.x=0,r.y=-e[0],r.width=t.width,r.height=-(e[1]-e[0])):(r.x=e[0],r.y=0,r.width=e[1]-e[0],r.height=-t.height);var o=new p({context:r});t.fillSp.addChild(o);var l=t.getProp(i.splitLabels,n,"");if(l){var s=t.getProp(i.fontColor,n,"#666"),d=t.getProp(i.fontSize,n,12),h="center",f="top",c=r.x+r.width/2,g=r.height+8;a&&(h="left",f="middle",c=r.x+8,g=r.y+r.height/2);var y=new u.default.Display.Text(l,{context:{fontSize:d,fillStyle:s,x:c,y:g,textAlign:h,textBaseline:f}});t.fillSp.addChild(y)}}}))}}})),t.xAxisSp=new u.default.Display.Sprite,t.sprite.addChild(t.xAxisSp),t.yAxisSp=new u.default.Display.Sprite,t.sprite.addChild(t.yAxisSp);for(var i=e?e.layoutData:[],a=0,r=i.length;a<r;a++){var o=i[a];if(o.visible){var l=new c({id:"back_line_"+a,context:{y:o.y,lineType:t.getProp(t.line.xDimension.lineType,a,"solid"),lineWidth:t.getProp(t.line.xDimension.lineWidth,a,1),strokeStyle:t.getProp(t.line.xDimension.strokeStyle,a,"#f0f0f0"),visible:!0}});t.line.xDimension.enabled&&(t.xAxisSp.addChild(l),l.context.start.x=0,l.context.end.x=t.width)}}for(var s=0,d=(i=n.layoutData).length;s<d;s++){var f=i[s],g=new c({context:{x:f.x,start:{x:0,y:0},end:{x:0,y:-t.height},lineType:t.getProp(t.line.yDimension.lineType,s,"solid"),lineWidth:t.getProp(t.line.yDimension.lineWidth,s,1),strokeStyle:t.getProp(t.line.yDimension.strokeStyle,s,"#f0f0f0"),visible:!0}});t.line.yDimension.enabled&&t.yAxisSp.addChild(g)}}}},{key:"getProp",value:function(t,e,n){var i=n;return null!=t&&null!=t&&((h.isString(t)||h.isNumber(t))&&(i=t),h.isFunction(t)&&(i=t.apply(this,[e,n])),h.isArray(t)&&(i=t[e])),i}}],[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启grid绘制",default:!0},line:{detail:"网格线条配置",propertys:{xDimension:{detail:"一维方向的网格线",propertys:{enabled:{detail:"是否开启",default:!0},data:[],lineType:{detail:"线的样式，虚线或者实现",default:"solid"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#e6e6e6"}}},yDimension:{detail:"二维方向的网格线",propertys:{enabled:{detail:"是否开启",default:!1},data:[],lineType:{detail:"线的样式，虚线或者实现",default:"solid"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#f0f0f0"}}}}},fill:{detail:"背景色配置",propertys:{xDimension:{detail:"以为方向的背景色块，x方向",propertys:{enabled:{detail:"是否开启",default:!1},splitVals:{detail:"从x轴上面用来分割区块的vals",default:null},splitLabels:{detail:"对应splitVals的文本",default:null},fontColor:{detail:"对应splitLabels的文本颜色",default:null},fontSize:{detail:"对应splitLabels的文本字体大小",default:null},fillStyle:{detail:"背景颜色",default:null},alpha:{detail:"背景透明度",default:null}}},yDimension:{detail:"以为方向的背景色块，y方向",propertys:{enabled:{detail:"是否开启",default:!1},splitVals:{detail:"从x轴上面用来分割区块的vals",default:null},splitLabels:{detail:"对应splitVals的文本",default:null},fontColor:{detail:"对应splitLabels的文本颜色",default:null},fontSize:{detail:"对应splitLabels的文本字体大小",default:null},fillStyle:{detail:"背景颜色",default:null},alpha:{detail:"背景透明度",default:null}}}}}}}}]),i}(f.Dispatcher);e.default=g}));e(Mn);var En=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(fn),a=i(hn),r=(0,n.default)((function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.default)(this,t),this.comp=e,this.params=n}));e.default=r}));e(En);var Rn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(Sn),d=i(ln),h=i(On),f=i(Tn),c=i(Mn),p=i(En);function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var y=d.default._,v=d.default.event,x=function(t){(0,o.default)(i,t);var e=g(i);function i(t,a){var o;return(0,n.default)(this,i),o=e.call(this,t,a),y.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),o.setDefaultOpt(t,a)),o.type="rect",o._xAxis=null,o._yAxis=[],o._yAxisLeft=null,o._yAxisRight=null,o._grid=null,o.init(t),o}return(0,a.default)(i,[{key:"setDefaultOpt",value:function(t,e){var n={field:this.dataFrame.fields[0],xAxis:{layoutType:"rule",posParseToInt:!1},grid:{}};if(y.extend(!0,n,t),n.yAxis){var i=[];y.each(y.flatten([n.yAxis]),(function(t){i.push(y.clone(t))})),n.yAxis=i}else n.yAxis=[];for(var a=e._opt.graphs?y.flatten([e._opt.graphs]):[],r=0;r<a.length;r++){var o=a[r];"bar"==o.type&&(n.xAxis.layoutType="peak"),o.field&&function(){var t="left";"right"==o.yAxisAlign&&(t="right");var e=null;e=y.find(n.yAxis,(function(e,n){return e.align==t||!e.align&&n==("left"==t?0:1)})),e?e.align||(e.align=t):(e={align:t,field:[]},n.yAxis.push(e)),e.field?y.isArray(e.field)||(e.field=[e.field]):e.field=[],y.isArray(o.field)?e.field=e.field.concat(o.field):e.field.push(o.field)}()}var l=[],s=[];return y.each(n.yAxis,(function(t,e){t.align||(t.align=e?"right":"left"),"left"==t.align?l.push(t):s.push(t)})),n.yAxis=l.concat(s),n.horizontal&&(n.xAxis.isH=!0,y.each(n.yAxis,(function(t){t.isH=!0}))),"enabled"in n&&(y.extend(!0,n.xAxis,{enabled:n.enabled}),y.each(n.yAxis,(function(t){y.extend(!0,t,{enabled:n.enabled})})),n.grid.enabled=n.enabled),"animation"in n&&(y.extend(!0,n.xAxis,{animation:n.animation}),y.each(n.yAxis,(function(t){y.extend(!0,t,{animation:n.animation})})),n.grid.animation=n.animation),n}},{key:"init",value:function(){this._initModules(),this.graphsFieldsMap=this.setGraphsFieldsMap({type:"yAxis"})}},{key:"resetData",value:function(t){var e=this,n=this.app.padding,i=this._opt.width||this.app.width;this.dataFrame=t;var a=0,r=0;y.each(this._yAxis,(function(t){var n=e.getAxisDataFrame(t.field);t.resetData(n),a+=t.width,"left"==t.align&&(r=t.width)}));var o=i-a-n.left-n.right;this.width=o;var l=this.getAxisDataFrame(this.xAxis.field);this._xAxis.resetData(l,{width:o,pos:{x:n.left+r}}),this.origin.x=r+n.left,this._resetXY_axisLine_pos(),this._grid.reset({animation:!1})}},{key:"draw",value:function(t){!t&&(t={});var e=this.app.padding,n=t.height||this.app.height,i=t.width||this.app.width;if(this.horizontal){var a=i;i=n,n=a}var r=n-this._xAxis.height-e.bottom,o=0,l=0;this._yAxisLeft&&(this._yAxisLeft.draw({pos:{x:e.left,y:r},yMaxHeight:r-e.top,resize:t.resize}),o=this._yAxisLeft.width),this._yAxisRight&&(this._yAxisRight.draw({pos:{x:0,y:r},yMaxHeight:r-e.top,resize:t.resize}),l=this._yAxisRight.width),this._xAxis.draw({pos:{x:e.left+o,y:r},width:i-o-e.left-l-e.right,resize:t.resize}),this._yAxisRight&&this._yAxisRight.setX(o+e.left+this._xAxis.width),this.width=this._xAxis.width,this.height=this._yAxis.length?this._yAxis[0].height:0,this.origin.x=o+e.left,this.origin.y=r,this._grid.draw({width:this.width,height:this.height,pos:this.origin,resize:t.resize}),this._initInduce(),this._resetXY_axisLine_pos(),this.horizontal&&this._horizontal({w:i,h:n})}},{key:"_resetXY_axisLine_pos",value:function(){var t,e=this;this._xAxis.enabled&&("center"==this._xAxis.axisLine.position&&(t=-this._yAxis[0].height/2),"center"==this._xAxis.axisLine.position&&(t=-this._yAxis[0].height/2),y.isNumber(this._xAxis.axisLine.position)&&(t=-this._yAxis[0].getPosOfVal(this._xAxis.axisLine.position)),void 0!==t&&(this._xAxis._axisLine.context.y=t)),y.each(this._yAxis,(function(t){var n;t.enabled&&("center"==t.axisLine.position&&(n=e._xAxis.width/2),y.isNumber(t.axisLine.position)&&(n=e._xAxis.getPosOfVal(t.axisLine.position)),void 0!==n&&(t._axisLine.context.x=n))}))}},{key:"getSizeAndOrigin",value:function(){var t={width:this.width,height:this.height,origin:this.origin};if(this.horizontal){var e=this.app.padding,n=e.bottom,i=e.right;t={width:this._yAxis[0].height,height:this._xAxis.width,origin:{x:this._xAxis.height+n,y:this._yAxis[0].height+i}}}return t}},{key:"_initModules",value:function(){this._grid=new c.default(this.grid,this),this.sprite.addChild(this._grid.sprite);var t=this.getAxisDataFrame(this.xAxis.field);this._xAxis=new h.default(this.xAxis,t,this),this._axiss.push(this._xAxis),this.sprite.addChild(this._xAxis.sprite);var e,n,i,a,r=this.yAxis;y.isArray(r)||(r=[r]),(e=y.find(r,(function(t){return"left"==t.align})))&&(i=this.getAxisDataFrame(e.field),this._yAxisLeft=new f.default(e,i,this),this._yAxisLeft.axis=e,this.sprite.addChild(this._yAxisLeft.sprite),this._yAxis.push(this._yAxisLeft),this._axiss.push(this._yAxisLeft)),(n=y.find(r,(function(t){return"right"==t.align})))&&(a=this.getAxisDataFrame(n.field),this._yAxisRight=new f.default(n,a,this),this._yAxisRight.axis=n,this.sprite.addChild(this._yAxisRight.sprite),this._yAxis.push(this._yAxisRight),this._axiss.push(this._yAxisRight))}},{key:"_horizontal",value:function(t){var e=t.h,n=t.w;y.each([this.sprite.context],(function(t){t.x+=(e-n)/2,t.y+=(n-e)/2;var i={x:n/2,y:e/2};t.rotation=90,t.rotateOrigin=i}))}},{key:"changeFieldEnabled",value:function(t){this.setFieldEnabled(t);var e=this.getFieldConfig(t),n=e.yAxis||e.rAxis,i=this.getEnabledFieldsOf(n);n.resetData(this.getAxisDataFrame(i)),this._resetXY_axisLine_pos(),this._grid.reset({animation:!1})}},{key:"_initInduce",value:function(){var t=this;t.induce=new d.default.Shapes.Rect({id:"induce",context:{x:t.origin.x,y:t.origin.y-t.height,width:t.width,height:t.height,fillStyle:"#000000",globalAlpha:0,cursor:"pointer"}}),t.sprite.getChildById("induce")||t.sprite.addChild(t.induce),t.induce.on(v.types.get(),(function(e){t.fire(e.type,e),t.app.fire(e.type,e)}))}},{key:"getTipsInfoHandler",value:function(t){var e=t.point.x;t.target!==this.induce&&(e=this.induce.globalToLocal(t.target.localToGlobal(t.point)).x);var n=this._xAxis.getNodeInfoOfX(e),i={xAxis:n,dimension_1:n,title:n.text,iNode:n.ind,nodes:[]};return t.eventInfo&&(y.extend(!0,i,t.eventInfo),i.xAxis&&(t.eventInfo.xAxis=n)),i}},{key:"getPoint",value:function(t){var e={x:0,y:void 0},n={type:"yAxis",field:t.field},i=this.getAxis({type:"xAxis"}),a=this.getAxis(n),r=t.iNode||0,o=t.value;"x"in o||(o.x=y.flatten(i.dataOrg)[r]),e.x=i.getPosOf({ind:r,val:o.x});var l=o.y;return isNaN(l)||null==l||""===l?e.y=void 0:(t.vIndex&&a._min>0&&(l+=a._min),e.y=-a.getPosOfVal(l)),{pos:e,value:o}}},{key:"getAxisOriginPoint",value:function(t){var e=this.getAxis(t);return{pos:-e.originPos,value:e.origin}}},{key:"getOriginPos",value:function(t){var e={type:"yAxis",field:t.field},n=this.getAxis({type:"xAxis"}),i=this.getAxis(e);return{x:n.originPos,y:-i.originPos}}},{key:"resetGraphsOfAxis",value:function(t){var e=this,n=this.app.getGraphs();"yAxis"==t.type&&n.forEach((function(n){n.yAxisAlign==t.align&&n.resetData(null,new p.default(e))}))}}],[{key:"defaultProps",value:function(){return{horizontal:{detail:"横向翻转坐标系",documentation:"横向翻转坐标系",insertText:"horizontal: ",default:!1,values:[!0,!1]},_props:{xAxis:h.default,yAxis:f.default,grid:c.default}}}}]),i}(u.default);u.default.registerComponent(x,"coord","rect");var _=x;e.default=_}));e(Rn);var In=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var h=u.default._,f=u.default.event,c=u.default.Shapes.Line,p=u.default.Shapes.Circle,g=u.default.Shapes.Polygon,y=function(t){(0,o.default)(i,t);var e=d(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).width=0,o.height=0,o.app=a,o.pos={x:0,y:0},o.dataSection=[],o.sprite=null,o.induce=null,h.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.init(t),o}return(0,a.default)(i,[{key:"init",value:function(){this.sprite=new u.default.Display.Sprite}},{key:"setX",value:function(t){this.sprite.context.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t}},{key:"draw",value:function(t){h.extend(!0,this,t),this._widget(),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"clean",value:function(){this.sprite.removeAllChildren()}},{key:"reset",value:function(t){}},{key:"_widget",value:function(){var t=this;h.each(this.dataSection,(function(e,n){if(e){var i,a=t.app.getROfNum(e),r=t.app.getPointsOfR(a),o={lineWidth:t.ring.lineWidth,strokeStyle:t._getStyle(t.ring.strokeStyle,n-1),fillStyle:t._getStyle(t.ring.fillStyle,n-1),fillAlpha:t.ring.fillAlpha},l=p;"circle"==t.ring.shapeType?(o.r=a,i=new l({context:o})):(o.pointList=[],h.each(r,(function(t,e){e<r.length&&o.pointList.push([t.x,t.y])})),i=new(l=g)({context:o})),t.sprite.addChildAt(i,0),n==t.dataSection.length-1&&(o.fillAlpha=0,o.fillStyle="#ffffff",t.induce=new l({context:o}),t.sprite.addChild(t.induce)),h.each(r,(function(e){var n=new c({context:{end:e,lineWidth:t.ring.lineWidth,strokeStyle:t.ring.strokeStyle}});t.sprite.addChild(n)}))}}))}},{key:"_getStyle",value:function(t,e){return h.isArray(t)?t[e%t.length]:t}}],[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启grid",default:!1},ring:{detail:"环背景线",propertys:{shapeType:{detail:"线的图形样式，默认poly，可选circle",default:"poly"},lineType:{detail:"线条样式，sold实线，dashed虚线",default:"sold"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#e5e5e5"},fillStyle:{detail:"环填充色,支持函数配置",default:null},fillAlpha:{detail:"环填充的透明度",default:.5}}},ray:{detail:"射线",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#e5e5e5"}}}}}}]),i}(f.Dispatcher);e.default=y}));e(In);var Ln=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(Sn),d=i(ln),h=i(In),f=i(Pn);function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var p=d.default._,g=d.default.event,y=function(t){(0,o.default)(i,t);var e=c(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="polar",p.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),o.setDefaultOpt(t,a)),o.init(t),o}return(0,a.default)(i,[{key:"setDefaultOpt",value:function(t,e){var n={rAxis:{field:[]},aAxis:{},grid:{}};p.extend(!0,n,t),p.isArray(n.rAxis.field)||(n.rAxis.field=[n.rAxis.field]);var i=p.flatten([e._opt.graphs]),a=[];return p.each(i,(function(t){if(t.field){var e=t.field;p.isArray(e)||(e=[e]),a=a.concat(e)}})),n.rAxis.field=n.rAxis.field.concat(a),t.aAxis&&t.aAxis.field?n.aAxis.enabled=!0:n.grid.enabled=!1,n}},{key:"init",value:function(){this._initModules(),this.graphsFieldsMap=this.setGraphsFieldsMap({type:"rAxis"})}},{key:"_initModules",value:function(){this.grid.enabled&&(this._grid=new h.default(this.grid,this),this.sprite.addChild(this._grid.sprite)),this.aAxis.enabled&&this.grid.enabled&&(this._aAxisScaleSp=new d.default.Display.Sprite({id:"aAxisScaleSp"}),this.sprite.addChild(this._aAxisScaleSp)),this._axiss.push({type:"rAxis",field:this.rAxis.field})}},{key:"draw",value:function(t){this._computeAttr(),this.rAxis.dataSection=this._getRDataSection(),this.aAxis.data=this.app.dataFrame.getFieldData(this.aAxis.field),this._setAAxisAngleList(),this.grid.enabled&&(this._grid.draw({pos:this.origin,width:this.width,height:this.height,dataSection:this.rAxis.dataSection},this),this.aAxis.enabled&&this._drawAAxis(),this._initInduce())}},{key:"resetData",value:function(){}},{key:"changeFieldEnabled",value:function(t){this.setFieldEnabled(t),this.rAxis.dataSection=this._getRDataSection(),this.aAxis.data=this.app.dataFrame.getFieldData(this.aAxis.field),this.grid.enabled&&this._grid.reset({dataSection:this.rAxis.dataSection},this)}},{key:"_getRDataSection",value:function(){var t=this;if(this._opt.rAxis&&this._opt.rAxis.dataSection)return this._opt.rAxis.dataSection;var e=[];return p.each(p.flatten([t.rAxis.field]),(function(n){e=e.concat(t.app.dataFrame.getFieldData(n))})),e.push(0),f.default.section(e,3)}},{key:"_computeAttr",value:function(){var t,e,n=this.app.padding,i=this.app.width,a=this.app.height;"width"in this._opt||(this.width=i-n.left-n.right),"height"in this._opt||(this.height=a-n.top-n.bottom);for(var r=this.width,o=this.height,l=0,s=0,u=0,d=0,h=[this.startAngle],f=0,c=parseInt((this.startAngle+this.allAngle)/90)-parseInt(this.startAngle/90);f<=c;f++){var g=90*parseInt(this.startAngle/90)+90*f;-1==p.indexOf(h,g)&&g>h.slice(-1)[0]&&h.push(g)}var y=this.startAngle+this.allAngle;-1==p.indexOf(h,y)&&h.push(y),p.each(h,(function(t){t%=360;var e=Math.sin(t*Math.PI/180);180==t&&(e=0);var n=Math.cos(t*Math.PI/180);270!=t&&90!=t||(n=0),l=Math.min(l,e),s=Math.max(s,e),u=Math.min(u,n),d=Math.max(d,n)})),e=(Math.abs(u)+Math.abs(d))/(Math.abs(l)+Math.abs(s));var v=Math.min(r,o);if(1==e)r=o=v;else{var x=o*e;x>r?o=r/e:r=x}var _=n.left+(this.width-r)/2,m=n.top+(this.height-o)/2;this.origin={x:_+r*(u/(u-d)),y:m+o*(l/(l-s))};var b={top:this.origin.y-m,right:_+r-this.origin.x,bottom:m+o-this.origin.y,left:this.origin.x-_},w=[],k=[["right","bottom"],["bottom","left"],["left","top"],["top","right"]];p.each(h,(function(t){t%=360;var e=parseInt(t/90),n=k[e];t%90==0&&(n=[["right","bottom","left","top"][e]]);var i=Math.sin(t*Math.PI/180);180==t&&(i=0);var a=Math.cos(t*Math.PI/180);270!=t&&90!=t||(a=0),p.each(n,(function(t){var e;"top"!=t&&"bottom"!=t||i&&(e=Math.abs(b[t]/i)),"right"!=t&&"left"!=t||a&&(e=Math.abs(b[t]/a)),w.push(e)}))})),t=p.min(w),this.aAxis.label.enabled&&(t-=20),this.radius=t}},{key:"getMaxDisToViewOfOrigin",value:function(){var t=this.origin,e=this.app.padding,n=this.app.width,i=this.app.height,a=n-e.left-e.right,r=i-e.top-e.bottom,o=[t.x-e.left,a+e.left-t.x,t.y-e.top,r+e.top-t.y];return p.max(o)}},{key:"getRadiansAtR",value:function(t,e,n){var i=this;null==e&&(e=this.width),null==n&&(n=this.height);var a,r,o=[],l=this.app.padding,s={x:this.origin.x-l.left-(this.width-e)/2,y:this.origin.y-l.top-(this.height-n)/2},u=s.y;u<t&&(a=Math.sqrt(Math.pow(t,2)-Math.pow(u,2)),o=o.concat(this._filterPointsInRect([{x:-a,y:-u},{x:a,y:-u}],s,e,n)));var d=e-s.x;d<t&&(r=Math.sqrt(Math.pow(t,2)-Math.pow(d,2)),o=o.concat(this._filterPointsInRect([{x:d,y:-r},{x:d,y:r}],s,e,n)));var h=n-s.y;h<t&&(a=Math.sqrt(Math.pow(t,2)-Math.pow(h,2)),o=o.concat(this._filterPointsInRect([{x:a,y:h},{x:-a,y:h}],s,e,n)));var f=s.x;f<t&&(r=Math.sqrt(Math.pow(t,2)-Math.pow(f,2)),o=o.concat(this._filterPointsInRect([{x:-f,y:r},{x:-f,y:-r}],s,e,n)));var c=[];0==o.length?c.push([{point:{x:t,y:0},radian:0},{point:{x:t,y:0},radian:2*Math.PI}]):p.each(o,(function(t,e){var n=e==o.length-1?0:e+1,a=o.slice(n,n+1)[0];c.push([{point:t,radian:i.getRadianInPoint(t)},{point:a,radian:i.getRadianInPoint(a)}])}));for(var g=0,y=c.length;g<y;g++)this._checkArcInRect(c[g],t,s,e,n)||(c.splice(g,1),g--,y--);return c}},{key:"_filterPointsInRect",value:function(t,e,n,i){for(var a=0,r=t.length;a<r;a++)this._checkPointInRect(t[a],e,n,i)||(t.splice(a,1),a--,r--);return t}},{key:"_checkPointInRect",value:function(t,e,n,i){var a=t.x+e.x,r=t.y+e.y;return!(a<0||a>n||r<0||r>i)}},{key:"_checkArcInRect",value:function(t,e,n,i,a){var r=t[0],o=t[1],l=o.radian-r.radian;o.radian<r.radian&&(l=2*Math.PI+o.radian-r.radian);var s=(r.radian+l/2)%(2*Math.PI);return this._checkPointInRect(this.getPointInRadianOfR(s,e),n,i,a)}},{key:"getRadianInPoint",value:function(t){var e=2*Math.PI;return(Math.atan2(t.y,t.x)+e)%e}},{key:"getPointInRadianOfR",value:function(t,e){var n=Math.PI,i=Math.cos(t)*e;t!=n/2&&t!=3*n/2||(i=0);var a=Math.sin(t)*e;return t%n==0&&(a=0),{x:i,y:a}}},{key:"getROfNum",value:function(t){var e=p.max(this.rAxis.dataSection);return this.radius*((t-0)/(e-0))}},{key:"getPointsOfR",value:function(t){var e=this,n=[];return p.each(e.aAxis.angleList,(function(i){var a=Math.PI*i/180,r=e.getPointInRadianOfR(a,t);n.push(r)})),n}},{key:"_setAAxisAngleList",value:function(){var t=this;t.aAxis.angleList=[];var e=this.aAxis.data;if("proportion"==this.aAxis.layoutType){e=[];for(var n=0,i=this.aAxis.data.length;n<i;n++)e.push(n)}var a=this.allAngle,r=p.max(e);"proportion"==this.aAxis.layoutType&&r++,p.each(e,(function(e){var n=(a*((e-0)/(r-0))+t.aAxis.beginAngle+a)%a;t.aAxis.angleList.push(n)}))}},{key:"_drawAAxis",value:function(){var t=this,e=t.getROfNum(p.max(this.rAxis.dataSection)),n=t.getPointsOfR(e+3);t._aAxisScaleSp.context.x=this.origin.x,t._aAxisScaleSp.context.y=this.origin.y,p.each(this.aAxis.data,(function(e,i){var a=n[i],r=p.isFunction(t.aAxis.label.format)?t.aAxis.label.format(e):e,o={value:e,text:r,iNode:i,field:t.aAxis.field};if(t._getProp(t.aAxis.label.enabled,o)){var l={x:a.x,y:a.y,fillStyle:t._getProp(t.aAxis.label.fontColor,o)};p.extend(l,t._getTextAlignForPoint(Math.atan2(a.y,a.x))),t._aAxisScaleSp.addChild(new d.default.Display.Text(r,{context:l})),t.aAxis.layoutData.push(r)}}))}},{key:"_getTextAlignForPoint",value:function(t){var e="center",n="bottom";return t>-Math.PI/2&&t<0&&(e="left",n="bottom"),0==t&&(e="left",n="middle"),t>0&&t<Math.PI/2&&(e="left",n="top"),t==Math.PI/2&&(e="center",n="top"),t>Math.PI/2&&t<Math.PI&&(e="right",n="top"),t!=Math.PI&&t!=-Math.PI||(e="right",n="middle"),t>-Math.PI&&t<-Math.PI/2&&(e="right",n="bottom"),{textAlign:e,textBaseline:n}}},{key:"getAxisNodeOf",value:function(t){var e=this,n=e.getAAxisIndOf(t);if(void 0!==n)return{ind:n,value:e.aAxis.data[n],text:e.aAxis.layoutData[n],angle:e.aAxis.angleList[n]}}},{key:"getAAxisIndOf",value:function(t){var e=this;if(void 0!==t.aAxisInd)return t.aAxisInd;if(e.aAxis.angleList.length){var n=t.point,i=(180*e.getRadianInPoint(n)/Math.PI-e.aAxis.beginAngle)%e.allAngle,a=0,r=e.aAxis.angleList.length;return p.each(e.aAxis.angleList,(function(t,n){t=(t-e.aAxis.beginAngle)%e.allAngle;var o=n+1,l=(e.aAxis.angleList[o]-e.aAxis.beginAngle)%e.allAngle;if(n==r-1&&(o=0,l=e.allAngle),i>=t&&i<=l)return a=i-t<l-i?n:o,!1})),a}}},{key:"_initInduce",value:function(){var t=this;t.induce=this._grid.induce,t.induce&&t.induce.on(g.types.get(),(function(e){t.fire(e.type,e),t.app.fire(e.type,e)}))}},{key:"getTipsInfoHandler",value:function(t){var e=this.getAxisNodeOf(t),n={nodes:[]};return e&&(n.aAxis=e,n.title=e.text,n.iNode=e.ind),t.eventInfo&&(n=p.extend(n,t.eventInfo)),n}},{key:"getPoint",value:function(){}},{key:"getSizeAndOrigin",value:function(){}},{key:"_getProp",value:function(t,e,n){var i=t;return p.isFunction(t)&&(i=t.apply(this,[e])),!i&&n&&(i=n),i}},{key:"resetGraphsOfAxis",value:function(t){this.app.getGraphs()}}],[{key:"defaultProps",value:function(){return{allAngle:{detail:"坐标系总角度",documentation:"",default:360,values:[0,360]},startAngle:{detail:"坐标系起始角度",documentation:"",default:0,values:[0,360]},radius:{detail:"坐标系的最大半径",documentation:"默认自动计算view的高宽，如果squareRange==true，则会取Math.min(width,height)",default:"auto",values:null},aAxis:{detail:"角度轴",documentation:"类似直角坐标系中的x轴",propertys:{data:[],angleList:[],layoutData:[],field:{detail:"数据字段",documentation:"",default:""},layoutType:{detail:"布局类型",documentation:"",default:"proportion"},beginAngle:{detail:"起始角度",documentation:"",default:-90},enabled:{detail:"是否显示",documentation:"",default:!1},label:{detail:"文本配置",documentation:"",propertys:{enabled:{detail:"是否显示",documentation:"",default:!0},format:{detail:"label的格式化处理函数",documentation:"",default:null},fontColor:{detail:"label颜色",documentation:"",default:"#666"}}}}},rAxis:{detail:"半径维度轴",documentation:"类似直角坐标系中的y轴维度",propertys:{field:{detail:"数据字段",documentation:"",default:""},dataSection:{detail:"轴的显示数据",documentation:"默认根据源数据中自动计算，用户也可以手动指定",default:!1},enabled:{detail:"是否显示",documentation:"",default:!1}}}}}}]),i}(u.default);u.default.registerComponent(y,"coord","polar");var v=y;e.default=v}));e(Ln);var Fn=n((function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports}));e(Fn);var Nn=n((function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,a,r=[],o=!0,l=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(r.push(i.value),!e||r.length!==e);o=!0);}catch(t){l=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return r}},t.exports.__esModule=!0,t.exports.default=t.exports}));e(Nn);var Bn=n((function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports}));e(Bn);var jn=n((function(t){t.exports=function(t,e){if(t){if("string"==typeof t)return Bn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bn(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}));e(jn);var zn=n((function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports}));e(zn);var Wn=n((function(t){t.exports=function(t,e){return Fn(t)||Nn(t,e)||jn(t,e)||zn()},t.exports.__esModule=!0,t.exports.default=t.exports}));e(Wn);var Vn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.colorIsHex=function(t){return a.test(t)},e.colorRgb=r,e.colorRgba=function(t,e){return r(t).replace(")",","+e+")").replace("RGB","RGBA")},e.gradient=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i=o(t),a=o(e),r=(a[0]-i[0])/n,s=(a[1]-i[1])/n,u=(a[2]-i[2])/n,d=[],h=0;h<n;h++)d.push(l([parseInt(r*h+i[0]),parseInt(s*h+i[1]),parseInt(u*h+i[2])]));return d},e.hex2rgb=o,e.rgb2hex=l,e.rgba2rgb=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#ffffff",i=t.match(/[\d\.]+/g),a=(0,n.default)(i,4),o=a[0],l=a[1],s=a[2],u=a[3],d=r(e).match(/[\d\.]+/g),h=(0,n.default)(d,3),f=h[0],c=h[1],p=h[2];return"RGB("+[(1-u)*f+u*o,(1-u)*c+u*l,(1-u)*p+u*s].join(",")+")"};var n=i(Wn),a=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;function r(t){if(Array.isArray(t)&&(t=t[0]),!t)return"RGB(0,0,0)";var e=t.toLowerCase();if(e&&a.test(e)){if(4===e.length){for(var n="#",i=1;i<4;i+=1)n+=e.slice(i,i+1).concat(e.slice(i,i+1));e=n}for(var r=[],o=1;o<7;o+=2)r.push(parseInt("0x"+e.slice(o,o+2)));return"RGB("+r.join(",")+")"}return e}function o(t,e){for(var n=[],i=1;i<7;i+=2)n.push(parseInt("0x"+t.slice(i,i+2)));return n}function l(t){var e=(t[0]<<16|t[1]<<8|t[2]).toString(16);return"#"+new Array(Math.abs(e.length-7)).join("0")+e}}));e(Vn);Vn.colorIsHex,Vn.colorRgb,Vn.colorRgba,Vn.gradient,Vn.hex2rgb,Vn.rgb2hex,Vn.rgba2rgb;var Gn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(gn),a=i(hn),r=i(fn),o=i(yn),l=i(pn),s=i(vn),u=i(xn),d=i(wn),h=i(ln);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}var c=h.default.AnimationFrame,p=h.default._,g=function(t){(0,l.default)(i,t);var e=f(i);function i(t,n){var r;(0,a.default)(this,i),r=e.call(this,t,n),p.extend(!0,(0,o.default)(r),(0,bn.getDefaultProps)(i.defaultProps())),r.name="graphs",r._opt=t||{},r.app=n,r.ctx=n.stage.ctx||n.stage.canvas.getContext("2d"),r.dataFrame=n.dataFrame,r.data=null,r.width=0,r.height=0,r.origin={x:0,y:0},r.inited=!1,r.sprite=new h.default.Display.Sprite({name:"graphs_"+t.type}),r.app.graphsSprite.addChild(r.sprite),r._growTween=null;var l=(0,o.default)(r);return r.sprite.on("destroy",(function(){l._growTween&&(c.destroyTween(l._growTween),l._growTween=null)})),r}return(0,r.default)(i,[{key:"tipsPointerOf",value:function(t){}},{key:"tipsPointerHideOf",value:function(t){}},{key:"focusAt",value:function(t,e){}},{key:"unfocusAt",value:function(t,e){}},{key:"selectAt",value:function(t,e){}},{key:"unselectAt",value:function(t,e){}},{key:"getSelectedList",value:function(){return[]}},{key:"getSelectedRowList",value:function(){return[]}},{key:"hide",value:function(t){}},{key:"show",value:function(t){}},{key:"getLegendData",value:function(){}},{key:"triggerEvent",value:function(t){var e=this,i=t.eventInfo.trigger;((0,n.default)(i),"string"==typeof i)&&("this"==i?i=this:i.split(".").map((function(t){"this"!=t&&(i=e[t])})));if(i){var a=i["on"+t.type];a&&p.isFunction(a)&&(t.eventInfo&&t.eventInfo.nodes&&t.eventInfo.nodes.length?1==t.eventInfo.nodes.length?a.apply(this,[t,t.eventInfo.nodes[0]]):a.apply(this,[t,t.eventInfo.nodes]):a.apply(this,arguments))}}},{key:"grow",value:function(t,e){!e&&(e={});var n=this,i=this.aniDuration;this.animation||(i=0);var a=0,r=1;"from"in e&&(a=e.from),"to"in e&&(r=e.to),this._growTween=c.registTween({from:{process:a},to:{process:r},duration:i,easing:this.aniEasing,onUpdate:function(e){p.isFunction(t)&&t(e.process)},onComplete:function(){this._growTween=null,n.fire("complete")}})}},{key:"getFieldConfig",value:function(t){return this.app.getComponent({name:"coord"}).getFieldConfig(t)}}],[{key:"defaultProps",value:function(){return{type:{detail:"绘图组件",default:"",insertText:"type: ",values:["bar","line","pie","scat"]},animation:{detail:"是否开启入场动画",default:!0},aniDuration:{detail:"动画时长",default:800},aniEasing:{detail:"折线生长动画的动画类型参数，默认 Linear.None",documentation:"类型演示https://sole.github.io/tween.js/examples/03_graphs.html",default:"Linear.None"},color:{detail:"line,area,node,label的抄底样式",default:""}}}}]),i}(d.default);e.default=g}));e(Gn);var Hn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Gn),h=i(kn);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var c=u.default._,p=u.default.event,g=u.default.AnimationFrame,y=u.default.Shapes.Rect,v=function(t){(0,o.default)(i,t);var e=f(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="bar",o.enabledField=null,o.node={_width:0,_count:0},o.select={_fillStyle:"#092848"},o._barsLen=0,o.txtsSp=null,c.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){this.barsSp=new u.default.Display.Sprite({id:"barsSp"}),this.txtsSp=new u.default.Display.Sprite({id:"txtsSp",context:{}})}},{key:"getNodesAt",value:function(t){var e=this.data,n=[];return c.each(this.enabledField,(function(i){if(c.isArray(i))c.each(i,(function(i){var a=e[i]?e[i][t]:null;a&&n.push(a)}));else{var a=e[i]?e[i][t]:null;a&&n.push(a)}})),n}},{key:"_getTargetField",value:function(t,e,n,i){if(c.isString(i))return i;if(c.isArray(i)){var a=i[t];if(c.isString(a))return a;if(c.isArray(a))return a[e]}}},{key:"_getColor",value:function(t,e){var n=e.field,i=c.flatten([this.field]),a=this.app.getComponent({name:"coord"}).getFieldConfig(n);return c.isFunction(t)&&(t=t.apply(this,[e])),c.isString(t),c.isArray(t)&&(t=c.flatten(t)[c.indexOf(i,n)]),t&&t.lineargradient&&t.lineargradient.length&&(t.points=[0,e.rectHeight,0,0]),null==t&&(t=a.color),t}},{key:"_getProp",value:function(t,e){if(c.isFunction(t)){var n=[];return null!=e&&n.push(e),t.apply(this,n)}return t}},{key:"_getBarWidth",value:function(t,e){return this.node.width?c.isFunction(this.node.width)?this.node._width=this.node.width(t):this.node._width=this.node.width:(this.node._width=e-Math.max(1,.2*e),1==this.node._width&&t>3&&(this.node._width=t-2)),this.node._width<1&&(this.node._width=1),this.node._width=parseInt(this.node._width),this.node._width>this.node.maxWidth&&(this.node._width=this.node.maxWidth),this.node._width}},{key:"show",value:function(){this.draw()}},{key:"hide",value:function(t){c.each(this.barsSp.children,(function(e,n){var i=e.getChildById("bar_"+n+"_"+t);i&&i.destroy()})),c.each(this.txtsSp.children,(function(e,n){var i=e.getChildById("text_"+n+"_"+t);i&&i.destroy()})),this.draw()}},{key:"resetData",value:function(t){t&&(this.dataFrame=t),this.draw()}},{key:"clean",value:function(){this.data={},this.barsSp.removeAllChildren(),this.label.enabled&&this.txtsSp.removeAllChildren()}},{key:"draw",value:function(t){!t&&(t={}),c.extend(!0,this,t);var e=this,n=e.animation&&!t.resize;if(this.data=this._trimGraphs(),0==this.enabledField.length||0==this._dataLen)return e._preDataLen=0,void this.clean();var i=e._preDataLen,a=this.enabledField.length,r=0;e.node._count=0;var o=0,l=e.app.getComponents({name:"graphs",type:"bar"});c.each(l,(function(t,n){t==e&&(o=n)}));var s=this.app.getComponent({name:"coord"});c.each(this.enabledField,(function(t,d){var f=(t=c.flatten([t])).length;if(0!=f){r=e.width/e._dataLen,e._barsLen=e._dataLen*a;for(var g=0;g<e._dataLen;g++){var v=null;if(0==d){if(g<=i-1?v=e.barsSp.getChildById("barGroup_"+g):(v=new u.default.Display.Sprite({id:"barGroup_"+g}),e.barsSp.addChild(v),v.iNode=g),!o){var x=void 0,_=r*e.select.width;e.select.width>1&&(_=e.select.width),g<=i-1?((x=v.getChildById("group_region_"+g)).context.width=_,x.context.x=r*g+(r-_)/2,x.context.globalAlpha=c.indexOf(e.select.inds,e.dataFrame.range.start+g)>-1?e.select.alpha:0):(x=new y({id:"group_region_"+g,pointChkPriority:!1,hoverClone:!1,xyToInt:!1,context:{x:r*g+(r-_)/2,y:-e.height,width:_,height:e.height,fillStyle:e._getGroupRegionStyle(g),globalAlpha:c.indexOf(e.select.inds,e.dataFrame.range.start+g)>-1?e.select.alpha:0}}),v.addChild(x),x.iNode=g,x.on(p.types.get(),(function(t){t.eventInfo={trigger:e,iNode:this.iNode},j.bind(this)(t),e.app.fire(t.type,t)})))}}else v=e.barsSp.getChildById("barGroup_"+g);var m=null;0==d?g<=i-1?m=e.txtsSp.getChildById("txtGroup_"+g):(m=new u.default.Display.Sprite({id:"txtGroup_"+g}),e.txtsSp.addChild(m),m.iGroup=d):m=e.txtsSp.getChildById("txtGroup_"+g);for(var b=0;b<f;b++){e.node._count++;var w=e.data[t[b]][g];w.iGroup=d,w.iNode=g,w.iLay=b;var k=w.y-w.fromY;isNaN(w.value)?k=0:Math.abs(k)<Math.abs(e.node.minHeight)&&(k=-e.node.minHeight),w.rectHeight=k;var S=e._getColor(e.node.fillStyle,w);if(w.color=S,S.addColorStop&&e.node.fillStyle.lineargradient){var A=e.node.fillStyle.lineargradient[parseInt(e.node.fillStyle.lineargradient.length/2)];A&&(w.color=A.color)}var P={x:Math.round(w.x),y:w.fromY,width:e.node._width,height:k,fillStyle:S,fillAlpha:e.node.fillAlpha,scaleY:-1};w.width=P.width;var C=e._getFillStyle(P.fillStyle,P),D={x:P.x,y:w.yOriginPoint.pos,width:P.width,height:P.height,fillStyle:C,fillAlpha:e.node.fillAlpha,scaleY:0,cursor:"pointer"};if(e.node.radius&&w.isLeaf&&!e.proportion){var O=Math.min(e.node._width/2,Math.abs(k));O=Math.min(O,e.node.radius),D.radius=[O,O,0,0]}n||(delete D.scaleY,D.y=P.y);var T=null,M="bar_"+g+"_"+w.field;if(g<=i-1&&(T=v.getChildById(M)),T?T.context.fillStyle=S:((T=new y({id:M,context:D})).field=w.field,v.addChild(T),e.node.eventEnabled&&T.on(p.types.get(),(function(t){t.eventInfo={trigger:"this.node",nodes:[this.nodeData]},j.bind(this)(t),e.app.fire(t.type,t)}))),T.finalPos=P,T.iGroup=d,T.iNode=g,T.iLay=b,T.nodeData=w,w.nodeElement=T,e.node.filter&&e.node.filter.apply(T,[w,e]),e.label.enabled){var E=w.value;if(e.label.format){if(c.isFunction(e.label.format)){var R=e.label.format.apply(e,[E,w]);void 0===R&&null===R||(E=R)}"string"==typeof e.label.format&&(E=(0,h.default)(E).format(e.label.format))}else{var I=s.getFieldConfig(w.field);I&&(E=I.getFormatValue(E))}if(null==E||""===E)continue;var L={fillStyle:e._getProp(e.label.fontColor,w)||P.fillStyle,fontSize:e._getProp(e.label.fontSize,w),lineWidth:e._getProp(e.label.lineWidth,w),strokeStyle:e._getProp(e.label.strokeStyle,w)||P.fillStyle,textBaseline:e._getProp(e.label.verticalAlign,w),rotation:e._getProp(e.label.rotation,w)},F=e._getTextPos(P,w);L.x=F.x,L.y=F.y,L.textAlign=e._getTextAlign(P,w);var N=null,B="text_"+g+"_"+w.field;g<=i-1&&(N=m.getChildById(B)),N?(N.resetText(E),N.context.x=L.x,N.context.y=L.y):((N=new u.default.Display.Text(E,{id:B,context:L})).field=w.field,m.addChild(N))}}}}function j(t){if(e.select.enabled&&e.select.triggerEventType.indexOf(t.type)>-1){var n=e.dataFrame.range.start+this.iNode;c.indexOf(e.select.inds,n)>-1?c.each(l,(function(t){t.unselectAt(n)})):c.each(l,(function(t){t.selectAt(n)}))}}})),this.sprite.addChild(this.barsSp),this.label.enabled&&this.sprite.addChild(this.txtsSp),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.grow((function(){e.fire("complete")}),{delay:0,duration:300,animate:n}),e._preDataLen=e._dataLen}},{key:"_getFillStyle",value:function(t,e){return"string"==typeof t&&(0,Vn.colorIsHex)(t)?{points:[0,e.height,0,0],lineargradient:[{position:0,color:(0,Vn.colorRgba)(t,1)},{position:1,color:(0,Vn.colorRgba)(t,.6)}]}:t}},{key:"setEnabledField",value:function(){this.enabledField=this.app.getComponent({name:"coord"}).filterEnabledFields(this.field)}},{key:"_getGroupRegionStyle",value:function(t){var e=this,n=e.select.fillStyle;return c.isArray(e.select.fillStyle)&&(n=e.select.fillStyle[t]),c.isFunction(e.select.fillStyle)&&(n=e.select.fillStyle.apply(this,[{iNode:t,rowData:e.dataFrame.getRowDataAt(t)}])),null==n?e.select._fillStyle:n}},{key:"_trimGraphs",value:function(){var t=this,e=this.app.getComponent({name:"coord"});this.setEnabledField(),this.data={};var n=[],i=0,a=0,r=!1;this.absolute?(n=[this],i=this.enabledField.length):c.each(t.app.getComponents({name:"graphs",type:"bar"}),(function(e){e.absolute||(e===t&&(r=!0),r?e.setEnabledField():a+=e.enabledField.length,i+=e.enabledField.length,n.push(e))}));var o=e.getAxis({type:"xAxis"}).getCellLength(),l=o/(i+1),s=this._getBarWidth(o,l),u=l-s;null!=this.node.xDis&&(u=this.node.xDis);var d=(o-s*i-u*(i-1))/2;a&&(d+=(u+s)*a);var h=this.dataFrame.getDataOrg(this.enabledField),f=t.getGraphSelectOpt();return!t.select.inds.length&&f&&f.inds&&f.inds.length&&(t.select.inds=c.clone(f.inds)),c.each(h,(function(n,i){var a=[];c.each(n,(function(r,l){a[l]=[],t._dataLen=r.length,c.each(r,(function(r,h){var f=r;t.proportion&&(f=0,c.each(n,(function(t){f+=t[h]})));var p=t._getTargetField(i,l,h,t.enabledField),g=e.getPoint({iNode:h,vIndex:l,field:p,value:{y:r}}),y=g.pos.x,v=y-o/2+d+(s+u)*i,x=0;x=t.proportion?-r/f*e.height:g.pos.y,isNaN(x)&&(x=0);var _=e.getAxisOriginPoint({field:p});var m=function t(e,n,i,a,r){var o=e[n-1];if(!o)return _.pos;var l=o[i].y,s=o[i].value,u=_.value;return a>=u?s>=u?(o[i].isLeaf=!1,l):t(e,n-1,i,a):s<u?(o[i].isLeaf=!1,l):t(e,n-1,i,a)}(a,l,h,r);x+=m-_.pos;var b={type:"bar",value:r,vInd:l,vCount:f,field:p,fromX:v,fromY:m,x:v,y:x,width:s,yOriginPoint:_,isLeaf:!0,xAxis:e.getAxis({type:"xAxis"}).getNodeInfoOfX(y),iNode:h,rowData:t.dataFrame.getRowDataAt(h),color:null,selected:!1};t.data[b.field]||(t.data[b.field]=a[l]),c.indexOf(t.select.inds,h)>-1&&(b.selected=!0),a[l].push(b)}))}))})),t.data}},{key:"_getTextAlign",value:function(t,e){var n=this.label.textAlign;return e.value<e.yOriginPoint.value&&("left"==n?n="right":"right"==n&&(n="left")),n}},{key:"_getTextPos",value:function(t,e){var n=this,i={x:0,y:0},a=t.x,r=t.y,o=!0;switch(t.y>=e.y&&(o=!1),n.label.position){case"top":a=t.x+t.width/2,r=t.y+t.height,o&&(r+=16);break;case"topRight":a=t.x+t.width,r=t.y+t.height,o&&(r+=16);break;case"right":a=t.x+t.width,r=t.y+t.height/2;break;case"rightBottom":a=t.x+t.width,r=t.y;break;case"bottom":a=t.x+t.width/2,r=t.y;break;case"bottomLeft":a=t.x,r=t.y;break;case"left":a=t.x,r=t.y+t.height/2;break;case"leftTop":a=t.x,r=t.y+t.height,o&&(r+=16);break;case"center":a=t.x+t.width/2,r=t.y+t.height/2}a-=n.label.offsetX;var l=1;return e.value<e.yOriginPoint.value&&(l=-1),r-=l*n.label.offsetY,i.x=a,i.y=r,i}},{key:"grow",value:function(t,e){var n=this;if(n._preDataLen>n._dataLen)for(var i=n._dataLen,a=n._preDataLen;i<a;i++)n.barsSp.getChildAt(i).destroy(),n.label.enabled&&n.txtsSp.getChildAt(i).destroy(),i--,a--;if(e.animate){var r=c.extend({delay:Math.min(1e3/this._barsLen,80),easing:"Linear.None",duration:500},e),o=0;c.each(n.enabledField,(function(e){var i=(e=c.flatten([e])).length;if(0!=i)for(var a=0;a<n._dataLen;a++)for(var l=0;l<i;l++){var s=n.data[e[l]][a],u=n.barsSp.getChildById("barGroup_"+a).getChildById("bar_"+a+"_"+s.field);0==r.duration?(u.context.scaleY=1,u.context.y=1*u.finalPos.y,u.context.x=u.finalPos.x,u.context.width=u.finalPos.width,u.context.height=u.finalPos.height):(u._tweenObj&&g.destroyTween(u._tweenObj),u._tweenObj=u.animate({scaleY:1,y:1*u.finalPos.y,x:u.finalPos.x,width:u.finalPos.width,height:u.finalPos.height},{duration:r.duration,easing:r.easing,delay:a*r.delay,onUpdate:function(){this.context.fillStyle=n._getFillStyle(this.nodeData.color,this.context)},onComplete:function(e){e.width<3&&this.context&&(this.context.radius=0),++o===n.node._count&&t&&t(n)},id:u.id}))}}))}else t&&t(n)}},{key:"selectAt",value:function(t){var e=this;if(!(c.indexOf(this.select.inds,t)>-1)){this.select.inds.push(t);var n=t-this.dataFrame.range.start;c.each(this.data,(function(t){var i=t[n];i.selected=!0,e.setNodeElementStyle(i)}));var i=this.barsSp.getChildById("barGroup_"+n);if(i){var a=i.getChildById("group_region_"+n);a&&(a.context.globalAlpha=this.select.alpha)}}}},{key:"unselectAt",value:function(t){var e=this;if(-1!=c.indexOf(this.select.inds,t)){var n=c.indexOf(this.select.inds,t);this.select.inds.splice(n,1);var i=t-this.dataFrame.range.start;c.each(this.data,(function(t){var n=t[i];n.selected=!1,e.setNodeElementStyle(n)}));var a=this.barsSp.getChildById("barGroup_"+i);if(a){var r=a.getChildById("group_region_"+i);r&&(r.context.globalAlpha=0)}}}},{key:"getSelectedRowList",value:function(){var t=[],e=this;return c.each(e.select.inds,(function(n){t.push(e.dataFrame.jsonOrg[n])})),t}},{key:"setNodeElementStyle",value:function(t){var e=this._getColor(this.node.fillStyle,t);t.nodeElement.context.fillStyle=e}},{key:"getGraphSelectOpt",value:function(){var t=this._opt.select;if(!t){var e=this.app.getComponents({name:"graphs",type:"bar"});c.each(e,(function(e){if(t)return!1;!t&&e._opt.select&&(t=e.select)}))}return t}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段设置",documentation:"支持二维数组格式的设置，一维方向就是横向分组，二维方向就是纵向的堆叠",default:null},yAxisAlign:{detail:"绘制在哪根y轴上面",default:"left"},absolute:{detail:"是否脱离graphs的位置计算",documentation:"                    trimGraphs的时候是否需要和其他的 bar graphs一起并排计算，                    true的话这个就会和别的重叠,                    和css中得absolute概念一致，脱离文档流的绝对定位",default:!1},proportion:{detail:"比例柱状图",default:!1},node:{detail:"单个数据对应的图形设置",propertys:{width:{detail:"bar的宽度",default:0},maxWidth:{detail:"最大width",default:50},minWidth:{detail:"最小width",default:1},minHeight:{detail:"最小height",default:0},radius:{detail:"叶子节点的圆角半径",default:10},fillStyle:{detail:"bar填充色",default:null},fillAlpha:{detail:"bar透明度",default:.95},xDis:{detail:"单分组内bar之间的间隔",default:null},filter:{detail:"bar过滤处理器",default:null},eventEnabled:{detail:"是否在单个柱子上面启动事件的监听",default:!0}}},label:{detail:"文本设置",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本颜色",default:null,documentation:"如果有设置text.fontColor那么优先使用fontColor"},fontSize:{detail:"文本字体大小",default:12},format:{detail:"文本格式化处理函数",default:null},lineWidth:{detail:"文本描边线宽",default:0},strokeStyle:{detail:"文本描边颜色",default:null},rotation:{detail:"旋转角度",default:0},textAlign:{detail:"水平对齐方式",documentation:"left center right",default:"center"},verticalAlign:{detail:"垂直基线对齐方式",documentation:"top middle bottom",default:"bottom"},position:{detail:"文本布局位置",documentation:"top,topRight,right,rightBottom,bottom,bottomLeft,left,leftTop,center",default:"top"},offsetX:{detail:"x偏移量",default:0},offsetY:{detail:"y偏移量",default:0}}},select:{detail:"分组选中",documentation:"                    分组的选中，不是选中具体的某个node，这里的选中靠groupRegion来表现出来,                    目前只有在第一个graphs bar 上配置有效",propertys:{enabled:{detail:"是否开启",default:!1},inds:{detail:"选中的分组索引集合",documentation:"选中的列的索引集合,注意，这里的ind不是当前视图的ind，而是加上了dataFrame.range.start的全局ind",default:[]},width:{detail:"选中态背景宽度",default:1},alpha:{detail:"选中态背景透明度",default:.2},fillStyle:{detail:"选中态背景填充色",default:null},triggerEventType:{detail:"触发选中效果的事件",default:"click,tap"}}}}}}]),i}(d.default);d.default.registerComponent(v,"graphs","bar");var x=v;e.default=x}));e(Hn);var Yn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(kn);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=u.default._,c=u.default.event,p=u.default.AnimationFrame,g=u.default.Shapes.BrokenLine,y=u.default.Shapes.Circle,v=u.default.Shapes.Isogon,x=u.default.Shapes.Rect,_=u.default.Shapes.Path,m=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a,o,l,s,u,d){var h,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};return(0,n.default)(this,i),(h=e.call(this))._graphs=d,h._opt=o,h.fieldConfig=t,h.field=null,h.iGroup=a,h._yAxis=t.yAxis,h.ctx=l,h.w=u,h.h=s,h.y=0,h.data=[],h.sprite=null,h._pointList=[],h._currPointList=[],h._line=null,h._bottomPointList=[],h._currBottomPointList=[],h._bottomLine=null,h.color=t.color,f.extend(!0,(0,r.default)(h),(0,bn.getDefaultProps)(i.defaultProps()),o),h.field=t.field,h.clipRect=null,h.__currFocusInd=-1,h._growed=!1,h._bottomField=c[h.field],h.init(o),h}return(0,a.default)(i,[{key:"init",value:function(){this.sprite=new u.default.Display.Sprite,this.graphSprite=new u.default.Display.Sprite,this.sprite.addChild(this.graphSprite),this.lineSprite=new u.default.Display.Sprite,this.graphSprite.addChild(this.lineSprite),this._focusNodes=new u.default.Display.Sprite({}),this.sprite.addChild(this._focusNodes),this._nodes=new u.default.Display.Sprite({}),this.sprite.addChild(this._nodes),this._labels=new u.default.Display.Sprite({}),this.sprite.addChild(this._labels)}},{key:"_clean",value:function(){this.lineSprite.removeAllChildren(),this._focusNodes.removeAllChildren(),this._nodes.removeAllChildren(),this._labels.removeAllChildren(),this._line=null,this._bottomLine=null,this._area=null}},{key:"draw",value:function(t,e){f.extend(!0,this,t),this.data=e,this._widget(t)}},{key:"destroy",value:function(){var t=this;t.sprite.animate({globalAlpha:0},{duration:300,onComplete:function(){t.sprite.remove()}})}},{key:"_getColor",value:function(t,e){var n=this._getProp(t,e);return arguments.length>1&&null==n&&(t&&t.lineargradient&&(n=t.lineargradient[parseInt(t.lineargradient.length/2)].color),n&&f.isString(n)||(n=this.fieldConfig.color)),n}},{key:"_getProp",value:function(t,e){if(f.isArray(t))return t[this.iGroup];if(f.isFunction(t)){var n=[];return null!=e&&n.push(this.data[e]),t.apply(this,n)}return t}},{key:"getNodeInfoAt",value:function(t,e){var n=this.data[t];if(e&&e.eventInfo&&e.eventInfo.dimension_1&&"proportion"==e.eventInfo.dimension_1.layoutType)for(var i,a=0,r=this.data.length;a<r;a++){var o=this.data[a],l=Math.abs(o.x-t);(null==i||l<i)&&(i=l,n=o)}return n}},{key:"resetData",value:function(t,e,n){var i=this;if(t&&(this.data=t),e&&e.comp){i._pointList=this._getPointList(this.data),i._bottomPointList=this._getBottomPointList();var a={left:0,right:i._pointList.length-i._currPointList.length};e&&e.params&&f.extend(a,e.params),a.left&&(a.left>0&&(this._currPointList=this._pointList.slice(0,a.left).concat(this._currPointList),this._bottomField&&(this._currBottomPointList=this._bottomPointList.slice(0,a.left).concat(this._currBottomPointList))),a.left<0&&(this._currPointList.splice(0,Math.abs(a.left)),this._bottomField&&this._currBottomPointList.splice(0,Math.abs(a.left)))),a.right&&(a.right>0&&(this._currPointList=this._currPointList.concat(this._pointList.slice(-a.right)),this._bottomField&&(this._currBottomPointList=this._currBottomPointList.concat(this._bottomPointList.slice(-a.right)))),a.right<0&&(this._currPointList.splice(this._currPointList.length-Math.abs(a.right)),this._bottomField&&this._currBottomPointList.splice(this._currBottomPointList.length-Math.abs(a.right)))),i._createNodes(),i._createTexts(),i._transition()}else i._growed=!1,i.clipRect&&(i.clipRect.destroy(),i.clipRect=null),i._widget(this),i._grow()}},{key:"_transition",value:function(t){var e=this;if(!e.data.length)return e._line.context&&(e._line.context.pointList=[]),e._bottomLine.context&&(e._bottomLine.context.pointList=[]),e._area&&e._area.context&&(e._area.context.path=""),void(t&&t(e));function n(t,n){if(!e._line)return e.sprite._removeTween(e._transitionTween),void(e._transitionTween=null);var i=e._getLineStrokeStyle();e._line.context&&(e._line.context.pointList=f.clone(t),e._line.context.strokeStyle=i),e._bottomField&&e._bottomLine&&e._bottomLine.context&&(e._bottomLine.context.pointList=f.clone(n),e._bottomLine.context.strokeStyle=i),e._area&&e._area.context&&(e._area.context.path=e._getFillPath(e._line,e._bottomLine),e._area.context.fillStyle=e._getFillStyle());var a=0;f.each(t,(function(t,n){if(f.isNumber(t[1])){if(e._nodes){var i=e._nodes.getChildAt(a);i&&(i.context.x=t[0],i.context.y=t[1])}if(e._labels){var r=e._labels.getChildAt(a);r&&(r.context.x=t[0],r.context.y=t[1]-3-3,e._checkTextPos(r,n))}a++}}))}if(!this._growed)return e._currPointList=e._pointList,e._currBottomPointList=e._bottomPointList,void n(e._currPointList,e._currBottomPointList);this._transitionTween=p.registTween({from:e._getPointPosStr(e._currPointList,e._currBottomPointList),to:e._getPointPosStr(e._pointList,e._bottomPointList),desc:e.field,onUpdate:function(t){for(var i in t){var a="p"==i.split("_")[0]?e._currPointList:e._currBottomPointList,r=parseInt(i.split("_")[2]),o=parseInt(i.split("_")[1]);a[r]&&(a[r][o]=t[i])}n(e._currPointList,e._currBottomPointList)},onComplete:function(){e.sprite._removeTween(e._transitionTween),e._transitionTween=null,n(e._pointList,e._bottomPointList),t&&t(e)}}),this.sprite._tweens.push(this._transitionTween)}},{key:"_grow",value:function(t){var e=this,n=this._graphs.app.getCoord(),i=n.width,a=n.height;this.clipRect=new x({context:{x:0,y:-a-3,width:0,height:a+6,fillStyle:"green"}});var r={width:i};this.lineSprite.clipTo(this.clipRect),this.graphSprite.addChild(this.clipRect),"rightLeft"==this.line.growDriction&&(this.clipRect.context.x=i,r.x=0),this.clipRect.animate(r,{duration:this._graphs.aniDuration,easing:this.aniEasing,onUpdate:function(){var t=e.clipRect.context;e._nodes.children.concat(e._labels.children).forEach((function(e){var n=e.context;0==n.globalAlpha&&n.x>=t.x&&n.x<=t.x+t.width&&e.animate({globalAlpha:1},{duration:300})}))},onComplete:function(){e._growed=!0,t&&t()}})}},{key:"_getPointPosStr",value:function(t,e){var n={};return t.forEach((function(t,e){t&&(n["p_1_"+e]=t[1],n["p_0_"+e]=t[0])})),e.forEach((function(t,e){t&&(n["bp_1_"+e]=t[1],n["bp_0_"+e]=t[0])})),n}},{key:"_getPointList",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var a=t[n];e.push([a.x,a.y])}return e}},{key:"_widget",value:function(t){var e=this;if(!t&&(t={}),t.isResize&&(e._growed=!0),e._clean(),e._pointList=this._getPointList(e.data),0!=e._pointList.length){var n=e._pointList;e._currPointList=n;var i=e._getLineStrokeStyle(n),a={pointList:n,lineWidth:e.line.lineWidth,y:e.y,strokeStyle:i,smooth:e.line.smooth,lineType:e._getProp(e.line.lineType),lineDash:e.line.lineDash,lineJoin:"bevel",lineCap:"round"};e.line.shadowBlur&&(a.shadowBlur=e._getProp(e.line.shadowBlur),a.shadowColor=e._getProp(e.line.shadowColor)||i,a.shadowOffsetY=e._getProp(e.line.shadowOffsetY),a.shadowOffsetX=e._getProp(e.line.shadowOffsetX));var r=new g({context:a});if(r.on(c.types.get(),(function(t){t.eventInfo={trigger:"this.line",nodes:[]},e._graphs.app.fire(t.type,t)})),this.line.enabled||(r.context.visible=!1),e.lineSprite.addChild(r),e._line=r,e.area.enabled){if(this._bottomField){e._bottomPointList=this._getBottomPointList();var o=e._bottomPointList;e._currBottomPointList=o;var l={};Object.assign(l,a),l.pointList=e._bottomPointList;var s=new g({context:l});this.area.bottomLine.enabled||(s.context.visible=!1),e.lineSprite.addChild(s),e._bottomLine=s}var u=new _({context:{path:e._getFillPath(e._line,e._bottomLine),fillStyle:e._getFillStyle(),globalAlpha:e.area.alpha}});u.on(c.types.get(),(function(t){t.eventInfo={trigger:"this.area",nodes:[]},e._graphs.app.fire(t.type,t)})),e.lineSprite.addChild(u),e._area=u}e._createNodes(t),e._createTexts(t)}}},{key:"_getBottomPointList",value:function(){var t=this;if(!this._bottomField)return[];var e=this._graphs.app.getCoord(),n=this._graphs.dataFrame.getFieldData(this._bottomField);this._yAxis.addValToSection(n);var i=[];return n.forEach((function(n,a){var r=e.getPoint({iNode:a,field:t.field,value:{y:n}});i.push([r.pos.x,r.pos.y])})),i}},{key:"_getFirstNode",value:function(){for(var t=null,e=0,n=this.data.length;e<n;e++){var i=this.data[e];if(f.isNumber(i.y)&&(null!==t&&"right"!=this.yAxisAlign||(t=i),"right"!==this.yAxisAlign&&null!==t))break}return t}},{key:"_getFillStyle",value:function(){var t;t=this._opt.area&&this._opt.area.fillStyle?this._getColor(this._opt.area.fillStyle):this.color;var e=this.area.alpha;if((0,Vn.colorIsHex)(t)&&!f.isArray(e)&&(e=[1,0]),f.isArray(e)){e.length=2,null==e[0]&&(e[0]=0),null==e[1]&&(e[1]=0);var n={lineargradient:[]};(0,Vn.colorIsHex)(t)&&(n.lineargradient=[{position:0,color:(0,Vn.colorRgba)(t,e[0])},{position:1,color:(0,Vn.colorRgba)(t,e[1])}],t=n)}if(t&&t.lineargradient){var i=t.lineargradient;"right"==this.yAxisAlign&&(i=i.reverse());var a=this._getLinearGradientPoints("area");a&&a.length&&(t.points=a)}return t}},{key:"_getLineStrokeStyle",value:function(t,e){var n;(n=this._opt.line&&this._opt.line.strokeStyle?this._getColor(this._opt.line.strokeStyle):this.color,(0,Vn.colorIsHex)(n))&&(n={lineargradient:[{position:0,color:(0,Vn.colorRgba)(n,.2)},{position:.05,color:(0,Vn.colorRgba)(n,1)},{position:.95,color:(0,Vn.colorRgba)(n,1)},{position:1,color:(0,Vn.colorRgba)(n,.2)}]});var i=n.lineargradient;if(i){"right"==this.yAxisAlign&&(i=i.reverse());var a=this._getLinearGradientPoints("line",t);if(!a)return;return n.points=a,n}return n}},{key:"_getLinearGradientPoints",value:function(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"line",i=arguments.length>1?arguments[1]:void 0,a=this[n].lineargradientDriction;if(!i&&(i=this._line.context.pointList),"topBottom"==a){for(var r=0,o=0,l=0,s=i.length;l<s;l++){var u=i[l][1];isNaN(u)||(r=Math.min(u,r),o=Math.max(u,o))}t={x:0,y:r},e={x:0,y:o},"area"==n&&(e.y=0)}else{for(var d,h,f=0,c=i.length;f<c;f++){var p=i[f],g=p[0],y=p[1];isNaN(g)||isNaN(y)||(d=null==d?g:Math.min(g,d),h=Math.max(g,d))}t={x:d,y:0},e={x:h,y:0}}return null==t.x||null==t.y||null==e.x||null==e.y?null:[t.x,t.y,e.x,e.y]}},{key:"_createNodes",value:function(){for(var t=this,e=this,n=e._currPointList,i=0,a=function(a,r){var o=e.data[a],l=e._getColor(e.node.strokeStyle||e.color,a);o.color=l;var s=e.node.enabled;1!=n.length||s||(s=!0);var u=e._currPointList[a];if(!u||!f.isNumber(u[1]))return"continue";var d=u[0],h=u[1],p=0;if(t.clipRect&&e._growed){var g=t.clipRect.context;d>=g.x&&d<=g.x+g.width&&(p=1)}var x=e.node.lineWidth||e.line.lineWidth,m={x:d,y:h,r:e._getProp(e.node.radius,a),lineWidth:e._getProp(x,a)||2,strokeStyle:l,fillStyle:e._getProp(e.node.fillStyle,a)||l,visible:s&&!!e._getProp(e.node.visible,a),globalAlpha:p},b=y,w=e._getProp(e.node.shapeType,a);"isogon"==w&&(b=v,m.n=e._getProp(e.node.isogonPointNum,a)),"path"==w&&(b=_,m.path=e._getProp(e.node.path,a));var k=e._nodes.children[i];if(k?k.type==w?f.extend(k.context,m):(k.destroy(),(k=new b({context:m})).on(c.types.get(),(function(t){t.eventInfo={trigger:"this.node",nodes:[o]},e._graphs.app.fire(t.type,t)})),e._nodes.addChildAt(k,i)):((k=new b({context:m})).on(c.types.get(),(function(t){t.eventInfo={trigger:"this.node",nodes:[o]},e._graphs.app.fire(t.type,t)})),e._nodes.addChild(k)),e.node.corner){var S=e._pointList[a][1],A=e._pointList[a-1],P=e._pointList[a+1];A&&P&&S==A[1]&&S==P[1]&&(k.context.visible=!1)}o.nodeElement=k,i++},r=0,o=n.length;r<o;r++)a(r);if(e._nodes.children.length>i)for(var l=i,s=e._nodes.children.length;l<s;l++)e._nodes.children[l].destroy(),l--,s--}},{key:"_createTexts",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this,n=e._currPointList,i=this._graphs.app.getCoord();if(e.label.enabled){for(var a=0,r=0,o=n.length;r<o;r++){var l=n[r];if(l&&f.isNumber(l[1])){var s=l[0],h=l[1]-this.node.radius-2,c=0;if(this.clipRect&&t._growed){var p=this.clipRect.context;s>=p.x&&s<=p.x+p.width&&(c=1)}var g={x:s,y:h,fontSize:this.label.fontSize,textAlign:this.label.textAlign,textBaseline:this.label.textBaseline,fillStyle:e._getColor(e.label.fontColor,r),lineWidth:1,strokeStyle:"#ffffff",globalAlpha:c},y=e.data[r],v=y.value;if(e.label.format)f.isFunction(e.label.format)&&(v=e.label.format.apply(e,[v,y])),"string"==typeof e.label.format&&(v=(0,d.default)(v).format(e.label.format));else{var x=i.getFieldConfig(this.field);x&&(v=x.getFormatValue(v))}if(null!=v&&null!=v){var _=this._labels.children[a];_?(_.resetText(v),f.extend(_.context,g)):(_=new u.default.Display.Text(v,{context:g}),e._labels.addChild(_),e._checkTextPos(_,r)),a++}}}if(e._labels.children.length>a)for(var m=a,b=e._labels.children.length;m<b;m++)e._labels.children[m].destroy(),m--,b--}}},{key:"_checkTextPos",value:function(t,e){var n=this._currPointList,i=n[e-1],a=n[e+1];i&&a&&i[1]<t.context.y&&a[1]<t.context.y&&(t.context.y+=12,t.context.textBaseline="top")}},{key:"_getFillPath",value:function(t,e){var n="",i=-this._yAxis.originPos,a=e?e.graphics.graphicsData:[];return t.graphics.graphicsData.forEach((function(t,e){var r=[].concat(t.shape.points);if(r.length>1){if(a.length){for(var o=(a[e]||a.slice(-1)[0]).shape.points,l=0,s=o.length/2;l<s;l++)r.push(o[2*(s-l-1)]),r.push(o[2*(s-l-1)+1]);r=r.concat([r[0],r[1]])}else r=r.concat([r[r.length-2],i,r[0],i,r[0],r[1]]);for(var u=r.length/2,d=0;d<u;d++){var h=r[2*d],f=r[2*d+1];d?(n+="L"+h+" "+f,d==u-1&&(n+="z")):n+="M"+h+" "+f}}})),n}},{key:"getNodeInfoOfX",value:function(t){for(var e=0,n=this.data.length;e<n;e++)if(null!==this.data[e].value&&Math.abs(this.data[e].x-t)<=.5)return this.data[e];var i,a=function(t,e){var n={x:t,y:0};return n.y=e[0][1]+(e[1][1]-e[0][1])/(e[1][0]-e[0][0])*(t-e[0][0]),n},r=function e(n){if(!(n.length<2)){var r=n.length/2;if(!(t<n[0]||t>n[2*(r-1)])){var o=parseInt(r/2),l=o+1,s=o-1,u=n[2*o],d=n[2*o+1];if(Math.abs(u-t)<=.5)i={x:u,y:d};else{var h=[];if(t>u){if(t<n[2*l])return void(i=a(t,[[u,d],[n[2*l],n[2*l+1]]]));h=n.slice(2*l)}else{if(t>n[2*s])return void(i=a(t,[[n[2*s],n[2*s+1]],[u,d]]));h=n.slice(0,2*o)}e(h)}}}};this._line&&this._line.graphics.graphicsData.forEach((function(t){i||r(t.shape.points)}));if(!i||null==i.y)return null;var o={type:"line",iGroup:this.iGroup,iNode:-1,field:this.field,value:this._yAxis.getValOfPos(-i.y),x:i.x,y:i.y,rowData:null,color:null};return o.color=this._getProp(this.node.strokeStyle,o),o}},{key:"tipsPointerOf",value:function(t){t.eventInfo&&(t.eventInfo.iNode!=this.__currFocusInd&&-1!=this.__currFocusInd&&this.unfocusOf(this.__currFocusInd),this.focusOf(t.eventInfo.iNode))}},{key:"tipsPointerHideOf",value:function(t){t.eventInfo&&this.unfocusOf(t.eventInfo.iNode)}},{key:"focusOf",value:function(t){var e=this.data[t];if(e){var n=e.nodeElement;if(n&&!e.focused&&this.__currFocusInd!=t){n._fillStyle=n.context.fillStyle,n.context.fillStyle="white",n.context.r+=n.context.lineWidth/2,n._visible=n.context.visible,n.context.visible=!0;var i=n.clone();this._focusNodes.addChild(i),i.context.visible=!0,i.context.lineWidth=0,i.context.fillStyle=n.context.strokeStyle,i.context.globalAlpha=this.node.focus.alpha,i.animate({r:i.context.r+this.node.focus.radiusDiff},{duration:300}),this.__currFocusInd=t}e.focused=!0}}},{key:"unfocusOf",value:function(t){this.__currFocusInd>-1&&(t=this.__currFocusInd);var e=this.data[t];if(e){this._focusNodes.removeAllChildren();var n=e.nodeElement;n&&e.focused&&(n.context.fillStyle=n._fillStyle,n.context.r-=n.context.lineWidth/2,n.context.visible=n._visible,e.focused=!1,this.__currFocusInd=-1)}}}],[{key:"defaultProps",value:function(){return{aniDuration:{detail:"动画时长",default:1e3},line:{detail:"线配置",propertys:{enabled:{detail:"是否开启",default:!0},growDriction:{detail:"生长动画的方向，默认为从左到右（leftRgiht）,可选rightLeft",default:"leftRight"},strokeStyle:{detail:"线的颜色",default:void 0},lineargradientDriction:{detail:"线的填充色是渐变对象的话，这里用来描述方向，默认从上到下（topBottom）,可选leftRight",default:"leftRight"},lineWidth:{detail:"线的宽度",default:2},lineType:{detail:"线的样式",default:"solid"},lineDash:{detail:"虚线的线段样式，默认[6,3]",default:[2,5]},smooth:{detail:"是否平滑处理",default:!0},shadowOffsetX:{detail:"折线的X方向阴影偏移量",default:0},shadowOffsetY:{detail:"折线的Y方向阴影偏移量",default:2},shadowBlur:{detail:"折线的阴影模糊效果",default:8},shadowColor:{detail:"折线的阴影颜色，默认和折线的strokeStyle同步， 如果strokeStyle是一个渐变色，那么shadowColor就会失效，变成默认的黑色，需要手动设置该shadowColor",default:function(){var t=this.color;return(0,Vn.colorRgba)(t,.4)}}}},node:{detail:"单个数据节点配置，对应线上的小icon图形",propertys:{enabled:{detail:"是否开启",default:!0},shapeType:{detail:"节点icon的图形类型，默认circle",documentation:'可选有"isogon"(正多边形)，"path"（自定义path路径，待实现）',default:"circle"},isogonPointNum:{detail:'shapeType为"isogon"时有效，描述正多边形的边数',default:3},path:{detail:"shapeType为path的时候，描述图形的path路径",default:null},corner:{detail:"拐角才有节点",default:!1},radius:{detail:"节点半径",default:3},fillStyle:{detail:"节点图形的背景色",default:null},strokeStyle:{detail:"节点图形的描边色，默认和line.strokeStyle保持一致",default:null},lineWidth:{detail:"节点图形边宽大小,默认跟随line.lineWidth",default:null},visible:{detail:"节点是否显示,支持函数",default:!0},focus:{detail:"节点hover态设置",propertys:{radiusDiff:{detail:"hover后的背景节点半径相差，正数为变大值,默认为4",default:4},alpha:{detail:"hover后的背景节点透明度，默认为0.5",default:.5}}}}},label:{detail:"文本配置",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本颜色",default:null},strokeStyle:{detail:"文本描边色",default:null},fontSize:{detail:"文本字体大小",default:12},format:{detail:"文本格式化处理函数",default:null},textAlign:{detail:"水平布局方式",default:"center"},textBaseline:{detail:"垂直布局方式",default:"bottom"}}},area:{detail:"面积区域配置",propertys:{enabled:{detail:"是否开启",default:!0},lineargradientDriction:{detail:"面积的填充色是渐变对象的话，这里用来描述方向，默认null(就会从line中取),从上到下（topBottom）,可选leftRight",default:"topBottom"},fillStyle:{detail:"面积背景色",default:null},alpha:{detail:"面积透明度",default:.5},bottomLine:{detail:"area的底部线配置",propertys:{enabled:{detail:"是否开启",default:!0}}}}}}}}]),i}(c.Dispatcher);e.default=m}));e(Yn);var Xn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(Yn),d=i(Gn);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f={},c=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="line",o.enabledField=null,o.groups=[],ln._.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){}},{key:"draw",value:function(t){return!t&&(t={}),this.width=t.width,this.height=t.height,ln._.extend(!0,this.origin,t.origin),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.data=this._trimGraphs(),this._setGroupsForYfield(this.data,null,t),this.animation&&!t.resize?this.grow():this.fire("complete"),this}},{key:"resetData",value:function(t,e,n){var i=this;t&&(i.dataFrame=t),n&&"origin"in n&&("x"in n.origin&&(this.sprite.context.x=n.origin.x),"y"in n.origin&&(this.sprite.context.y=n.origin.y)),i.data=i._trimGraphs(),i.groups.forEach((function(t){t.resetData(i.data[t.field].data,e,n)}))}},{key:"setEnabledField",value:function(){this.enabledField=this.app.getComponent({name:"coord"}).filterEnabledFields(this.field)}},{key:"_trimGraphs",value:function(){var t=this,e=this.app.getComponent({name:"coord"}),n={};return t.setEnabledField(),ln._.each(ln._.flatten(t.enabledField),(function(i,a){var r=t.app.getComponent({name:"coord"}).getFieldConfig(i),o=t.dataFrame.getFieldData(i);if(o){for(var l=[],s=0,u=o.length;s<u;s++){var d=e.getPoint({iNode:s,field:i,value:{y:o[s]}}),h={type:"line",iGroup:a,iNode:s,field:i,value:o[s],x:d.pos.x,y:d.pos.y,rowData:t.dataFrame.getRowDataAt(s),color:r.color};l.push(h)}n[i]={yAxis:r.yAxis,field:i,data:l}}})),n}},{key:"grow",value:function(t){var e=0,n=this.groups.length,i=this;return ln._.each(this.groups,(function(a){a._grow((function(){e++,t&&t(a),e==n&&i.fire("complete")}))})),this}},{key:"show",value:function(t){var e=this;this.data=this._trimGraphs(),this.groups.forEach((function(t){t.resetData(e.data[t.field].data)})),this._setGroupsForYfield(this.data,t).forEach((function(t){t._grow()}))}},{key:"hide",value:function(t){var e=this,n=e.getGroupIndex(t);n>-1&&this.groups.splice(n,1)[0].destroy(),this.data=this._trimGraphs(),ln._.each(this.groups,(function(t){t.resetData(e.data[t.field].data)}))}},{key:"getGroupIndex",value:function(t){for(var e=-1,n=0,i=this.groups.length;n<i;n++)if(this.groups[n].field===t){e=n;break}return e}},{key:"getGroup",value:function(t){return this.groups[this.getGroupIndex(t)]}},{key:"_setGroupsForYfield",value:function(t,e,n){var i=this;!n&&(n={}),e&&(e=ln._.flatten([e]));var a=ln._.flatten([this.field]),r=[];return ln._.each(t,(function(t,o){if(!e||-1!=ln._.indexOf(e,o)){for(var l=i.app.getComponent({name:"coord"}).getFieldConfig(o),s=ln._.indexOf(a,o),d=new u.default(l,s,i._opt,i.ctx,i.height,i.width,i,f),h=!1,c=0,p=i.groups.length;c<p;c++)if(s<i.groups[c].iGroup){i.groups.splice(c,0,d),h=!0,i.sprite.addChildAt(d.sprite,c);break}if(!h){var g=i.groups.find((function(t){return t.field==d.field}));g&&(i.groups.splice(i.groups.indexOf(g),1),g.destroy()),i.groups.push(d),i.sprite.addChild(d.sprite)}d.draw({animation:i.animation,isResize:n.resize},t.data),r.push(d)}})),r}},{key:"getNodesAt",value:function(t,e){var n=[];return ln._.each(this.groups,(function(i){var a=i.getNodeInfoAt(t,e);a&&n.push(a)})),n}},{key:"getNodesOfPos",value:function(t){var e=[];return ln._.each(this.groups,(function(n){var i=n.getNodeInfoOfX(t);i&&e.push(i)})),e}},{key:"tipsPointerOf",value:function(t){this.groups.forEach((function(e){e.tipsPointerOf(t)}))}},{key:"tipsPointerHideOf",value:function(t){this.groups.forEach((function(e){e.tipsPointerHideOf(t)}))}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置，支持二维数组格式",default:null},yAxisAlign:{detail:"绘制在哪根y轴上面",default:"left"},_props:[u.default]}}},{key:"polyfill",value:function(t){return Array.isArray(t.field)&&t.field.forEach((function(t){if(Array.isArray(t)&&t.length>1){var e=t[1];t.length=1,f[t[0]]=e}})),t}}]),i}(d.default);d.default.registerComponent(c,"graphs","line");var p=c;e.default=p}));e(Xn);var Un=n((function(t,e){function n(t,e,n,i,a,r){var o=(r-e)*(n-t)-(i-e)*(a-t);return o>0||!(o<0)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(t,e){var i=t[0][0],a=t[0][1],r=t[1][0],o=t[1][1],l=e[0][0],s=e[0][1],u=e[1][0],d=e[1][1];return n(i,a,l,s,u,d)!==n(r,o,l,s,u,d)&&n(i,a,r,o,l,s)!==n(i,a,r,o,u,d)};e.default=i}));e(Un);var qn=n((function(t,e){function n(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(var n=0;n<t.length;n++){var i=t[n],a=this.coordToCellNum(i[0]),r=this.coordToCellNum(i[1]);if(this._cells[a])this._cells[a][r]?this._cells[a][r].push(i):this._cells[a][r]=[i];else{var o=[];o[r]=[i],this._cells[a]=o}}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n.prototype={cellPoints:function(t,e){return void 0!==this._cells[t]&&void 0!==this._cells[t][e]?this._cells[t][e]:[]},rangePoints:function(t){for(var e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),i=this.coordToCellNum(t[2]),a=this.coordToCellNum(t[3]),r=[],o=e;o<=i;o++)for(var l=n;l<=a;l++)Array.prototype.push.apply(r,this.cellPoints(o,l));return r},removePoint:function(t){for(var e,n=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),a=this._cells[n][i],r=0;r<a.length;r++)if(a[r][0]===t[0]&&a[r][1]===t[1]){e=r;break}return a.splice(e,1),a},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}};var i=function(t,e){return new n(t,e)};e.default=i}));e(qn);var $n=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={toXy:function(t,e){return void 0===e?t.slice():t.map((function(t){return new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(t)}))},fromXy:function(t,e){return void 0===e?t.slice():t.map((function(t){return new Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(t)}))}};e.default=n}));e($n);var Jn=n((function(t,e){function n(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(t){var e=function(t){for(var e=[],i=0;i<t.length;i++){for(;e.length>=2&&n(e[e.length-2],e[e.length-1],t[i])<=0;)e.pop();e.push(t[i])}return e.pop(),e}(t),i=function(t){for(var e=t.reverse(),i=[],a=0;a<e.length;a++){for(;i.length>=2&&n(i[i.length-2],i[i.length-1],e[a])<=0;)i.pop();i.push(e[a])}return i.pop(),i}(t).concat(e);return i.push(t[0]),i};e.default=i}));e(Jn);var Zn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(Un),a=i(qn),r=i($n),o=i(Jn);function l(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function s(t,e,n){var i=[e[0]-t[0],e[1]-t[1]],a=[n[0]-t[0],n[1]-t[1]],r=l(t,e),o=l(t,n);return(i[0]*a[0]+i[1]*a[1])/Math.sqrt(r*o)}function u(t,e){for(var i=0;i<e.length-1;i++){var a=[e[i],e[i+1]];if(!(t[0][0]===a[0][0]&&t[0][1]===a[0][1]||t[0][0]===a[1][0]&&t[0][1]===a[1][1])&&(0,n.default)(t,a))return!0}return!1}function d(t){return[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]}function h(t,e,n){for(var i,a,r=null,o=c,l=c,d=0;d<e.length;d++)i=s(t[0],t[1],e[d]),a=s(t[1],t[0],e[d]),i>o&&a>l&&!u([t[0],e[d]],n)&&!u([t[1],e[d]],n)&&(o=i,l=a,r=e[d]);return r}function f(t,e,n,i,a){for(var r=!1,o=0;o<t.length-1;o++){var s=[t[o],t[o+1]],u=s[0][0]+","+s[0][1]+","+s[1][0]+","+s[1][1];if(!(l(s[0],s[1])<e||a.has(u))){var c=0,p=d(s),g=void 0,y=void 0,v=void 0;do{g=(p=i.extendBbox(p,c))[2]-p[0],y=p[3]-p[1],v=h(s,i.rangePoints(p),t),c++}while(null===v&&(n[0]>g||n[1]>y));g>=n[0]&&y>=n[1]&&a.add(u),null!==v&&(t.splice(o+1,0,v),i.removePoint(v),r=!0)}}return r?f(t,e,n,i,a):t}var c=Math.cos(90/(180/Math.PI)),p=.6,g=function(t,e,n){var i=e||20,l=function(t){for(var e=[t[0]],n=t[0],i=1;i<t.length;i++){var a=t[i];n[0]===a[0]&&n[1]===a[1]||e.push(a),n=a}return e}(function(t){return t.sort((function(t,e){return t[0]-e[0]||t[1]-e[1]}))}(r.default.toXy(t,n)));if(l.length<4)return l.concat([l[0]]);var s=function(t){for(var e=1/0,n=1/0,i=-1/0,a=-1/0,r=t.length-1;r>=0;r--)t[r][0]<e&&(e=t[r][0]),t[r][1]<n&&(n=t[r][1]),t[r][0]>i&&(i=t[r][0]),t[r][1]>a&&(a=t[r][1]);return[i-e,a-n]}(l),u=[s[0]*p,s[1]*p],d=(0,o.default)(l),h=l.filter((function(t){return d.indexOf(t)<0})),c=Math.ceil(1/(l.length/(s[0]*s[1]))),g=f(d,Math.pow(i,2),u,(0,a.default)(h,c),new Set);return n?r.default.fromXy(g,n):g};e.default=g}));e(Zn);var Qn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(gn),a=i(hn),r=i(fn),o=i(yn),l=i(pn),s=i(vn),u=i(xn),d=i(ln),h=i(Gn),f=i(Zn);function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}var p=d.default._,g=d.default.event,y=d.default.Shapes.Circle,v=d.default.Shapes.Rect,x=d.default.Shapes.Line,_=d.default.Shapes.Polygon,m=function(t){(0,l.default)(i,t);var e=c(i);function i(t,n){var r;return(0,a.default)(this,i),(r=e.call(this,t,n)).type="scat",r._rData=null,r._rMaxValue=null,r._rMinValue=null,r._alphaData=null,r._alphaMaxValue=null,r._alphaMinValue=null,r._groupData={},p.extend(!0,(0,o.default)(r),(0,bn.getDefaultProps)(i.defaultProps()),t),r.init(),r}return(0,r.default)(i,[{key:"init",value:function(){this._shapesp=new d.default.Display.Sprite({id:"scat_shapesp"}),this._textsp=new d.default.Display.Sprite({id:"textsp"}),this._linesp=new d.default.Display.Sprite({id:"textsp"}),this._areasp=new d.default.Display.Sprite({id:"areasp"}),this.sprite.addChild(this._areasp),this.sprite.addChild(this._linesp),this.sprite.addChild(this._shapesp),this.sprite.addChild(this._textsp)}},{key:"draw",value:function(t){!t&&(t={}),p.extend(!0,this,t),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y;var e=this;return!this.animation||t.resize||e.inited?this.fire("complete"):this.grow((function(){e.fire("complete")})),this.inited=!0,this}},{key:"resetData",value:function(t){this.dataFrame=t,this.data=this._trimGraphs(),this._widget(),this.grow()}},{key:"getNodesAt",value:function(){return[]}},{key:"_trimGraphs",value:function(){var t=[];this._groupData={};var e=this.app.getComponent({name:"coord"}),n=this.dataFrame.length;this._rData=null,this._rMaxValue=null,this._rMinValue=null,this._alphaData=null,this._alphaMaxValue=null,this._alphaMinValue=null;for(var i=0;i<n;i++){var a=this.dataFrame.getRowDataAt(i),r=e.getFieldConfig(this.field),o=e.getPoint({iNode:i,field:this.field,value:{y:a[this.field]}});if(null!=o.pos.x&&null!=o.pos.y){var l={type:"scat",rowData:a,x:o.pos.x,y:o.pos.y,value:o.value,field:this.field,fieldColor:r.color,iNode:i,focused:!1,selected:!1,radius:null,fillStyle:null,color:null,strokeStyle:null,lineType:null,lineDash:null,strokeAlpha:1,lineWidth:0,shapeType:null,label:null,fillAlpha:1,nodeElement:null};if(this._setR(l),this._setFillStyle(l),this._setFillAlpha(l),this._setStrokeStyle(l),this._setLineWidth(l),this._setLineType(l),this._setLineDash(l),this._setStrokeAlpha(l),this._setNodeType(l),this._setText(l),!this.dataFilter||!p.isFunction(this.dataFilter)||this.dataFilter.apply(this,[l])){if(this.groupField){var s=a[this.groupField];s&&(this._groupData[s]||(this._groupData[s]=[]),this._groupData[s].push(l))}else this._groupData.all||(this._groupData.all=[]),this._groupData.all.push(l);t.push(l)}}}return t}},{key:"_setR",value:function(t){var e=this.node.normalRadius,n=t.rowData;if(null!=this.node.radius){if(p.isString(this.node.radius)&&n[this.node.radius]){this._rData||this._rMaxValue||this._rMinValue||(this._rData=this.dataFrame.getFieldData(this.node.radius),this._rData=this._rData.filter((function(t){return t||0==t})),this._rMaxValue=p.max(this._rData),this._rMinValue=p.min(this._rData));var i=n[this.node.radius];e=this._rMaxValue==this._rMinValue?this.node.minRadius+(this.node.maxRadius-this.node.minRadius)/2:this.node.minRadius+(i-this._rMinValue)/(this._rMaxValue-this._rMinValue)*(this.node.maxRadius-this.node.minRadius)}p.isFunction(this.node.radius)&&(e=this.node.radius(n)),isNaN(parseInt(this.node.radius))||(e=parseInt(this.node.radius))}return e=Math.max(e*this.node.radiusScale,2),t.radius=e,this}},{key:"_setText",value:function(t){null!=this.label.field&&p.isString(this.label.field)&&t.rowData[this.label.field]&&(t.label=this.label.format(t.rowData[this.label.field],t))}},{key:"_setFillStyle",value:function(t){return t.color=t.fillStyle=this._getStyle(this.node.fillStyle,t),this}},{key:"_setFillAlpha",value:function(t){var e,n=this.node.fillAlpha,i=this.node.minFillAlpha,a=this.node.maxFillAlpha,r=t.rowData;if(null!=n)if(p.isString(n)&&r[n]){this._alphaData||this._alphaMaxValue||this._alphaMinValue||(this._alphaData=this.dataFrame.getFieldData(n),this._alphaData=this._alphaData.filter((function(t){return t||0==t})),this._alphaMaxValue=p.max(this._alphaData),this._alphaMinValue=p.min(this._alphaData));var o=r[n];e=this._alphaMaxValue==this._alphaMinValue?i+(a-i)/2:i+(o-this._alphaMinValue)/(this._alphaMaxValue-this._alphaMinValue)*(a-i)}else e=this._getProp(this.node.fillAlpha,t);else e=0;return t.fillAlpha=e,this}},{key:"_setStrokeAlpha",value:function(t){return t.strokeAlpha=this._getProp(this.node.strokeAlpha,t),this}},{key:"_setStrokeStyle",value:function(t){return t.strokeStyle=this._getStyle(this.node.strokeStyle||this.node.fillStyle,t),this}},{key:"_getProp",value:function(t,e){var n=t;return p.isArray(t)&&(n=t[e.iGroup]),p.isFunction(t)&&(n=t.apply(this,[e])),n}},{key:"_getStyle",value:function(t,e){var n=t;return p.isArray(t)&&(n=t[e.iGroup]),p.isFunction(t)&&(n=t.apply(this,[e])),n||(n=e.fieldColor),n}},{key:"_setLineWidth",value:function(t){return t.lineWidth=this._getProp(this.node.lineWidth,t),this}},{key:"_setLineType",value:function(t){return t.lineType=this._getProp(this.node.lineType,t),this}},{key:"_setLineDash",value:function(t){var e=this;return t.lineDash=function(t,n){var i=t;return p.isFunction(t)&&(i=t.apply(e,[n])),i}(this.node.lineDash,t),this}},{key:"_setNodeType",value:function(t){var e=this.node.shapeType;return p.isArray(e)&&(e=e[t.iGroup]),p.isFunction(e)&&(e=e(t)),e||(e="circle"),t.shapeType=e,this}},{key:"_widget",value:function(){var t=this,e=this;if(p.each(p.flatten([e._shapesp.children,e._textsp.children,e._linesp.children]),(function(t){t.__used=!1})),p.each(e.data,(function(t,n){var i=e._getNodeElement(t,n);i||(t.__isNew=!0);var a=e._getNodeContext(t),r="circle"==t.shapeType?y:v;if(i?i.animate(a):(i=new r({id:"shape_"+n,hoverClone:!1,context:a}),e._shapesp.addChild(i),i.on(g.types.get(),(function(t){t.eventInfo={title:null,trigger:"this.node",nodes:[this.nodeData]},this.nodeData.label&&(t.eventInfo.title=this.nodeData.label),"mouseover"==t.type&&e.focusAt(this.nodeData),"mouseout"==t.type&&!this.nodeData.selected&&e.unfocusAt(this.nodeData),e.app.fire(t.type,t)}))),i.__used=!0,i.nodeData=t,i.iNode=n,t.nodeElement=i,e.line.enabled){var o=i.lineElement,l={start:{x:a.x,y:a.y+a.r},end:{x:a.x,y:0},lineWidth:e.line.lineWidth,strokeStyle:e.line.strokeStyle,lineType:e.line.lineType};o?o.animate(l):(o=new x({context:l}),e._linesp.addChild(o)),o.__used=!0,i.lineElement=o}if(t.label&&e.label.enabled){var s=i.labelElement,u={};s?(s.resetText(t.label),u=e._getTextContext(s,a),s.animate(u)):(s=new d.default.Display.Text(t.label,{id:"scat_text_"+n,context:{}}),u=e._getTextContext(s,a),p.extend(s.context,u),e._textsp.addChild(s)),s.__used=!0,i.labelElement=s,s.nodeElement=i}})),e.area.enabled){e._areasp.removeAllChildren();var n=0,i=function(i){var a=t._groupData[i],r={name:i,iGroup:n,data:a},o=[];p.each(a,(function(t){o=o.concat(function(t,e){if(!e||1==e)return[[t.x,t.y]];for(var n=[],i=0;i<e;i++){var a=360/(e-1)*i,r=t.radius+3,o=t.x+Math.cos(2*Math.PI/360*a)*r,l=t.y+Math.sin(2*Math.PI/360*a)*r;n.push([o,l])}return n}(t,e.area.quantile))}));var l=(0,f.default)(o,e.area.concavity),s=e.app.getTheme(n),u=e._getStyle(e.area.fillStyle,r)||s,d=e._getProp(e.area.fillAlpha,r),h=e._getStyle(e.area.strokeStyle,r)||s,c=e._getProp(e.area.lineWidth,r),g=e._getProp(e.area.strokeAlpha,r),y=new _({context:{pointList:l,fillStyle:u,fillAlpha:d,strokeStyle:h,lineWidth:c,strokeAlpha:g,smooth:!1}});e._areasp.addChild(y),n++};for(var a in this._groupData)i(a)}if(p.each(p.flatten([e._shapesp.children,e._textsp.children,e._linesp.children]),(function(t){t.__used||t.animate({globalAlpha:0,r:0},{onComplete:function(){t.destroy()}})})),e.label.enabled)for(var r=0,o=e.data.length;r<o;r++){var l=e.data.length-1-r,s=e.data[l],u=e.data[l].nodeElement.labelElement;if(u){var h=void 0,c=void 0;if(l==e.data.length-1)u.context.visible=!0;else{for(var m=!1,b=l+1,w=e.data.length-1;b<=w;b++)if(h=e.data[b],(c=e.data[b].nodeElement.labelElement).context.visible){var k=s.x-u.getTextWidth()/2,S=k+u.getTextWidth(),A=s.y-u.getTextHeight()/2,P=A+u.getTextHeight(),C=h.x-c.getTextWidth()/2,D=C+c.getTextWidth(),O=h.y-c.getTextHeight()/2,T=O+c.getTextHeight();S<C||k>D||P<O||A>T||(m=!0)}u.context.visible=!m}}}}},{key:"_getNodeElement",value:function(t,e){var n,i=this.node.dataKey;if(i){p.isString(i)&&(i=i.split(","));for(var a=0,r=this._shapesp.children.length;a<r;a++){for(var o=this._shapesp.children[a],l=!0,s=0,u=i.length;s<u;s++){var d=i[s];if(o.nodeData.rowData[d]!=t.rowData[d]){l=!1;break}}if(l&&i.length){n=o;break}}}else n=this._shapesp.getChildAt(e);return n}},{key:"_getTextPosition",value:function(t,e){var n=0,i=0;switch(this.label.position){case"center":n=e.x,i=e.y;break;case"top":n=e.x,i=e.y-e.r;break;case"right":n=e.x+e.r,i=e.y;break;case"bottom":n=e.x,i=e.y+e.r;break;case"left":n=e.x-e.r,i=e.y;break;case"auto":n=e.x,i=e.y,t.getTextWidth()>2*e.r&&(i=e.y+e.r+.5*t.getTextHeight())}return{x:n+this.label.offsetX,y:i+this.label.offsetY}}},{key:"_getTextContext",value:function(t,e){var n=this._getTextPosition(t,e),i=this.label.fontSize;t.getTextWidth()>2*e.r&&(i-=2);var a={x:n.x,y:n.y,fillStyle:this.label.fontColor||e.fillStyle,fontSize:i,strokeStyle:this.label.strokeStyle||e.fillStyle,lineWidth:this.label.lineWidth,textAlign:this.label.textAlign,textBaseline:this.label.verticalAlign};return this.animation&&!this.inited&&this._setCtxAniOrigin(a),a}},{key:"_setCtxAniOrigin",value:function(t){if("default"==this.aniOrigin&&(t.y=0),"origin"==this.aniOrigin){var e=this.app.getComponent({name:"coord"}).getOriginPos({field:this.field});t.x=e.x,t.y=e.y}"center"==this.aniOrigin&&(t.x=this.width/2,t.y=-this.height/2)}},{key:"_getNodeContext",value:function(t){if("circle"==t.shapeType)return this._getCircleContext(t)}},{key:"_getCircleContext",value:function(t){var e={x:t.x,y:t.y,r:t.radius,fillStyle:t.fillStyle,strokeStyle:t.strokeStyle,strokeAlpha:t.strokeAlpha,lineWidth:t.lineWidth,lineType:t.lineType,lineDash:t.lineDash,fillAlpha:t.fillAlpha,cursor:"pointer"};return!this.animation||this.inited&&!t.__isNew||(this._setCtxAniOrigin(e),e.r=1),e}},{key:"grow",value:function(t){var e=0,n=this.data.length-1,i=this;p.each(this.data,(function(a){a.__isNew&&i._growNode(a,(function(){e+=1,delete a.__isNew,e==n&&t&&t()}))}))}},{key:"_growNode",value:function(t,e){var n=this;t.nodeElement.animate({x:t.x,y:t.y,r:t.radius},{onUpdate:function(t){if(this.labelElement&&this.labelElement.context){var e=n._getTextPosition(this.labelElement,t);this.labelElement.context.x=e.x,this.labelElement.context.y=e.y}this.lineElement&&this.lineElement.context&&(this.lineElement.context.start.y=t.y+t.r)},delay:Math.round(300*Math.random()),onComplete:function(){e&&e()}})}},{key:"focusAt",value:function(t){var e,i;if("object"==(0,n.default)(t)?e=t:(i=t,e=this.data.find((function(t){return t.iNode==i}))),this.node.focus.enabled&&!e.focused){var a=e.nodeElement.context;a.lineWidth=this._getProp(this.node.focus.lineWidth,e),a.strokeAlpha=this._getProp(this.node.focus.strokeAlpha,e),a.fillAlpha=this._getProp(this.node.focus.fillAlpha,e),e.focused=!0}}},{key:"unfocusAt",value:function(t){var e,i;if("object"==(0,n.default)(t)?e=t:(i=t,e=this.data.find((function(t){return t.iNode==i}))),this.node.focus.enabled&&e.focused){var a=e.nodeElement.context;a.lineWidth=this._getProp(e.lineWidth,e),a.strokeAlpha=this._getProp(e.strokeAlpha,e),a.fillAlpha=this._getProp(e.fillAlpha,e),a.strokeStyle=this._getProp(e.strokeStyle,e),e.focused=!1}}},{key:"selectAt",value:function(t){var e,i;if("object"==(0,n.default)(t)?e=t:(i=t,e=this.data.find((function(t){return t.iNode==i}))),this.node.select.enabled&&!e.selected){var a=e.nodeElement.context;a.lineWidth=this._getProp(this.node.select.lineWidth,e),a.strokeAlpha=this._getProp(this.node.select.strokeAlpha,e),a.fillAlpha=this._getProp(this.node.select.fillAlpha,e),e.selected=!0}}},{key:"unselectAt",value:function(t){var e,i;if("object"==(0,n.default)(t)?e=t:(i=t,e=this.data.find((function(t){return t.iNode==i}))),this.node.select.enabled&&e.selected){var a=e.nodeElement.context;e.focused?(a.lineWidth=this._getProp(this.node.focus.lineWidth,e),a.strokeAlpha=this._getProp(this.node.focus.strokeAlpha,e),a.fillAlpha=this._getProp(this.node.focus.fillAlpha,e)):(a.lineWidth=e.lineWidth,a.strokeAlpha=e.strokeAlpha,a.fillAlpha=e.fillAlpha),e.selected=!1}}},{key:"getNodesOfPos",value:function(){return[]}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},groupField:{detail:"分组字段",default:null,documentation:"分组字段，如果area配置enabled为true，那么需要groupField来构建几个area"},dataFilter:{detail:"散点过滤数据",default:null,documentation:"数据过滤器，可以和groupField实现交叉过滤"},aniOrigin:{detail:"节点动画的原点",default:"default",documentation:"可选的还有center（坐标正中）、origin（坐标原点）"},node:{detail:"单数据节点图形设置",propertys:{dataKey:{detail:"元素的数据id，默认索引匹配",default:"__index__"},shapeType:{detail:"图形类型",default:"circle",documentation:"节点的现状可以是圆 ，也可以是rect，也可以是三角形，后面两种后面实现"},maxRadius:{detail:"节点最大半径",default:25},minRadius:{detail:"节点最小半径",default:5},radius:{detail:"半径",default:null},radiusScale:{detail:"半径缩放比例",documentation:"在计算好真实半径后缩放，主要用在,缩略图中，比如datazoom的缩略图",default:1},normalRadius:{detail:"默认半径",default:15},fillStyle:{detail:"节点景色",default:null},fillAlpha:{detail:"节点透明度",default:.8},maxFillAlpha:{detail:"节点最大透明度",default:1},minFillAlpha:{detail:"节点最小透明度",default:.2},strokeStyle:{detail:"节点描边颜色",default:null},lineWidth:{detail:"节点描边线宽",default:0},lineType:{detail:"描边样式",default:"solid"},lineDash:{detail:"虚线样式",default:[2,6]},strokeAlpha:{detail:"节点描边透明度",default:1},focus:{detail:"节点hover态设置",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"hover后的边框大小",default:6},strokeAlpha:{detail:"hover后的边框透明度",default:.2},fillAlpha:{detail:"hover后的背景透明度",default:.8}}},select:{detail:"节点选中态设置",propertys:{enabled:{detail:"是否开启",default:!1},lineWidth:{detail:"选中后的边框大小",default:8},strokeAlpha:{detail:"选中后的边框透明度",default:.4},fillAlpha:{detail:"选中后的背景透明度",default:1}}}}},line:{detail:"每个节点和指标轴线的连线",propertys:{enabled:{detail:"是否开启",default:!1},lineWidth:{detail:"连线宽",default:1},strokeStyle:{detail:"连线颜色",default:"#ccc"},lineType:{detail:"连线类型",default:"dashed"}}},area:{detail:"散点集合组成的面",propertys:{enabled:{detail:"是否开启",default:!1},concavity:{detail:"凹凸系数，默认80，越大越凸",default:88},quantile:{detail:"散点用来计入面积的分位数",default:8},fillStyle:{detail:"散点集合面的背景色",default:null},fillAlpha:{detail:"散点集合面的透明度",default:.15},strokeStyle:{detail:"散点集合面的描边颜色",default:null},lineWidth:{detail:"散点集合面的描边线宽",default:0},strokeAlpha:{detail:"散点集合面的描边透明度",default:.5}}},label:{detail:"文本设置",propertys:{enabled:{detail:"是否开启",default:!0},field:{detail:"获取label的字段",default:null},format:{detail:"label格式化处理函数",default:function(t){return t}},fontSize:{detail:"label字体大小",default:13},fontColor:{detail:"字体颜色",default:"#888"},strokeStyle:{detail:"字体描边颜色",default:"#ffffff"},lineWidth:{detail:"描边大小",default:0},textAlign:{detail:"水平对齐方式",default:"center"},verticalAlign:{detail:"垂直基线对齐方式",default:"middle"},position:{detail:"文本布局位置",documentation:"auto(目前等于center，还未实现),center,top,right,bottom,left",default:"center"},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0}}}}}}]),i}(h.default);h.default.registerComponent(m,"graphs","scat");var b=m;e.default=b}));e(Qn);var Kn=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(pn),o=i(vn),l=i(xn),s=i(ln);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,l.default)(t);if(e){var a=(0,l.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,o.default)(this,n)}}var d=s.default._,h=s.default.event,f=s.default.Shapes.Sector,c=s.default.Shapes.Path,p=s.default.Display.Text,g=s.default.AnimationFrame,y=function(t){(0,r.default)(i,t);var e=u(i);function i(t,a){var r;return(0,n.default)(this,i),(r=e.call(this)).width=0,r.height=0,r.origin={x:0,y:0},r._graphs=t,r.domContainer=t.app.canvax.domView,r.data=a,r.sprite=null,r.textSp=null,r.sectorsSp=null,r.selectedSp=null,r.init(),r.sectors=[],r.textMaxCount=15,r.textList=[],r.completed=!1,r}return(0,a.default)(i,[{key:"init",value:function(){this.sprite=new s.default.Display.Sprite,this.sectorsSp=new s.default.Display.Sprite,this.sprite.addChild(this.sectorsSp),this.selectedSp=new s.default.Display.Sprite,this.sprite.addChild(this.selectedSp),this._graphs.label.enabled&&(this.textSp=new s.default.Display.Sprite)}},{key:"draw",value:function(t){var e=this;d.extend(!0,this,t),this.sprite.context.x=e.origin.x,this.sprite.context.y=e.origin.y,e._widget()}},{key:"resetData",value:function(t){var e=this;this.data=t,e.destroyLabel();for(var n=0,i=0;i<e.sectors.length;i++){var a=e.sectors[i],r=this.data.list[i];a.animate({r:r.outRadius,startAngle:r.startAngle,endAngle:r.endAngle},{duration:280,onComplete:function(){++n==e.sectors.length&&e._graphs.label.enabled&&e._startWidgetLabel()}})}}},{key:"_widget",value:function(){var t=this,e=t.data.list,n=t.data.total;if(e.length>0&&n>0){t.textSp&&t.sprite.addChild(t.textSp);for(var i=0;i<e.length;i++){var a=e[i],r=new f({hoverClone:!1,xyToInt:!1,context:{x:a.focused?a.outOffsetx:0,y:a.focused?a.outOffsety:0,r0:a.innerRadius,r:a.outRadius,startAngle:a.startAngle,endAngle:a.endAngle,fillStyle:a.fillStyle,cursor:"pointer"},id:"sector"+i});r.nodeData=a,a.focusEnabled&&r.hover((function(){t.focusOf(this.nodeData)}),(function(){!this.nodeData.selected&&t.unfocusOf(this.nodeData)})),r.on(h.types.get(),(function(e){e.eventInfo={trigger:"this._graphs.node",nodes:[this.nodeData]},t._graphs.app.fire(e.type,e)})),t.sectorsSp.addChildAt(r,0),t.sectors.push(r)}t._graphs.label.enabled&&t._startWidgetLabel()}}},{key:"focusOf",value:function(t,e){if(!t.focused){this.sectors[t.iNode].animate({r:t.outRadius+t.moveDis},{duration:100,onComplete:function(){e&&e()}}),t.focused=!0}}},{key:"unfocusOf",value:function(t,e){if(t.focused){this.sectors[t.iNode].animate({r:t.outRadius},{duration:100,onComplete:function(){e&&e()}}),t.focused=!1}}},{key:"selectOf",value:function(t){var e=this;if(this.sectors.length&&t.selectEnabled){var n=this.sectors[t.iNode];t.selected||(t.focused?this.addCheckedSec(n):(t._focusTigger="select",this.focusOf(t,(function(){e.addCheckedSec(n)}))),t.selected=!0)}}},{key:"unselectOf",value:function(t){var e=this.sectors[t.iNode];if(t.selected&&t.selectEnabled){var n=this;n.cancelCheckedSec(e,(function(){"select"==t._focusTigger&&n.unfocusOf(t)})),t.selected=!1}}},{key:"addCheckedSec",value:function(t,e){var n=t.context,i=t.nodeData;if(n){var a=new f({xyToInt:!1,context:{x:n.x,y:n.y,r0:n.r-1,r:n.r+i.selectedR,startAngle:n.startAngle,endAngle:n.startAngle,fillStyle:n.fillStyle,globalAlpha:i.selectedAlpha},id:"selected_"+t.id});t._selectedSec=a,this.selectedSp.addChild(a),this.completed?a.animate({endAngle:n.endAngle},{duration:this._getAngleTime(n),onComplete:function(){e&&e()}}):a.context.endAngle=n.endAngle}}},{key:"cancelCheckedSec",value:function(t,e){var n=t._selectedSec;n.animate({startAngle:n.context.endAngle-.5},{duration:this._getAngleTime(t.context),onComplete:function(){delete t._selectedSec,n.destroy(),e&&e()}})}},{key:"_getAngleTime",value:function(t){return Math.abs(t.startAngle-t.endAngle)/360*500}},{key:"grow",value:function(t){var e=this;d.each(e.sectors,(function(t){t.context&&(t.context.r0=0,t.context.r=0,t.context.startAngle=e._graphs.startAngle,t.context.endAngle=e._graphs.startAngle)})),e._hideGrowLabel();var n=g.registTween({from:{process:0},to:{process:1},duration:500,onUpdate:function(t){for(var n=0;n<e.sectors.length;n++){var i=e.sectors[n],a=i.nodeData,r=i.context,o=a.startAngle,l=a.endAngle,s=a.outRadius,u=a.innerRadius;if(r){if(r.r=s*t.process,r.r0=u*t.process,0==n)r.startAngle=o,r.endAngle=o+(l-o)*t.process;else{var d=function(t){var n=t-1,i=e.sectors[n].context;return 0==n?i?i.endAngle:0:i?i.endAngle:arguments.callee(n)}(n);r.startAngle=d,r.endAngle=r.startAngle+(l-o)*t.process}i._selectedSec&&(i._selectedSec.context.r0=r.r-1,i._selectedSec.context.r=r.r+a.selectedR,i._selectedSec.context.startAngle=r.startAngle,i._selectedSec.context.endAngle=r.endAngle)}}},onComplete:function(){e.sprite._removeTween(n),e._showGrowLabel(),e.completed=!0,t&&t()}});e.sprite._tweens.push(n)}},{key:"_widgetLabel",value:function(t,e,n,i,a,r){var o,l,s,u,d,h,f,g,y,v,x,_,m=this,b=0,w=m.data.list,k=2==t||3==t,S=3==t||4==t,A=k?n:i;e.length>0&&e.sort((function(t,e){return S?w[t].edgey-w[e].edgey:w[e].edgey-w[t].edgey}));for(var P=0;P<e.length;P++){o=e[P];var C=w[o],D=C.outRadius+C.moveDis;if(!(!C.enabled||C.y<A||b>=m.textMaxCount)){b++,s=C.edgey,u=Math.abs(C.edgex),d=s-l,0!=P&&(Math.abs(d)<15||S&&d<0||!S&&d>0)&&(s=S?l+15:l-15,D-Math.abs(s)>0&&(u=Math.sqrt(Math.pow(D,2)-Math.pow(s,2))),(k&&-u>C.edgex||!k&&u<C.edgex)&&(u=Math.abs(C.edgex))),a&&(v=k?r.left:r.right,x=e.length-P,_=S?v-15*x:v+15*x,(S&&s>_||!S&&s<_)&&(s=_)),l=s,a||(k?r.left=l:r.right=l);var O=k?-u-5:u+5,T=O+m.origin.x,M=s+m.origin.y;if(T>m._graphs.app.width||M<0||M>m._graphs.app.height)return;var E="M"+C.centerx+","+C.centery;E+="Q"+C.outx+","+C.outy+","+O+","+s;var R=new c({context:{lineType:"solid",path:E,lineWidth:1,strokeStyle:C.fillStyle}}),I=C.labelText,L=void 0;switch(m.domContainer?((L=document.createElement("div")).style.cssText=" ;position:absolute;left:-1000px;top:-1000px;color:"+C.fillStyle,L.innerHTML=I,m.domContainer.appendChild(L),h=L.offsetWidth,f=L.offsetHeight):(L=new p(I,{context:{fillStyle:C.fillStyle}}),m.textSp.addChild(L),h=Math.ceil(L.getTextWidth()),f=Math.ceil(L.getTextHeight())),g=k?-u:u,y=s,t){case 1:case 4:g+=5,y-=f/2;break;case 2:case 3:g-=h+5,y-=f/2}L.style?(L.style.left=g+m.origin.x+"px",L.style.top=y+m.origin.y+"px"):L.context&&(L.context.x=g,L.context.y=y),m.textSp.addChild(R),m.textList.push({width:h,height:f,x:g+m.origin.x,y:y+m.origin.y,data:C,textTxt:I,textEle:L})}}}},{key:"_startWidgetLabel",value:function(){for(var t,e,n=this,i=n.data.list,a=0,r=0,o=[],l=[{indexs:[],count:0},{indexs:[],count:0},{indexs:[],count:0},{indexs:[],count:0}],s={right:{startQuadrant:4,endQuadrant:1,clockwise:!0,indexs:[]},left:{startQuadrant:3,endQuadrant:2,clockwise:!1,indexs:[]}},u=0;u<i.length;u++){var d=i[u].quadrant;l[d-1].indexs.push(u),l[d-1].count++}l[0].count>1&&l[0].indexs.reverse(),l[2].count>1&&l[2].indexs.reverse(),l[0].count>l[3].count&&(s.right.startQuadrant=1,s.right.endQuadrant=4,s.right.clockwise=!1),l[1].count>l[2].count&&(s.left.startQuadrant=2,s.left.endQuadrant=3,s.left.clockwise=!0),s.right.indexs=l[s.right.startQuadrant-1].indexs.concat(l[s.right.endQuadrant-1].indexs),s.left.indexs=l[s.left.startQuadrant-1].indexs.concat(l[s.left.endQuadrant-1].indexs),s.right.indexs.length>n.textMaxCount&&((e=s.right.indexs.slice(0)).sort((function(t,e){return i[e].y-i[t].y})),t=e.slice(n.textMaxCount),i[t[0]].percentage,a=i[t[0]].y),s.left.indexs.length>n.textMaxCount&&((e=s.left.indexs.slice(0)).sort((function(t,e){return i[e].y-i[t].y})),t=e.slice(n.textMaxCount),i[t[0]].percentage,r=i[t[0]].y),o.push(s.right.startQuadrant),o.push(s.right.endQuadrant),o.push(s.left.startQuadrant),o.push(s.left.endQuadrant);for(var h={},f=0;f<o.length;f++){var c=1==f||3==f;n._widgetLabel(o[f],l[o[f]-1].indexs,r,a,c,h)}}},{key:"destroyLabel",value:function(){var t=this;this.textSp&&this.textSp.removeAllChildren(),d.each(this.textList,(function(e){t.domContainer&&t.domContainer.removeChild(e.textEle)})),this.textList=[]}},{key:"_showGrowLabel",value:function(){this.textSp&&this.textSp.context&&(this.textSp.context.globalAlpha=1,d.each(this.textList,(function(t){t.textEle.style&&(t.textEle.style.visibility="visible")})))}},{key:"_hideGrowLabel",value:function(){this.textSp&&this.textSp.context&&(this.textSp.context.globalAlpha=0,d.each(this.textList,(function(t){t.textEle.style&&(t.textEle.style.visibility="hidden")})))}}]),i}(h.Dispatcher);e.default=y}));e(Kn);var ti=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(Kn),d=i(Gn);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="pie",ln._.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){this.data=this._dataHandle()}},{key:"_computerProps",value:function(){var t=this.width,e=this.height;if(!this.node.outRadius){var n=Math.min(t,e)/2;this.label.enabled&&(n-=this.node.moveDis),this.node.outRadius=parseInt(n)}null!==this.node.radius&&ln._.isNumber(this.node.radius)&&(this.node.radius=Math.max(this.node.radius,this.node.minRadius),this.node.innerRadius=this.node.outRadius-this.node.radius),this.node.outRadius-this.node.innerRadius<this.node.minRadius&&(this.node.innerRadius=this.node.outRadius-this.node.minRadius),this.node.innerRadius<0&&(this.node.innerRadius=0)}},{key:"draw",value:function(t){!t&&(t={}),ln._.extend(!0,this,t),this._computerProps(),this._pie=new u.default(this,this._trimGraphs(this.data)),this._pie.draw(t);var e=this;this.animation&&!t.resize?this._pie.grow((function(){e.fire("complete")})):this.fire("complete"),this.sprite.addChild(this._pie.sprite)}},{key:"show",value:function(t){this._setEnabled(t,!0)}},{key:"hide",value:function(t){this._setEnabled(t,!1)}},{key:"_setEnabled",value:function(t,e){var n=this;ln._.each(this.data,(function(n){if(n.label===t)return n.enabled=e,!1})),n._pie.resetData(n._trimGraphs(n.data))}},{key:"_dataHandle",value:function(){for(var t=this,e=[],n=t.dataFrame,i=0,a=n.length;i<a;i++){var r=n.getRowDataAt(i),o={type:"pie",field:t.field,rowData:r,focused:!1,focusEnabled:t.node.focus.enabled,selected:!1,selectEnabled:t.node.select.enabled,selectedR:t.node.select.radius,selectedAlpha:t.node.select.alpha,enabled:!0,fillStyle:null,color:null,value:r[t.field],label:r[t.keyField||t.field],labelText:null,iNode:i},l=t._getColor(t.node.fillStyle,o);o.fillStyle=o.color=l,e.push(o)}return e.length&&t.sort&&(e.sort((function(e,n){return"asc"==t.sort?e.value-n.value:n.value-e.value})),ln._.each(e,(function(t,e){t.iNode=e}))),e}},{key:"_trimGraphs",value:function(t){var e=this,n=0;e.currentAngle=0+e.startAngle%360;var i=e.allAngle+e.startAngle%e.allAngle,a=0,r=0;if(t.length){for(var o=0;o<t.length;o++)if(t[o].enabled&&(n+=t[o].value,e.node.radius&&ln._.isString(e.node.radius)&&e.node.radius in t[o].rowData)){var l=Number(t[o].rowData[e.node.radius]);a=Math.max(a,l),r=Math.min(r,l)}if(n>0)for(var s=0;s<t.length;s++){var u=t[s].value/n;t[s].enabled||(u=0);var d=+(100*u).toFixed(2),h=e.allAngle*u,f=e.currentAngle+h>i?i:e.currentAngle+h,c=Math.cos((e.currentAngle+h/2)/180*Math.PI),p=Math.sin((e.currentAngle+h/2)/180*Math.PI),g=e.currentAngle+h/2,y=function(t){t>=i&&(t=i),t%=e.allAngle;var n=parseInt(t/90);if(t>=0)switch(n){case 0:return 1;case 1:return 2;case 2:return 3;case 3:case 4:return 4}else if(t<0)switch(n){case 0:return 4;case-1:return 3;case-2:return 2;case-3:case-4:return 1}}(g),v=e.node.outRadius;if(e.node.radius&&ln._.isString(e.node.radius)&&e.node.radius in t[s].rowData){var x=Number(t[s].rowData[e.node.radius]);v=parseInt((e.node.outRadius-e.node.innerRadius)*((x-r)/(a-r))+e.node.innerRadius)}var _=e.node.moveDis;ln._.extend(t[s],{outRadius:v,innerRadius:e.node.innerRadius,startAngle:e.currentAngle,endAngle:f,midAngle:g,moveDis:_,outOffsetx:.7*_*c,outOffsety:.7*_*p,centerx:v*c,centery:v*p,outx:(v+_)*c,outy:(v+_)*p,edgex:(v+_)*c,edgey:(v+_)*p,orginPercentage:u,percentage:d,quadrant:y,labelDirection:1==y||4==y?1:0,iNode:s}),t[s].labelText=e._getLabelText(t[s]),t[s].subValue=d+"%",e.currentAngle+=h,e.currentAngle>i&&(e.currentAngle=i)}}return{list:t,total:n}}},{key:"_getColor",value:function(t,e){var n=e.iNode,i=t;return ln._.isArray(t)&&(i=t[n]),ln._.isFunction(t)&&(i=t.apply(this,[e])),i||(i=this.app.getTheme(n)),i}},{key:"_getLabelText",value:function(t){var e;if(this.label.enabled)if(this.label.format)ln._.isFunction(this.label.format)&&(e=this.label.format(t.label,t));else{var n=this.keyField;e=n?t.rowData[n]+"："+t.percentage+"%":t.percentage+"%"}return e}},{key:"getList",value:function(){return this.data}},{key:"getLegendData",value:function(){var t=[];return ln._.each(this.data,(function(e){t.push({name:e.label,color:e.fillStyle,enabled:e.enabled})})),t}},{key:"tipsPointerOf",value:function(){}},{key:"tipsPointerHideOf",value:function(){}},{key:"focusAt",value:function(t){var e=this._pie.data.list[t];this.node.focus.enabled&&this._pie.focusOf(e)}},{key:"unfocusAt",value:function(t){var e=this._pie.data.list[t];e.node.focus.enabled&&this._pie.unfocusOf(e)}},{key:"selectAt",value:function(t){var e=this._pie.data.list[t];this.node.select.enabled&&this._pie.selectOf(e)}},{key:"unselectAt",value:function(t){var e=this._pie.data.list[t];this.node.select.enabled&&this._pie.unselectOf(e)}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},keyField:{detail:"分组字段",default:null,documentation:"keyField主要是给legend用的， 所有在legend中需要显示的分组数据，都用keyField"},sort:{detail:"排序，默认不排序，可以配置为asc,desc",default:null},startAngle:{detail:"起始角度",default:-90},allAngle:{detail:"全部角度",default:360},node:{detail:"单个节点（扇形）配置",propertys:{radius:{detail:"半径",default:null,documentation:"每个扇形单元的半径，也可以配置一个字段，就成了丁格尔玫瑰图"},innerRadius:{detail:"内径",default:0},outRadius:{detail:"外径",default:null},minRadius:{detail:"最小的半径厚度",default:10,documentation:"outRadius - innerRadius ， 也就是radius的最小值"},moveDis:{detail:"hover偏移量",default:8,documentation:"要预留moveDis位置来hover sector 的时候外扩"},fillStyle:{detail:"单个图形背景色",default:null},focus:{detail:"图形的hover设置",propertys:{enabled:{detail:"是否开启",default:!0}}},select:{detail:"图形的选中效果",propertys:{enabled:{detail:"是否开启",default:!0},radius:{detail:"选中效果图形的半径厚度",default:5},alpha:{detail:"选中效果图形的透明度",default:.7}}}}},label:{detail:"label",propertys:{field:{detail:"获取label的字段",default:null},enabled:{detail:"是否开启",default:!1},format:{detail:"label的格式化函数，支持html",default:null}}}}}},{key:"polyfill",value:function(t){return t.groupField&&(t.keyField=t.groupField,delete t.groupField),t.label&&t.label.field&&(t.keyField=t.label.field,delete t.label.field),t}}]),i}(d.default);d.default.registerComponent(f,"graphs","pie");var c=f;e.default=c}));e(ti);var ei=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Gn);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=u.default._,c=u.default.event,p=u.default.Shapes.Polygon,g=u.default.Shapes.Circle,y=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="radar",o.enabledField=null,o.groups={},f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){}},{key:"draw",value:function(t){!t&&(t={}),f.extend(!0,this,t),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.fire("complete")}},{key:"_widget",value:function(){var t=this,e=this.app.getComponent({name:"coord"}),n=0;f.each(this.data,(function(i,a){var r={},o=[];f.each(i,(function(t){o.push([t.point.x,t.point.y])}));var l=e.getFieldConfig(a),s=t._getStyle(t.line.strokeStyle,l,n,l.color),u=t._getStyle(t.line.lineType,l,n,l.color),d={pointList:o,cursor:"pointer"};t.line.enabled&&(d.lineWidth=t.line.lineWidth,d.strokeStyle=s,d.lineType=u),t.area.enabled&&(d.fillStyle=t._getStyle(t.area.fillStyle,l,n,l.color),d.fillAlpha=t._getStyle(t.area.fillAlpha,l,n,1));var h=new p({hoverClone:!1,context:d});r.area=h,t.sprite.addChild(h),h.__hoverFillAlpha=h.context.fillAlpha+.2,h.__fillAlpha=h.context.fillAlpha,h.on(c.types.get(),(function(e){"mouseover"==e.type&&(this.context.fillAlpha=this.__hoverFillAlpha),"mouseout"==e.type&&(this.context.fillAlpha=this.__fillAlpha),t.app.fire(e.type,e)}));var y=[];t.node.enabled&&f.each(i,(function(e,n){o.push([e.point.x,e.point.y]);var i=new g({context:{cursor:"pointer",x:e.point.x,y:e.point.y,r:t.node.radius,lineWidth:t.node.lineWidth,strokeStyle:t.node.strokeStyle,fillStyle:s}});t.sprite.addChild(i),i.iNode=n,i.nodeData=e,i._strokeStyle=s,i.on(c.types.get(),(function(e){e.aAxisInd=this.iNode,e.eventInfo={trigger:"this.node",nodes:[this.nodeData]},t.app.fire(e.type,e)})),y.push(i)})),r.nodes=y,t.groups[a]=r,n++}))}},{key:"tipsPointerOf",value:function(t){var e=this;e.tipsPointerHideOf(t),t.eventInfo&&t.eventInfo.nodes&&f.each(t.eventInfo.nodes,(function(t){e.data[t.field]&&f.each(e.data[t.field],(function(n,i){t.iNode==i&&e.focusOf(n)}))}))}},{key:"tipsPointerHideOf",value:function(){var t=this;f.each(t.data,(function(e){f.each(e,(function(e){t.unfocusOf(e)}))}))}},{key:"focusOf",value:function(t){if(!t.focused){var e=this;if(e.node.enabled){var n=e.groups[t.field].nodes[t.iNode];n.context.r+=1,n.context.fillStyle=e.node.strokeStyle,n.context.strokeStyle=n._strokeStyle}t.focused=!0}}},{key:"unfocusOf",value:function(t){if(t.focused){var e=this;if(e.node.enabled){var n=e.groups[t.field].nodes[t.iNode];n.context.r-=1,n.context.fillStyle=n._strokeStyle,n.context.strokeStyle=e.node.strokeStyle}t.focused=!1}}},{key:"hide",value:function(t){var e=this.app.getComponent({name:"coord"});this.enabledField=e.filterEnabledFields(this.field);var n=this.groups[t];n&&(n.area.context.visible=!1,f.each(n.nodes,(function(t){t.context.visible=!1})))}},{key:"show",value:function(t){var e=this.app.getComponent({name:"coord"});this.enabledField=e.filterEnabledFields(this.field);var n=this.groups[t];n&&(n.area.context.visible=!0,f.each(n.nodes,(function(t){t.context.visible=!0})))}},{key:"_trimGraphs",value:function(){var t=this,e=this.app.getComponent({name:"coord"});this.enabledField=e.filterEnabledFields(this.field);var n={};return f.each(this.enabledField,(function(i){var a=t.dataFrame.getFieldData(i),r=e.getFieldConfig(i),o=[];f.each(e.aAxis.angleList,(function(n,l){var s=Math.PI*n/180,u=e.getPointInRadianOfR(s,e.getROfNum(a[l]));o.push({type:"radar",field:i,iNode:l,rowData:t.dataFrame.getRowDataAt(l),focused:!1,value:a[l],point:u,color:r.color})})),n[i]=o})),n}},{key:"_getStyle",value:function(t,e,n,i){var a=i;return(f.isString(t)||f.isNumber(t))&&(a=t),f.isArray(t)&&(a=t[n]),f.isFunction(t)&&(a=t(n,e)),null==a&&(a=i),a}},{key:"getNodesAt",value:function(t){var e=this.data,n=[];return f.each(this.enabledField,(function(i){if(f.isArray(i))f.each(i,(function(i){var a=e[i][t];a&&n.push(a)}));else{var a=e[i][t];a&&n.push(a)}})),n}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},line:{detail:"线配置",propertys:{enabled:{detail:"是否显示",default:!0},lineWidth:{detail:"线宽",default:2},strokeStyle:{detail:"线颜色",default:null},lineType:{detail:"线条样式,默认solid，可选dashed",default:"solid"}}},area:{detail:"面积区域配置",propertys:{enabled:{detail:"是否显示",default:!0},fillStyle:{detail:"面积背景色",default:null},fillAlpha:{detail:"面积透明度",default:.1}}},node:{detail:"线上面的单数据节点图形配置",propertys:{enabled:{detail:"是否显示",default:!0},strokeStyle:{detail:"边框色",default:"#ffffff"},radius:{detail:"半径",default:4},lineWidth:{detail:"边框大小",default:1}}}}}}]),i}(d.default);d.default.registerComponent(y,"graphs","radar");var v=y;e.default=v}));e(ei);var ni=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={value:function(){}};function i(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i)throw new Error("illegal type: "+t);i[t]=[]}return new a(i)}function a(t){this._=t}function r(t,e){for(var n,i=0,a=t.length;i<a;++i)if((n=t[i]).name===e)return n.value}function o(t,e,i){for(var a=0,r=t.length;a<r;++a)if(t[a].name===e){t[a]=n,t=t.slice(0,a).concat(t.slice(a+1));break}return null!=i&&t.push({name:e,value:i}),t}a.prototype=i.prototype={constructor:a,on:function(t,e){var n,i=this._,a=function(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}(t+"",i),l=-1,s=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++l<s;)if(n=(t=a[l]).type)i[n]=o(i[n],t.name,e);else if(null==e)for(n in i)i[n]=o(i[n],t.name,null);return this}for(;++l<s;)if((n=(t=a[l]).type)&&(n=r(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new a(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,a=new Array(n),r=0;r<n;++r)a[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=0,n=(i=this._[t]).length;r<n;++r)i[r].value.apply(e,a)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],a=0,r=i.length;a<r;++a)i[a].value.apply(e,n)}};var l=i;e.default=l}));e(ni);var ii=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(ni),a=Math.PI/180,r=64,o=2048;function l(t){return t.text}function s(){return"serif"}function u(){return"normal"}function d(t){return Math.sqrt(t.value)}function h(){return 30*(~~(6*Math.random())-3)}function f(){return 1}function c(t,e,n,i){if(!e.sprite){var l=t.context,s=t.ratio;l.clearRect(0,0,(r<<5)/s,o/s);var u=0,d=0,h=0,f=n.length;for(--i;++i<f;){e=n[i],l.save(),l.font=e.style+" "+e.weight+" "+~~((e.size+1)/s)+"px "+e.font;var c=l.measureText(e.text+"m").width*s,p=e.size<<1;if(e.rotate){var g=Math.sin(e.rotate*a),y=Math.cos(e.rotate*a),v=c*y,x=c*g,_=p*y,m=p*g;c=Math.max(Math.abs(v+m),Math.abs(v-m))+31>>5<<5,p=~~Math.max(Math.abs(x+_),Math.abs(x-_))}else c=c+31>>5<<5;if(p>h&&(h=p),u+c>=r<<5&&(u=0,d+=h,h=0),d+p>=o)break;l.translate((u+(c>>1))/s,(d+(p>>1))/s),e.rotate&&l.rotate(e.rotate*a),l.fillText(e.text,0,0),e.padding&&(l.lineWidth=2*e.padding,l.strokeText(e.text,0,0)),l.restore(),e.width=c,e.height=p,e.xoff=u,e.yoff=d,e.x1=c>>1,e.y1=p>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,u+=c}for(var b=l.getImageData(0,0,(r<<5)/s,o/s).data,w=[];--i>=0;)if((e=n[i]).hasText){for(var k=(c=e.width)>>5,S=(p=e.y1-e.y0,0);S<p*k;S++)w[S]=0;if(null==(u=e.xoff))return;d=e.yoff;for(var A=0,P=-1,C=0;C<p;C++){for(S=0;S<c;S++){var D=k*C+(S>>5),O=b[(d+C)*(r<<5)+(u+S)<<2]?1<<31-S%32:0;w[D]|=O,A|=O}A?P=C:(e.y0++,p--,C--,d++)}e.y1=e.y0+P,e.sprite=w.slice(0,(e.y1-e.y0)*k)}}}function p(t,e,n){n>>=5;for(var i,a=t.sprite,r=t.width>>5,o=t.x-(r<<4),l=127&o,s=32-l,u=t.y1-t.y0,d=(t.y+t.y0)*n+(o>>5),h=0;h<u;h++){i=0;for(var f=0;f<=r;f++)if((i<<s|(f<r?(i=a[h*r+f])>>>l:0))&e[d+f])return!0;d+=n}return!1}function g(t,e){var n=t[0],i=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>i.x&&(i.x=e.x+e.x1),e.y+e.y1>i.y&&(i.y=e.y+e.y1)}function y(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function v(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function x(){return document.createElement("canvas")}function _(t){return"function"==typeof t?t:function(){return t}}var m={archimedean:v,rectangular:function(t){var e=4*t[0]/t[1],n=0,i=0;return function(t){var a=t<0?-1:1;switch(Math.sqrt(1+4*a*t)-a&3){case 0:n+=e;break;case 1:i+=4;break;case 2:n-=e;break;default:i-=4}return[n,i]}}},b=function(){var t=[256,256],e=l,i=s,a=d,b=u,w=u,k=h,S=f,A=v,P=[],C=1/0,D=(0,n.default)("word","end"),O=null,T=Math.random,M={},E=x;function R(e,n,i){t[0],t[1];for(var a,r,o,l=n.x,s=n.y,u=Math.sqrt(t[0]*t[0]+t[1]*t[1]),d=A(t),h=T()<.5?1:-1,f=-h;(a=d(f+=h))&&(r=~~a[0],o=~~a[1],!(Math.min(Math.abs(r),Math.abs(o))>=u));)if(n.x=l+r,n.y=s+o,!(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>t[0]||n.y+n.y1>t[1])&&(!i||!p(n,e,t[0]))&&(!i||y(n,i))){for(var c,g=n.sprite,v=n.width>>5,x=t[0]>>5,_=n.x-(v<<4),m=127&_,b=32-m,w=n.y1-n.y0,k=(n.y+n.y0)*x+(_>>5),S=0;S<w;S++){c=0;for(var P=0;P<=v;P++)e[k+P]|=c<<b|(P<v?(c=g[S*v+P])>>>m:0);k+=x}return delete n.sprite,!0}return!1}return M.canvas=function(t){return arguments.length?(E=_(t),M):E},M.start=function(){var n=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(r<<5)/e,t.height=o/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(E()),l=function(t){var e=[],n=-1;for(;++n<t;)e[n]=0;return e}((t[0]>>5)*t[1]),s=null,u=P.length,d=-1,h=[],f=P.map((function(t,n){return t.text=e.call(this,t,n),t.font=i.call(this,t,n),t.style=b.call(this,t,n),t.weight=w.call(this,t,n),t.rotate=k.call(this,t,n),t.size=~~a.call(this,t,n),t.padding=S.call(this,t,n),t})).sort((function(t,e){return e.size-t.size}));return O&&clearInterval(O),O=setInterval(p,0),p(),M;function p(){for(var e=Date.now();Date.now()-e<C&&++d<u&&O;){var i=f[d];i.x=t[0]*(T()+.5)>>1,i.y=t[1]*(T()+.5)>>1,c(n,i,f,d),i.hasText&&R(l,i,s)&&(h.push(i),D.call("word",M,i),s?g(s,i):s=[{x:i.x+i.x0,y:i.y+i.y0},{x:i.x+i.x1,y:i.y+i.y1}],i.x-=t[0]>>1,i.y-=t[1]>>1)}d>=u&&(M.stop(),D.call("end",M,h,s))}},M.stop=function(){return O&&(clearInterval(O),O=null),M},M.timeInterval=function(t){return arguments.length?(C=null==t?1/0:t,M):C},M.words=function(t){return arguments.length?(P=t,M):P},M.size=function(e){return arguments.length?(t=[+e[0],+e[1]],M):t},M.font=function(t){return arguments.length?(i=_(t),M):i},M.fontStyle=function(t){return arguments.length?(b=_(t),M):b},M.fontWeight=function(t){return arguments.length?(w=_(t),M):w},M.rotate=function(t){return arguments.length?(k=_(t),M):k},M.text=function(t){return arguments.length?(e=_(t),M):e},M.spiral=function(t){return arguments.length?(A=m[t]||t,M):A},M.fontSize=function(t){return arguments.length?(a=_(t),M):a},M.padding=function(t){return arguments.length?(S=_(t),M):S},M.random=function(t){return arguments.length?(T=t,M):T},M.on=function(){var t=D.on.apply(D,arguments);return t===D?M:t},M};e.default=b}));e(ii);var ai=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Gn),h=i(ii);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var c=u.default._,p=u.default.event,g=u.default.Display.Text,y=function(t){(0,o.default)(i,t);var e=f(i);function i(t,a){var o;(0,n.default)(this,i),(o=e.call(this,t,a)).type="cloud";var l=(0,r.default)(o);return o.node={_maxFontSizeVal:0,_minFontSizeVal:null},c.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.node.fontColor=function(t){return l.app.getTheme(t.iNode)},o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){}},{key:"draw",value:function(t){!t&&(t={}),c.extend(!0,this,t),this._drawGraphs(),this.sprite.context.x=this.width/2,this.sprite.context.y=this.height/2,this.fire("complete")}},{key:"getDaraFrameIndOfVal",value:function(t){var e=this,n=this.dataFrame,i=c.find(n.data,(function(t){return t.field==e.field}));return c.indexOf(i.data,t)}},{key:"_getFontSize",value:function(t){var e=this.node.minFontSize;if(c.isFunction(this.node.fontSize)&&(e=this.node.fontSize(t)),c.isString(this.node.fontSize)&&this.node.fontSize in t){var n=Number(t[this.node.fontSize]);isNaN(n)||(e=this.node.minFontSize+(this.node.maxFontSize-this.node.minFontSize)/(this.node._maxFontSizeVal-this.node._minFontSizeVal)*(n-this.node._minFontSizeVal))}return c.isNumber(this.node.fontSize)&&(e=this.node.fontSize),e}},{key:"_getRotate",value:function(t,e){var n=this.node.rotation;return c.isFunction(this.node.rotation)&&(n=this.node.rotation(t,e)||0),n}},{key:"_getFontColor",value:function(t){var e;return c.isString(this.node.fontColor)&&(e=this.node.fontColor),c.isFunction(this.node.fontColor)&&(e=this.node.fontColor(t)),null==e&&(e="#ccc"),e}},{key:"_drawGraphs",value:function(){var t=this;c.isString(this.node.fontSize)&&c.each(t.dataFrame.getFieldData(this.node.fontSize),(function(e){t.node._maxFontSizeVal=Math.max(t.node._maxFontSizeVal,e),t.node._minFontSizeVal=Math.min(t.node._minFontSizeVal,e)}));var e=(0,h.default)().size([t.width,t.height]).words(t.dataFrame.getFieldData(t.field).map((function(e,n){var i=t.app.dataFrame.getRowDataAt(t.getDaraFrameIndOfVal(e)),a={type:"cloud",rowData:i,field:t.field,name:"",value:e,text:null,size:t._getFontSize(i,e),iNode:n,color:null,__no__name:!0};a.fontColor=t._getFontColor(a);var r=e;if(t.node.format)r=t.node.format(e,a);else{var o=t.app.getComponent({name:"coord"}).getFieldConfig(t.field);o&&(r=o.getFormatValue(e))}return a.text=r||e,a}))).padding(t.node.padding).rotate((function(e,n){return t._getRotate(e,n)})).font(t.node.fontFamily).fontSize((function(t){return t.size})).on("end",(function(e){t.data=e,t.sprite.removeAllChildren(),c.each(e,(function(n,i){n.iNode=i,n.dataLen=e.length,n.focused=!1,n.selected=!1;var a=new g(n.text,{context:{x:n.x,y:n.y,fontSize:n.size,fontFamily:n.font,rotation:n.rotate,textBaseline:"middle",textAlign:"center",cursor:"pointer",fontWeight:t.node.fontWeight,fillStyle:n.fontColor}});t.sprite.addChild(a),t.node.focus.enabled&&a.hover((function(){t.focusAt(this.nodeData.iNode)}),(function(){!this.nodeData.selected&&t.unfocusAt(this.nodeData.iNode)})),a.nodeData=n,n._node=a,a.on(p.types.get(),(function(e){e.eventInfo={trigger:"this.node",title:null,nodes:[this.nodeData]},this.nodeData.text&&(e.eventInfo.title=""),t.app.fire(e.type,e)}))}))}));e.start()}},{key:"focusAt",value:function(t){var e=this.data[t];this.node.focus.enabled&&!e.focused&&(e._node.context.fontSize+=3,e.focused=!0)}},{key:"unfocusAt",value:function(t){var e=this.data[t];this.node.focus.enabled&&e.focused&&(e._node.context.fontSize-=3,e.focused=!1)}},{key:"selectAt",value:function(t){var e=this.data[t];if(this.node.select.enabled&&!e.selected){var n=e._node.context;n.lineWidth=this.node.select.lineWidth,n.strokeAlpha=this.node.select.strokeAlpha,n.strokeStyle=this.node.select.strokeStyle,e.selected=!0}}},{key:"unselectAt",value:function(t){var e=this.data[t];this.node.select.enabled&&e.selected&&(e._node.context.strokeStyle=this.node.strokeStyle,e.selected=!1)}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},node:{detail:"节点文字配置",propertys:{fontFamily:{detail:"字体设置",default:"Impact"},fontColor:{detail:"文字颜色",default:"#999"},fontSize:{detail:"文本字体大小",default:function(){return this.minFontSize+Math.random()*this.maxFontSize}},maxFontSize:{detail:"文本最大字体大小",default:30},minFontSize:{detail:"文本最小字体大小",default:16},fontWeight:{detail:"fontWeight",default:"normal"},format:{detail:"文本格式化处理函数",default:null},padding:{detail:"文本间距",default:10},rotation:{detail:"文本旋转角度",default:function(){return 30*(~~(6*Math.random())-3)}},strokeStyle:{detail:"文本描边颜色",default:null},select:{detail:"文本选中效果",propertys:{enabled:{detail:"是否开启选中",default:!0},lineWidth:{detail:"选中后的文本描边宽",default:2},strokeStyle:{detail:"选中后的文本描边色",default:"#666"}}},focus:{detail:"文本hover效果",propertys:{enabled:{detail:"是否开启hover效果",default:!0}}}}}}}}]),i}(d.default);d.default.registerComponent(y,"graphs","cloud");var v=y;e.default=v}));e(ai);var ri=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(ln),o=r.default._,l=r.default.event,s=r.default.Shapes.Circle,u=function(){function t(e,i,a){(0,n.default)(this,t),this._opt=e,this.dataFrame=i,this._graphs=a,this.app=a.app,this.field=null,this.iGroup=0,this.groupLen=1,this.rRange={start:0,to:0},this.width=0,this.height=0,this.selectInds=[],this.layoutType="radian",this.pit={radius:30},this.planets=[],this.maxRingNum=0,this.ringNum=0,o.extend(!0,this,(0,bn.getDefaultProps)(t.defaultProps()),e),this.node.maxRadius>this.pit.radius&&(this.pit.radius=this.node.maxRadius),this.init()}return(0,a.default)(t,[{key:"init",value:function(){var t=this.app.getComponent({name:"coord"});this.sprite=new r.default.Display.Sprite({id:"group_"+this.iGroup,context:{x:t.origin.x,y:t.origin.y}}),this._trimGraphs(),this.draw()}},{key:"_trimGraphs",value:function(){var t=this,e=this.app.getComponent({name:"coord"}).getMaxDisToViewOfOrigin();(e-this.rRange.to)/(2*this.pit.radius)<this.groupLen-1-this.iGroup&&(this.rRange.to=e-(this.groupLen-1-this.iGroup)*this.pit.radius*2),this.rRange.to-this.rRange.start<2*this.pit.radius&&(this.rRange.to=this.rRange.start+2*this.pit.radius),this.maxRingNum||(this.maxRingNum=parseInt((this.rRange.to-this.rRange.start)/(2*this.pit.radius),10),this.ringNum=this.maxRingNum),this.rRange.to=this.rRange.start+this.ringNum*this.pit.radius*2;for(var n=[],i=this.dataFrame.length,a=0;a<i;a++){var r=this.dataFrame.getRowDataAt(a),l={type:"planet",groupLen:this.groupLen,iGroup:t.iGroup,iNode:a,nodeElement:null,labelElement:null,rowData:r,iRing:null,iPlanet:null,fillStyle:null,color:null,strokeStyle:null,pit:null,ringInd:-1,field:t.field,label:r[t.field],focused:!1,selected:!!~o.indexOf(this.selectInds,r.__index__)};n.push(l)}t.sortField&&(n=n.sort((function(e,n){var i=t.sortField;return"desc"==t.sort?n.rowData[i]-e.rowData[i]:e.rowData[i]-n.rowData[i]})),o.each(n,(function(t,e){t.iNode=e}))),this._rings=this["_setRings_"+this.layoutType+"Range"](n),this.planets=n}},{key:"_setRings_radianRange",value:function(t){for(var e=this,n=[],i=this.app.getComponent({name:"coord"}),a=0,r=this.ringNum;a<r;a++){var l=a*this.pit.radius*2+this.pit.radius+this.rRange.start;e._graphs.center.enabled||(l=a*this.pit.radius*2+this.rRange.start);var s=i.getRadiansAtR(l,e.width,e.height);n.push({arcs:s,pits:[],planets:[],radius:l,max:0})}var u=0;o.each(n,(function(t){var n=2*Math.asin(e.pit.radius/t.radius);0==t.radius&&(n=2*Math.PI);var i=0;o.each(t.arcs,(function(a){var r=e._getDiffRadian(a[0].radian,a[1].radian);if(r>=n){var o=parseInt(r/n,10);i+=o;for(var l=0;l<o;l++){var s={hasRadish:!1,start:(a[0].radian+n*l+2*Math.PI)%(2*Math.PI)};s.middle=(s.start+n/2+2*Math.PI)%(2*Math.PI),s.to=(s.start+n+2*Math.PI)%(2*Math.PI),t.pits.push(s)}}})),t.max=i,u+=i,t.pits=o.shuffle(t.pits)}));var d=0;return o.each(n,(function(e,i){if(d>=t.length)return!1;var a=Math.ceil(e.max/u*t.length);a=Math.min(e.max,a),e.planets=t.slice(d,d+a),i==n.length-1&&(e.planets=t.slice(d)),d+=a,o.each(e.planets,(function(t,n){if(!(n>=e.pits.length)){var i=o.filter(e.pits,(function(t){return!t.hasRadish})),a=i[parseInt(Math.random()*i.length)];a.hasRadish=!0,t.pit=a}}))})),n}},{key:"_getDiffRadian",value:function(t,e){var n=e-t;return e<t&&(n=(e+2*Math.PI-t)%(2*Math.PI)),n}},{key:"_setRings_indexRange",value:function(){}},{key:"_setRings_valRange",value:function(){}},{key:"draw",value:function(){var t=this,e=this.app.getComponent({name:"coord"});o.each(this._rings,(function(n,i){var a={rotation:0};1==n.arcs.length&&0==n.arcs[0][0].radian&&n.arcs[0][1].radian==2*Math.PI&&(a.rotation=parseInt(360*Math.random()));var u=new r.default.Display.Sprite({context:a});o.each(n.planets,(function(d,h){if(d.pit){var f=e.getPointInRadianOfR(d.pit.middle,n.radius),c=t._getRProp(t.node.radius,i,h,d),p=t.node.maxRadius-c,g=parseInt(Math.random()*p),y=parseInt(360*Math.random())*Math.PI/180;0!=g&&(f.x+=Math.sin(y)*g,f.y+=Math.cos(y)*g);var v=t.node;d.selected&&(v=t.node.select);var x=t._getProp(t.node.fillStyle,d),_=t._getProp(v.strokeStyle,d),m=t._getProp(v.strokeAlpha,d),b=t._getProp(v.lineWidth,d),w={x:f.x,y:f.y,r:c,fillStyle:x,lineWidth:b,strokeStyle:_,strokeAlpha:m,cursor:"pointer"};d.color=d.fillStyle=x,d.strokeStyle=_,d.iRing=i,d.iPlanet=h;var k=new s({hoverClone:!1,context:w});if(k.on(l.types.get(),(function(e){if(e.eventInfo={title:null,trigger:"this.node",nodes:[this.nodeData]},this.nodeData.label&&(e.eventInfo.title=this.nodeData.label),t.node.focus.enabled&&("mouseover"==e.type&&t.focusAt(this.nodeData),"mouseout"==e.type&&t.unfocusAt(this.nodeData)),t.node.select.enabled&&t.node.select.triggerEventType.indexOf(e.type)>-1){var n=t.node.select.onbefore,i=t.node.select.onend;(!n||"function"==typeof n&&!1!==n.apply(t,[this.nodeData]))&&(this.nodeData.selected?t.unselectAt(this.nodeData):t.selectAt(this.nodeData),i&&"function"==typeof i&&i.apply(t,[this.nodeData]))}t.app.fire(e.type,e)})),k.nodeData=d,d.nodeElement=k,k.ringInd=i,k.planetIndInRing=h,u.addChild(k),t._graphs.animation){var S=k.context.r,A=k.context.globalAlpha;k.context.r=1,k.context.globalAlpha=.1,k.animate({r:S,globalAlpha:A},{delay:Math.round(1500*Math.random()),onComplete:function(){k.labelElement&&(k.labelElement.context.visible=!0);var t=k.clone();u.addChildAt(t,0),t.animate({r:S+10,globalAlpha:0},{onComplete:function(){t.destroy()}})}})}var P={x:f.x,y:f.y,fontSize:t.label.fontSize,textAlign:t.label.textAlign,textBaseline:t.label.verticalAlign,fillStyle:t.label.fontColor,rotation:-a.rotation,rotateOrigin:{x:0,y:0}},C=new r.default.Display.Text(d.label,{context:P}),D=C.getTextWidth(),O=C.getTextHeight();if(D>2*c&&(P.fontSize=t.label.fontSize-3),o.isFunction(t.label.position)){var T=t.label.position({node:k,circleR:c,circleCenter:{x:f.x,y:f.y},textWidth:D,textHeight:O});P.rotation=-a.rotation,P.rotateOrigin={x:-(T.x-P.x),y:-(T.y-P.y)},P.x=T.x,P.y=T.y}"auto"==t.label.position&&D>2*c&&M(),"bottom"==t.label.position&&M(),P.x+=t.label.offsetX,P.y+=t.label.offsetY,C=new r.default.Display.Text(d.label,{context:P}),k.labelElement=C,C.nodeData=d,d.labelElement=C,t._graphs.animation&&(C.context.visible=!1),u.addChild(C)}function M(){P.y=f.y+c+3,P.rotation=-a.rotation,P.rotateOrigin={x:0,y:-(c+.7*O)}}})),t.sprite.addChild(u)}))}},{key:"_getRProp",value:function(t,e,n,i){var a=this;if(o.isString(t)&&o.indexOf(a.dataFrame.fields,t)>-1){null==this.__rValMax&&null==this.__rValMax&&(this.__rValMax=0,this.__rValMin=0,o.each(a.planets,(function(e){a.__rValMax=Math.max(a.__rValMax,e.rowData[t]),a.__rValMin=Math.min(a.__rValMin,e.rowData[t])})));var r=i.rowData[t];return a.node.minRadius+(r-this.__rValMin)/(this.__rValMax-this.__rValMin)*(a.node.maxRadius-a.node.minRadius)}return a._getProp(t,i)}},{key:"_getProp",value:function(t,e){var n=this.iGroup;return o.isFunction(t)?t.apply(this,[e,n]):t}},{key:"getPlanetAt",value:function(t){var e=t;return o.isNumber(t)&&o.each(this.planets,(function(n){if(n.rowData.__index__==t)return e=n,!1})),e}},{key:"selectAt",value:function(t){if(this.node.select.enabled){var e=this.getPlanetAt(t);e.selected=!0,e.nodeElement&&(e.nodeElement.context.lineWidth=this._getProp(this.node.select.lineWidth,e),e.nodeElement.context.strokeStyle=this._getProp(this.node.select.strokeStyle,e),e.nodeElement.context.strokeAlpha=this._getProp(this.node.select.strokeAlpha,e));for(var n=0;n<this.selectInds.length;n++)if(t===this.selectInds[n]){this.selectInds.splice(n--,1);break}}}},{key:"unselectAt",value:function(t){if(this.node.select.enabled){var e=this.getPlanetAt(t);e.selected=!1,e.nodeElement&&(e.nodeElement.context.lineWidth=this._getProp(this.node.lineWidth,e),e.nodeElement.context.strokeAlpha=this._getProp(this.node.strokeAlpha,e)),this.selectInds.push(t)}}},{key:"getSelectedNodes",value:function(){return o.filter(this.planets,(function(t){return t.selected}))}},{key:"focusAt",value:function(t){if(this.node.focus.enabled){var e=this.getPlanetAt(t);e.selected||(e.focused=!0,e.nodeElement&&(e.nodeElement.context.lineWidth=this._getProp(this.node.focus.lineWidth,e),e.nodeElement.context.strokeStyle=this._getProp(this.node.focus.strokeStyle,e),e.nodeElement.context.strokeAlpha=this._getProp(this.node.focus.strokeAlpha,e)))}}},{key:"unfocusAt",value:function(t){if(this.node.focus.enabled){var e=this.getPlanetAt(t);e.selected||(e.focused=!1,e.nodeElement&&(e.nodeElement.context.lineWidth=this._getProp(this.node.lineWidth,e),e.nodeElement.context.strokeAlpha=this._getProp(this.node.strokeAlpha,e)))}}}],[{key:"defaultProps",value:function(){return{sort:{detail:"排序",default:"desc"},sortField:{detail:"用来排序的字段",default:"null"},node:{detail:"单个数据节点图形配置",propertys:{maxRadius:{detail:"最大半径",default:30},minRadius:{detail:"最小半径",default:5},radius:{detail:"半径",default:15,documentation:'也可以是个function,也可以配置{field:"pv"}来设置字段， 自动计算r'},lineWidth:{detail:"描边线宽",default:1},strokeStyle:{detail:"描边颜色",default:"#ffffff"},fillStyle:{detail:"图形填充色",default:"#f2fbfb"},strokeAlpha:{detail:"边框透明度",default:.6},focus:{detail:"hover态设置",propertys:{enabled:{detail:"是否开启",default:!0},strokeAlpha:{detail:"hover时候边框透明度",default:.7},lineWidth:{detail:"hover时候边框大小",default:2},strokeStyle:{detail:"hover时候边框颜色",default:"#fff"}}},select:{detail:"选中态设置",propertys:{enabled:{detail:"是否开启",default:!1},strokeAlpha:{detail:"选中时候边框透明度",default:1},lineWidth:{detail:"选中时候边框大小",default:2},strokeStyle:{detail:"选中时候边框颜色",default:"#fff"},triggerEventType:{detail:"触发事件",default:"click,tap"},onbefore:{detail:"执行select处理函数的前处理函数，返回false则取消执行select",default:null},onend:{detail:"执行select处理函数的后处理函数",default:null}}}}},label:{detail:"文本设置",propertys:{enabled:{detail:"是否开启",default:!0},fontColor:{detail:"文本颜色",default:"#666666"},fontSize:{detail:"文本字体大小",default:13},textAlign:{detail:"水平对齐方式",default:"center"},verticalAlign:{detail:"基线对齐方式",default:"middle"},position:{detail:"文本布局位置",default:"center"},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0}}}}}}]),t}();e.default=u}));e(ri);var oi=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Gn),h=i(ri),f=i(Pn);function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var p=u.default._,g=u.default.event,y=u.default.Display.Text,v=u.default.Shapes.Circle,x=u.default.Shapes.Line,_=u.default.Shapes.Rect,m=u.default.Shapes.Sector,b=function(t){(0,o.default)(i,t);var e=c(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="planet",o.groupDataFrames=[],o.groupField=null,o._ringGroups=[],o.grid={rings:{_section:[]}},p.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),0!=o.center.radius&&o.center.enabled||(o.center.radius=0,o.center.margin=0,o.center.enabled=!1),o.__scanIngCurOration=0,o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){this.gridSp=new u.default.Display.Sprite({id:"gridSp"}),this.groupSp=new u.default.Display.Sprite({id:"groupSp"}),this.scanSp=new u.default.Display.Sprite({id:"scanSp"}),this.centerSp=new u.default.Display.Sprite({id:"centerSp"}),this.sprite.addChild(this.gridSp),this.sprite.addChild(this.groupSp),this.sprite.addChild(this.scanSp),this.sprite.addChild(this.centerSp)}},{key:"draw",value:function(t){!t&&(t={}),p.extend(!0,this,t),this._dataGroupHandle(),this._drawGroups(),this._drawBack(),this._drawBewrite(),this._drawCenter(),this._drawScan(),this.fire("complete")}},{key:"_getMaxR",value:function(){var t;return this.graphs&&this.graphs.group&&this.graphs.group.circle&&(t=this.graphs.group.circle.maxRadius),null==t&&(t=30),t}},{key:"_drawGroups",value:function(){var t=this,e=this.center.radius+this.center.margin,n=t.app.getComponent({name:"coord"}).getMaxDisToViewOfOrigin()-t.center.radius-t.center.margin,i=this._getMaxR();p.each(this.groupDataFrames,(function(a,r){var o=e+n*(a.length/t.dataFrame.length),l=new h.default(p.extend(!0,{iGroup:r,groupLen:t.groupDataFrames.length,rRange:{start:e,to:o},width:t.width-2*i,height:t.height-2*i,selectInds:t.selectInds},t._opt),a,t);e=l.rRange.to,t._ringGroups.push(l),t.grid.rings._section.push({radius:l.rRange.to})})),p.each(t._ringGroups,(function(e){t.sprite.addChild(e.sprite)}))}},{key:"_drawCenter",value:function(){var t=this;this.center.enabled&&(this._center=new v({hoverClone:!1,context:{x:this.origin.x,y:this.origin.y,fillStyle:this.center.fillStyle,r:this.center.radius,cursor:this.center.cursor}}),this._centerTxt=new y(this.center.text,{context:{x:this.origin.x,y:this.origin.y,fontSize:this.center.fontSize,textAlign:"center",textBaseline:"middle",fillStyle:this.center.fontColor}}),this._center.on(g.types.get(),(function(e){e.eventInfo={title:t.center.text,trigger:"this.center",nodes:[t.center]},t.center.onclick&&("mousedown"==e.type&&(t._center.context.r+=2),"mouseup"==e.type&&(t._center.context.r-=2)),t.app.fire(e.type,e)})),this.centerSp.addChild(this._center),this.centerSp.addChild(this._centerTxt))}},{key:"_drawBack",value:function(){var t=this,e=this.app.getComponent({name:"coord"});if(1==t.grid.rings._section.length){var n=(t.grid.rings._section[0].radius-t.center.radius)/t.grid.rings.count;t.grid.rings._section=[];for(var i=0;i<t.grid.rings.count;i++)t.grid.rings._section.push({radius:t.center.radius+n*(i+1)})}else t.grid.rings.count=t.grid.rings._section.length;for(var a=t.grid.rings._section.length-1;a>=0;a--){var r=t.grid.rings._section[a];t.gridSp.addChild(new v({context:{x:e.origin.x,y:e.origin.y,r:r.radius,lineWidth:t._getBackProp(t.grid.rings.lineWidth,a),strokeStyle:t._getBackProp(t.grid.rings.strokeStyle,a),fillStyle:t._getBackProp(t.grid.rings.fillStyle,a)}}))}if(t.grid.rays.count>1){var o=e.origin.x,l=e.origin.y,s=360/t.grid.rays.count,u=e.getMaxDisToViewOfOrigin();t.grid.rings._section.length&&(u=t.grid.rings._section.slice(-1)[0].radius);for(var d=0,h=t.grid.rays.count;d<h;d++){var f=s*d/180*Math.PI,c=o+u*Math.cos(f),p=l+u*Math.sin(f);t.gridSp.addChild(new x({context:{start:{x:o,y:l},end:{x:c,y:p},lineWidth:t._getBackProp(t.grid.rays.lineWidth,d),strokeStyle:t._getBackProp(t.grid.rays.strokeStyle,d),globalAlpha:t.grid.rays.globalAlpha}}))}}var g=new _({name:"clipRect",context:{x:e.origin.x-t.app.width/2,y:e.origin.y-t.height/2,width:t.app.width,height:t.height}});t.gridSp.clipTo(g),t.sprite.addChild(g)}},{key:"_getBackProp",value:function(t,e){var n=null;return p.isFunction(t)&&(n=t.apply(this,[{scaleInd:e,count:this.grid.rings._section.length,groups:this._ringGroups,graphs:this}])),(p.isString(t)||p.isNumber(t))&&(n=t),p.isArray(t)&&(n=t[e]),n}},{key:"_drawBewrite",value:function(){var t=this;if(t.bewrite.enabled){var e,n,i,a,r=function(e,i,a,r){a.context.x=e*t.center.radius+20*e,o.addChild(a),o.addChild(new x({context:{lineType:"dashed",start:{x:a.context.x,y:0},end:{x:e*(i?l/2-n/2:l),y:0},lineWidth:1,strokeStyle:"#ccc"}})),i&&(i.context.x=e*(l/2),o.addChild(i),o.addChild(new x({context:{lineType:"dashed",start:{x:e*(l/2+n/2),y:0},end:{x:e*l,y:0},lineWidth:1,strokeStyle:"#ccc"}}))),r.context.x=e*l,o.addChild(r)};t.bewrite.text&&(e=new u.default.Display.Text(t.bewrite.text,{context:{fillStyle:t.bewrite.fontColor,fontSize:t.bewrite.fontSize,textBaseline:"middle",textAlign:"center"}}),n=e.getTextWidth()),i=new u.default.Display.Text("强",{context:{fillStyle:t.bewrite.fontColor,fontSize:t.bewrite.fontSize,textBaseline:"middle",textAlign:"center"}}),a=new u.default.Display.Text("弱",{context:{fillStyle:t.bewrite.fontColor,fontSize:t.bewrite.fontSize,textBaseline:"middle",textAlign:"center"}});var o=new u.default.Display.Sprite({context:{x:this.origin.x,y:this.origin.y}});t.sprite.addChild(o);var l=t.width/2;r(1,e.clone(),i.clone(),a.clone()),r(-1,e.clone(),i.clone(),a.clone())}}},{key:"scan",value:function(){var t=this;this._scanAnim&&this._scanAnim.stop();var e=t._getScanSp();360==t.__scanIngCurOration&&(e.context.rotation=0),t._scanAnim=e.animate({rotation:360,globalAlpha:1},{duration:(360-t.__scanIngCurOration)/360*1e3,onUpdate:function(e){t.__scanIngCurOration=e.rotation},onComplete:function(){e.context.rotation=0,t._scanAnim=e.animate({rotation:360},{duration:1e3,repeat:1e3,onUpdate:function(e){t.__scanIngCurOration=e.rotation}})}})}},{key:"_drawScan",value:function(t){var e=this;if(e.scan.enabled){var n=e._getScanSp();360==e.__scanIngCurOration&&(n.context.rotation=0),e._scanAnim&&e._scanAnim.stop(),e._scanAnim=n.animate({rotation:360,globalAlpha:1},{duration:(360-e.__scanIngCurOration)/360*1e3,onUpdate:function(t){e.__scanIngCurOration=t.rotation},onComplete:function(){n.context.rotation=0,e._scanAnim=n.animate({rotation:360},{duration:1e3,repeat:e.scan.repeat-2,onUpdate:function(t){e.__scanIngCurOration=t.rotation},onComplete:function(){n.context.rotation=0,e._scanAnim=n.animate({rotation:360,globalAlpha:0},{duration:1e3,onUpdate:function(t){e.__scanIngCurOration=t.rotation},onComplete:function(){n.destroy(),e.__scanSp=null,delete e.__scanSp,e.__scanIngCurOration=0,t&&t()}})}})}})}}},{key:"_getScanSp",value:function(){var t=this,e=t.__scanSp;if(!e){e=new u.default.Display.Sprite({context:{x:this.origin.x,y:this.origin.y,globalAlpha:0,rotation:t.__scanIngCurOration}}),t.scanSp.addChild(e),t.__scanSp=e;for(var n=t.scan.r||t.height/2-10,i=t.scan.fillStyle||t.center.fillStyle,a=t.scan.angle,r=0,o=a;r<o;r++){var l=new m({context:{r:n,fillStyle:i,clockwise:!0,startAngle:360-r,endAngle:359-r,globalAlpha:t.scan.alpha-t.scan.alpha/a*r}});e.addChild(l)}var s=new x({context:{end:{x:n,y:0},lineWidth:1,strokeStyle:i}});e.addChild(s)}return e}},{key:"_dataGroupHandle",value:function(){var t=p.indexOf(this.dataFrame.fields,this.groupField);if(t>=0){var e=this.dataFrame.org[0],n={};for(var i in p.each(this.dataFrame.org,(function(i,a){a&&(n[i[t]]||(n[i[t]]=[p.clone(e)]),n[i[t]].push(i))})),n)this.groupDataFrames.push((0,f.default)(n[i]))}else this.groupDataFrames.push(this.dataFrame)}},{key:"show",value:function(t,e){this.getAgreeNodeData(e,(function(t){t.nodeElement&&(t.nodeElement.context.visible=!0),t.labelElement&&(t.labelElement.context.visible=!0)}))}},{key:"hide",value:function(t,e){this.getAgreeNodeData(e,(function(t){t.nodeElement&&(t.nodeElement.context.visible=!1),t.labelElement&&(t.labelElement.context.visible=!1)}))}},{key:"getAgreeNodeData",value:function(t,e){p.each(this._ringGroups,(function(n){p.each(n._rings,(function(n){p.each(n.planets,(function(n){var i=n.rowData;t.params.name==i[t.params.field]&&e&&e(n)}))}))}))}},{key:"getLayoutNodes",value:function(){var t=[];return p.each(this._ringGroups,(function(e){p.each(e.planets,(function(e){e.pit&&t.push(e)}))})),t}},{key:"getInvalidNodes",value:function(){var t=[];return p.each(this._ringGroups,(function(e){p.each(e.planets,(function(e){e.pit||t.push(e)}))})),t}},{key:"selectAt",value:function(t){p.each(this._ringGroups,(function(e){e.selectAt(t)}))}},{key:"selectAll",value:function(){var t=this;p.each(t.dataFrame.getFieldData("__index__"),(function(e){t.selectAt(e)}))}},{key:"unselectAt",value:function(t){p.each(this._ringGroups,(function(e){e.unselectAt(t)}))}},{key:"unselectAll",value:function(){var t=this;p.each(t.dataFrame.getFieldData("__index__"),(function(e){t.unselectAt(e)}))}},{key:"getSelectedNodes",value:function(){var t=[];return p.each(this._ringGroups,(function(e){t=t.concat(e.getSelectedNodes())})),t}},{key:"getSelectedRowList",value:function(){var t=[];return p.each(this._ringGroups,(function(e){var n=[];p.each(e.getSelectedNodes(),(function(t){n.push(t.rowData)})),t=t.concat(n)})),t}},{key:"getNodesAt",value:function(){}},{key:"resetData",value:function(t){this.clean(),this.dataFrame=t,this._dataGroupHandle(),this._drawGroups(),this._drawScan()}},{key:"clean",value:function(){var t=this;t.groupDataFrames=[],p.each(t._ringGroups,(function(t){t.sprite.destroy()})),t._ringGroups=[]}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段设置",default:null},center:{detail:"中心点设置",propertys:{enabled:{detail:"是否显示中心",default:!0},text:{detail:"中心区域文本",default:"center"},radius:{detail:"中心圆半径",default:30},fillStyle:{detail:"中心背景色",default:"#70629e"},fontSize:{detail:"中心字体大小",default:15},fontColor:{detail:"中心字体颜色",default:"#ffffff"},margin:{detail:"中区区域和外围可绘图区域距离",default:20},cursor:{detail:"中心节点的鼠标手势",default:"default"}}},selectInds:{detail:"选中的数据索引",default:[]},grid:{detail:"星系图自己的grid",propertys:{rings:{detail:"环配置",propertys:{fillStyle:{detail:"背景色",default:null},strokeStyle:{detail:"环线色",default:null},lineWidth:{detail:"环线宽",default:1},count:{detail:"分几环",default:3}}},rays:{detail:"射线配置",propertys:{count:{detail:"射线数量",default:0},globalAlpha:{detail:"线透明度",default:.4},strokeStyle:{detail:"线色",default:"#10519D"},lineWidth:{detail:"线宽",default:1}}}}},bewrite:{detail:"planet的趋势描述",propertys:{enabled:{detail:"是否开启趋势描述",default:!1},text:{detail:"描述文本",default:null},fontColor:{detail:"fontColor",default:"#999"},fontSize:{detail:"fontSize",default:12}}},scan:{detail:"扫描效果",propertys:{enabled:{detail:"是否开启扫描效果",default:!1},fillStyle:{detail:"扫描效果颜色",default:null},alpha:{detail:"起始透明度",default:.6},angle:{detail:"扫描效果的覆盖角度",default:90},r:{detail:"扫描效果覆盖的半径",default:null},repeat:{detail:"扫描次数",default:3}}},_props:[h.default]}}}]),i}(d.default);d.default.registerComponent(b,"graphs","planet");var w=b;e.default=w}));e(oi);var li=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Gn),h=i(kn);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var c=u.default._,p=u.default.event,g=u.default.Display.Text,y=u.default.Shapes.Polygon,v=function(t){(0,o.default)(i,t);var e=f(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="funnel",o.dataOrg=[],o.data=[],o.maxValue=null,o.minValue=null,c.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){this.node.maxFillStyle||(this.node.maxFillStyle=this.app.getTheme(0)),this._nodesp=new u.default.Display.Sprite({id:"nodeSp"}),this._textsp=new u.default.Display.Sprite({id:"textsp"}),this.sprite.addChild(this._nodesp),this.sprite.addChild(this._textsp)}},{key:"_computerAttr",value:function(){this.field&&(this.dataOrg=this.dataFrame.getFieldData(this.field)),this.maxValue=c.max(this.dataOrg),this.minValue=c.min(this.dataOrg),null==this.node.maxWidth&&(this.node.maxWidth=parseInt(1*this.width)),null==this.node.minWidth&&(this.maxValue==this.minValue?this.node.minWidth=this.node.maxValue:this.node.minWidth=parseInt(this.node.maxWidth*(this.minValue/this.maxValue))),null==this.node.spireWidth&&(this.node.spireWidth=this.node.minWidth),this.node.height||(this.node.height=parseInt(this.height/this.dataOrg.length))}},{key:"draw",value:function(t){!t&&(t={}),c.extend(!0,this,t),this._computerAttr(),this.data=this._trimGraphs(),this._drawGraphs(),this.sprite.context.x=this.origin.x+this.width/2,this.sprite.context.y=this.origin.y,this.fire("complete")}},{key:"_trimGraphs",value:function(){if(this.field){var t=this,e=[],n=this.app.getCoord();return c.each(this.dataOrg,(function(n,i){var a=t.dataFrame.getRowDataAt(i),r={type:"funnel",field:t.field,rowData:a,value:n,name:t.nameField?a[t.nameField]:i+1,width:t._getNodeWidth(n),color:"",cursor:"pointer",label:"",middlePoint:null,iNode:-1,points:[]};r.color=t._getProp(t.node,"fillStyle",r),e.push(r)})),this.sort&&(e=e.sort((function(e,n){return"desc"==t.sort?n.value-e.value:e.value-n.value}))),c.each(e,(function(e,i){e.iNode=i;var a=e.value;if(t.label.format){if(c.isFunction(t.label.format)){var r=t.label.format.apply(t,[a,e]);void 0===r&&null===r||(a=r)}"string"==typeof t.label.format&&(a=(0,h.default)(a).format(t.label.format))}else{var o=n.getFieldConfig(t.field);o&&(a=o.getFormatValue(a))}e.label=a})),c.each(e,(function(n,i){n.points=t._getPoints(n,e[i+1],e[i-1]),n.middlePoint={x:0,y:(n.iNode+.5)*t.node.height}})),e}}},{key:"_getNodeWidth",value:function(t){var e=this.node.maxWidth;return this.maxValue!=this.minValue&&(e=parseInt(this.node.minWidth+(this.node.maxWidth-this.node.minWidth)/(this.maxValue-this.minValue)*(t-this.minValue))),e}},{key:"_getPoints",value:function(t,e,n){var i=[],a=t.iNode*this.node.height,r=a+this.node.height;if("asc"!==this.sort){i.push([-t.width/2,a]),i.push([t.width/2,a]);var o=e?e.width:t.width;e||null==this.node.spireWidth||this.maxValue==this.minValue||(o=Math.min(this.node.spireWidth,o)),i.push([o/2,r]),i.push([-o/2,r])}else{var l=n?n.width:t.width;n||null==this.node.spireWidth||this.maxValue==this.minValue||(l=Math.min(this.node.spireWidth,l)),i.push([-l/2,a]),i.push([l/2,a]),i.push([t.width/2,r]),i.push([-t.width/2,r])}return i}},{key:"_drawGraphs",value:function(){var t=this,e=this.app.getCoord().getFieldConfig(t.field).name||this.field;c.each(this.data,(function(n){var i=t._getProp(t.node,"fillAlpha",n),a=t._getProp(t.node,"strokeStyle",n),r=t._getProp(t.node,"strokeAlpha",n),o=t._getProp(t.node,"lineWidth",n),l=t._getProp(t.node,"lineType",n),s=new y({id:"funel_item_"+n.iNode,hoverClone:!1,context:{pointList:n.points,fillStyle:n.color,cursor:n.cursor,fillAlpha:i,strokeStyle:a,strokeAlpha:r,lineWidth:o,lineType:l}});n.nodeElement=s,t._nodesp.addChild(s),s.nodeData=n,s.on(p.types.get(),(function(n){n.eventInfo={trigger:"this.node",title:e,nodes:[this.nodeData]},"mouseover"==n.type&&t.focusAt(this.nodeData.iNode),"mouseout"==n.type&&!this.nodeData.selected&&t.unfocusAt(this.nodeData.iNode),t.app.fire(n.type,n)}));var u="center",d={x:n.middlePoint.x,y:n.middlePoint.y};"left"==t.label.textAlign&&(d.x=n.points[0][0]-(n.points[0][0]-n.points[3][0])/2,d.x-=15,u="right"),"right"==t.label.textAlign&&(d.x=n.points[1][0]-(n.points[1][0]-n.points[2][0])/2,d.x+=15,u="left"),n.textPoint=d;var h=new g(n.label,{context:{x:d.x,y:d.y,fontSize:t.label.fontSize,fillStyle:"center"==t.label.textAlign?t.label.fontColor:n.color,strokeStyle:t.label.strokeStyle,lineWidth:t.label.lineWidth,textAlign:u,textBaseline:t.label.textBaseline}});t._textsp.addChild(h),t.node.drawEnd(n)}))}},{key:"focusAt",value:function(t){var e=this._nodesp.getChildById("funel_item_"+t),n=e.nodeData;if(e){var i=e.context,a=i.fillStyle,r=i.fillAlpha,o=i.strokeStyle,l=i.strokeAlpha;e._default={fillStyle:a,fillAlpha:r,strokeStyle:o,strokeAlpha:l};var s=this._getProp(this.node.focus,"fillStyle",n)||a,u=this._getProp(this.node.focus,"fillAlpha",n)||r,d=this._getProp(this.node.focus,"strokeStyle",n)||o,h=this._getProp(this.node.focus,"strokeAlpha",n)||l,f=this._getProp(this.node.focus,"lineWidth",n),c=this._getProp(this.node.focus,"lineType",n);e.context.fillStyle=s,e.context.fillAlpha=u,e.context.strokeStyle=d,e.context.strokeAlpha=h,e.context.lineWidth=f,e.context.lineType=c}}},{key:"unfocusAt",value:function(t){var e=this._nodesp.getChildById("funel_item_"+t);if(e){var n=e._default,i=n.fillStyle,a=n.fillAlpha,r=n.strokeStyle,o=n.strokeAlpha,l=n.lineType,s=n.lineWidth;e.context.fillStyle=i,e.context.fillAlpha=a,e.context.strokeStyle=r,e.context.strokeAlpha=o,e.context.lineWidth=s,e.context.lineType=l}}},{key:"_getProp",value:function(t,e,n){var i,a=t[e];if(i=c.isFunction(a)?a.apply(this,[n,this.dataFrame]):a,"fillStyle"==e){var r=n.rowData;if(r)if(void 0!==r[e])i=r[e];else{var o=r[this.field];if(!isNaN(o)&&""!=o){var l=(o-this.minValue)/(this.maxValue-this.minValue)*(this.node.fillAlpha-this.node.minFillAlpha)+this.node.minFillAlpha;isNaN(l)&&(l=1),i=(0,Vn.colorRgba)(this.node.maxFillStyle,parseFloat(l.toFixed(2)))}}}return i}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},nameFiled:{detail:"field字段每行数据对应的name名称字段配置",default:null},sort:{detail:"排序规则",default:null},node:{detail:"单个元素图形配置",propertys:{margin:{detail:"node节点之间的间距",default:2},maxWidth:{detail:"最大的元素宽",default:null},minWidth:{detail:"最小的元素宽",default:null},spireWidth:{detail:"漏斗的塔尖的宽度，默认等于minWidth",documentation:"如果想要实现全三角的效果，可以设置为0",default:null},height:{detail:"高",default:0,documentation:"漏斗单元高，如果options没有设定， 就会被自动计算为 this.height/dataOrg.length"},drawEnd:{detail:"单个节点绘制完毕处理函数",default:function(){}},fillStyle:{detail:"单个区块背景色",default:null},fillAlpha:{detail:"单个区块透明度",default:1},maxFillStyle:{detail:"单个区块数值最大的颜色值",default:null},maxFillAlpha:{detail:"单个区块最大透明度",default:1},minFillAlpha:{detail:"单个区块最小透明度",default:.5},strokeStyle:{detail:"单个区块描边颜色",default:null},strokeAlpha:{detail:"单个区块描边透明度",default:1},lineWidth:{detail:"单个区块描边线宽",default:0},lineType:{detail:"区块描边样式",default:"solid"},focus:{detail:"单个区块hover态设置",propertys:{enabled:{detail:"是否开启",default:!0},fillStyle:{detail:"hover态单个区块背景色",default:null},fillAlpha:{detail:"hover态单个区块透明度",default:.95},strokeStyle:{detail:"hover态单个区块描边颜色",default:null},strokeAlpha:{detail:"hover态单个区块描边透明度",default:null},lineWidth:{detail:"hover态单个区块描边线宽",default:null},lineType:{detail:"hover态区块描边样式",default:null}}},select:{detail:"单个区块选中态设置",propertys:{enabled:{detail:"是否开启",default:!1},fillStyle:{detail:"选中态单个区块背景色",default:null},fillAlpha:{detail:"选中态单个区块透明度",default:1},strokeStyle:{detail:"选中态单个区块描边颜色",default:null},strokeAlpha:{detail:"选中态单个区块描边颜色",default:null},lineWidth:{detail:"选中态单个区块描边线宽",default:null},lineType:{detail:"选中态区块描边样式",default:null}}}}},label:{detail:"文本配置",propertys:{enabled:{detail:"是否开启文本",default:!0},textAlign:{detail:"文本布局位置(left,center,right)",default:"center"},textBaseline:{detail:"文本基线对齐方式",default:"middle"},format:{detail:"文本格式化处理函数",default:null},fontSize:{detail:"文本字体大小",default:13},fontColor:{detail:"文本颜色",default:"#ffffff",documentation:"align为center的时候的颜色，align为其他属性时候取node的颜色"},strokeStyle:{detail:"文本描边色",default:"#fff"},lineWidth:{detail:"文本描边宽",default:0}}}}}}]),i}(d.default);d.default.registerComponent(v,"graphs","funnel");var x=v;e.default=x}));e(li);var si=n((function(t,e){!function(t){function e(t,e,n,i){var a=(i=i||{}).maxIterations||100,r=i.tolerance||1e-10,o=t(e),l=t(n),s=n-e;if(o*l>0)throw"Initial bisect points must have opposite signs";if(0===o)return e;if(0===l)return n;for(var u=0;u<a;++u){var d=e+(s/=2),h=t(d);if(h*o>=0&&(e=d),Math.abs(s)<r||0===h)return d}return e+s}function n(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=0;return e}function i(t,e){return n(t).map((function(){return n(e)}))}function a(t,e){for(var n=0,i=0;i<t.length;++i)n+=t[i]*e[i];return n}function r(t){return Math.sqrt(a(t,t))}function o(t,e,n){for(var i=0;i<e.length;++i)t[i]=e[i]*n}function l(t,e,n,i,a){for(var r=0;r<t.length;++r)t[r]=e*n[r]+i*a[r]}function s(t,e,n){var i,a=(n=n||{}).maxIterations||200*e.length,r=n.nonZeroDelta||1.05,o=n.zeroDelta||.001,s=n.minErrorDelta||1e-6,u=n.minErrorDelta||1e-5,d=void 0!==n.rho?n.rho:1,h=void 0!==n.chi?n.chi:2,f=void 0!==n.psi?n.psi:-.5,c=void 0!==n.sigma?n.sigma:.5,p=e.length,g=new Array(p+1);g[0]=e,g[0].fx=t(e),g[0].id=0;for(var y=0;y<p;++y){var v=e.slice();v[y]=v[y]?v[y]*r:o,g[y+1]=v,g[y+1].fx=t(v),g[y+1].id=y+1}function x(t){for(var e=0;e<t.length;e++)g[p][e]=t[e];g[p].fx=t.fx}for(var _=function(t,e){return t.fx-e.fx},m=e.slice(),b=e.slice(),w=e.slice(),k=e.slice(),S=0;S<a;++S){if(g.sort(_),n.history){var A=g.map((function(t){var e=t.slice();return e.fx=t.fx,e.id=t.id,e}));A.sort((function(t,e){return t.id-e.id})),n.history.push({x:g[0].slice(),fx:g[0].fx,simplex:A})}for(i=0,y=0;y<p;++y)i=Math.max(i,Math.abs(g[0][y]-g[1][y]));if(Math.abs(g[0].fx-g[p].fx)<s&&i<u)break;for(y=0;y<p;++y){m[y]=0;for(var P=0;P<p;++P)m[y]+=g[P][y];m[y]/=p}var C=g[p];if(l(b,1+d,m,-d,C),b.fx=t(b),b.fx<g[0].fx)l(k,1+h,m,-h,C),k.fx=t(k),k.fx<b.fx?x(k):x(b);else if(b.fx>=g[p-1].fx){var D=!1;if(b.fx>C.fx?(l(w,1+f,m,-f,C),w.fx=t(w),w.fx<C.fx?x(w):D=!0):(l(w,1-f*d,m,f*d,C),w.fx=t(w),w.fx<b.fx?x(w):D=!0),D){if(c>=1)break;for(y=1;y<g.length;++y)l(g[y],1-c,g[0],c,g[y]),g[y].fx=t(g[y])}}else x(b)}return g.sort(_),{fx:g[0].fx,x:g[0]}}function u(t,e,n,i,r,o,s){var u=n.fx,d=a(n.fxprime,e),h=u,f=u,c=d,p=0;function g(f,p,g){for(var y=0;y<16;++y)if(r=(f+p)/2,l(i.x,1,n.x,r,e),h=i.fx=t(i.x,i.fxprime),c=a(i.fxprime,e),h>u+o*r*d||h>=g)p=r;else{if(Math.abs(c)<=-s*d)return r;c*(p-f)>=0&&(p=f),f=r,g=h}return 0}r=r||1,o=o||1e-6,s=s||.1;for(var y=0;y<10;++y){if(l(i.x,1,n.x,r,e),h=i.fx=t(i.x,i.fxprime),c=a(i.fxprime,e),h>u+o*r*d||y&&h>=f)return g(p,r,f);if(Math.abs(c)<=-s*d)return r;if(c>=0)return g(r,p,h);f=h,p=r,r*=2}return r}function d(t,e,n){var i,s,d,h={x:e.slice(),fx:0,fxprime:e.slice()},f={x:e.slice(),fx:0,fxprime:e.slice()},c=e.slice(),p=1;d=(n=n||{}).maxIterations||20*e.length,h.fx=t(h.x,h.fxprime),o(i=h.fxprime.slice(),h.fxprime,-1);for(var g=0;g<d;++g){if(p=u(t,i,h,f,p),n.history&&n.history.push({x:h.x.slice(),fx:h.fx,fxprime:h.fxprime.slice(),alpha:p}),p){l(c,1,f.fxprime,-1,h.fxprime);var y=a(h.fxprime,h.fxprime);l(i,Math.max(0,a(c,f.fxprime)/y),i,-1,f.fxprime),s=h,h=f,f=s}else o(i,h.fxprime,-1);if(r(h.fxprime)<=1e-5)break}return n.history&&n.history.push({x:h.x.slice(),fx:h.fx,fxprime:h.fxprime.slice(),alpha:p}),h}function h(t,e,n){for(var i=(n=n||{}).maxIterations||100*e.length,a=n.learnRate||.001,o={x:e.slice(),fx:0,fxprime:e.slice()},s=0;s<i&&(o.fx=t(o.x,o.fxprime),n.history&&n.history.push({x:o.x.slice(),fx:o.fx,fxprime:o.fxprime.slice()}),l(o.x,1,o.x,-a,o.fxprime),!(r(o.fxprime)<=1e-5));++s);return o}function f(t,e,n){n=n||{};var i,a={x:e.slice(),fx:0,fxprime:e.slice()},l={x:e.slice(),fx:0,fxprime:e.slice()},s=n.maxIterations||100*e.length,d=n.learnRate||1,h=e.slice(),f=n.c1||.001,c=n.c2||.1,p=[];if(n.history){var g=t;t=function(t,e){return p.push(t.slice()),g(t,e)}}a.fx=t(a.x,a.fxprime);for(var y=0;y<s&&(o(h,a.fxprime,-1),d=u(t,h,a,l,d,f,c),n.history&&(n.history.push({x:a.x.slice(),fx:a.fx,fxprime:a.fxprime.slice(),functionCalls:p,learnRate:d,alpha:d}),p=[]),i=a,a=l,l=i,!(0===d||r(a.fxprime)<1e-5));++y);return a}t.bisect=e,t.nelderMead=s,t.conjugateGradient=d,t.gradientDescent=h,t.gradientDescentLineSearch=f,t.zeros=n,t.zerosM=i,t.norm2=r,t.weightedSum=l,t.scale=o}(e)})),ui=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.circleArea=a,e.circleCircleIntersection=o,e.circleOverlap=function(t,e,n){if(n>=t+e)return 0;if(n<=Math.abs(t-e))return Math.PI*Math.min(t,e)*Math.min(t,e);var i=e-(n*n-t*t+e*e)/(2*n);return a(t,t-(n*n-e*e+t*t)/(2*n))+a(e,i)},e.containedInCircles=i,e.distance=r,e.getCenter=l,e.intersectionArea=function(t,e){var s,u=function(t){for(var e=[],n=0;n<t.length;++n)for(var i=n+1;i<t.length;++i)for(var a=o(t[n],t[i]),r=0;r<a.length;++r){var l=a[r];l.parentIndex=[n,i],e.push(l)}return e}(t),d=u.filter((function(e){return i(e,t)})),h=0,f=0,c=[];if(d.length>1){var p=l(d);for(s=0;s<d.length;++s){var g=d[s];g.angle=Math.atan2(g.x-p.x,g.y-p.y)}d.sort((function(t,e){return e.angle-t.angle}));var y=d[d.length-1];for(s=0;s<d.length;++s){var v=d[s];f+=(y.x+v.x)*(v.y-y.y);for(var x={x:(v.x+y.x)/2,y:(v.y+y.y)/2},_=null,m=0;m<v.parentIndex.length;++m)if(y.parentIndex.indexOf(v.parentIndex[m])>-1){var b=t[v.parentIndex[m]],w=Math.atan2(v.x-b.x,v.y-b.y),k=Math.atan2(y.x-b.x,y.y-b.y),S=k-w;S<0&&(S+=2*Math.PI);var A=k-S/2,P=r(x,{x:b.x+b.radius*Math.sin(A),y:b.y+b.radius*Math.cos(A)});P>2*b.radius&&(P=2*b.radius),(null===_||_.width>P)&&(_={circle:b,width:P,p1:v,p2:y})}null!==_&&(c.push(_),h+=a(_.circle.radius,_.width),y=v)}}else{var C=t[0];for(s=1;s<t.length;++s)t[s].radius<C.radius&&(C=t[s]);var D=!1;for(s=0;s<t.length;++s)if(r(t[s],C)>Math.abs(C.radius-t[s].radius)){D=!0;break}D?h=f=0:(h=C.radius*C.radius*Math.PI,c.push({circle:C,p1:{x:C.x,y:C.y+C.radius},p2:{x:C.x-n,y:C.y+C.radius},width:2*C.radius}))}f/=2,e&&(e.area=h+f,e.arcArea=h,e.polygonArea=f,e.arcs=c,e.innerPoints=d,e.intersectionPoints=u);return h+f};var n=1e-10;function i(t,e){for(var i=0;i<e.length;++i)if(r(t,e[i])>e[i].radius+n)return!1;return!0}function a(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function r(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function o(t,e){var n=r(t,e),i=t.radius,a=e.radius;if(n>=i+a||n<=Math.abs(i-a))return[];var o=(i*i-a*a+n*n)/(2*n),l=Math.sqrt(i*i-o*o),s=t.x+o*(e.x-t.x)/n,u=t.y+o*(e.y-t.y)/n,d=-(e.y-t.y)*(l/n),h=-(e.x-t.x)*(l/n);return[{x:s+d,y:u-h},{x:s-d,y:u+h}]}function l(t){for(var e={x:0,y:0},n=0;n<t.length;++n)e.x+=t[n].x,e.y+=t[n].y;return e.x/=t.length,e.y/=t.length,e}}));e(ui);ui.circleArea,ui.circleCircleIntersection,ui.circleOverlap,ui.containedInCircles,ui.distance,ui.getCenter,ui.intersectionArea;var di=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.bestInitialLayout=r,e.constrainedMDSLayout=o,e.disjointCluster=d,e.distanceFromIntersectArea=i,e.getDistanceMatrices=a,e.greedyLayout=l,e.lossFunction=s,e.normalizeSolution=function(t,e,n){null===e&&(e=Math.PI/2);var i,a,r=[];for(a in t)if(t.hasOwnProperty(a)){var o=t[a];r.push({x:o.x,y:o.y,radius:o.radius,setid:a})}var l=d(r);for(i=0;i<l.length;++i){u(l[i],e,n);var s=h(l[i]);l[i].size=(s.xRange.max-s.xRange.min)*(s.yRange.max-s.yRange.min),l[i].bounds=s}l.sort((function(t,e){return e.size-t.size}));var f=(r=l[0]).bounds,c=(f.xRange.max-f.xRange.min)/50;function p(t,e,n){if(t){var i,a,o,l=t.bounds;e?i=f.xRange.max-l.xRange.min+c:(i=f.xRange.max-l.xRange.max,(o=(l.xRange.max-l.xRange.min)/2-(f.xRange.max-f.xRange.min)/2)<0&&(i+=o)),n?a=f.yRange.max-l.yRange.min+c:(a=f.yRange.max-l.yRange.max,(o=(l.yRange.max-l.yRange.min)/2-(f.yRange.max-f.yRange.min)/2)<0&&(a+=o));for(var s=0;s<t.length;++s)t[s].x+=i,t[s].y+=a,r.push(t[s])}}var g=1;for(;g<l.length;)p(l[g],!0,!1),p(l[g+1],!1,!0),p(l[g+2],!0,!0),g+=3,f=h(r);var y={};for(i=0;i<r.length;++i)y[r[i].setid]=r[i];return y},e.scaleSolution=function(t,e,n,i){var a=[],r=[];for(var o in t)t.hasOwnProperty(o)&&(r.push(o),a.push(t[o]));e-=2*i,n-=2*i;var l=h(a),s=l.xRange,u=l.yRange;if(s.max==s.min||u.max==u.min)return t;for(var d=e/(s.max-s.min),f=n/(u.max-u.min),c=Math.min(f,d),p=(e-(s.max-s.min)*c)/2,g=(n-(u.max-u.min)*c)/2,y={},v=0;v<a.length;++v){var x=a[v];y[r[v]]={radius:c*x.radius,x:i+p+(x.x-s.min)*c,y:i+g+(x.y-u.min)*c}}return y},e.venn=function(t,e){(e=e||{}).maxIterations=e.maxIterations||500;var n=e.initialLayout||r,i=e.lossFunction||s;t=function(t){t=t.slice();var e,n,i,a,r=[],o={};for(e=0;e<t.length;++e){var l=t[e];1==l.sets.length?r.push(l.sets[0]):2==l.sets.length&&(o[[i=l.sets[0],a=l.sets[1]]]=!0,o[[a,i]]=!0)}for(r.sort((function(t,e){return t>e})),e=0;e<r.length;++e)for(i=r[e],n=e+1;n<r.length;++n)[i,a=r[n]]in o||t.push({sets:[i,a],size:0});return t}(t);var a,o=n(t,e),l=[],u=[];for(a in o)o.hasOwnProperty(a)&&(l.push(o[a].x),l.push(o[a].y),u.push(a));for(var d=(0,si.nelderMead)((function(e){for(var n={},a=0;a<u.length;++a){var r=u[a];n[r]={x:e[2*a],y:e[2*a+1],radius:o[r].radius}}return i(n,t)}),l,e),h=d.x,f=0;f<u.length;++f)a=u[f],o[a].x=h[2*f],o[a].y=h[2*f+1];return o};var n=1e-10;function i(t,e,i){return Math.min(t,e)*Math.min(t,e)*Math.PI<=i+n?Math.abs(t-e):(0,si.bisect)((function(n){return(0,ui.circleOverlap)(t,e,n)-i}),0,t+e)}function a(t,e,n){var a=(0,si.zerosM)(e.length,e.length),r=(0,si.zerosM)(e.length,e.length);return t.filter((function(t){return 2==t.sets.length})).map((function(t){var o=n[t.sets[0]],l=n[t.sets[1]],s=i(Math.sqrt(e[o].size/Math.PI),Math.sqrt(e[l].size/Math.PI),t.size);a[o][l]=a[l][o]=s;var u=0;t.size+1e-10>=Math.min(e[o].size,e[l].size)?u=1:t.size<=1e-10&&(u=-1),r[o][l]=r[l][o]=u})),{distances:a,constraints:r}}function r(t,e){var n=l(t,e),i=e.lossFunction||s;if(t.length>=8){var a=o(t,e);i(a,t)+1e-8<i(n,t)&&(n=a)}return n}function o(t,e){var n,i=(e=e||{}).restarts||10,r=[],o={};for(n=0;n<t.length;++n){var l=t[n];1==l.sets.length&&(o[l.sets[0]]=r.length,r.push(l))}var s=a(t,r,o),u=s.distances,d=s.constraints,h=(0,si.norm2)(u.map(si.norm2))/u.length;u=u.map((function(t){return t.map((function(t){return t/h}))}));var f,c,p=function(t,e){return function(t,e,n,i){var a,r=0;for(a=0;a<e.length;++a)e[a]=0;for(a=0;a<n.length;++a)for(var o=t[2*a],l=t[2*a+1],s=a+1;s<n.length;++s){var u=t[2*s],d=t[2*s+1],h=n[a][s],f=i[a][s],c=(u-o)*(u-o)+(d-l)*(d-l),p=Math.sqrt(c),g=c-h*h;f>0&&p<=h||f<0&&p>=h||(r+=2*g*g,e[2*a]+=4*g*(o-u),e[2*a+1]+=4*g*(l-d),e[2*s]+=4*g*(u-o),e[2*s+1]+=4*g*(d-l))}return r}(t,e,u,d)};for(n=0;n<i;++n){var g=(0,si.zeros)(2*u.length).map(Math.random);c=(0,si.conjugateGradient)(p,g,e),(!f||c.fx<f.fx)&&(f=c)}var y=f.x,v={};for(n=0;n<r.length;++n){var x=r[n];v[x.sets[0]]={x:y[2*n]*h,y:y[2*n+1]*h,radius:Math.sqrt(x.size/Math.PI)}}if(e.history)for(n=0;n<e.history.length;++n)(0,si.scale)(e.history[n].x,h);return v}function l(t,e){for(var a,r=e&&e.lossFunction?e.lossFunction:s,o={},l={},u=0;u<t.length;++u){var d=t[u];1==d.sets.length&&(a=d.sets[0],o[a]={x:1e10,y:1e10,rowid:o.length,size:d.size,radius:Math.sqrt(d.size/Math.PI)},l[a]=[])}for(t=t.filter((function(t){return 2==t.sets.length})),u=0;u<t.length;++u){var h=t[u],f=h.hasOwnProperty("weight")?h.weight:1,c=h.sets[0],p=h.sets[1];h.size+n>=Math.min(o[c].size,o[p].size)&&(f=0),l[c].push({set:p,size:h.size,weight:f}),l[p].push({set:c,size:h.size,weight:f})}var g=[];for(a in l)if(l.hasOwnProperty(a)){var y=0;for(u=0;u<l[a].length;++u)y+=l[a][u].size*l[a][u].weight;g.push({set:a,size:y})}function v(t,e){return e.size-t.size}g.sort(v);var x={};function _(t){return t.set in x}function m(t,e){o[e].x=t.x,o[e].y=t.y,x[e]=!0}for(m({x:0,y:0},g[0].set),u=1;u<g.length;++u){var b=g[u].set,w=l[b].filter(_);if(a=o[b],w.sort(v),0===w.length)throw"ERROR: missing pairwise overlap information";for(var k=[],S=0;S<w.length;++S){var A=o[w[S].set],P=i(a.radius,A.radius,w[S].size);k.push({x:A.x+P,y:A.y}),k.push({x:A.x-P,y:A.y}),k.push({y:A.y+P,x:A.x}),k.push({y:A.y-P,x:A.x});for(var C=S+1;C<w.length;++C)for(var D=o[w[C].set],O=i(a.radius,D.radius,w[C].size),T=(0,ui.circleCircleIntersection)({x:A.x,y:A.y,radius:P},{x:D.x,y:D.y,radius:O}),M=0;M<T.length;++M)k.push(T[M])}var E=1e50,R=k[0];for(S=0;S<k.length;++S){o[b].x=k[S].x,o[b].y=k[S].y;var I=r(o,t);I<E&&(E=I,R=k[S])}m(R,b)}return o}function s(t,e){var n=0;for(var i=0;i<e.length;++i){var a,r=e[i];if(1!=r.sets.length){if(2==r.sets.length){var o=t[r.sets[0]],l=t[r.sets[1]];a=(0,ui.circleOverlap)(o.radius,l.radius,(0,ui.distance)(o,l))}else a=(0,ui.intersectionArea)(r.sets.map((function(e){return t[e]})));n+=(r.hasOwnProperty("weight")?r.weight:1)*(a-r.size)*(a-r.size)}}return n}function u(t,e,n){var i;if(null===n?t.sort((function(t,e){return e.radius-t.radius})):t.sort(n),t.length>0){var a=t[0].x,r=t[0].y;for(i=0;i<t.length;++i)t[i].x-=a,t[i].y-=r}2==t.length&&((0,ui.distance)(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y));if(t.length>1){var o,l,s=Math.atan2(t[1].x,t[1].y)-e,u=Math.cos(s),d=Math.sin(s);for(i=0;i<t.length;++i)o=t[i].x,l=t[i].y,t[i].x=u*o-d*l,t[i].y=d*o+u*l}if(t.length>2){for(var h=Math.atan2(t[2].x,t[2].y)-e;h<0;)h+=2*Math.PI;for(;h>2*Math.PI;)h-=2*Math.PI;if(h>Math.PI){var f=t[1].y/(1e-10+t[1].x);for(i=0;i<t.length;++i){var c=(t[i].x+f*t[i].y)/(1+f*f);t[i].x=2*c-t[i].x,t[i].y=2*c*f-t[i].y}}}}function d(t){function e(t){return t.parent!==t&&(t.parent=e(t.parent)),t.parent}function n(t,n){var i=e(t),a=e(n);i.parent=a}t.map((function(t){t.parent=t}));for(var i=0;i<t.length;++i)for(var a=i+1;a<t.length;++a){var r=t[i].radius+t[a].radius;(0,ui.distance)(t[i],t[a])+1e-10<r&&n(t[a],t[i])}var o,l={};for(i=0;i<t.length;++i)(o=e(t[i]).parent.setid)in l||(l[o]=[]),l[o].push(t[i]);t.map((function(t){delete t.parent}));var s=[];for(o in l)l.hasOwnProperty(o)&&s.push(l[o]);return s}function h(t){var e=function(e){var n=Math.max.apply(null,t.map((function(t){return t[e]+t.radius}))),i=Math.min.apply(null,t.map((function(t){return t[e]-t.radius})));return{max:n,min:i}};return{xRange:e("x"),yRange:e("y")}}}));e(di);di.bestInitialLayout,di.constrainedMDSLayout,di.disjointCluster,di.distanceFromIntersectArea,di.getDistanceMatrices,di.greedyLayout,di.lossFunction,di.normalizeSolution,di.scaleSolution,di.venn;var hi=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Gn);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=u.default._,c=u.default.event,p=u.default.Display.Text,g=u.default.Shapes.Path,y=u.default.Shapes.Circle,v=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="venn",o.vennData=null,f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o._dataCircleLen=0,o._dataLabelLen=0,o._dataPathLen=0,o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){this.venn_circles=new u.default.Display.Sprite({id:"venn_circles"}),this.sprite.addChild(this.venn_circles),this.venn_paths=new u.default.Display.Sprite({id:"venn_paths"}),this.sprite.addChild(this.venn_paths),this.venn_labels=new u.default.Display.Sprite({id:"venn_labels"}),this.sprite.addChild(this.venn_labels)}},{key:"draw",value:function(t){!t&&(t={}),f.extend(!0,this,t),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.app.padding.left,this.sprite.context.y=this.app.padding.top,this.fire("complete")}},{key:"resetData",value:function(t){this.dataFrame=t,this.data=this._trimGraphs(),this._widget()}},{key:"_trimGraphs",value:function(){var t=this,e=t._vennData(),n=di.venn,i=di.lossFunction,a=Math.PI/2,r={},o={};if(this._dataCircleLen=0,this._dataLabelLen=0,this._dataPathLen=0,e.length>0){var l=n(e,{lossFunction:i});l=(0,di.normalizeSolution)(l,a,null),r=(0,di.scaleSolution)(l,this.width,this.height,0),o=function(t,e){for(var n={},i=function(t){var e={},n=[];for(var i in t)n.push(i),e[i]=[];for(var a=0;a<n.length;a++)for(var r=t[n[a]],o=a+1;o<n.length;++o){var l=t[n[o]],s=(0,ui.distance)(r,l);s+l.radius<=r.radius+1e-10?e[n[o]].push(n[a]):s+r.radius<=l.radius+1e-10&&e[n[a]].push(n[o])}return e}(t),a=0;a<e.length;++a){for(var r=e[a].sets,o={},l={},s=0;s<r.length;++s){o[r[s]]=!0;for(var u=i[r[s]],d=0;d<u.length;++d)l[u[d]]=!0}var h=[],f=[];for(var c in t)c in o?h.push(t[c]):c in l||f.push(t[c]);var p=x(h,f);n[r]=p,p.disjoint&&e[a].size}return n}(r,e)}var s=0,u=0;return f.each(e,(function(e){if(e.label&&(e.sets.length>1&&!t.label.showInter||(e.labelPosition=o[e.nodeId],t._dataLabelLen++)),e.sets.length>1){var n=function(t){var e={};(0,ui.intersectionArea)(t,e);var n=e.arcs;if(0===n.length)return"M 0 0";if(1==n.length){var i=n[0].circle;return function(t,e,n){var i=[];return i.push("\nM",t,e),i.push("\nm",-n,0),i.push("\na",n,n,0,1,0,2*n,0),i.push("\na",n,n,0,1,0,2*-n,0),i.join(" ")}(i.x,i.y,i.radius)}for(var a=["\nM",n[0].p2.x,n[0].p2.y],r=0;r<n.length;++r){var o=n[r],l=o.circle.radius,s=o.width>l;a.push("\nA",l,l,0,s?1:0,1,o.p1.x,o.p1.y)}return a.join(" ")+" z"}(e.sets.map((function(t){return r[t]})));e.shape={type:"path",path:n,pathInd:u++},t._dataPathLen++}else 1==e.sets.length&&(e.shape=f.extend({type:"circle",circleInd:s++},r[e.nodeId]),t._dataCircleLen++)})),e}},{key:"_vennData",value:function(){for(var t=[],e=this,n=0,i=this.dataFrame.length;n<i;n++){var a=e.dataFrame.getRowDataAt(n),r={type:"venn",field:e.field,iNode:n,nodeId:null,rowData:a,sets:null,size:null,value:null,fillStyle:null,strokeStyle:null,label:null,labelPosition:null};for(var o in a){var l=a[o];o==e.keyField&&(f.isString(l)&&(l=l.split(/[,|]/)),r.sets=l,r.nodeId=l.join(),e.label.field||(r.label=l.join())),o==e.field&&(r.size=l,r.value=l),o==e.label.field&&(r.label=l)}t.push(r)}return t}},{key:"_getStyle",value:function(t,e,n,i){var a;return f.isString(t)&&(a=t),f.isFunction(t)&&(a=t(n)),a||null==e||(a=this.app.getTheme(e)),a||null==i||(a=i),a}},{key:"_widget",value:function(){var t=this;if(t.venn_circles.children.length>t._dataCircleLen)for(var e=t._dataCircleLen;e<t.venn_circles.children.length;e++)t.venn_circles.getChildAt(e--).destroy();if(t.venn_paths.children.length>t._dataPathLen)for(var n=t._dataPathLen;n<t.venn_paths.children.length;n++)t.venn_paths.getChildAt(n--).destroy();if(t.venn_labels.children.length>t._dataLabelLen)for(var i=t._dataLabelLen;i<t.venn_labels.children.length;i++)t.venn_labels.getChildAt(i--).destroy();var a=0,r=0,o=0;f.each(this.data,(function(e){var n,i=e.shape,l=!0;if(i){var s;if("circle"==i.type){var u=t._getStyle(t.node.fillStyle,i.circleInd,e),d=t._getStyle(t.node.strokeStyle,i.circleInd,e);e.fillStyle=u,e.strokeStyle=d,s={x:i.x,y:i.y,r:i.radius,fillStyle:u,fillAlpha:t.node.fillAlpha,lineWidth:t.node.lineWidth,strokeStyle:d,strokeAlpha:t.node.strokeAlpha},(n=t.venn_circles.getChildAt(a++))?(l=!1,n.animate(s)):(n=new y({pointChkPriority:!1,hoverClone:!1,context:s}),t.venn_circles.addChild(n))}"path"==e.shape.type&&(s={path:i.path,fillStyle:"#ffffff",fillAlpha:0,lineWidth:t.node.lineWidth,strokeStyle:"#ffffff",strokeAlpha:0},(n=t.venn_paths.getChildAt(r++))?(l=!1,n.context.path=i.path):(n=new g({pointChkPriority:!1,context:s}),t.venn_paths.addChild(n))),n.nodeData=e,e._node=n,t.node.focus.enabled&&n.hover((function(){t.focusAt(this.nodeData.iNode)}),(function(){!this.nodeData.selected&&t.unfocusAt(this.nodeData.iNode)})),l&&n.on(c.types.get(),(function(e){e.eventInfo={trigger:"this.node",title:null,nodes:[this.nodeData]},t.app.fire(e.type,e)}))}if(e.label&&t.label.enabled){var h=t._getStyle(t.label.fontColor,i.circleInd,e,"#999"),f=t.label.fontSize;if(e.sets.length>1&&(t.label.showInter?f-=2:f=0),f){var v={x:e.labelPosition.x,y:e.labelPosition.y,fontSize:f,textBaseline:"middle",textAlign:"center",fontWeight:t.label.fontWeight,fillStyle:h},x=t.venn_labels.getChildAt(o++);x?(x.resetText(e.label),x.animate(v)):(x=new p(e.label,{context:v}),t.venn_labels.addChild(x))}}}))}},{key:"focusAt",value:function(t){var e=this.data[t];if(this.node.focus.enabled&&!e.focused){var n=e._node.context;e.sets.length>1?n.strokeAlpha=1:n.strokeAlpha=this.node.focus.strokeAlpha,e.focused=!0}}},{key:"unfocusAt",value:function(t){var e=this.data[t];this.node.focus.enabled&&e.focused&&(e._node.context.strokeAlpha=this.node.strokeAlpha,e.focused=!1)}},{key:"selectAt",value:function(t){var e=this.data[t];if(this.node.select.enabled&&!e.selected){var n=e._node.context;n.lineWidth=this.node.select.lineWidth,n.strokeAlpha=this.node.select.strokeAlpha,n.strokeStyle=this.node.select.strokeStyle,e.selected=!0}}},{key:"unselectAt",value:function(t){var e=this.data[t];this.node.select.enabled&&e.selected&&(e._node.context.strokeStyle=this.node.strokeStyle,e.selected=!1)}}],[{key:"defaultProps",value:function(){return{field:{detail:"value字段",default:"value"},keyField:{detail:"key字段",default:"name"},node:{detail:"单个节点配置",propertys:{strokeStyle:{detail:"边框颜色",default:null},lineWidth:{detail:"边框大小",default:2},strokeAlpha:{detail:"边框透明度",default:0},fillStyle:{detail:"背景色",default:null},fillAlpha:{detail:"背景透明度",default:.25},focus:{detail:"hover设置",propertys:{enabled:{detail:"是否开启",default:!0},strokeAlpha:{detail:"边框透明度",default:.3}}},select:{detail:"选中设置",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"描边宽度",default:2},strokeStyle:{detail:"描边颜色",default:"#666666"}}}}},label:{detail:"文本设置",propertys:{field:{detail:"获取文本的字段",default:null},fontSize:{detail:"字体大小",default:14},fontColor:{detail:"文本颜色",default:null},fontWeight:{detail:"fontWeight",default:"normal"},showInter:{detail:"是否显示相交部分的文本",default:!0}}}}}},{key:"polyfill",value:function(t){return t.valueField&&(t.field=t.valueField,delete t.valueField),t}}]),i}(d.default);function x(t,e){var n,i=[];for(n=0;n<t.length;++n){var a=t[n];i.push({x:a.x,y:a.y}),i.push({x:a.x+a.radius/2,y:a.y}),i.push({x:a.x-a.radius/2,y:a.y}),i.push({x:a.x,y:a.y+a.radius/2}),i.push({x:a.x,y:a.y-a.radius/2})}var r=i[0],o=_(i[0],t,e);for(n=1;n<i.length;++n){var l=_(i[n],t,e);l>=o&&(r=i[n],o=l)}var s=(0,si.nelderMead)((function(n){return-1*_({x:n[0],y:n[1]},t,e)}),[r.x,r.y],{maxIterations:500,minErrorDelta:1e-10}).x,u={x:s[0],y:s[1]},d=!0;for(n=0;n<t.length;++n)if((0,ui.distance)(u,t[n])>t[n].radius){d=!1;break}for(n=0;n<e.length;++n)if((0,ui.distance)(u,e[n])<e[n].radius){d=!1;break}if(!d)if(1==t.length)u={x:t[0].x,y:t[0].y};else{var h={};(0,ui.intersectionArea)(t,h),u=0===h.arcs.length?{x:0,y:-1e3,disjoint:!0}:1==h.arcs.length?{x:h.arcs[0].circle.x,y:h.arcs[0].circle.y}:e.length?x(t,[]):(0,ui.getCenter)(h.arcs.map((function(t){return t.p1})))}return u}function _(t,e,n){var i,a,r=e[0].radius-(0,ui.distance)(e[0],t);for(i=1;i<e.length;++i)(a=e[i].radius-(0,ui.distance)(e[i],t))<=r&&(r=a);for(i=0;i<n.length;++i)(a=(0,ui.distance)(n[i],t)-n[i].radius)<=r&&(r=a);return r}d.default.registerComponent(v,"graphs","venn");var m=v;e.default=m}));e(hi);var fi=n((function(t,e){function n(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var i,a=1,r=arguments.length;for(;++a<r;)t[i=arguments[a]]=n(t,e,e[i]);return t}}));e(fi);var ci=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={merge:function(t){for(var e,n,i,a=t.length,r=-1,o=0;++r<a;)o+=t[r].length;for(n=new Array(o);--a>=0;)for(e=(i=t[a]).length;--e>=0;)n[--o]=i[e];return n}};e.default=n}));e(ci);var pi=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(fi),a=i(ci),r=function t(){var e=s,n=o,i=l;function a(r){var o,l=[r],s=[];for(r.depth=0;null!=(o=l.pop());)if(s.push(o),(d=n.call(a,o,o.depth))&&(u=d.length)){for(var u,d,h;--u>=0;)l.push(h=d[u]),h.parent=o,h.depth=o.depth+1;if(i){var f=+i.call(a,o,o.depth);f&&!isNaN(f)&&(o._value=f)}i&&(o.value=0),o.children=d}else i&&(o.value=+i.call(a,o,o.depth)||0),delete o.children;return t.layout_hierarchyVisitAfter(r,(function(t){var n,a;e&&(n=t.children)&&n.sort(e),i&&(a=t.parent)&&(a.value+=t.value),t._value&&t._value>t.value&&(t.value=t._value),delete t._value})),s}return a.sort=function(t){return arguments.length?(e=t,a):e},a.children=function(t){return arguments.length?(n=t,a):n},a.value=function(t){return arguments.length?(i=t,a):i},a.revalue=function(e){return i&&(t.layout_hierarchyVisitBefore(e,(function(t){t.children&&(t.value=0)})),t.layout_hierarchyVisitAfter(e,(function(t){var e;t.children||(t.value=+i.call(a,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value),t._value&&t._value>t.value&&(t.value=t._value),delete t._value}))),e},a};function o(t){return t.children}function l(t){return t.value}function s(t,e){return e.value-t.value}function u(t){return a.default.merge(t.map((function(t){return(t.children||[]).map((function(e){return{source:t,target:e}}))})))}r.layout_hierarchyRebind=function(t,e){return(0,n.default)(t,e,"sort","children","value"),t.nodes=t,t.links=u,t},r.layout_hierarchyVisitBefore=function(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(a=t.children)&&(i=a.length))for(var i,a;--i>=0;)n.push(a[i])},r.layout_hierarchyVisitAfter=function(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(r=t.children)&&(a=r.length))for(var a,r,o=-1;++o<a;)n.push(r[o]);for(;null!=(t=i.pop());)e(t)};var d=r;e.default=d}));e(pi);var gi=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=(0,n.default)(),e=[1,1];function i(t,e,n,a){var r=t.children;if(t.x=e,t.y=t.depth*a,t.dx=n,t.dy=a,r&&(o=r.length)){var o,l,s,u=-1;for(n=t.value?n/t.value:0;++u<o;)i(l=r[u],e,s=l.value*n,a),e+=s}}function a(t){var e=t.children,n=0;if(e&&(i=e.length))for(var i,r=-1;++r<i;)n=Math.max(n,a(e[r]));return 1+n}function r(n,r){var o=t.call(this,n,r);return i(o[0],0,e[0],e[1]/a(o[0])),o}return r.size=function(t){return arguments.length?(e=t,r):e},n.default.layout_hierarchyRebind(r,t)};var n=i(pi)}));e(gi);var yi=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Gn),h=i(gi);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var c=u.default._,p=u.default.event,g=u.default.Shapes.Sector,y=function(t){(0,o.default)(i,t);var e=f(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="sunburst",c.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.data=[],o.dataGroup=[],o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){}},{key:"draw",value:function(t){!t&&(t={}),c.extend(!0,this,t),this.data=this._trimGraphs(),this.dataGroup=this._getDataGroupOfDepth(),this._widget(),this.sprite.context.x=this.width/2+this.origin.x,this.sprite.context.y=this.height/2+this.origin.y,this.fire("complete")}},{key:"_trimGraphs",value:function(){var t=this,e=this,n=parseInt(Math.min(this.width,this.height)/2),i=(0,h.default)().sort(null).size([2*Math.PI,n*n]).value((function(t){return t[e.field]})),a=this._tansTreeData();return this.data=i(a,0),this.data.forEach((function(e){e.field=t.field})),this.data}},{key:"_getDataGroupOfDepth",value:function(){var t={};c.each(this.data,(function(e){t[e.depth]=[]})),c.each(this.data,(function(e){t[e.depth].push(e)}));var e=[];for(var n in t)e.push(t[n]);return e}},{key:"_tansTreeData",value:function(){var t=this.dataFrame,e={},n=t.getFieldData(this.keyField),i=t.getFieldData(this.field),a=t.getFieldData(this.parentKeyField);return function t(e,r,o){for(var l=r?r.name:void 0,s=o||0;s<a.length;s++){var u=a[s];if(u||0===u||(u=void 0),l===u){e.name=n[s],e.iNode=s;var d=i[s];(d||0===d)&&(e.value=d),c.each(a,(function(n,i){if(n===e.name){e.children||(e.children=[]);var a={};t(a,e,i),e.children.push(a)}}));break}}}(e),e}},{key:"_widget",value:function(){var t=this;c.each(this.dataGroup,(function(e,n){c.each(e,(function(i,a){if(i.depth){var r=Math.sqrt(i.y+i.dy),o={r0:Math.sqrt(i.y),r:Math.sqrt(i.y)+2,startAngle:180*i.x/Math.PI,endAngle:180*(i.x+i.dx)/Math.PI,fillStyle:i.color||t.app.getTheme(i.iNode),strokeStyle:t.node.strokeStyle,lineWidth:t.node.lineWidth,globalAlpha:0},l=new g({id:"sector_"+n+"_"+a,context:o});l.layoutData=i,i.sector=l,i.group=e,t.sprite.addChild(l),l.hover((function(){t._focus(i,e)}),(function(){t._unfocus(i,e)})),l.on(p.types.get(),(function(e){e.eventInfo={trigger:"this.node",iNode:i.iNode},t.app.fire(e.type,e)})),n<=1?(l.context.r=r,l.context.globalAlpha=1):setTimeout((function(){l.context&&(l.context.globalAlpha=1,l.animate({r:r},{duration:350}))}),350*(n-1))}}))}))}},{key:"getNodesAt",value:function(t){var e=[];if(void 0!==t){var n=c.find(this.data,(function(e){return e.iNode==t}));n.type="sunburst",n&&e.push(n)}return e}},{key:"_focus",value:function(t,e){var n=this;c.each(e,(function(e){e!==t&&(e.sector.context.globalAlpha=n.node.blurAlpha,n._focusChildren(e,(function(t){t.sector.context.globalAlpha=n.node.blurAlpha})))})),n._focusParent(t)}},{key:"_unfocus",value:function(){c.each(this.data,(function(t){t.sector&&(t.sector.context.globalAlpha=1)}))}},{key:"_focusChildren",value:function(t,e){var n=this;t.children&&t.children.length&&c.each(t.children,(function(t){e(t),n._focusChildren(t,e)}))}},{key:"_focusParent",value:function(t){var e=this;t.parent&&t.parent.sector&&t.parent.group&&c.each(t.parent.group,(function(n){n===t.parent?(n.sector.context.globalAlpha=1,e._focusParent(t.parent)):n.sector.context.globalAlpha=e.node.blurAlpha}))}}],[{key:"defaultProps",value:function(){return{keyField:{detail:"key字段",default:""},field:{detail:"value字段",default:""},parentKeyField:{detail:"parent字段",default:""},node:{detail:"单个节点图形设置",propertys:{strokeStyle:{detail:"描边色",default:"#ffffff"},lineWidth:{detail:"描边线宽",default:1},strokeAlpha:{detail:"描边边框透明度",default:1},fillStyle:{detail:"背景色",default:null},fillAlpha:{detail:"背景透明度",default:1},blurAlpha:{detail:"非激活状态透明度",documentation:"比如选中其中一项，其他不先关的要降低透明度",default:.4}}}}}},{key:"polyfill",value:function(t){return t}}]),i}(d.default);d.default.registerComponent(y,"graphs","sunburst");var v=y;e.default=v}));e(yi);var vi=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t={},e=24,n=8,i=[1,1],a=[],r=function(t,e){return t.y-e.y},o=[];function l(t,e){var n,i=0,a=t.length,r=-1;if(1===arguments.length)for(;++r<a;)isNaN(n=+t[r])||(i+=n);else for(;++r<a;)isNaN(n=+e.call(t,t[r],r))||(i+=n);return i}function s(){for(var t,n,r=a,o=0;r.length;)t=[],r.forEach((function(n){n.x=o,n.dx=e,n.sourceLinks.forEach((function(e){t.indexOf(e.target)<0&&t.push(e.target)}))})),r=t,++o;!function(t){a.forEach((function(e){e.sourceLinks.length||(e.x=t-1)}))}(o),n=(i[0]-e)/(o-1),a.forEach((function(t){t.x*=n}))}t.nodeWidth=function(n){return arguments.length?(e=+n,t):e},t.nodeSort=function(e){return arguments.length?(r=e,t):r},t.nodePadding=function(e){return arguments.length?(n=+e,t):n},t.nodes=function(e){return arguments.length?(a=e,t):a},t.links=function(e){return arguments.length?(o=e,t):o},t.size=function(e){return arguments.length?(i=e,t):i},t.layout=function(e){return a.forEach((function(t){t.sourceLinks=[],t.targetLinks=[]})),o.forEach((function(t){var e=t.source,n=t.target;"number"==typeof e&&(e=t.source=a[t.source]),"number"==typeof n&&(n=t.target=a[t.target]),e.sourceLinks.push(t),n.targetLinks.push(t)})),a.forEach((function(t){t.value=Math.max(l(t.sourceLinks,_),l(t.targetLinks,_))})),s(),function(t){var e=u().key((function(t){return t.x})).sortKeys(y).entries(a).map((function(t){return t.values}));d(),c();for(var s=1;t>0;--t)f(s*=.99),c(),h(s),c();function d(){var t=function(t,e){var n,i,a=-1,r=t.length;if(1===arguments.length){for(;++a<r&&(null==(n=t[a])||n!=n);)n=void 0;for(;++a<r;)null!=(i=t[a])&&n>i&&(n=i)}else{for(;++a<r&&(null==(n=e.call(t,t[a],a))||n!=n);)n=void 0;for(;++a<r;)null!=(i=e.call(t,t[a],a))&&n>i&&(n=i)}return n}(e,(function(t){return(i[1]-(t.length-1)*n)/l(t,_)}));e.forEach((function(e){e.forEach((function(e,n){e.y=n,e.dy=e.value*t}))})),o.forEach((function(e){e.dy=e.value*t}))}function h(t){function n(t){return x(t.source)*t.value}e.forEach((function(e,i){e.forEach((function(e){if(e.targetLinks.length){var i=l(e.targetLinks,n)/l(e.targetLinks,_);e.y+=(i-x(e))*t}}))}))}function f(t){function n(t){return x(t.target)*t.value}e.slice().reverse().forEach((function(e){e.forEach((function(e){if(e.sourceLinks.length){var i=l(e.sourceLinks,n)/l(e.sourceLinks,_);e.y+=(i-x(e))*t}}))}))}function c(){e.forEach((function(t){var e,a,o,l=0,s=t.length;for(r&&t.sort(r),o=0;o<s;++o)(a=l-(e=t[o]).y)>0&&(e.y+=a),l=e.y+e.dy+n;if((a=l-n-i[1])>0)for(l=e.y-=a,o=s-2;o>=0;--o)(a=(e=t[o]).y+e.dy+n-l)>0&&(e.y-=a),l=e.y}))}}(e),v(),t},t.relayout=function(){return v(),t},t.link=function(){var t=.5;function e(e){var n=e.source.x+e.source.dx,i=e.target.x,a=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}(n,i),r=a(t),o=a(1-t),l=e.source.y+e.sy,s=e.target.y+e.ty,u=e.dy;u<1&&(u=1);var d="M"+n+","+l+"C"+r+","+l+" "+o+","+s+" "+i+","+s;return d+="v"+u,d+="C"+o+","+(s+u)+" "+r+","+(l+u)+" "+n+","+(l+u),d+="v"+-u+"z"}return e.curvature=function(n){return arguments.length?(t=+n,e):t},e};var u=function(){var t,e,n={},i=[],a=[];function r(a,o,l){if(l>=i.length)return e?e.call(n,o):t?o.sort(t):o;for(var s,u,d,f,c=-1,p=o.length,g=i[l++],y=new h;++c<p;)(f=y.get(s=g(u=o[c])))?f.push(u):y.set(s,[u]);return a?(u=a(),d=function(t,e){u.set(t,r(a,e,l))}):(u={},d=function(t,e){u[t]=r(a,e,l)}),y.forEach(d),u}function o(t,e){if(e>=i.length)return t;var n=[],r=a[e++];return t.forEach((function(t,i){n.push({key:t,values:o(i,e)})})),r?n.sort((function(t,e){return r(t.key,e.key)})):n}return n.map=function(t,e){return r(e,t,0)},n.entries=function(t){return o(r(d,t,0),0)},n.key=function(t){return i.push(t),n},n.sortKeys=function(t){return a[i.length-1]=t,n},n.sortValues=function(e){return t=e,n},n.rollup=function(t){return e=t,n},n},d=function(t,e){var n=new h;if(t instanceof h)t.forEach((function(t,e){n.set(t,e)}));else if(Array.isArray(t)){var i,a=-1,r=t.length;if(1===arguments.length)for(;++a<r;)n.set(a,t[a]);else for(;++a<r;)n.set(e.call(t,i=t[a],a),i)}else for(var o in t)n.set(o,t[o]);return n};function h(){this._=Object.create(null)}var f="__proto__",c="\0";function p(t){return(t+="")===f||t[0]===c?c+t:t}function g(t){return(t+="")[0]===c?t.slice(1):t}function y(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function v(){function t(t,e){return t.source.y-e.source.y}function e(t,e){return t.target.y-e.target.y}a.forEach((function(n){n.sourceLinks.sort(e),n.targetLinks.sort(t)})),a.forEach((function(t){var e=0,n=0;t.sourceLinks.forEach((function(t){t.sy=e,e+=t.dy})),t.targetLinks.forEach((function(t){t.ty=n,n+=t.dy}))}))}function x(t){return t.y+t.dy/2}function _(t){return t.value}return function(t,e){if(Object.defineProperty)for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1});else ln._.extend(t.prototype,e)}(h,{has:function(t){return p(t)in this._},get:function(t){return this._[p(t)]},set:function(t,e){return this._[p(t)]=e},remove:function(t){return(t=p(t))in this._&&delete this._[t]},keys:function(){var t=[];for(var e in this._)t.push(g(e));return t},values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:g(e),value:this._[e]});return t},size:function(){var t=0;for(var e in this._)++t;return t},empty:function(){for(var t in this._)return!1;return!0},forEach:function(t){for(var e in this._)t.call(this,g(e),this._[e])}}),t}}));e(vi);var xi=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Gn),h=i(vi);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var c=u.default._,p=u.default.event,g=u.default.Shapes.Path,y=u.default.Shapes.Rect,v=function(t){(0,o.default)(i,t);var e=f(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="sankey",c.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){this._links=new u.default.Display.Sprite,this._nodes=new u.default.Display.Sprite,this._labels=new u.default.Display.Sprite,this.sprite.addChild(this._links),this.sprite.addChild(this._nodes),this.sprite.addChild(this._labels)}},{key:"draw",value:function(t){!t&&(t={}),c.extend(!0,this,t),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.fire("complete")}},{key:"_trimGraphs",value:function(){var t=this,e=[],n=[],i=t.dataFrame.getFieldData(t.keyField),a=t.dataFrame.getFieldData(t.field),r=t.dataFrame.getFieldData(t.parentField),o={};return c.each(i,(function(n,i){var a=[];t.parentField&&a.push(r[i]),a=a.concat(n.split(/[|]/)),c.each(a,(function(t){void 0===o[t]&&(o[t]=e.length,e.push({name:t}))}))})),c.each(i,(function(e,i){var l=[];t.parentField&&l.push(r[i]),2==(l=l.concat(e.split(/[|]/))).length&&n.push({source:o[l[0]],target:o[l[1]],value:a[i]})})),(0,h.default)().nodeWidth(this.node.width).nodePadding(this.node.padding).nodeSort(this.node.sort).size([this.width,this.height]).nodes(e).links(n).layout(16)}},{key:"_widget",value:function(){this._drawNodes(),this._drawLinks(),this._drawLabels()}},{key:"_getColor",value:function(t,e,n){var i=t;return c.isArray(i)&&(i=i[n]),c.isFunction(i)&&(i=i(e)),i||(i=this.app.getTheme(n)),i}},{key:"_drawNodes",value:function(){var t=this.data.nodes(),e=this;c.each(t,(function(t,n){t.field=e.field;var i=e._getColor(e.node.fillStyle,t,n),a=new y({xyToInt:!1,context:{x:t.x,y:t.y,width:e.data.nodeWidth(),height:Math.max(t.dy,1),fillStyle:i}});a.data=t,e._nodes.addChild(a)}))}},{key:"_drawLinks",value:function(){var t=this.data.links(),e=this;c.each(t,(function(t,n){var i=e._getColor(e.line.strokeStyle,t,n),a=e.data.link()(t),r=new g({xyToInt:!1,context:{path:a,fillStyle:i,globalAlpha:e.line.alpha,cursor:"pointer"}});r.__glpha=e.line.alpha,r.link=t,r.on(p.types.get(),(function(n){e.line.focus.enabled&&("mouseover"==n.type&&(this.__glpha+=.1),"mouseout"==n.type&&(this.__glpha-=.1));var i=this.link;i.type="sankey",t.field=e.field,t.__no__name=!0,n.eventInfo={trigger:"this.node",title:i.source.name+" <span style='display:inline-block;margin-left:4px;position:relative;top:-0.5px;font-size:16px;left:-3px;'>></span> "+i.target.name,nodes:[i]},e.app.fire(n.type,n)})),e._links.addChild(r)}))}},{key:"_drawLabels",value:function(){var t=this.data.nodes(),e=this;c.each(t,(function(t){var n=e.label.textAlign,i=t.x+e.data.nodeWidth()+4,a=t.y+Math.max(t.dy/2,1),r=e.label.format?e.label.format(t.name,t):t.name,o=new u.default.Display.Text(r,{context:{x:i,y:a,fillStyle:e.label.fontColor,fontSize:e.label.fontSize,textAlign:n,textBaseline:e.label.verticalAlign}});e._labels.addChild(o),o.getTextWidth()+i>e.width&&(o.context.x=t.x-4,o.context.textAlign="right")}))}}],[{key:"defaultProps",value:function(){return{keyField:{detail:"key字段",default:null},field:{detail:"value字段",default:"value"},parentField:{detail:"parent字段",default:null},node:{detail:"node",propertys:{width:{detail:"节点宽",default:18},padding:{detail:"节点间距",default:10},sort:{detail:"节点排序字段",default:function(t,e){return t.y-e.y}},fillStyle:{detail:"节点背景色",default:null}}},line:{detail:"线设置",propertys:{strokeStyle:{detail:"线颜色",default:"blue"},alpha:{detail:"线透明度",default:.3},focus:{detail:"图形的hover设置",propertys:{enabled:{detail:"是否开启",default:!0}}}}},label:{detail:"文本设置",propertys:{fontColor:{detail:"文本颜色",default:"#666666"},fontSize:{detail:"文本字体大小",default:12},textAlign:{detail:"水平对齐方式",default:"left"},verticalAlign:{detail:"垂直对齐方式",default:"middle"},format:{detail:"文本格式函数",default:null}}}}}},{key:"polyfill",value:function(t){return t.valueField&&(t.field=t.valueField,delete t.valueField),t}}]),i}(d.default);d.default.registerComponent(v,"graphs","sankey");var x=v;e.default=x}));e(xi);var _i=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(mn),a=i(hn),r=i(fn),o=i(yn),l=i(pn),s=i(vn),u=i(xn),d=i(ln),h=i(Gn);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?f(Object(i),!0).forEach((function(e){(0,n.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}var g=d.default._,y=function(t){(0,l.default)(n,t);var e=p(n);function n(t,i){var r;return(0,a.default)(this,n),(r=e.call(this,t,i)).type="progress",g.extend(!0,(0,o.default)(r),(0,bn.getDefaultProps)(n.defaultProps()),t),r.bgNodeData=null,r.init(),r}return(0,r.default)(n,[{key:"init",value:function(){}},{key:"draw",value:function(t){!t&&(t={});var e=this;g.extend(!0,this,t),e.grow((function(t){e.data=e._trimGraphs(t),e._widget()})),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.fire("complete")}},{key:"_trimGraphs",value:function(t){var e=this;null==t&&(t=1);var n=this.app.getComponent({name:"coord"});this.enabledField=n.filterEnabledFields(this.field);var i=e.startAngle||n.startAngle,a=e.allAngle||n.allAngle;this.bgNodeData=this._getNodeData(i,a),this.bgNodeData.fillStyle=this._getStyle(this.bgNodeData,this.bgColor);var r={};return g.each(this.enabledField,(function(n){var o=e.dataFrame.getFieldData(n),l=[];g.each(o,(function(r,o){r*=t;var s=l.slice(-1)[0],u=s?s.endAngle:i,d=a*(r/100),h=e._getNodeData(u,d,n,r,o);h.fillStyle=e._getStyle(h,e.node.fillStyle),l.push(h)})),r[n]=l})),r}},{key:"_getNodeData",value:function(t,e,n,i,a){var r=this,o=this.app.getComponent({name:"coord"}),l=t+Math.min(e,180),s=t+e,u=Math.PI*t/180,d=Math.PI*l/180,h=Math.PI*s/180,f=r.radius||o.radius,c=f-r.node.width,p={field:n,value:i,text:i,iNode:a,allAngle:e,startAngle:t,middleAngle:l,endAngle:s,startRadian:u,middleRadian:d,endRadian:h,outRadius:f,innerRadius:c,startOutPoint:o.getPointInRadianOfR(u,f),middleOutPoint:o.getPointInRadianOfR(d,f),endOutPoint:o.getPointInRadianOfR(h,f),startInnerPoint:o.getPointInRadianOfR(u,c),middleInnerPoint:o.getPointInRadianOfR(d,c),endInnerPoint:o.getPointInRadianOfR(h,c),rowData:r.dataFrame.getRowDataAt(a),fillStyle:null};if(n)if(r.label.format)g.isFunction(r.label.format)&&(p.text=r.label.format.apply(this,[i,p]));else{var y=r.app.getComponent({name:"coord"}).getFieldConfig(n);p.text=y?y.getFormatValue(p.value):p.value.toFixed(this.label.fixNum)}return p}},{key:"_widget",value:function(){var t=this;if(t.bgEnabled){var e=t._getPathStr(this.bgNodeData);t._bgPathElement?t._bgPathElement.context.path=e:(t._bgPathElement=new d.default.Shapes.Path({context:{path:e}}),t.sprite.addChild(t._bgPathElement)),t._bgPathElement.context.lineWidth=this.node.width,t._bgPathElement.context.strokeStyle=this.bgNodeData.fillStyle}g.each(this.data,(function(e){g.each(e,(function(e,n){var i=t._getBarPathStr1(e),a="progress_bar_"+e.field+"_"+n,r=t.sprite.getChildById(a);r?r.context.path=i:(r=new d.default.Shapes.Path({id:a,context:{path:i}}),t.sprite.addChild(r)),r.context.lineWidth=t.node.width;var o=e.fillStyle,l=[];if(o&&o.lineargradient){var s=c({},o.lineargradient[0]),u=c({},o.lineargradient.slice(-1)[0]),h=[s,u];e.endAngle>e.middleAngle&&(l=(0,Vn.gradient)(o.lineargradient[0].color,o.lineargradient.slice(-1)[0].color,parseInt(e.allAngle/10)),u.color=l[17]),o={lineargradient:h,points:[e.startOutPoint.x,e.startOutPoint.y,e.middleOutPoint.x,e.middleOutPoint.y]}}if(r.context.strokeStyle=o,e.endAngle>e.middleAngle){var f=t._getBarPathStr2(e),p="progress_bar_"+e.field+"_"+n+"_2",y=t.sprite.getChildById(p);y?y.context.path=f:(y=new d.default.Shapes.Path({id:p,context:{path:f}}),t.sprite.addChild(y)),y.context.lineWidth=t.node.width;var v=e.fillStyle;if(v&&v.lineargradient){var x=c({},v.lineargradient[0]);x.color=l[17];var _=c({},v.lineargradient.slice(-1)[0]);v={lineargradient:[x,_],points:[e.middleOutPoint.x,e.middleOutPoint.y,e.endOutPoint.x,e.endOutPoint.y]}}y.context.strokeStyle=v}if(t.label.enabled){var m="progress_label_"+e.field+"_sprite_"+n,b=t.sprite.getChildById(m);b||(b=new d.default.Display.Sprite({id:m}),t.sprite.addChild(b)),b.context.x=t.label.offsetX-6,b.context.y=t.label.offsetY;var w={fillStyle:t.label.fontColor||e.fillStyle,fontSize:t.label.fontSize,lineWidth:t.label.lineWidth,strokeStyle:t.label.strokeStyle,textAlign:t.label.textAlign,textBaseline:t.label.verticalAlign,rotation:t.label.rotation},k="progress_label_"+e.field+"_"+n,S=b.getChildById(k);S?(S.resetText(e.text),g.extend(S.context,w)):(S=new d.default.Display.Text(e.text,{id:k,context:w}),b.addChild(S));var A="progress_label_"+e.field+"_symbol_"+n,P=b.getChildById(A),C={x:S.getTextWidth()/2+2,y:3,fillStyle:t.label.unitColor||t.label.fontColor||e.fillStyle,fontSize:t.label.unitFontSize,textAlign:"left",textBaseline:t.label.verticalAlign};if(P)g.extend(P.context,C);else{var D=t.label.unit;P=new d.default.Display.Text(D,{id:A,context:C}),b.addChild(P)}}}))}))}},{key:"_getPathStr",value:function(t){var e="M"+t.startOutPoint.x+" "+t.startOutPoint.y;return e+="A"+t.outRadius+" "+t.outRadius+" 0 0 1 "+t.middleOutPoint.x+" "+t.middleOutPoint.y,e+="A"+t.outRadius+" "+t.outRadius+" 0 0 1 "+t.endOutPoint.x+" "+t.endOutPoint.y}},{key:"_getBarPathStr1",value:function(t){var e="M"+t.startOutPoint.x+" "+t.startOutPoint.y;return e+="A"+t.outRadius+" "+t.outRadius+" 0 0 1 "+t.middleOutPoint.x+" "+t.middleOutPoint.y}},{key:"_getBarPathStr2",value:function(t){var e="M"+t.middleOutPoint.x+" "+t.middleOutPoint.y;return e+="A"+t.outRadius+" "+t.outRadius+" 0 0 1 "+t.endOutPoint.x+" "+t.endOutPoint.y}},{key:"_getStyle",value:function(t,e,n){var i=this.app.getComponent({name:"coord"}).getFieldConfig(t.field);n=n||(i?i.color:"#171717");var a=e;return e&&(g.isString(e)&&(a=e),g.isArray(e)&&(a=e[t.iNode]),g.isFunction(e)&&(a=e.apply(this,arguments))),a||(a=n),a}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},aniEasing:"Quintic.Out",node:{detail:"进度条设置",propertys:{width:{detail:"进度条的宽度",default:16},fillStyle:{detail:"进度条的填充色",documentation:"可以是单个颜色，也可以是数组，也可以是一个函数,也可以是个lineargradient",default:null}}},label:{detail:"进度值文本",propertys:{enabled:{detail:"是否启用label",default:"true"},unit:{detail:"单位值，默认%",default:"%"},unitColor:{detail:"单位值的颜色",default:null},unitFontSize:{detail:"单位值的大小",default:14},fontColor:{detail:"label颜色",default:null},fontSize:{detail:"label文本大小",default:26},fixNum:{detail:"toFixed的位数",default:2},format:{detail:"label格式化处理函数",default:null},lineWidth:{detail:"label文本描边线宽",default:null},strokeStyle:{detail:"label描边颜色",default:null},rotation:{detail:"label旋转角度",default:0},textAlign:{detail:"label textAlign",default:"center",values:["left","center","right"]},verticalAlign:{detail:"label verticalAlign",default:"middle",values:["top","middle","bottom"]},position:{detail:"label位置",default:"origin"},offsetX:{detail:"label在x方向的偏移量",default:0},offsetY:{detail:"label在y方向的偏移量",default:0}}},bgEnabled:{detail:"是否开启背景",default:!0},bgColor:{detail:"进度条背景颜色",default:"#f7f7f7"},radius:{detail:"半径",default:null},allAngle:{detail:"总角度",documentation:"默认为null，则和坐标系同步",default:null},startAngle:{detail:"其实角度",documentation:"默认为null，则和坐标系同步",default:null}}}}]),n}(h.default);h.default.registerComponent(y,"graphs","progress");var v=y;e.default=v}));e(_i);var mi=n((function(t){t.exports=function(t){if(Array.isArray(t))return Bn(t)},t.exports.__esModule=!0,t.exports.default=t.exports}));e(mi);var bi=n((function(t){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports}));e(bi);var wi=n((function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports}));e(wi);var ki=n((function(t){t.exports=function(t){return mi(t)||bi(t)||jn(t)||wi()},t.exports.__esModule=!0,t.exports.default=t.exports}));e(ki);var Si=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.arrayToTreeJsonForRelation=function(t,e){var n={},i={};ln._.each(t,(function(t){var a=t[e.field]+"";1==a.split(",").length?n[a]=t:i[a]=t}));var a=[];return ln._.each(n,(function(t,e){var n=!0;ln._.each(i,(function(t,i){if((i+="").split(",")[1]==e)return n=!1,!1})),n&&(a.push(t),t.__inRelation=!0)})),function t(a){ln._.each(a,(function(a){if(!a.__cycle){var r=a[e.field];ln._.each(i,(function(t,e){if((e+="").split(",")[0]==r){var i=n[e.split(",")[1]];i&&(a.children||(a.children=[]),ln._.find(a.children,(function(t){return t.key==i.key}))||a.children.push(i),i.__inRelation&&(i.__cycle=!0))}})),a.children&&a.children.length&&t(a.children)}}))}(a),a},e.checkDataIsJson=a,e.jsonToArrayForRelation=function(t,e,r){i=r;var o=[],l=new WeakMap,s=e.field||n,u=e.node&&e.node.content&&e.node.content.field;if(!a(t,s,i))return o;var d=[],h=0;ln._.each(t,(function(t){d.push(t)}));var f=function(){var t=d.pop();t[s]||(t[s]=h);var e=t[i];e&&(ln._.each(e,(function(e){l.set(e,{parentIndex:h,parentNode:t})})),d=d.concat(e.reverse()));var n={};ln._.each(t,(function(t,e){e!==i&&(n[e]=t)})),o.push(n);var a=l.get(t);if(a){var r=a.parentIndex,f=a.parentNode,c={};c.key=[r,h].join(","),u&&(c[u]=[f[u],t[u]].join("_")),o.push(c)}h++};for(;d.length;)f();return o};var n="__key__",i="children";function a(t,e,n){i=n;return!!ln._.isArray(t)&&(ln._.every(t,(function(t){return ln._.isObject(t)}))&&ln._.every(t,(function(t){return!ln._.isArray(t[e])})),ln._.some(t,(function(t){return i in t})))}}));e(Si);Si.arrayToTreeJsonForRelation,Si.checkDataIsJson,Si.jsonToArrayForRelation;var Ai=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={x:0,y:0,rx:0,ry:0},n=t.scale||1,i=t.scaleMin||1,a=t.scaleMax||8,r=0,o=0,l=0,s=0,u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Math.floor((t-r)*n+l)},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Math.floor((t-o)*n+s)},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Math.floor(1/n*(t-l)+r)},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Math.floor(1/n*(t-s)+o)},c=function(t){e.x=t.x,e.y=t.y;var n=e.rx,i=e.ry;return e.rx=h(e.x),e.ry=f(e.y),{xx:n,yy:i}},p=function(t){var i=c(t),a=i.xx,l=i.yy;return r-=e.rx-a,o-=e.ry-l,e.rx=h(e.x),e.ry=f(e.y),{scale:n,x:u(),y:d()}};this.wheel=function(t,h){return c(h),r=e.rx,o=e.ry,l=e.x,s=e.y,{scale:n=t.deltaY<0?Math.min(a,1.1*n):Math.max(i,n*(1/1.1)),x:u(),y:d()}},this.move=p,this.mouseMoveTo=c,this.offset=function(t){return e.x+=t.x,e.y+=t.y,p(e)},this.getZoomedPoint=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};return{x:u(t.x),y:d(t.y)}}}}));e(Ai);var Pi=function(){this.__data__=[],this.size=0};var Ci=function(t,e){return t===e||t!=t&&e!=e};var Di=function(t,e){for(var n=t.length;n--;)if(Ci(t[n][0],e))return n;return-1},Oi=Array.prototype.splice;var Ti=function(t){var e=this.__data__,n=Di(e,t);return!(n<0)&&(n==e.length-1?e.pop():Oi.call(e,n,1),--this.size,!0)};var Mi=function(t){var e=this.__data__,n=Di(e,t);return n<0?void 0:e[n][1]};var Ei=function(t){return Di(this.__data__,t)>-1};var Ri=function(t,e){var n=this.__data__,i=Di(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};function Ii(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Ii.prototype.clear=Pi,Ii.prototype.delete=Ti,Ii.prototype.get=Mi,Ii.prototype.has=Ei,Ii.prototype.set=Ri;var Li=Ii;var Fi=function(){this.__data__=new Li,this.size=0};var Ni=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n};var Bi=function(t){return this.__data__.get(t)};var ji=function(t){return this.__data__.has(t)},zi="object"==typeof t&&t&&t.Object===Object&&t,Wi="object"==typeof self&&self&&self.Object===Object&&self,Vi=zi||Wi||Function("return this")(),Gi=Vi.Symbol,Hi=Object.prototype,Yi=Hi.hasOwnProperty,Xi=Hi.toString,Ui=Gi?Gi.toStringTag:void 0;var qi=function(t){var e=Yi.call(t,Ui),n=t[Ui];try{t[Ui]=void 0;var i=!0}catch(t){}var a=Xi.call(t);return i&&(e?t[Ui]=n:delete t[Ui]),a},$i=Object.prototype.toString;var Ji=function(t){return $i.call(t)},Zi=Gi?Gi.toStringTag:void 0;var Qi=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Zi&&Zi in Object(t)?qi(t):Ji(t)};var Ki=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var ta,ea=function(t){if(!Ki(t))return!1;var e=Qi(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},na=Vi["__core-js_shared__"],ia=(ta=/[^.]+$/.exec(na&&na.keys&&na.keys.IE_PROTO||""))?"Symbol(src)_1."+ta:"";var aa=function(t){return!!ia&&ia in t},ra=Function.prototype.toString;var oa=function(t){if(null!=t){try{return ra.call(t)}catch(t){}try{return t+""}catch(t){}}return""},la=/^\[object .+?Constructor\]$/,sa=Function.prototype,ua=Object.prototype,da=sa.toString,ha=ua.hasOwnProperty,fa=RegExp("^"+da.call(ha).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ca=function(t){return!(!Ki(t)||aa(t))&&(ea(t)?fa:la).test(oa(t))};var pa=function(t,e){return null==t?void 0:t[e]};var ga=function(t,e){var n=pa(t,e);return ca(n)?n:void 0},ya=ga(Vi,"Map"),va=ga(Object,"create");var xa=function(){this.__data__=va?va(null):{},this.size=0};var _a=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ma=Object.prototype.hasOwnProperty;var ba=function(t){var e=this.__data__;if(va){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return ma.call(e,t)?e[t]:void 0},wa=Object.prototype.hasOwnProperty;var ka=function(t){var e=this.__data__;return va?void 0!==e[t]:wa.call(e,t)};var Sa=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=va&&void 0===e?"__lodash_hash_undefined__":e,this};function Aa(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Aa.prototype.clear=xa,Aa.prototype.delete=_a,Aa.prototype.get=ba,Aa.prototype.has=ka,Aa.prototype.set=Sa;var Pa=Aa;var Ca=function(){this.size=0,this.__data__={hash:new Pa,map:new(ya||Li),string:new Pa}};var Da=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var Oa=function(t,e){var n=t.__data__;return Da(e)?n["string"==typeof e?"string":"hash"]:n.map};var Ta=function(t){var e=Oa(this,t).delete(t);return this.size-=e?1:0,e};var Ma=function(t){return Oa(this,t).get(t)};var Ea=function(t){return Oa(this,t).has(t)};var Ra=function(t,e){var n=Oa(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this};function Ia(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Ia.prototype.clear=Ca,Ia.prototype.delete=Ta,Ia.prototype.get=Ma,Ia.prototype.has=Ea,Ia.prototype.set=Ra;var La=Ia;var Fa=function(t,e){var n=this.__data__;if(n instanceof Li){var i=n.__data__;if(!ya||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new La(i)}return n.set(t,e),this.size=n.size,this};function Na(t){var e=this.__data__=new Li(t);this.size=e.size}Na.prototype.clear=Fi,Na.prototype.delete=Ni,Na.prototype.get=Bi,Na.prototype.has=ji,Na.prototype.set=Fa;var Ba=Na;var ja=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t},za=function(){try{var t=ga(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Wa=function(t,e,n){"__proto__"==e&&za?za(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},Va=Object.prototype.hasOwnProperty;var Ga=function(t,e,n){var i=t[e];Va.call(t,e)&&Ci(i,n)&&(void 0!==n||e in t)||Wa(t,e,n)};var Ha=function(t,e,n,i){var a=!n;n||(n={});for(var r=-1,o=e.length;++r<o;){var l=e[r],s=i?i(n[l],t[l],l,n,t):void 0;void 0===s&&(s=t[l]),a?Wa(n,l,s):Ga(n,l,s)}return n};var Ya=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i};var Xa=function(t){return null!=t&&"object"==typeof t};var Ua=function(t){return Xa(t)&&"[object Arguments]"==Qi(t)},qa=Object.prototype,$a=qa.hasOwnProperty,Ja=qa.propertyIsEnumerable,Za=Ua(function(){return arguments}())?Ua:function(t){return Xa(t)&&$a.call(t,"callee")&&!Ja.call(t,"callee")},Qa=Array.isArray;var Ka=function(){return!1},tr=n((function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,a=i&&i.exports===n?Vi.Buffer:void 0,r=(a?a.isBuffer:void 0)||Ka;t.exports=r})),er=/^(?:0|[1-9]\d*)$/;var nr=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&er.test(t))&&t>-1&&t%1==0&&t<e};var ir=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},ar={};ar["[object Float32Array]"]=ar["[object Float64Array]"]=ar["[object Int8Array]"]=ar["[object Int16Array]"]=ar["[object Int32Array]"]=ar["[object Uint8Array]"]=ar["[object Uint8ClampedArray]"]=ar["[object Uint16Array]"]=ar["[object Uint32Array]"]=!0,ar["[object Arguments]"]=ar["[object Array]"]=ar["[object ArrayBuffer]"]=ar["[object Boolean]"]=ar["[object DataView]"]=ar["[object Date]"]=ar["[object Error]"]=ar["[object Function]"]=ar["[object Map]"]=ar["[object Number]"]=ar["[object Object]"]=ar["[object RegExp]"]=ar["[object Set]"]=ar["[object String]"]=ar["[object WeakMap]"]=!1;var rr=function(t){return Xa(t)&&ir(t.length)&&!!ar[Qi(t)]};var or=function(t){return function(e){return t(e)}},lr=n((function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,a=i&&i.exports===n&&zi.process,r=function(){try{var t=i&&i.require&&i.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=r})),sr=lr&&lr.isTypedArray,ur=sr?or(sr):rr,dr=Object.prototype.hasOwnProperty;var hr=function(t,e){var n=Qa(t),i=!n&&Za(t),a=!n&&!i&&tr(t),r=!n&&!i&&!a&&ur(t),o=n||i||a||r,l=o?Ya(t.length,String):[],s=l.length;for(var u in t)!e&&!dr.call(t,u)||o&&("length"==u||a&&("offset"==u||"parent"==u)||r&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||nr(u,s))||l.push(u);return l},fr=Object.prototype;var cr=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||fr)};var pr=function(t,e){return function(n){return t(e(n))}},gr=pr(Object.keys,Object),yr=Object.prototype.hasOwnProperty;var vr=function(t){if(!cr(t))return gr(t);var e=[];for(var n in Object(t))yr.call(t,n)&&"constructor"!=n&&e.push(n);return e};var xr=function(t){return null!=t&&ir(t.length)&&!ea(t)};var _r=function(t){return xr(t)?hr(t):vr(t)};var mr=function(t,e){return t&&Ha(e,_r(e),t)};var br=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e},wr=Object.prototype.hasOwnProperty;var kr=function(t){if(!Ki(t))return br(t);var e=cr(t),n=[];for(var i in t)("constructor"!=i||!e&&wr.call(t,i))&&n.push(i);return n};var Sr=function(t){return xr(t)?hr(t,!0):kr(t)};var Ar=function(t,e){return t&&Ha(e,Sr(e),t)},Pr=n((function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,a=i&&i.exports===n?Vi.Buffer:void 0,r=a?a.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,i=r?r(n):new t.constructor(n);return t.copy(i),i}}));var Cr=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e};var Dr=function(t,e){for(var n=-1,i=null==t?0:t.length,a=0,r=[];++n<i;){var o=t[n];e(o,n,t)&&(r[a++]=o)}return r};var Or=function(){return[]},Tr=Object.prototype.propertyIsEnumerable,Mr=Object.getOwnPropertySymbols,Er=Mr?function(t){return null==t?[]:(t=Object(t),Dr(Mr(t),(function(e){return Tr.call(t,e)})))}:Or;var Rr=function(t,e){return Ha(t,Er(t),e)};var Ir=function(t,e){for(var n=-1,i=e.length,a=t.length;++n<i;)t[a+n]=e[n];return t},Lr=pr(Object.getPrototypeOf,Object),Fr=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Ir(e,Er(t)),t=Lr(t);return e}:Or;var Nr=function(t,e){return Ha(t,Fr(t),e)};var Br=function(t,e,n){var i=e(t);return Qa(t)?i:Ir(i,n(t))};var jr=function(t){return Br(t,_r,Er)};var zr=function(t){return Br(t,Sr,Fr)},Wr=ga(Vi,"DataView"),Vr=ga(Vi,"Promise"),Gr=ga(Vi,"Set"),Hr=ga(Vi,"WeakMap"),Yr="[object Map]",Xr="[object Promise]",Ur="[object Set]",qr="[object WeakMap]",$r="[object DataView]",Jr=oa(Wr),Zr=oa(ya),Qr=oa(Vr),Kr=oa(Gr),to=oa(Hr),eo=Qi;(Wr&&eo(new Wr(new ArrayBuffer(1)))!=$r||ya&&eo(new ya)!=Yr||Vr&&eo(Vr.resolve())!=Xr||Gr&&eo(new Gr)!=Ur||Hr&&eo(new Hr)!=qr)&&(eo=function(t){var e=Qi(t),n="[object Object]"==e?t.constructor:void 0,i=n?oa(n):"";if(i)switch(i){case Jr:return $r;case Zr:return Yr;case Qr:return Xr;case Kr:return Ur;case to:return qr}return e});var no=eo,io=Object.prototype.hasOwnProperty;var ao=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&io.call(t,"index")&&(n.index=t.index,n.input=t.input),n},ro=Vi.Uint8Array;var oo=function(t){var e=new t.constructor(t.byteLength);return new ro(e).set(new ro(t)),e};var lo=function(t,e){var n=e?oo(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)},so=/\w*$/;var uo=function(t){var e=new t.constructor(t.source,so.exec(t));return e.lastIndex=t.lastIndex,e},ho=Gi?Gi.prototype:void 0,fo=ho?ho.valueOf:void 0;var co=function(t){return fo?Object(fo.call(t)):{}};var po=function(t,e){var n=e?oo(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)};var go=function(t,e,n){var i=t.constructor;switch(e){case"[object ArrayBuffer]":return oo(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return lo(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return po(t,n);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return uo(t);case"[object Symbol]":return co(t)}},yo=Object.create,vo=function(){function t(){}return function(e){if(!Ki(e))return{};if(yo)return yo(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var xo=function(t){return"function"!=typeof t.constructor||cr(t)?{}:vo(Lr(t))};var _o=function(t){return Xa(t)&&"[object Map]"==no(t)},mo=lr&&lr.isMap,bo=mo?or(mo):_o;var wo=function(t){return Xa(t)&&"[object Set]"==no(t)},ko=lr&&lr.isSet,So=ko?or(ko):wo,Ao="[object Arguments]",Po="[object Function]",Co="[object Object]",Do={};Do[Ao]=Do["[object Array]"]=Do["[object ArrayBuffer]"]=Do["[object DataView]"]=Do["[object Boolean]"]=Do["[object Date]"]=Do["[object Float32Array]"]=Do["[object Float64Array]"]=Do["[object Int8Array]"]=Do["[object Int16Array]"]=Do["[object Int32Array]"]=Do["[object Map]"]=Do["[object Number]"]=Do[Co]=Do["[object RegExp]"]=Do["[object Set]"]=Do["[object String]"]=Do["[object Symbol]"]=Do["[object Uint8Array]"]=Do["[object Uint8ClampedArray]"]=Do["[object Uint16Array]"]=Do["[object Uint32Array]"]=!0,Do["[object Error]"]=Do[Po]=Do["[object WeakMap]"]=!1;var Oo=function t(e,n,i,a,r,o){var l,s=1&n,u=2&n,d=4&n;if(i&&(l=r?i(e,a,r,o):i(e)),void 0!==l)return l;if(!Ki(e))return e;var h=Qa(e);if(h){if(l=ao(e),!s)return Cr(e,l)}else{var f=no(e),c=f==Po||"[object GeneratorFunction]"==f;if(tr(e))return Pr(e,s);if(f==Co||f==Ao||c&&!r){if(l=u||c?{}:xo(e),!s)return u?Nr(e,Ar(l,e)):Rr(e,mr(l,e))}else{if(!Do[f])return r?e:{};l=go(e,f,s)}}o||(o=new Ba);var p=o.get(e);if(p)return p;o.set(e,l),So(e)?e.forEach((function(a){l.add(t(a,n,i,a,e,o))})):bo(e)&&e.forEach((function(a,r){l.set(r,t(a,n,i,r,e,o))}));var g=h?void 0:(d?u?zr:jr:u?Sr:_r)(e);return ja(g||e,(function(a,r){g&&(a=e[r=a]),Ga(l,r,t(a,n,i,r,e,o))})),l};var To=function(t){return Oo(t,4)};var Mo=function(t){return function(){return t}};var Eo=function(t){return function(e,n,i){for(var a=-1,r=Object(e),o=i(e),l=o.length;l--;){var s=o[t?l:++a];if(!1===n(r[s],s,r))break}return e}},Ro=Eo();var Io=function(t,e){return t&&Ro(t,e,_r)};var Lo=function(t,e){return function(n,i){if(null==n)return n;if(!xr(n))return t(n,i);for(var a=n.length,r=e?a:-1,o=Object(n);(e?r--:++r<a)&&!1!==i(o[r],r,o););return n}},Fo=Lo(Io);var No=function(t){return t};var Bo=function(t){return"function"==typeof t?t:No};var jo=function(t,e){return(Qa(t)?ja:Fo)(t,Bo(e))},zo=jo;var Wo=function(t,e){var n=[];return Fo(t,(function(t,i,a){e(t,i,a)&&n.push(t)})),n};var Vo=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var Go=function(t){return this.__data__.has(t)};function Ho(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new La;++e<n;)this.add(t[e])}Ho.prototype.add=Ho.prototype.push=Vo,Ho.prototype.has=Go;var Yo=Ho;var Xo=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1};var Uo=function(t,e){return t.has(e)};var qo=function(t,e,n,i,a,r){var o=1&n,l=t.length,s=e.length;if(l!=s&&!(o&&s>l))return!1;var u=r.get(t),d=r.get(e);if(u&&d)return u==e&&d==t;var h=-1,f=!0,c=2&n?new Yo:void 0;for(r.set(t,e),r.set(e,t);++h<l;){var p=t[h],g=e[h];if(i)var y=o?i(g,p,h,e,t,r):i(p,g,h,t,e,r);if(void 0!==y){if(y)continue;f=!1;break}if(c){if(!Xo(e,(function(t,e){if(!Uo(c,e)&&(p===t||a(p,t,n,i,r)))return c.push(e)}))){f=!1;break}}else if(p!==g&&!a(p,g,n,i,r)){f=!1;break}}return r.delete(t),r.delete(e),f};var $o=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n};var Jo=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n},Zo=Gi?Gi.prototype:void 0,Qo=Zo?Zo.valueOf:void 0;var Ko=function(t,e,n,i,a,r,o){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!r(new ro(t),new ro(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ci(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var l=$o;case"[object Set]":var s=1&i;if(l||(l=Jo),t.size!=e.size&&!s)return!1;var u=o.get(t);if(u)return u==e;i|=2,o.set(t,e);var d=qo(l(t),l(e),i,a,r,o);return o.delete(t),d;case"[object Symbol]":if(Qo)return Qo.call(t)==Qo.call(e)}return!1},tl=Object.prototype.hasOwnProperty;var el=function(t,e,n,i,a,r){var o=1&n,l=jr(t),s=l.length;if(s!=jr(e).length&&!o)return!1;for(var u=s;u--;){var d=l[u];if(!(o?d in e:tl.call(e,d)))return!1}var h=r.get(t),f=r.get(e);if(h&&f)return h==e&&f==t;var c=!0;r.set(t,e),r.set(e,t);for(var p=o;++u<s;){var g=t[d=l[u]],y=e[d];if(i)var v=o?i(y,g,d,e,t,r):i(g,y,d,t,e,r);if(!(void 0===v?g===y||a(g,y,n,i,r):v)){c=!1;break}p||(p="constructor"==d)}if(c&&!p){var x=t.constructor,_=e.constructor;x==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof x&&x instanceof x&&"function"==typeof _&&_ instanceof _||(c=!1)}return r.delete(t),r.delete(e),c},nl="[object Arguments]",il="[object Array]",al="[object Object]",rl=Object.prototype.hasOwnProperty;var ol=function(t,e,n,i,a,r){var o=Qa(t),l=Qa(e),s=o?il:no(t),u=l?il:no(e),d=(s=s==nl?al:s)==al,h=(u=u==nl?al:u)==al,f=s==u;if(f&&tr(t)){if(!tr(e))return!1;o=!0,d=!1}if(f&&!d)return r||(r=new Ba),o||ur(t)?qo(t,e,n,i,a,r):Ko(t,e,s,n,i,a,r);if(!(1&n)){var c=d&&rl.call(t,"__wrapped__"),p=h&&rl.call(e,"__wrapped__");if(c||p){var g=c?t.value():t,y=p?e.value():e;return r||(r=new Ba),a(g,y,n,i,r)}}return!!f&&(r||(r=new Ba),el(t,e,n,i,a,r))};var ll=function t(e,n,i,a,r){return e===n||(null==e||null==n||!Xa(e)&&!Xa(n)?e!=e&&n!=n:ol(e,n,i,a,t,r))};var sl=function(t,e,n,i){var a=n.length,r=a,o=!i;if(null==t)return!r;for(t=Object(t);a--;){var l=n[a];if(o&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++a<r;){var s=(l=n[a])[0],u=t[s],d=l[1];if(o&&l[2]){if(void 0===u&&!(s in t))return!1}else{var h=new Ba;if(i)var f=i(u,d,s,t,e,h);if(!(void 0===f?ll(d,u,3,i,h):f))return!1}}return!0};var ul=function(t){return t==t&&!Ki(t)};var dl=function(t){for(var e=_r(t),n=e.length;n--;){var i=e[n],a=t[i];e[n]=[i,a,ul(a)]}return e};var hl=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}};var fl=function(t){var e=dl(t);return 1==e.length&&e[0][2]?hl(e[0][0],e[0][1]):function(n){return n===t||sl(n,t,e)}};var cl=function(t){return"symbol"==typeof t||Xa(t)&&"[object Symbol]"==Qi(t)},pl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,gl=/^\w*$/;var yl=function(t,e){if(Qa(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!cl(t))||(gl.test(t)||!pl.test(t)||null!=e&&t in Object(e))};function vl(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var i=arguments,a=e?e.apply(this,i):i[0],r=n.cache;if(r.has(a))return r.get(a);var o=t.apply(this,i);return n.cache=r.set(a,o)||r,o};return n.cache=new(vl.Cache||La),n}vl.Cache=La;var xl=vl;var _l=function(t){var e=xl(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e},ml=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bl=/\\(\\)?/g,wl=_l((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ml,(function(t,n,i,a){e.push(i?a.replace(bl,"$1"):n||t)})),e}));var kl=function(t,e){for(var n=-1,i=null==t?0:t.length,a=Array(i);++n<i;)a[n]=e(t[n],n,t);return a},Sl=Gi?Gi.prototype:void 0,Al=Sl?Sl.toString:void 0;var Pl=function t(e){if("string"==typeof e)return e;if(Qa(e))return kl(e,t)+"";if(cl(e))return Al?Al.call(e):"";var n=e+"";return"0"==n&&1/e==-Infinity?"-0":n};var Cl=function(t){return null==t?"":Pl(t)};var Dl=function(t,e){return Qa(t)?t:yl(t,e)?[t]:wl(Cl(t))};var Ol=function(t){if("string"==typeof t||cl(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e};var Tl=function(t,e){for(var n=0,i=(e=Dl(e,t)).length;null!=t&&n<i;)t=t[Ol(e[n++])];return n&&n==i?t:void 0};var Ml=function(t,e,n){var i=null==t?void 0:Tl(t,e);return void 0===i?n:i};var El=function(t,e){return null!=t&&e in Object(t)};var Rl=function(t,e,n){for(var i=-1,a=(e=Dl(e,t)).length,r=!1;++i<a;){var o=Ol(e[i]);if(!(r=null!=t&&n(t,o)))break;t=t[o]}return r||++i!=a?r:!!(a=null==t?0:t.length)&&ir(a)&&nr(o,a)&&(Qa(t)||Za(t))};var Il=function(t,e){return null!=t&&Rl(t,e,El)};var Ll=function(t,e){return yl(t)&&ul(e)?hl(Ol(t),e):function(n){var i=Ml(n,t);return void 0===i&&i===e?Il(n,t):ll(e,i,3)}};var Fl=function(t){return function(e){return null==e?void 0:e[t]}};var Nl=function(t){return function(e){return Tl(e,t)}};var Bl=function(t){return yl(t)?Fl(Ol(t)):Nl(t)};var jl=function(t){return"function"==typeof t?t:null==t?No:"object"==typeof t?Qa(t)?Ll(t[0],t[1]):fl(t):Bl(t)};var zl=function(t,e){return(Qa(t)?Dr:Wo)(t,jl(e))},Wl=Object.prototype.hasOwnProperty;var Vl=function(t,e){return null!=t&&Wl.call(t,e)};var Gl=function(t,e){return null!=t&&Rl(t,e,Vl)},Hl=Object.prototype.hasOwnProperty;var Yl=function(t){if(null==t)return!0;if(xr(t)&&(Qa(t)||"string"==typeof t||"function"==typeof t.splice||tr(t)||ur(t)||Za(t)))return!t.length;var e=no(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(cr(t))return!vr(t).length;for(var n in t)if(Hl.call(t,n))return!1;return!0};var Xl=function(t){return void 0===t};var Ul=function(t,e){var n=-1,i=xr(t)?Array(t.length):[];return Fo(t,(function(t,a,r){i[++n]=e(t,a,r)})),i};var ql=function(t,e){return(Qa(t)?kl:Ul)(t,jl(e))};var $l=function(t,e,n,i){var a=-1,r=null==t?0:t.length;for(i&&r&&(n=t[++a]);++a<r;)n=e(n,t[a],a,t);return n};var Jl=function(t,e,n,i,a){return a(t,(function(t,a,r){n=i?(i=!1,t):e(n,t,a,r)})),n};var Zl=function(t,e,n){var i=Qa(t)?$l:Jl,a=arguments.length<3;return i(t,jl(e),n,a,Fo)};var Ql=function(t){return"string"==typeof t||!Qa(t)&&Xa(t)&&"[object String]"==Qi(t)},Kl=Fl("length"),ts=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var es=function(t){return ts.test(t)},ns="\\ud800-\\udfff",is="["+ns+"]",as="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",rs="\\ud83c[\\udffb-\\udfff]",os="[^"+ns+"]",ls="(?:\\ud83c[\\udde6-\\uddff]){2}",ss="[\\ud800-\\udbff][\\udc00-\\udfff]",us="(?:"+as+"|"+rs+")"+"?",ds="[\\ufe0e\\ufe0f]?",hs=ds+us+("(?:\\u200d(?:"+[os,ls,ss].join("|")+")"+ds+us+")*"),fs="(?:"+[os+as+"?",as,ls,ss,is].join("|")+")",cs=RegExp(rs+"(?="+rs+")|"+fs+hs,"g");var ps=function(t){for(var e=cs.lastIndex=0;cs.test(t);)++e;return e};var gs=function(t){return es(t)?ps(t):Kl(t)};var ys=function(t){if(null==t)return 0;if(xr(t))return Ql(t)?gs(t):t.length;var e=no(t);return"[object Map]"==e||"[object Set]"==e?t.size:vr(t).length};var vs=function(t,e,n){var i=Qa(t),a=i||tr(t)||ur(t);if(e=jl(e),null==n){var r=t&&t.constructor;n=a?i?new r:[]:Ki(t)&&ea(r)?vo(Lr(t)):{}}return(a?ja:Io)(t,(function(t,i,a){return e(n,t,i,a)})),n},xs=Gi?Gi.isConcatSpreadable:void 0;var _s=function(t){return Qa(t)||Za(t)||!!(xs&&t&&t[xs])};var ms=function t(e,n,i,a,r){var o=-1,l=e.length;for(i||(i=_s),r||(r=[]);++o<l;){var s=e[o];n>0&&i(s)?n>1?t(s,n-1,i,a,r):Ir(r,s):a||(r[r.length]=s)}return r};var bs=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},ws=Math.max;var ks=function(t,e,n){return e=ws(void 0===e?t.length-1:e,0),function(){for(var i=arguments,a=-1,r=ws(i.length-e,0),o=Array(r);++a<r;)o[a]=i[e+a];a=-1;for(var l=Array(e+1);++a<e;)l[a]=i[a];return l[e]=n(o),bs(t,this,l)}},Ss=za?function(t,e){return za(t,"toString",{configurable:!0,enumerable:!1,value:Mo(e),writable:!0})}:No,As=Date.now;var Ps=function(t){var e=0,n=0;return function(){var i=As(),a=16-(i-n);if(n=i,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}},Cs=Ps(Ss);var Ds=function(t,e){return Cs(ks(t,e,No),t+"")};var Os=function(t,e,n,i){for(var a=t.length,r=n+(i?1:-1);i?r--:++r<a;)if(e(t[r],r,t))return r;return-1};var Ts=function(t){return t!=t};var Ms=function(t,e,n){for(var i=n-1,a=t.length;++i<a;)if(t[i]===e)return i;return-1};var Es=function(t,e,n){return e==e?Ms(t,e,n):Os(t,Ts,n)};var Rs=function(t,e){return!!(null==t?0:t.length)&&Es(t,e,0)>-1};var Is=function(t,e,n){for(var i=-1,a=null==t?0:t.length;++i<a;)if(n(e,t[i]))return!0;return!1};var Ls=function(){},Fs=Gr&&1/Jo(new Gr([,-0]))[1]==1/0?function(t){return new Gr(t)}:Ls,Ns=Fs;var Bs=function(t,e,n){var i=-1,a=Rs,r=t.length,o=!0,l=[],s=l;if(n)o=!1,a=Is;else if(r>=200){var u=e?null:Ns(t);if(u)return Jo(u);o=!1,a=Uo,s=new Yo}else s=e?[]:l;t:for(;++i<r;){var d=t[i],h=e?e(d):d;if(d=n||0!==d?d:0,o&&h==h){for(var f=s.length;f--;)if(s[f]===h)continue t;e&&s.push(h),l.push(d)}else a(s,h,n)||(s!==l&&s.push(h),l.push(d))}return l};var js=function(t){return Xa(t)&&xr(t)},zs=Ds((function(t){return Bs(ms(t,1,js,!0))})),Ws=zs;var Vs=function(t,e){return kl(e,(function(e){return t[e]}))};var Gs,Hs=function(t){return null==t?[]:Vs(t,_r(t))};try{Gs={clone:To,constant:Mo,each:zo,filter:zl,has:Gl,isArray:Qa,isEmpty:Yl,isFunction:ea,isUndefined:Xl,keys:_r,map:ql,reduce:Zl,size:ys,transform:vs,union:Ws,values:Hs}}catch(t){}Gs||(Gs=window._);var Ys=Gs,Xs=Js,Us="\0",qs="\0",$s="";function Js(t){this._isDirected=!Ys.has(t,"directed")||t.directed,this._isMultigraph=!!Ys.has(t,"multigraph")&&t.multigraph,this._isCompound=!!Ys.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=Ys.constant(void 0),this._defaultEdgeLabelFn=Ys.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[qs]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function Zs(t,e){t[e]?t[e]++:t[e]=1}function Qs(t,e){--t[e]||delete t[e]}function Ks(t,e,n,i){var a=""+e,r=""+n;if(!t&&a>r){var o=a;a=r,r=o}return a+$s+r+$s+(Ys.isUndefined(i)?Us:i)}function tu(t,e){return Ks(t,e.v,e.w,e.name)}Js.prototype._nodeCount=0,Js.prototype._edgeCount=0,Js.prototype.isDirected=function(){return this._isDirected},Js.prototype.isMultigraph=function(){return this._isMultigraph},Js.prototype.isCompound=function(){return this._isCompound},Js.prototype.setGraph=function(t){return this._label=t,this},Js.prototype.graph=function(){return this._label},Js.prototype.setDefaultNodeLabel=function(t){return Ys.isFunction(t)||(t=Ys.constant(t)),this._defaultNodeLabelFn=t,this},Js.prototype.nodeCount=function(){return this._nodeCount},Js.prototype.nodes=function(){return Ys.keys(this._nodes)},Js.prototype.sources=function(){var t=this;return Ys.filter(this.nodes(),(function(e){return Ys.isEmpty(t._in[e])}))},Js.prototype.sinks=function(){var t=this;return Ys.filter(this.nodes(),(function(e){return Ys.isEmpty(t._out[e])}))},Js.prototype.setNodes=function(t,e){var n=arguments,i=this;return Ys.each(t,(function(t){n.length>1?i.setNode(t,e):i.setNode(t)})),this},Js.prototype.setNode=function(t,e){return Ys.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=qs,this._children[t]={},this._children[qs][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},Js.prototype.node=function(t){return this._nodes[t]},Js.prototype.hasNode=function(t){return Ys.has(this._nodes,t)},Js.prototype.removeNode=function(t){var e=this;if(Ys.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],Ys.each(this.children(t),(function(t){e.setParent(t)})),delete this._children[t]),Ys.each(Ys.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],Ys.each(Ys.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},Js.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(Ys.isUndefined(e))e=qs;else{for(var n=e+="";!Ys.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},Js.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},Js.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==qs)return e}},Js.prototype.children=function(t){if(Ys.isUndefined(t)&&(t=qs),this._isCompound){var e=this._children[t];if(e)return Ys.keys(e)}else{if(t===qs)return this.nodes();if(this.hasNode(t))return[]}},Js.prototype.predecessors=function(t){var e=this._preds[t];if(e)return Ys.keys(e)},Js.prototype.successors=function(t){var e=this._sucs[t];if(e)return Ys.keys(e)},Js.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return Ys.union(e,this.successors(t))},Js.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},Js.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var n=this;Ys.each(this._nodes,(function(n,i){t(i)&&e.setNode(i,n)})),Ys.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,n.edge(t))}));var i={};function a(t){var r=n.parent(t);return void 0===r||e.hasNode(r)?(i[t]=r,r):r in i?i[r]:a(r)}return this._isCompound&&Ys.each(e.nodes(),(function(t){e.setParent(t,a(t))})),e},Js.prototype.setDefaultEdgeLabel=function(t){return Ys.isFunction(t)||(t=Ys.constant(t)),this._defaultEdgeLabelFn=t,this},Js.prototype.edgeCount=function(){return this._edgeCount},Js.prototype.edges=function(){return Ys.values(this._edgeObjs)},Js.prototype.setPath=function(t,e){var n=this,i=arguments;return Ys.reduce(t,(function(t,a){return i.length>1?n.setEdge(t,a,e):n.setEdge(t,a),a})),this},Js.prototype.setEdge=function(){var t,e,n,i,a=!1,r=arguments[0];"object"==typeof r&&null!==r&&"v"in r?(t=r.v,e=r.w,n=r.name,2===arguments.length&&(i=arguments[1],a=!0)):(t=r,e=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],a=!0)),t=""+t,e=""+e,Ys.isUndefined(n)||(n=""+n);var o=Ks(this._isDirected,t,e,n);if(Ys.has(this._edgeLabels,o))return a&&(this._edgeLabels[o]=i),this;if(!Ys.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[o]=a?i:this._defaultEdgeLabelFn(t,e,n);var l=function(t,e,n,i){var a=""+e,r=""+n;if(!t&&a>r){var o=a;a=r,r=o}var l={v:a,w:r};i&&(l.name=i);return l}(this._isDirected,t,e,n);return t=l.v,e=l.w,Object.freeze(l),this._edgeObjs[o]=l,Zs(this._preds[e],t),Zs(this._sucs[t],e),this._in[e][o]=l,this._out[t][o]=l,this._edgeCount++,this},Js.prototype.edge=function(t,e,n){var i=1===arguments.length?tu(this._isDirected,arguments[0]):Ks(this._isDirected,t,e,n);return this._edgeLabels[i]},Js.prototype.hasEdge=function(t,e,n){var i=1===arguments.length?tu(this._isDirected,arguments[0]):Ks(this._isDirected,t,e,n);return Ys.has(this._edgeLabels,i)},Js.prototype.removeEdge=function(t,e,n){var i=1===arguments.length?tu(this._isDirected,arguments[0]):Ks(this._isDirected,t,e,n),a=this._edgeObjs[i];return a&&(t=a.v,e=a.w,delete this._edgeLabels[i],delete this._edgeObjs[i],Qs(this._preds[e],t),Qs(this._sucs[t],e),delete this._in[e][i],delete this._out[t][i],this._edgeCount--),this},Js.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var i=Ys.values(n);return e?Ys.filter(i,(function(t){return t.v===e})):i}},Js.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var i=Ys.values(n);return e?Ys.filter(i,(function(t){return t.w===e})):i}},Js.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))};var eu={Graph:Xs,version:"2.1.8"},nu={write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:iu(t),edges:au(t)};Ys.isUndefined(t.graph())||(e.value=Ys.clone(t.graph()));return e},read:function(t){var e=new Xs(t.options).setGraph(t.value);return Ys.each(t.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),Ys.each(t.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}};function iu(t){return Ys.map(t.nodes(),(function(e){var n=t.node(e),i=t.parent(e),a={v:e};return Ys.isUndefined(n)||(a.value=n),Ys.isUndefined(i)||(a.parent=i),a}))}function au(t){return Ys.map(t.edges(),(function(e){var n=t.edge(e),i={v:e.v,w:e.w};return Ys.isUndefined(e.name)||(i.name=e.name),Ys.isUndefined(n)||(i.value=n),i}))}var ru=function(t){var e,n={},i=[];function a(i){Ys.has(n,i)||(n[i]=!0,e.push(i),Ys.each(t.successors(i),a),Ys.each(t.predecessors(i),a))}return Ys.each(t.nodes(),(function(t){e=[],a(t),e.length&&i.push(e)})),i};var ou=lu;function lu(){this._arr=[],this._keyIndices={}}lu.prototype.size=function(){return this._arr.length},lu.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},lu.prototype.has=function(t){return Ys.has(this._keyIndices,t)},lu.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},lu.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},lu.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),!Ys.has(n,t)){var i=this._arr,a=i.length;return n[t]=a,i.push({key:t,priority:e}),this._decrease(a),!0}return!1},lu.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},lu.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},lu.prototype._heapify=function(t){var e=this._arr,n=2*t,i=n+1,a=t;n<e.length&&(a=e[n].priority<e[a].priority?n:a,i<e.length&&(a=e[i].priority<e[a].priority?i:a),a!==t&&(this._swap(t,a),this._heapify(a)))},lu.prototype._decrease=function(t){for(var e,n=this._arr,i=n[t].priority;0!==t&&!(n[e=t>>1].priority<i);)this._swap(t,e),t=e},lu.prototype._swap=function(t,e){var n=this._arr,i=this._keyIndices,a=n[t],r=n[e];n[t]=r,n[e]=a,i[r.key]=t,i[a.key]=e};var su=function(t,e,n,i){return function(t,e,n,i){var a,r,o={},l=new ou,s=function(t){var e=t.v!==a?t.v:t.w,i=o[e],s=n(t),u=r.distance+s;if(s<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+s);u<i.distance&&(i.distance=u,i.predecessor=a,l.decrease(e,u))};t.nodes().forEach((function(t){var n=t===e?0:Number.POSITIVE_INFINITY;o[t]={distance:n},l.add(t,n)}));for(;l.size()>0&&(a=l.removeMin(),(r=o[a]).distance!==Number.POSITIVE_INFINITY);)i(a).forEach(s);return o}(t,String(e),n||uu,i||function(e){return t.outEdges(e)})},uu=Ys.constant(1);var du=function(t,e,n){return Ys.transform(t.nodes(),(function(i,a){i[a]=su(t,a,e,n)}),{})};var hu=function(t){var e=0,n=[],i={},a=[];function r(o){var l=i[o]={onStack:!0,lowlink:e,index:e++};if(n.push(o),t.successors(o).forEach((function(t){Ys.has(i,t)?i[t].onStack&&(l.lowlink=Math.min(l.lowlink,i[t].index)):(r(t),l.lowlink=Math.min(l.lowlink,i[t].lowlink))})),l.lowlink===l.index){var s,u=[];do{s=n.pop(),i[s].onStack=!1,u.push(s)}while(o!==s);a.push(u)}}return t.nodes().forEach((function(t){Ys.has(i,t)||r(t)})),a};var fu=function(t){return Ys.filter(hu(t),(function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))};var cu=function(t,e,n){return function(t,e,n){var i={},a=t.nodes();return a.forEach((function(t){i[t]={},i[t][t]={distance:0},a.forEach((function(e){t!==e&&(i[t][e]={distance:Number.POSITIVE_INFINITY})})),n(t).forEach((function(n){var a=n.v===t?n.w:n.v,r=e(n);i[t][a]={distance:r,predecessor:t}}))})),a.forEach((function(t){var e=i[t];a.forEach((function(n){var r=i[n];a.forEach((function(n){var i=r[t],a=e[n],o=r[n],l=i.distance+a.distance;l<o.distance&&(o.distance=l,o.predecessor=a.predecessor)}))}))})),i}(t,e||pu,n||function(e){return t.outEdges(e)})},pu=Ys.constant(1);var gu=yu;function yu(t){var e={},n={},i=[];if(Ys.each(t.sinks(),(function a(r){if(Ys.has(n,r))throw new vu;Ys.has(e,r)||(n[r]=!0,e[r]=!0,Ys.each(t.predecessors(r),a),delete n[r],i.push(r))})),Ys.size(e)!==t.nodeCount())throw new vu;return i}function vu(){}yu.CycleException=vu,vu.prototype=new Error;var xu=function(t,e,n){Ys.isArray(e)||(e=[e]);var i=(t.isDirected()?t.successors:t.neighbors).bind(t),a=[],r={};return Ys.each(e,(function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);_u(t,e,"post"===n,r,i,a)})),a};function _u(t,e,n,i,a,r){Ys.has(i,e)||(i[e]=!0,n||r.push(e),Ys.each(a(e),(function(e){_u(t,e,n,i,a,r)})),n&&r.push(e))}var mu,bu={Graph:eu.Graph,json:nu,alg:{components:ru,dijkstra:su,dijkstraAll:du,findCycles:fu,floydWarshall:cu,isAcyclic:function(t){try{gu(t)}catch(t){if(t instanceof gu.CycleException)return!1;throw t}return!0},postorder:function(t,e){return xu(t,e,"post")},preorder:function(t,e){return xu(t,e,"pre")},prim:function(t,e){var n,i=new Xs,a={},r=new ou;function o(t){var i=t.v===n?t.w:t.v,o=r.priority(i);if(void 0!==o){var l=e(t);l<o&&(a[i]=n,r.decrease(i,l))}}if(0===t.nodeCount())return i;Ys.each(t.nodes(),(function(t){r.add(t,Number.POSITIVE_INFINITY),i.setNode(t)})),r.decrease(t.nodes()[0],0);var l=!1;for(;r.size()>0;){if(n=r.removeMin(),Ys.has(a,n))i.setEdge(n,a[n]);else{if(l)throw new Error("Input graph is not connected: "+t);l=!0}t.nodeEdges(n).forEach(o)}return i},tarjan:hu,topsort:gu},version:eu.version};try{mu=bu}catch(t){}mu||(mu=window.graphlib);var wu=mu;var ku=function(t){return Oo(t,5)};var Su=function(t,e,n){if(!Ki(n))return!1;var i=typeof e;return!!("number"==i?xr(n)&&nr(e,n.length):"string"==i&&e in n)&&Ci(n[e],t)},Au=Object.prototype,Pu=Au.hasOwnProperty,Cu=Ds((function(t,e){t=Object(t);var n=-1,i=e.length,a=i>2?e[2]:void 0;for(a&&Su(e[0],e[1],a)&&(i=1);++n<i;)for(var r=e[n],o=Sr(r),l=-1,s=o.length;++l<s;){var u=o[l],d=t[u];(void 0===d||Ci(d,Au[u])&&!Pu.call(t,u))&&(t[u]=r[u])}return t})),Du=Cu;var Ou=function(t){return function(e,n,i){var a=Object(e);if(!xr(e)){var r=jl(n);e=_r(e),n=function(t){return r(a[t],t,a)}}var o=t(e,n,i);return o>-1?a[r?e[o]:o]:void 0}},Tu=/\s/;var Mu=function(t){for(var e=t.length;e--&&Tu.test(t.charAt(e)););return e},Eu=/^\s+/;var Ru=function(t){return t?t.slice(0,Mu(t)+1).replace(Eu,""):t},Iu=/^[-+]0x[0-9a-f]+$/i,Lu=/^0b[01]+$/i,Fu=/^0o[0-7]+$/i,Nu=parseInt;var Bu=function(t){if("number"==typeof t)return t;if(cl(t))return NaN;if(Ki(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ki(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ru(t);var n=Lu.test(t);return n||Fu.test(t)?Nu(t.slice(2),n?2:8):Iu.test(t)?NaN:+t},ju=1/0;var zu=function(t){return t?(t=Bu(t))===ju||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var Wu=function(t){var e=zu(t),n=e%1;return e==e?n?e-n:e:0},Vu=Math.max;var Gu=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var a=null==n?0:Wu(n);return a<0&&(a=Vu(i+a,0)),Os(t,jl(e),a)},Hu=Ou(Gu);var Yu=function(t){return(null==t?0:t.length)?ms(t,1):[]};var Xu=function(t,e){return null==t?t:Ro(t,Bo(e),Sr)};var Uu=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0};var qu=function(t,e){var n={};return e=jl(e),Io(t,(function(t,i,a){Wa(n,i,e(t,i,a))})),n};var $u=function(t,e,n){for(var i=-1,a=t.length;++i<a;){var r=t[i],o=e(r);if(null!=o&&(void 0===l?o==o&&!cl(o):n(o,l)))var l=o,s=r}return s};var Ju=function(t,e){return t>e};var Zu=function(t){return t&&t.length?$u(t,No,Ju):void 0};var Qu=function(t,e,n){(void 0!==n&&!Ci(t[e],n)||void 0===n&&!(e in t))&&Wa(t,e,n)},Ku=Function.prototype,td=Object.prototype,ed=Ku.toString,nd=td.hasOwnProperty,id=ed.call(Object);var ad=function(t){if(!Xa(t)||"[object Object]"!=Qi(t))return!1;var e=Lr(t);if(null===e)return!0;var n=nd.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&ed.call(n)==id};var rd=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var od=function(t){return Ha(t,Sr(t))};var ld=function(t,e,n,i,a,r,o){var l=rd(t,n),s=rd(e,n),u=o.get(s);if(u)Qu(t,n,u);else{var d=r?r(l,s,n+"",t,e,o):void 0,h=void 0===d;if(h){var f=Qa(s),c=!f&&tr(s),p=!f&&!c&&ur(s);d=s,f||c||p?Qa(l)?d=l:js(l)?d=Cr(l):c?(h=!1,d=Pr(s,!0)):p?(h=!1,d=po(s,!0)):d=[]:ad(s)||Za(s)?(d=l,Za(l)?d=od(l):Ki(l)&&!ea(l)||(d=xo(s))):h=!1}h&&(o.set(s,d),a(d,s,i,r,o),o.delete(s)),Qu(t,n,d)}};var sd=function t(e,n,i,a,r){e!==n&&Ro(n,(function(o,l){if(r||(r=new Ba),Ki(o))ld(e,n,l,i,t,a,r);else{var s=a?a(rd(e,l),o,l+"",e,n,r):void 0;void 0===s&&(s=o),Qu(e,l,s)}}),Sr)};var ud=function(t){return Ds((function(e,n){var i=-1,a=n.length,r=a>1?n[a-1]:void 0,o=a>2?n[2]:void 0;for(r=t.length>3&&"function"==typeof r?(a--,r):void 0,o&&Su(n[0],n[1],o)&&(r=a<3?void 0:r,a=1),e=Object(e);++i<a;){var l=n[i];l&&t(e,l,i,r)}return e}))},dd=ud((function(t,e,n){sd(t,e,n)}));var hd=function(t,e){return t<e};var fd=function(t){return t&&t.length?$u(t,No,hd):void 0};var cd=function(t,e){return t&&t.length?$u(t,jl(e),hd):void 0},pd=function(){return Vi.Date.now()};var gd=function(t,e,n,i){if(!Ki(t))return t;for(var a=-1,r=(e=Dl(e,t)).length,o=r-1,l=t;null!=l&&++a<r;){var s=Ol(e[a]),u=n;if("__proto__"===s||"constructor"===s||"prototype"===s)return t;if(a!=o){var d=l[s];void 0===(u=i?i(d,s,l):void 0)&&(u=Ki(d)?d:nr(e[a+1])?[]:{})}Ga(l,s,u),l=l[s]}return t};var yd=function(t,e,n){for(var i=-1,a=e.length,r={};++i<a;){var o=e[i],l=Tl(t,o);n(l,o)&&gd(r,Dl(o,t),l)}return r};var vd=function(t,e){return yd(t,e,(function(e,n){return Il(t,n)}))};var xd=function(t){return Cs(ks(t,void 0,Yu),t+"")}((function(t,e){return null==t?{}:vd(t,e)})),_d=Math.ceil,md=Math.max;var bd=function(t,e,n,i){for(var a=-1,r=md(_d((e-t)/(n||1)),0),o=Array(r);r--;)o[i?r:++a]=t,t+=n;return o};var wd=function(t){return function(e,n,i){return i&&"number"!=typeof i&&Su(e,n,i)&&(n=i=void 0),e=zu(e),void 0===n?(n=e,e=0):n=zu(n),i=void 0===i?e<n?1:-1:zu(i),bd(e,n,i,t)}}();var kd=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t};var Sd=function(t,e){if(t!==e){var n=void 0!==t,i=null===t,a=t==t,r=cl(t),o=void 0!==e,l=null===e,s=e==e,u=cl(e);if(!l&&!u&&!r&&t>e||r&&o&&s&&!l&&!u||i&&o&&s||!n&&s||!a)return 1;if(!i&&!r&&!u&&t<e||u&&n&&a&&!i&&!r||l&&n&&a||!o&&a||!s)return-1}return 0};var Ad=function(t,e,n){for(var i=-1,a=t.criteria,r=e.criteria,o=a.length,l=n.length;++i<o;){var s=Sd(a[i],r[i]);if(s)return i>=l?s:s*("desc"==n[i]?-1:1)}return t.index-e.index};var Pd=function(t,e,n){e=e.length?kl(e,(function(t){return Qa(t)?function(e){return Tl(e,1===t.length?t[0]:t)}:t})):[No];var i=-1;e=kl(e,or(jl));var a=Ul(t,(function(t,n,a){return{criteria:kl(e,(function(e){return e(t)})),index:++i,value:t}}));return kd(a,(function(t,e){return Ad(t,e,n)}))},Cd=Ds((function(t,e){if(null==t)return[];var n=e.length;return n>1&&Su(t,e[0],e[1])?e=[]:n>2&&Su(e[0],e[1],e[2])&&(e=[e[0]]),Pd(t,ms(e,1),[])})),Dd=0;var Od=function(t){var e=++Dd;return Cl(t)+e};var Td=function(t,e,n){for(var i=-1,a=t.length,r=e.length,o={};++i<a;){var l=i<r?e[i]:void 0;n(o,t[i],l)}return o};var Md,Ed=function(t,e){return Td(t||[],e||[],Ga)};try{Md={cloneDeep:ku,constant:Mo,defaults:Du,each:zo,filter:zl,find:Hu,flatten:Yu,forEach:jo,forIn:Xu,has:Gl,isUndefined:Xl,last:Uu,map:ql,mapValues:qu,max:Zu,merge:dd,min:fd,minBy:cd,now:pd,pick:xd,range:wd,reduce:Zl,sortBy:Cd,uniqueId:Od,values:Hs,zipObject:Ed}}catch(t){}Md||(Md=window._);var Rd=Md,Id=Ld;function Ld(){var t={};t._next=t._prev=t,this._sentinel=t}function Fd(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function Nd(t,e){if("_next"!==t&&"_prev"!==t)return e}Ld.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return Fd(e),e},Ld.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&Fd(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e},Ld.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,Nd)),n=n._prev;return"["+t.join(", ")+"]"};var Bd=wu.Graph,jd=function(t,e){if(t.nodeCount()<=1)return[];var n=function(t,e){var n=new Bd,i=0,a=0;Rd.forEach(t.nodes(),(function(t){n.setNode(t,{v:t,in:0,out:0})})),Rd.forEach(t.edges(),(function(t){var r=n.edge(t.v,t.w)||0,o=e(t),l=r+o;n.setEdge(t.v,t.w,l),a=Math.max(a,n.node(t.v).out+=o),i=Math.max(i,n.node(t.w).in+=o)}));var r=Rd.range(a+i+3).map((function(){return new Id})),o=i+1;return Rd.forEach(n.nodes(),(function(t){Vd(r,o,n.node(t))})),{graph:n,buckets:r,zeroIdx:o}}(t,e||zd),i=function(t,e,n){var i,a=[],r=e[e.length-1],o=e[0];for(;t.nodeCount();){for(;i=o.dequeue();)Wd(t,e,n,i);for(;i=r.dequeue();)Wd(t,e,n,i);if(t.nodeCount())for(var l=e.length-2;l>0;--l)if(i=e[l].dequeue()){a=a.concat(Wd(t,e,n,i,!0));break}}return a}(n.graph,n.buckets,n.zeroIdx);return Rd.flatten(Rd.map(i,(function(e){return t.outEdges(e.v,e.w)})),!0)},zd=Rd.constant(1);function Wd(t,e,n,i,a){var r=a?[]:void 0;return Rd.forEach(t.inEdges(i.v),(function(i){var o=t.edge(i),l=t.node(i.v);a&&r.push({v:i.v,w:i.w}),l.out-=o,Vd(e,n,l)})),Rd.forEach(t.outEdges(i.v),(function(i){var a=t.edge(i),r=i.w,o=t.node(r);o.in-=a,Vd(e,n,o)})),t.removeNode(i.v),r}function Vd(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}var Gd={run:function(t){var e="greedy"===t.graph().acyclicer?jd(t,function(t){return function(e){return t.edge(e).weight}}(t)):function(t){var e=[],n={},i={};function a(r){Rd.has(i,r)||(i[r]=!0,n[r]=!0,Rd.forEach(t.outEdges(r),(function(t){Rd.has(n,t.w)?e.push(t):a(t.w)})),delete n[r])}return Rd.forEach(t.nodes(),a),e}(t);Rd.forEach(e,(function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,Rd.uniqueId("rev"))}))},undo:function(t){Rd.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.reversed){t.removeEdge(e);var i=n.forwardName;delete n.reversed,delete n.forwardName,t.setEdge(e.w,e.v,n,i)}}))}};var Hd=wu.Graph,Yd={addDummyNode:Xd,simplify:function(t){var e=(new Hd).setGraph(t.graph());return Rd.forEach(t.nodes(),(function(n){e.setNode(n,t.node(n))})),Rd.forEach(t.edges(),(function(n){var i=e.edge(n.v,n.w)||{weight:0,minlen:1},a=t.edge(n);e.setEdge(n.v,n.w,{weight:i.weight+a.weight,minlen:Math.max(i.minlen,a.minlen)})})),e},asNonCompoundGraph:function(t){var e=new Hd({multigraph:t.isMultigraph()}).setGraph(t.graph());return Rd.forEach(t.nodes(),(function(n){t.children(n).length||e.setNode(n,t.node(n))})),Rd.forEach(t.edges(),(function(n){e.setEdge(n,t.edge(n))})),e},successorWeights:function(t){var e=Rd.map(t.nodes(),(function(e){var n={};return Rd.forEach(t.outEdges(e),(function(e){n[e.w]=(n[e.w]||0)+t.edge(e).weight})),n}));return Rd.zipObject(t.nodes(),e)},predecessorWeights:function(t){var e=Rd.map(t.nodes(),(function(e){var n={};return Rd.forEach(t.inEdges(e),(function(e){n[e.v]=(n[e.v]||0)+t.edge(e).weight})),n}));return Rd.zipObject(t.nodes(),e)},intersectRect:function(t,e){var n,i,a=t.x,r=t.y,o=e.x-a,l=e.y-r,s=t.width/2,u=t.height/2;if(!o&&!l)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(l)*s>Math.abs(o)*u?(l<0&&(u=-u),n=u*o/l,i=u):(o<0&&(s=-s),n=s,i=s*l/o);return{x:a+n,y:r+i}},buildLayerMatrix:function(t){var e=Rd.map(Rd.range(Ud(t)+1),(function(){return[]}));return Rd.forEach(t.nodes(),(function(n){var i=t.node(n),a=i.rank;Rd.isUndefined(a)||(e[a][i.order]=n)})),e},normalizeRanks:function(t){var e=Rd.min(Rd.map(t.nodes(),(function(e){return t.node(e).rank})));Rd.forEach(t.nodes(),(function(n){var i=t.node(n);Rd.has(i,"rank")&&(i.rank-=e)}))},removeEmptyRanks:function(t){var e=Rd.min(Rd.map(t.nodes(),(function(e){return t.node(e).rank}))),n=[];Rd.forEach(t.nodes(),(function(i){var a=t.node(i).rank-e;n[a]||(n[a]=[]),n[a].push(i)}));var i=0,a=t.graph().nodeRankFactor;Rd.forEach(n,(function(e,n){Rd.isUndefined(e)&&n%a!=0?--i:i&&Rd.forEach(e,(function(e){t.node(e).rank+=i}))}))},addBorderNode:function(t,e,n,i){var a={width:0,height:0};arguments.length>=4&&(a.rank=n,a.order=i);return Xd(t,"border",a,e)},maxRank:Ud,partition:function(t,e){var n={lhs:[],rhs:[]};return Rd.forEach(t,(function(t){e(t)?n.lhs.push(t):n.rhs.push(t)})),n},time:function(t,e){var n=Rd.now();try{return e()}finally{console.log(t+" time: "+(Rd.now()-n)+"ms")}},notime:function(t,e){return e()}};function Xd(t,e,n,i){var a;do{a=Rd.uniqueId(i)}while(t.hasNode(a));return n.dummy=e,t.setNode(a,n),a}function Ud(t){return Rd.max(Rd.map(t.nodes(),(function(e){var n=t.node(e).rank;if(!Rd.isUndefined(n))return n})))}var qd={run:function(t){t.graph().dummyChains=[],Rd.forEach(t.edges(),(function(e){!function(t,e){var n,i,a,r=e.v,o=t.node(r).rank,l=e.w,s=t.node(l).rank,u=e.name,d=t.edge(e),h=d.labelRank;if(s===o+1)return;for(t.removeEdge(e),a=0,++o;o<s;++a,++o)d.points=[],i={width:0,height:0,edgeLabel:d,edgeObj:e,rank:o},n=Yd.addDummyNode(t,"edge",i,"_d"),o===h&&(i.width=d.width,i.height=d.height,i.dummy="edge-label",i.labelpos=d.labelpos),t.setEdge(r,n,{weight:d.weight},u),0===a&&t.graph().dummyChains.push(n),r=n;t.setEdge(r,l,{weight:d.weight},u)}(t,e)}))},undo:function(t){Rd.forEach(t.graph().dummyChains,(function(e){var n,i=t.node(e),a=i.edgeLabel;for(t.setEdge(i.edgeObj,a);i.dummy;)n=t.successors(e)[0],t.removeNode(e),a.points.push({x:i.x,y:i.y}),"edge-label"===i.dummy&&(a.x=i.x,a.y=i.y,a.width=i.width,a.height=i.height),e=n,i=t.node(e)}))}};var $d=function(t){var e={};Rd.forEach(t.sources(),(function n(i){var a=t.node(i);if(Rd.has(e,i))return a.rank;e[i]=!0;var r=Rd.min(Rd.map(t.outEdges(i),(function(e){return n(e.w)-t.edge(e).minlen})));return r!==Number.POSITIVE_INFINITY&&null!=r||(r=0),a.rank=r}))},Jd=function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen};var Zd=wu.Graph,Qd=Jd,Kd=function(t){var e,n,i=new Zd({directed:!1}),a=t.nodes()[0],r=t.nodeCount();i.setNode(a,{});for(;th(i,t)<r;)e=eh(i,t),n=i.hasNode(e.v)?Qd(t,e):-Qd(t,e),nh(i,t,n);return i};function th(t,e){return Rd.forEach(t.nodes(),(function n(i){Rd.forEach(e.nodeEdges(i),(function(a){var r=a.v,o=i===r?a.w:r;t.hasNode(o)||Qd(e,a)||(t.setNode(o,{}),t.setEdge(i,o,{}),n(o))}))})),t.nodeCount()}function eh(t,e){return Rd.minBy(e.edges(),(function(n){if(t.hasNode(n.v)!==t.hasNode(n.w))return Qd(e,n)}))}function nh(t,e,n){Rd.forEach(t.nodes(),(function(t){e.node(t).rank+=n}))}var ih=Jd,ah=$d,rh=wu.alg.preorder,oh=wu.alg.postorder,lh=Yd.simplify,sh=uh;function uh(t){t=lh(t),ah(t);var e,n=Kd(t);for(fh(n),dh(n,t);e=ph(n);)yh(n,t,e,gh(n,t,e))}function dh(t,e){var n=oh(t,t.nodes());n=n.slice(0,n.length-1),Rd.forEach(n,(function(n){!function(t,e,n){var i=t.node(n),a=i.parent;t.edge(n,a).cutvalue=hh(t,e,n)}(t,e,n)}))}function hh(t,e,n){var i=t.node(n).parent,a=!0,r=e.edge(n,i),o=0;return r||(a=!1,r=e.edge(i,n)),o=r.weight,Rd.forEach(e.nodeEdges(n),(function(r){var l=r.v===n,s=l?r.w:r.v;if(s!==i){var u=l===a,d=e.edge(r).weight;if(o+=u?d:-d,function(t,e,n){return t.hasEdge(e,n)}(t,n,s)){var h=t.edge(n,s).cutvalue;o+=u?-h:h}}})),o}function fh(t,e){arguments.length<2&&(e=t.nodes()[0]),ch(t,{},1,e)}function ch(t,e,n,i,a){var r=n,o=t.node(i);return e[i]=!0,Rd.forEach(t.neighbors(i),(function(a){Rd.has(e,a)||(n=ch(t,e,n,a,i))})),o.low=r,o.lim=n++,a?o.parent=a:delete o.parent,n}function ph(t){return Rd.find(t.edges(),(function(e){return t.edge(e).cutvalue<0}))}function gh(t,e,n){var i=n.v,a=n.w;e.hasEdge(i,a)||(i=n.w,a=n.v);var r=t.node(i),o=t.node(a),l=r,s=!1;r.lim>o.lim&&(l=o,s=!0);var u=Rd.filter(e.edges(),(function(e){return s===vh(t,t.node(e.v),l)&&s!==vh(t,t.node(e.w),l)}));return Rd.minBy(u,(function(t){return ih(e,t)}))}function yh(t,e,n,i){var a=n.v,r=n.w;t.removeEdge(a,r),t.setEdge(i.v,i.w,{}),fh(t),dh(t,e),function(t,e){var n=Rd.find(t.nodes(),(function(t){return!e.node(t).parent})),i=rh(t,n);i=i.slice(1),Rd.forEach(i,(function(n){var i=t.node(n).parent,a=e.edge(n,i),r=!1;a||(a=e.edge(i,n),r=!0),e.node(n).rank=e.node(i).rank+(r?a.minlen:-a.minlen)}))}(t,e)}function vh(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}uh.initLowLimValues=fh,uh.initCutValues=dh,uh.calcCutValue=hh,uh.leaveEdge=ph,uh.enterEdge=gh,uh.exchangeEdges=yh;var xh=$d,_h=function(t){switch(t.graph().ranker){case"network-simplex":default:bh(t);break;case"tight-tree":!function(t){xh(t),Kd(t)}(t);break;case"longest-path":mh(t)}};var mh=xh;function bh(t){sh(t)}var wh=function(t){var e=function(t){var e={},n=0;function i(a){var r=n;Rd.forEach(t.children(a),i),e[a]={low:r,lim:n++}}return Rd.forEach(t.children(),i),e}(t);Rd.forEach(t.graph().dummyChains,(function(n){for(var i=t.node(n),a=i.edgeObj,r=function(t,e,n,i){var a,r,o=[],l=[],s=Math.min(e[n].low,e[i].low),u=Math.max(e[n].lim,e[i].lim);a=n;do{a=t.parent(a),o.push(a)}while(a&&(e[a].low>s||u>e[a].lim));r=a,a=i;for(;(a=t.parent(a))!==r;)l.push(a);return{path:o.concat(l.reverse()),lca:r}}(t,e,a.v,a.w),o=r.path,l=r.lca,s=0,u=o[s],d=!0;n!==a.w;){if(i=t.node(n),d){for(;(u=o[s])!==l&&t.node(u).maxRank<i.rank;)s++;u===l&&(d=!1)}if(!d){for(;s<o.length-1&&t.node(u=o[s+1]).minRank<=i.rank;)s++;u=o[s]}t.setParent(n,u),n=t.successors(n)[0]}}))};var kh={run:function(t){var e=Yd.addDummyNode(t,"root",{},"_root"),n=function(t){var e={};function n(i,a){var r=t.children(i);r&&r.length&&Rd.forEach(r,(function(t){n(t,a+1)})),e[i]=a}return Rd.forEach(t.children(),(function(t){n(t,1)})),e}(t),i=Rd.max(Rd.values(n))-1,a=2*i+1;t.graph().nestingRoot=e,Rd.forEach(t.edges(),(function(e){t.edge(e).minlen*=a}));var r=function(t){return Rd.reduce(t.edges(),(function(e,n){return e+t.edge(n).weight}),0)}(t)+1;Rd.forEach(t.children(),(function(o){Sh(t,e,a,r,i,n,o)})),t.graph().nodeRankFactor=a},cleanup:function(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,Rd.forEach(t.edges(),(function(e){t.edge(e).nestingEdge&&t.removeEdge(e)}))}};function Sh(t,e,n,i,a,r,o){var l=t.children(o);if(l.length){var s=Yd.addBorderNode(t,"_bt"),u=Yd.addBorderNode(t,"_bb"),d=t.node(o);t.setParent(s,o),d.borderTop=s,t.setParent(u,o),d.borderBottom=u,Rd.forEach(l,(function(l){Sh(t,e,n,i,a,r,l);var d=t.node(l),h=d.borderTop?d.borderTop:l,f=d.borderBottom?d.borderBottom:l,c=d.borderTop?i:2*i,p=h!==f?1:a-r[o]+1;t.setEdge(s,h,{weight:c,minlen:p,nestingEdge:!0}),t.setEdge(f,u,{weight:c,minlen:p,nestingEdge:!0})})),t.parent(o)||t.setEdge(e,s,{weight:0,minlen:a+r[o]})}else o!==e&&t.setEdge(e,o,{weight:0,minlen:n})}var Ah=function(t){Rd.forEach(t.children(),(function e(n){var i=t.children(n),a=t.node(n);if(i.length&&Rd.forEach(i,e),Rd.has(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(var r=a.minRank,o=a.maxRank+1;r<o;++r)Ph(t,"borderLeft","_bl",n,a,r),Ph(t,"borderRight","_br",n,a,r)}}))};function Ph(t,e,n,i,a,r){var o={width:0,height:0,rank:r,borderType:e},l=a[e][r-1],s=Yd.addDummyNode(t,"border",o,n);a[e][r]=s,t.setParent(s,i),l&&t.setEdge(l,s,{weight:1})}var Ch={adjust:function(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||Dh(t)},undo:function(t){var e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||function(t){Rd.forEach(t.nodes(),(function(e){Th(t.node(e))})),Rd.forEach(t.edges(),(function(e){var n=t.edge(e);Rd.forEach(n.points,Th),Rd.has(n,"y")&&Th(n)}))}(t);"lr"!==e&&"rl"!==e||(!function(t){Rd.forEach(t.nodes(),(function(e){Mh(t.node(e))})),Rd.forEach(t.edges(),(function(e){var n=t.edge(e);Rd.forEach(n.points,Mh),Rd.has(n,"x")&&Mh(n)}))}(t),Dh(t))}};function Dh(t){Rd.forEach(t.nodes(),(function(e){Oh(t.node(e))})),Rd.forEach(t.edges(),(function(e){Oh(t.edge(e))}))}function Oh(t){var e=t.width;t.width=t.height,t.height=e}function Th(t){t.y=-t.y}function Mh(t){var e=t.x;t.x=t.y,t.y=e}var Eh=function(t){var e={},n=Rd.filter(t.nodes(),(function(e){return!t.children(e).length})),i=Rd.max(Rd.map(n,(function(e){return t.node(e).rank}))),a=Rd.map(Rd.range(i+1),(function(){return[]}));function r(n){if(!Rd.has(e,n)){e[n]=!0;var i=t.node(n);a[i.rank].push(n),Rd.forEach(t.successors(n),r)}}var o=Rd.sortBy(n,(function(e){return t.node(e).rank}));return Rd.forEach(o,r),a};var Rh=function(t,e){for(var n=0,i=1;i<e.length;++i)n+=Ih(t,e[i-1],e[i]);return n};function Ih(t,e,n){for(var i=Rd.zipObject(n,Rd.map(n,(function(t,e){return e}))),a=Rd.flatten(Rd.map(e,(function(e){return Rd.sortBy(Rd.map(t.outEdges(e),(function(e){return{pos:i[e.w],weight:t.edge(e).weight}})),"pos")})),!0),r=1;r<n.length;)r<<=1;var o=2*r-1;r-=1;var l=Rd.map(new Array(o),(function(){return 0})),s=0;return Rd.forEach(a.forEach((function(t){var e=t.pos+r;l[e]+=t.weight;for(var n=0;e>0;)e%2&&(n+=l[e+1]),l[e=e-1>>1]+=t.weight;s+=t.weight*n}))),s}var Lh=function(t,e){return Rd.map(e,(function(e){var n=t.inEdges(e);if(n.length){var i=Rd.reduce(n,(function(e,n){var i=t.edge(n),a=t.node(n.v);return{sum:e.sum+i.weight*a.order,weight:e.weight+i.weight}}),{sum:0,weight:0});return{v:e,barycenter:i.sum/i.weight,weight:i.weight}}return{v:e}}))};var Fh=function(t,e){var n={};return Rd.forEach(t,(function(t,e){var i=n[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};Rd.isUndefined(t.barycenter)||(i.barycenter=t.barycenter,i.weight=t.weight)})),Rd.forEach(e.edges(),(function(t){var e=n[t.v],i=n[t.w];Rd.isUndefined(e)||Rd.isUndefined(i)||(i.indegree++,e.out.push(n[t.w]))})),function(t){var e=[];function n(t){return function(e){e.merged||(Rd.isUndefined(e.barycenter)||Rd.isUndefined(t.barycenter)||e.barycenter>=t.barycenter)&&function(t,e){var n=0,i=0;t.weight&&(n+=t.barycenter*t.weight,i+=t.weight);e.weight&&(n+=e.barycenter*e.weight,i+=e.weight);t.vs=e.vs.concat(t.vs),t.barycenter=n/i,t.weight=i,t.i=Math.min(e.i,t.i),e.merged=!0}(t,e)}}function i(e){return function(n){n.in.push(e),0==--n.indegree&&t.push(n)}}for(;t.length;){var a=t.pop();e.push(a),Rd.forEach(a.in.reverse(),n(a)),Rd.forEach(a.out,i(a))}return Rd.map(Rd.filter(e,(function(t){return!t.merged})),(function(t){return Rd.pick(t,["vs","i","barycenter","weight"])}))}(Rd.filter(n,(function(t){return!t.indegree})))};var Nh=function(t,e){var n=Yd.partition(t,(function(t){return Rd.has(t,"barycenter")})),i=n.lhs,a=Rd.sortBy(n.rhs,(function(t){return-t.i})),r=[],o=0,l=0,s=0;i.sort((u=!!e,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:u?e.i-t.i:t.i-e.i})),s=Bh(r,a,s),Rd.forEach(i,(function(t){s+=t.vs.length,r.push(t.vs),o+=t.barycenter*t.weight,l+=t.weight,s=Bh(r,a,s)}));var u;var d={vs:Rd.flatten(r,!0)};l&&(d.barycenter=o/l,d.weight=l);return d};function Bh(t,e,n){for(var i;e.length&&(i=Rd.last(e)).i<=n;)e.pop(),t.push(i.vs),n++;return n}var jh=function t(e,n,i,a){var r=e.children(n),o=e.node(n),l=o?o.borderLeft:void 0,s=o?o.borderRight:void 0,u={};l&&(r=Rd.filter(r,(function(t){return t!==l&&t!==s})));var d=Lh(e,r);Rd.forEach(d,(function(n){if(e.children(n.v).length){var r=t(e,n.v,i,a);u[n.v]=r,Rd.has(r,"barycenter")&&(o=n,l=r,Rd.isUndefined(o.barycenter)?(o.barycenter=l.barycenter,o.weight=l.weight):(o.barycenter=(o.barycenter*o.weight+l.barycenter*l.weight)/(o.weight+l.weight),o.weight+=l.weight))}var o,l}));var h=Fh(d,i);!function(t,e){Rd.forEach(t,(function(t){t.vs=Rd.flatten(t.vs.map((function(t){return e[t]?e[t].vs:t})),!0)}))}(h,u);var f=Nh(h,a);if(l&&(f.vs=Rd.flatten([l,f.vs,s],!0),e.predecessors(l).length)){var c=e.node(e.predecessors(l)[0]),p=e.node(e.predecessors(s)[0]);Rd.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+c.order+p.order)/(f.weight+2),f.weight+=2}return f};var zh=wu.Graph,Wh=function(t,e,n){var i=function(t){var e;for(;t.hasNode(e=Rd.uniqueId("_root")););return e}(t),a=new zh({compound:!0}).setGraph({root:i}).setDefaultNodeLabel((function(e){return t.node(e)}));return Rd.forEach(t.nodes(),(function(r){var o=t.node(r),l=t.parent(r);(o.rank===e||o.minRank<=e&&e<=o.maxRank)&&(a.setNode(r),a.setParent(r,l||i),Rd.forEach(t[n](r),(function(e){var n=e.v===r?e.w:e.v,i=a.edge(n,r),o=Rd.isUndefined(i)?0:i.weight;a.setEdge(n,r,{weight:t.edge(e).weight+o})})),Rd.has(o,"minRank")&&a.setNode(r,{borderLeft:o.borderLeft[e],borderRight:o.borderRight[e]}))})),a};var Vh=function(t,e,n){var i,a={};Rd.forEach(n,(function(n){for(var r,o,l=t.parent(n);l;){if((r=t.parent(l))?(o=a[r],a[r]=l):(o=i,i=l),o&&o!==l)return void e.setEdge(o,l);l=r}}))};var Gh=wu.Graph,Hh=function(t){var e=Yd.maxRank(t),n=Yh(t,Rd.range(1,e+1),"inEdges"),i=Yh(t,Rd.range(e-1,-1,-1),"outEdges"),a=Eh(t);Uh(t,a);for(var r,o=Number.POSITIVE_INFINITY,l=0,s=0;s<4;++l,++s){Xh(l%2?n:i,l%4>=2),a=Yd.buildLayerMatrix(t);var u=Rh(t,a);u<o&&(s=0,r=Rd.cloneDeep(a),o=u)}Uh(t,r)};function Yh(t,e,n){return Rd.map(e,(function(e){return Wh(t,e,n)}))}function Xh(t,e){var n=new Gh;Rd.forEach(t,(function(t){var i=t.graph().root,a=jh(t,i,n,e);Rd.forEach(a.vs,(function(e,n){t.node(e).order=n})),Vh(t,n,a.vs)}))}function Uh(t,e){Rd.forEach(e,(function(e){Rd.forEach(e,(function(e,n){t.node(e).order=n}))}))}var qh=wu.Graph,$h=function(t){var e,n=Yd.buildLayerMatrix(t),i=Rd.merge(Jh(t,n),Zh(t,n)),a={};Rd.forEach(["u","d"],(function(r){e="u"===r?n:Rd.values(n).reverse(),Rd.forEach(["l","r"],(function(n){"r"===n&&(e=Rd.map(e,(function(t){return Rd.values(t).reverse()})));var o=("u"===r?t.predecessors:t.successors).bind(t),l=tf(t,e,i,o),s=ef(t,e,l.root,l.align,"r"===n);"r"===n&&(s=Rd.mapValues(s,(function(t){return-t}))),a[r+n]=s}))}));var r=nf(t,a);return af(a,r),rf(a,t.graph().align)};function Jh(t,e){var n={};return Rd.reduce(e,(function(e,i){var a=0,r=0,o=e.length,l=Rd.last(i);return Rd.forEach(i,(function(e,s){var u=function(t,e){if(t.node(e).dummy)return Rd.find(t.predecessors(e),(function(e){return t.node(e).dummy}))}(t,e),d=u?t.node(u).order:o;(u||e===l)&&(Rd.forEach(i.slice(r,s+1),(function(e){Rd.forEach(t.predecessors(e),(function(i){var r=t.node(i),o=r.order;!(o<a||d<o)||r.dummy&&t.node(e).dummy||Qh(n,i,e)}))})),r=s+1,a=d)})),i})),n}function Zh(t,e){var n={};function i(e,i,a,r,o){var l;Rd.forEach(Rd.range(i,a),(function(i){l=e[i],t.node(l).dummy&&Rd.forEach(t.predecessors(l),(function(e){var i=t.node(e);i.dummy&&(i.order<r||i.order>o)&&Qh(n,e,l)}))}))}return Rd.reduce(e,(function(e,n){var a,r=-1,o=0;return Rd.forEach(n,(function(l,s){if("border"===t.node(l).dummy){var u=t.predecessors(l);u.length&&(a=t.node(u[0]).order,i(n,o,s,r,a),o=s,r=a)}i(n,o,n.length,a,e.length)})),n})),n}function Qh(t,e,n){if(e>n){var i=e;e=n,n=i}var a=t[e];a||(t[e]=a={}),a[n]=!0}function Kh(t,e,n){if(e>n){var i=e;e=n,n=i}return Rd.has(t[e],n)}function tf(t,e,n,i){var a={},r={},o={};return Rd.forEach(e,(function(t){Rd.forEach(t,(function(t,e){a[t]=t,r[t]=t,o[t]=e}))})),Rd.forEach(e,(function(t){var e=-1;Rd.forEach(t,(function(t){var l=i(t);if(l.length){l=Rd.sortBy(l,(function(t){return o[t]}));for(var s=(l.length-1)/2,u=Math.floor(s),d=Math.ceil(s);u<=d;++u){var h=l[u];r[t]===t&&e<o[h]&&!Kh(n,t,h)&&(r[h]=t,r[t]=a[t]=a[h],e=o[h])}}}))})),{root:a,align:r}}function ef(t,e,n,i,a){var r={},o=function(t,e,n,i){var a=new qh,r=t.graph(),o=function(t,e,n){return function(i,a,r){var o,l=i.node(a),s=i.node(r),u=0;if(u+=l.width/2,Rd.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":o=-l.width/2;break;case"r":o=l.width/2}if(o&&(u+=n?o:-o),o=0,u+=(l.dummy?e:t)/2,u+=(s.dummy?e:t)/2,u+=s.width/2,Rd.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":o=s.width/2;break;case"r":o=-s.width/2}return o&&(u+=n?o:-o),o=0,u}}(r.nodesep,r.edgesep,i);return Rd.forEach(e,(function(e){var i;Rd.forEach(e,(function(e){var r=n[e];if(a.setNode(r),i){var l=n[i],s=a.edge(l,r);a.setEdge(l,r,Math.max(o(t,e,i),s||0))}i=e}))})),a}(t,e,n,a),l=a?"borderLeft":"borderRight";function s(t,e){for(var n=o.nodes(),i=n.pop(),a={};i;)a[i]?t(i):(a[i]=!0,n.push(i),n=n.concat(e(i))),i=n.pop()}return s((function(t){r[t]=o.inEdges(t).reduce((function(t,e){return Math.max(t,r[e.v]+o.edge(e))}),0)}),o.predecessors.bind(o)),s((function(e){var n=o.outEdges(e).reduce((function(t,e){return Math.min(t,r[e.w]-o.edge(e))}),Number.POSITIVE_INFINITY),i=t.node(e);n!==Number.POSITIVE_INFINITY&&i.borderType!==l&&(r[e]=Math.max(r[e],n))}),o.successors.bind(o)),Rd.forEach(i,(function(t){r[t]=r[n[t]]})),r}function nf(t,e){return Rd.minBy(Rd.values(e),(function(e){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return Rd.forIn(e,(function(e,a){var r=function(t,e){return t.node(e).width}(t,a)/2;n=Math.max(e+r,n),i=Math.min(e-r,i)})),n-i}))}function af(t,e){var n=Rd.values(e),i=Rd.min(n),a=Rd.max(n);Rd.forEach(["u","d"],(function(n){Rd.forEach(["l","r"],(function(r){var o,l=n+r,s=t[l];if(s!==e){var u=Rd.values(s);(o="l"===r?i-Rd.min(u):a-Rd.max(u))&&(t[l]=Rd.mapValues(s,(function(t){return t+o})))}}))}))}function rf(t,e){return Rd.mapValues(t.ul,(function(n,i){if(e)return t[e.toLowerCase()][i];var a=Rd.sortBy(Rd.map(t,i));return(a[1]+a[2])/2}))}var of=$h,lf=function(t){(function(t){var e=Yd.buildLayerMatrix(t),n=t.graph().ranksep,i=0;Rd.forEach(e,(function(e){var a=Rd.max(Rd.map(e,(function(e){return t.node(e).height})));Rd.forEach(e,(function(e){t.node(e).y=i+a/2})),i+=a+n}))})(t=Yd.asNonCompoundGraph(t)),Rd.forEach(of(t),(function(e,n){t.node(n).x=e}))};var sf=Yd.normalizeRanks,uf=Yd.removeEmptyRanks,df=Yd,hf=wu.Graph,ff=function(t,e){var n=e&&e.debugTiming?df.time:df.notime;n("layout",(function(){var e=n("  buildLayoutGraph",(function(){return function(t){var e=new hf({multigraph:!0,compound:!0}),n=wf(t.graph());return e.setGraph(Rd.merge({},pf,bf(n,cf),Rd.pick(n,gf))),Rd.forEach(t.nodes(),(function(n){var i=wf(t.node(n));e.setNode(n,Rd.defaults(bf(i,yf),vf)),e.setParent(n,t.parent(n))})),Rd.forEach(t.edges(),(function(n){var i=wf(t.edge(n));e.setEdge(n,Rd.merge({},_f,bf(i,xf),Rd.pick(i,mf)))})),e}(t)}));n("  runLayout",(function(){!function(t,e){e("    makeSpaceForEdgeLabels",(function(){!function(t){var e=t.graph();e.ranksep/=2,Rd.forEach(t.edges(),(function(n){var i=t.edge(n);i.minlen*=2,"c"!==i.labelpos.toLowerCase()&&("TB"===e.rankdir||"BT"===e.rankdir?i.width+=i.labeloffset:i.height+=i.labeloffset)}))}(t)})),e("    removeSelfEdges",(function(){!function(t){Rd.forEach(t.edges(),(function(e){if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:e,label:t.edge(e)}),t.removeEdge(e)}}))}(t)})),e("    acyclic",(function(){Gd.run(t)})),e("    nestingGraph.run",(function(){kh.run(t)})),e("    rank",(function(){_h(df.asNonCompoundGraph(t))})),e("    injectEdgeLabelProxies",(function(){!function(t){Rd.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.width&&n.height){var i=t.node(e.v),a={rank:(t.node(e.w).rank-i.rank)/2+i.rank,e:e};df.addDummyNode(t,"edge-proxy",a,"_ep")}}))}(t)})),e("    removeEmptyRanks",(function(){uf(t)})),e("    nestingGraph.cleanup",(function(){kh.cleanup(t)})),e("    normalizeRanks",(function(){sf(t)})),e("    assignRankMinMax",(function(){!function(t){var e=0;Rd.forEach(t.nodes(),(function(n){var i=t.node(n);i.borderTop&&(i.minRank=t.node(i.borderTop).rank,i.maxRank=t.node(i.borderBottom).rank,e=Rd.max(e,i.maxRank))})),t.graph().maxRank=e}(t)})),e("    removeEdgeLabelProxies",(function(){!function(t){Rd.forEach(t.nodes(),(function(e){var n=t.node(e);"edge-proxy"===n.dummy&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))}))}(t)})),e("    normalize.run",(function(){qd.run(t)})),e("    parentDummyChains",(function(){wh(t)})),e("    addBorderSegments",(function(){Ah(t)})),e("    order",(function(){Hh(t)})),e("    insertSelfEdges",(function(){!function(t){var e=df.buildLayerMatrix(t);Rd.forEach(e,(function(e){var n=0;Rd.forEach(e,(function(e,i){var a=t.node(e);a.order=i+n,Rd.forEach(a.selfEdges,(function(e){df.addDummyNode(t,"selfedge",{width:e.label.width,height:e.label.height,rank:a.rank,order:i+ ++n,e:e.e,label:e.label},"_se")})),delete a.selfEdges}))}))}(t)})),e("    adjustCoordinateSystem",(function(){Ch.adjust(t)})),e("    position",(function(){lf(t)})),e("    positionSelfEdges",(function(){!function(t){Rd.forEach(t.nodes(),(function(e){var n=t.node(e);if("selfedge"===n.dummy){var i=t.node(n.e.v),a=i.x+i.width/2,r=i.y,o=n.x-a,l=i.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:a+2*o/3,y:r-l},{x:a+5*o/6,y:r-l},{x:a+o,y:r},{x:a+5*o/6,y:r+l},{x:a+2*o/3,y:r+l}],n.label.x=n.x,n.label.y=n.y}}))}(t)})),e("    removeBorderNodes",(function(){!function(t){Rd.forEach(t.nodes(),(function(e){if(t.children(e).length){var n=t.node(e),i=t.node(n.borderTop),a=t.node(n.borderBottom),r=t.node(Rd.last(n.borderLeft)),o=t.node(Rd.last(n.borderRight));n.width=Math.abs(o.x-r.x),n.height=Math.abs(a.y-i.y),n.x=r.x+n.width/2,n.y=i.y+n.height/2}})),Rd.forEach(t.nodes(),(function(e){"border"===t.node(e).dummy&&t.removeNode(e)}))}(t)})),e("    normalize.undo",(function(){qd.undo(t)})),e("    fixupEdgeLabelCoords",(function(){!function(t){Rd.forEach(t.edges(),(function(e){var n=t.edge(e);if(Rd.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(t)})),e("    undoCoordinateSystem",(function(){Ch.undo(t)})),e("    translateGraph",(function(){!function(t){var e=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,a=0,r=t.graph(),o=r.marginx||0,l=r.marginy||0;function s(t){var r=t.x,o=t.y,l=t.width,s=t.height;e=Math.min(e,r-l/2),n=Math.max(n,r+l/2),i=Math.min(i,o-s/2),a=Math.max(a,o+s/2)}Rd.forEach(t.nodes(),(function(e){s(t.node(e))})),Rd.forEach(t.edges(),(function(e){var n=t.edge(e);Rd.has(n,"x")&&s(n)})),e-=o,i-=l,Rd.forEach(t.nodes(),(function(n){var a=t.node(n);a.x-=e,a.y-=i})),Rd.forEach(t.edges(),(function(n){var a=t.edge(n);Rd.forEach(a.points,(function(t){t.x-=e,t.y-=i})),Rd.has(a,"x")&&(a.x-=e),Rd.has(a,"y")&&(a.y-=i)})),r.width=n-e+o,r.height=a-i+l}(t)})),e("    assignNodeIntersects",(function(){!function(t){Rd.forEach(t.edges(),(function(e){var n,i,a=t.edge(e),r=t.node(e.v),o=t.node(e.w);a.points?(n=a.points[0],i=a.points[a.points.length-1]):(a.points=[],n=o,i=r),a.points.unshift(df.intersectRect(r,n)),a.points.push(df.intersectRect(o,i))}))}(t)})),e("    reversePoints",(function(){!function(t){Rd.forEach(t.edges(),(function(e){var n=t.edge(e);n.reversed&&n.points.reverse()}))}(t)})),e("    acyclic.undo",(function(){Gd.undo(t)}))}(e,n)})),n("  updateInputGraph",(function(){!function(t,e){Rd.forEach(t.nodes(),(function(n){var i=t.node(n),a=e.node(n);i&&(i.x=a.x,i.y=a.y,e.children(n).length&&(i.width=a.width,i.height=a.height))})),Rd.forEach(t.edges(),(function(n){var i=t.edge(n),a=e.edge(n);i.points=a.points,Rd.has(a,"x")&&(i.x=a.x,i.y=a.y)})),t.graph().width=e.graph().width,t.graph().height=e.graph().height}(t,e)}))}))};var cf=["nodesep","edgesep","ranksep","marginx","marginy"],pf={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},gf=["acyclicer","ranker","rankdir","align"],yf=["width","height"],vf={width:0,height:0},xf=["minlen","weight","width","height","labeloffset"],_f={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},mf=["labelpos"];function bf(t,e){return Rd.mapValues(Rd.pick(t,e),Number)}function wf(t){var e={};return Rd.forEach(t,(function(t,n){e[n.toLowerCase()]=t})),e}var kf=wu.Graph;var Sf={graphlib:wu,layout:ff,debug:{debugOrdering:function(t){var e=Yd.buildLayerMatrix(t),n=new kf({compound:!0,multigraph:!0}).setGraph({});return Rd.forEach(t.nodes(),(function(e){n.setNode(e,{label:e}),n.setParent(e,"layer"+t.node(e).rank)})),Rd.forEach(t.edges(),(function(t){n.setEdge(t.v,t.w,{},t.name)})),Rd.forEach(e,(function(t,e){var i="layer"+e;n.setNode(i,{rank:"same"}),Rd.reduce(t,(function(t,e){return n.setEdge(t,e,{style:"invis"}),e}))})),n}},util:{time:Yd.time,notime:Yd.notime},version:"0.8.5"},Af=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(ki),a=i(hn),r=i(fn),o=i(yn),l=i(pn),s=i(vn),u=i(xn),d=i(ln),h=i(Gn),f=i(dn),c=i(_n),p=i(Ai),g=i(Sf);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}var v=d.default._,x=d.default.event,_=d.default.Shapes.Rect,m=d.default.Shapes.Diamond,b=d.default.Shapes.Path,w=d.default.Shapes.BrokenLine,k=d.default.Shapes.Circle,S=d.default.Shapes.Arrow,A=function(t){(0,l.default)(i,t);var e=y(i);function i(t,n){var r;if((0,a.default)(this,i),(r=e.call(this,t,n)).type="relation",v.extend(!0,(0,o.default)(r),(0,bn.getDefaultProps)(i.defaultProps()),t),"dagre"===r.layout){var l={graph:{rankdir:"TB",nodesep:10,ranksep:10,edgesep:10,acyclicer:"greedy"},node:{},edge:{labelpos:"c"}};v.extend(!0,l,r.layoutOpts),v.extend(!0,r.layoutOpts,l),r.rankdir?r.layoutOpts.graph.rankdir=r.rankdir:r.rankdir=r.layoutOpts.graph.rankdir}return r.domContainer=n.canvax.domView,r.induce=null,r.init(),r}return(0,r.default)(i,[{key:"init",value:function(){this._initInduce(),this.nodesSp=new d.default.Display.Sprite({id:"nodesSp"}),this.nodesContentSp=new d.default.Display.Sprite({id:"nodesContentSp"}),this.edgesSp=new d.default.Display.Sprite({id:"edgesSp"}),this.arrowsSp=new d.default.Display.Sprite({id:"arrowsSp"}),this.labelsSp=new d.default.Display.Sprite({id:"labelsSp"}),this.graphsSp=new d.default.Display.Sprite({id:"graphsSp"}),this.graphsView=new d.default.Display.Sprite({id:"graphsView"}),this.graphsSp.addChild(this.edgesSp),this.graphsSp.addChild(this.nodesSp),this.graphsSp.addChild(this.nodesContentSp),this.graphsSp.addChild(this.arrowsSp),this.graphsSp.addChild(this.labelsSp),this.graphsView.addChild(this.graphsSp),this.sprite.addChild(this.graphsView),this.zoom=new p.default}},{key:"_initInduce",value:function(){var t=this;this.induce=new _({id:"induce",context:{width:0,height:0,fillStyle:"#000000",globalAlpha:0}}),this.sprite.addChild(this.induce);var e=!1,n=t.app.canvax.domView?"default":t.app.canvax.domView.style.cursor,i=null,a=0;this.induce.on(x.types.get(),(function(r){if(t.status.transform.enabled){r.preventDefault();var o=r.target.localToGlobal(r.point,t.sprite);if("mousedown"==r.type&&(t.induce.toFront(),e=!0,t.app.canvax.domView&&(t.app.canvax.domView.style.cursor="move"),t.zoom.mouseMoveTo(o)),"mouseup"!=r.type&&"mouseout"!=r.type||(t.induce.toBack(),e=!1,t.app.canvax.domView&&(t.app.canvax.domView.style.cursor=n)),"mousemove"==r.type&&e){var l=t.zoom.move(o),s=l.x,u=l.y;t.graphsView.context.x=parseInt(s),t.graphsView.context.y=parseInt(u)}"wheel"==r.type&&(Math.abs(r.deltaY)>Math.abs(a)&&(a=r.deltaY),i||(i=setTimeout((function(){if("offset"==t.status.transform.wheelAction){var e=t.zoom.offset({x:-r.deltaX,y:-r.deltaY}),n=e.x,l=e.y;t.graphsView.context.x=n,t.graphsView.context.y=l}if("scale"==t.status.transform.wheelAction){var s=t.zoom.wheel(r,o),u=s.scale,d=s.x,h=s.y;t.graphsView.context.x=d,t.graphsView.context.y=h,t.graphsView.context.scaleX=u,t.graphsView.context.scaleY=u,t.status.transform.scale=u}i=null,a=0}),32)))}}))}},{key:"draw",value:function(t){var e=this;!t&&(t={}),v.extend(!0,this,t),this._initData(t.data).then((function(t){e.data=t,e._layoutData(),e.widget(),e.induce.context.width=e.width,e.induce.context.height=e.height,e.sprite.context.x=parseInt(e.origin.x),e.sprite.context.y=parseInt(e.origin.y);var n=(e.width-e.data.size.width)/2;n<0&&(n=0);var i=(e.height-e.data.size.height)/2;i<0&&(i=0),e.graphsSp.context.x=parseInt(n),e.graphsSp.context.y=parseInt(i),e.fire("complete")}))}},{key:"resetData",value:function(t,e){var n=this;this._resetData(t,e).then((function(){n.fire("complete")}))}},{key:"_resetData",value:function(t,e){var n=this,i=this;return this._preData=this.data,new Promise((function(a){n._initData(t).then((function(t){if(n.data=t,n._layoutData(),v.each(n._preData.nodes,(function(t){var e=v.find(i.data.nodes,(function(e){return t.key==e.key}));e?(e.focused=t.focused,e.selected=t.selected):i._destroy(t)})),v.each(n._preData.edges,(function(t){v.find(i.data.edges,(function(e){return t.key.join("_")==e.key.join("_")}))||i._destroy(t)})),n.widget(),e){var r=e.origin||(e.params||{}).origin;if(null!=r){var o=v.find(n._preData.nodes,(function(t){return t.key==r})),l=v.find(n.data.nodes,(function(t){return t.key==r}));if(o&&l){var s={x:parseInt(o.x)-parseInt(l.x),y:parseInt(o.y)-parseInt(l.y)},u=n.zoom.offset(s),d=u.x,h=u.y;i.graphsView.context.x=parseInt(d),i.graphsView.context.y=parseInt(h)}}}a()}))}))}},{key:"_destroy",value:function(t){t.shapeElement&&t.shapeElement.destroy(),t.contentElement.destroy?t.contentElement.destroy():this.domContainer.removeChild(t.contentElement),t.pathElement&&t.pathElement.destroy(),t.labelElement&&t.labelElement.destroy(),t.arrowElement&&t.arrowElement.destroy(),t.edgeIconElement&&t.edgeIconElement.destroy(),t.edgeIconBack&&t.edgeIconBack.destroy()}},{key:"_getDefNode",value:function(){return{type:"relation",iNode:0,rowData:null,key:"",content:"",_contentInited:!1,ctype:"canvas",contentElement:null,width:null,height:null,x:null,y:null,shapeType:null,source:null,target:null,focused:!1,selected:!1}}},{key:"_initData",value:function(t){var e=this;return new Promise((function(n){if(t&&t.nodes&&t.edges)n(t);else{var i={nodes:[],edges:[],size:{width:0,height:0}},a=e.app._data;(0,Si.checkDataIsJson)(a,e.field,e.childrenField)?(e.jsonData=(0,Si.jsonToArrayForRelation)(a,e,e.childrenField),e.dataFrame=e.app.dataFrame=(0,c.default)(e.jsonData,e)):"tree"==e.layout&&(e.jsonData=(0,Si.arrayToTreeJsonForRelation)(JSON.parse(JSON.stringify(e.app.dataFrame.jsonOrg)),e));for(var r=0;r<e.dataFrame.length;r++){var o=e.dataFrame.getRowDataAt(r),l=v.flatten([(o[e.field]+"").split(",")]),s=e._getContent(o),u=e._getDefNode();Object.assign(u,{iNode:r,rowData:o,key:1==l.length?l[0]:l,content:s,ctype:e._checkHtml(s)?"html":"canvas"}),1==l.length?(u.shapeType=e.getProp(e.node.shapeType,u),Object.assign(u,e.layoutOpts.node),i.nodes.push(u)):(u.shapeType=e.getProp(e.line.shapeType,u),Object.assign(u,e.layoutOpts.edge),i.edges.push(u))}e._initAllDataSize(i).then((function(t){n(t)}))}}))}},{key:"_initAllDataSize",value:function(t){var e=this;return new Promise((function(n){var i={},a=0;t.nodes.concat(t.edges).forEach((function(r){i[r.key]=r,e._initContentAndGetSize(r).then((function(o){if(v.extend(r,o),"diamond"==r.shapeType){var l={width:r.width,height:r.height},s=e.node.includedAngle/2*Math.PI/180,u=l.height/Math.tan(s),d=l.width*Math.tan(s),h=l.width+u,f=l.height+d;r._innerRect={width:r.width,height:r.height},r.width=h,r.height=f}r._contentInited=!0,++a==t.nodes.length+t.edges.length&&(v.each(t.edges,(function(t){var e=t.key;t.source=i[e[0]],t.target=i[e[1]]})),n(t))}))}))}))}},{key:"_layoutData",value:function(){"dagre"==this.layout?this._dagreLayout(this.data):"tree"==this.layout?this._treeLayout(this.data):v.isFunction(this.layout)&&this.layout(this.data)}},{key:"_dagreLayout",value:function(t){var e=f.default.layout.dagre||g.default,i=new e.graphlib.Graph;return i.setGraph(this.layoutOpts.graph),i.setDefaultEdgeLabel((function(){return{}})),v.each(t.nodes,(function(t){i.setNode(t.key,t)})),v.each(t.edges,(function(t){i.setEdge.apply(i,(0,n.default)(t.key).concat([t]))})),e.layout(i),t.size.width=i.graph().width,t.size.height=i.graph().height,t}},{key:"_treeLayout",value:function(){}},{key:"widget",value:function(){this._drawEdges(),this._drawNodes()}},{key:"offset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},e=this.zoom.offset(t),n=e.x,i=e.y;this.graphsView.context.x=parseInt(n),this.graphsView.context.y=parseInt(i)}},{key:"setNodeToCenter",value:function(t){var e=this.getNodeDataAt(t);if(e){var n=e.shapeElement.localToGlobal(),i={x:this.app.width/2-e.width/2,y:this.app.height/2-e.height/2},a={x:parseInt(i.x-n.x),y:parseInt(i.y-n.y)};this.offset(a)}}},{key:"_drawEdges",value:function(){var t=this;v.each(this.data.edges,(function(e){var n=e.key.join("_");t.line.isTree&&3==e.points.length&&t._setTreePoints(e);var i=t._getLineShape(e,t.line.inflectionRadius),a=i.type,r=i.path,o=i.pointList,l="path"==a?b:w,s=t.getProp(t.line.lineWidth,e),u=t.getProp(t.line.strokeStyle,e),h=t.getProp(t.line.lineType,e),f=t.getProp(t.line.cursor,e),c="edge_"+n,p=t.edgesSp.getChildById(c);if(p)"path"==a&&(p.context.path=r),"brokenLine"==a&&(p.context.pointList=o),p.context.lineWidth=s,p.context.strokeStyle=u,p.context.lineType=h;else{var g={lineWidth:s,strokeStyle:u,lineType:h,cursor:f};"path"==a&&(g.path=r),"brokenLine"==a&&(g.pointList=o),(p=new l({id:c,context:g})).on(x.types.get(),(function(e){var n=this.nodeData;n.__no_value=!0,e.eventInfo={trigger:t.line,nodes:[n]},t.app.fire(e.type,e)})),t.edgesSp.addChild(p)}e.pathElement=p,p.nodeData=e;var y=e.points.slice(-2,-1)[0];"bezier"==t.line.shapeType&&("TB"!=t.rankdir&&"BT"!=t.rankdir||(y.x+=(e.source.x-e.target.x)/20),"LR"!=t.rankdir&&"RL"!=t.rankdir||(y.y+=(e.source.y-e.target.y)/20));var v="label_"+n;if(t.getProp(t.line.edgeLabel.enabled,e)){var _=t.getProp(t.node.content.textAlign,e),m=t.getProp(t.node.content.textBaseline,e),A=t.getProp(t.line.edgeLabel.fontSize,e),P=t.getProp(t.line.edgeLabel.fontColor,e),C=t.getProp(t.line.icon.offset,e);C||(C={x:e.x,y:e.y});var D=t.labelsSp.getChildById(v);D?(D.resetText(e.content),D.context.x=C.x,D.context.y=C.y,D.context.fontSize=A,D.context.fillStyle=P,D.context.textAlign=_,D.context.textBaseline=m):((D=new d.default.Display.Text(e.content,{id:v,context:{x:C.x,y:C.y,fontSize:A,fillStyle:P,textAlign:_,textBaseline:m}})).on(x.types.get(),(function(e){var n=this.nodeData;n.__no_value=!0,e.eventInfo={trigger:t.line,nodes:[n]},t.app.fire(e.type,e)})),t.labelsSp.addChild(D)),e.labelElement=D,D.nodeData=e}if(t.getProp(t.line.icon.enabled,e)){var O=t.getProp(t.line.icon.charCode,e),T=String.fromCharCode(parseInt(O,16));if(""!=O){var M=t.getProp(t.line.icon.lineWidth,e),E=t.getProp(t.line.icon.strokeStyle,e),R=t.getProp(t.line.icon.fontFamily,e),I=t.getProp(t.line.icon.fontSize,e),L=t.getProp(t.line.icon.fontColor,e),F=t.getProp(t.line.icon.background,e),N="center",B="middle",j=t.getProp(t.line.icon.offset,e),z=t.getProp(t.line.icon.offsetX,e),W=t.getProp(t.line.icon.offsetY,e);j||(j={x:parseInt(e.x)+z,y:parseInt(e.y)+W});var V={x:j.x,y:j.y-1,r:parseInt(.5*I)+2,fillStyle:F,strokeStyle:E,lineWidth:M},G="edge_item_icon_back_"+n,H=t.labelsSp.getChildById(G);H?Object.assign(H.context,V):(H=new k({id:G,context:V}),t.labelsSp.addChild(H)),e.edgeIconBack=H,H.nodeData=e;var Y="edge_item_icon_"+n,X=t.labelsSp.getChildById(Y);X?(X.resetText(T),X.context.x=j.x,X.context.y=j.y,X.context.fontSize=I,X.context.fillStyle=L,X.context.textAlign=N,X.context.textBaseline=B,X.context.fontFamily=R):((X=new d.default.Display.Text(T,{id:Y,context:{x:j.x,y:j.y,fillStyle:L,cursor:"pointer",fontSize:I,textAlign:N,textBaseline:B,fontFamily:R}})).on(x.types.get(),(function(e){var n=this.nodeData;n.__no_value=!0;var i=t.line;t.line.icon["on"+e.type]&&(i=t.line.icon),e.eventInfo={trigger:i,nodes:[n]},t.app.fire(e.type,e)})),t.labelsSp.addChild(X)),e.edgeIconElement=X,X.nodeData=e}}if(t.line.arrow.enabled){var U="arrow_"+n,q=t.arrowsSp.getChildById(U);q?(q.context.x=t.line.arrow.offsetX,q.context.y=t.line.arrow.offsetY,q.context.fillStyle=u,q.context.control.x=y.x,q.context.control.y=y.y,q.context.point=e.points.slice(-1)[0],q.context.strokeStyle=u,q.context.fillStyle=u):(q=new S({id:U,context:{x:t.line.arrow.offsetX,y:t.line.arrow.offsetY,control:y,point:e.points.slice(-1)[0],strokeStyle:u,fillStyle:u}}),t.arrowsSp.addChild(q)),e.arrowElement=q}}))}},{key:"_drawNodes",value:function(){var t=this;v.each(this.data.nodes,(function(e){t._drawNode(e)}))}},{key:"_drawNode",value:function(t){var e=this,n=_,i="node_"+t.key,a=e.node.cursor,r=e._getNodeStyle(t),o=r.lineWidth,l=r.fillStyle,s=r.strokeStyle,u=r.radius,d=r.shadowOffsetX,h=r.shadowOffsetY,f=r.shadowBlur,c=r.shadowColor,p={x:parseInt(t.x)-parseInt(t.width/2),y:parseInt(t.y)-parseInt(t.height/2),width:t.width,height:t.height,cursor:a,lineWidth:o,fillStyle:l,strokeStyle:s,radius:u,shadowOffsetX:d,shadowOffsetY:h,shadowBlur:f,shadowColor:c};"diamond"==t.shapeType&&(n=m,p={x:parseInt(t.x),y:parseInt(t.y),cursor:a,innerRect:t._innerRect,lineWidth:o,fillStyle:l,strokeStyle:s,shadowOffsetX:d,shadowOffsetY:h,shadowBlur:f,shadowColor:c});var g=e.nodesSp.getChildById(i);g?v.extend(g.context,p):(g=new n({id:i,hoverClone:!1,context:p}),e.nodesSp.addChild(g),g.on(x.types.get(),(function(t){var n=this.nodeData;if(n.__no_value=!0,t.eventInfo={trigger:e.node,nodes:[n]},e.node.focus.enabled&&("mouseover"==t.type&&e.focusAt(this.nodeData),"mouseout"==t.type&&e.unfocusAt(this.nodeData)),e.node.select.enabled&&e.node.select.triggerEventType.indexOf(t.type)>-1){var i=e.node.select.onbefore,a=e.node.select.onend;(!i||"function"==typeof i&&!1!==i.apply(e,[this.nodeData]))&&(this.nodeData.selected?e.unselectAt(this.nodeData):e.selectAt(this.nodeData),a&&"function"==typeof a&&a.apply(e,[this.nodeData]))}e.app.fire(t.type,t)}))),g.nodeData=t,t.shapeElement=g,e.node.select.list.indexOf(t.key)>-1&&e.selectAt(t),"canvas"==t.ctype&&(t.contentElement.context.visible=!0),g.on("transform",(function(){if("canvas"==t.ctype)t.contentElement.context.x=parseInt(t.x),t.contentElement.context.y=parseInt(t.y);else if("html"==t.ctype){var n="undefined"!=typeof window?window.devicePixelRatio:1,i=g.worldTransform.clone();i=i.scale(1/n,1/n),t.contentElement.style.transform="matrix("+i.toArray().join()+")",t.contentElement.style.transformOrigin="left top","diamond"==t.shapeType&&(t.contentElement.style.left=-parseInt(t._innerRect.width/2*e.status.transform.scale)+"px",t.contentElement.style.top=-parseInt(t._innerRect.height/2*e.status.transform.scale)+"px"),t.contentElement.style.visibility="visible"}}))}},{key:"_getNodeStyle",value:function(t,e){var n=this,i=v.flatten([n.getProp(n.node.radius,t)]),a=n.node;return"select"==e&&(a=n.node.select),"focus"==e&&(a=n.node.focus),{lineWidth:n.getProp(a.lineWidth,t),fillStyle:n.getProp(a.fillStyle,t),strokeStyle:n.getProp(a.strokeStyle,t),radius:i,shadowOffsetX:n.getProp(a.shadow.shadowOffsetX,t),shadowOffsetY:n.getProp(a.shadow.shadowOffsetY,t),shadowBlur:n.getProp(a.shadow.shadowBlur,t),shadowColor:n.getProp(a.shadow.shadowColor,t)}}},{key:"_setNodeStyle",value:function(t,e){var n=this._getNodeStyle(t,e),i=n.lineWidth,a=n.fillStyle,r=n.strokeStyle,o=n.shadowOffsetX,l=n.shadowOffsetY,s=n.shadowBlur,u=n.shadowColor;if(t.shapeElement&&t.shapeElement.context){var d=t.shapeElement.context;d.lineWidth=i,d.fillStyle=a,d.strokeStyle=r,d.shadowOffsetX=o,d.shadowOffsetY=l,d.shadowBlur=s,d.shadowColor=u}}},{key:"focusAt",value:function(t){var e=this.getNodeDataAt(t);e&&(!e.selected&&this._setNodeStyle(e,"focus"),e.focused=!0)}},{key:"unfocusAt",value:function(t){var e=this.getNodeDataAt(t);e&&(!e.selected&&this._setNodeStyle(e),e.focused=!1)}},{key:"selectAt",value:function(t){var e=this.getNodeDataAt(t);e&&(this._setNodeStyle(e,"select"),e.selected=!0,-1==this.node.select.list.indexOf(e.key)&&this.node.select.list.push(e.key))}},{key:"selectAll",value:function(){var t=this;this.data.nodes.forEach((function(e){t.selectAt(e)}))}},{key:"unselectAt",value:function(t){var e=this.getNodeDataAt(t);if(e){e.focused?this._setNodeStyle(e,"focus"):this._setNodeStyle(e),e.selected=!1;var n=this.node.select.list.indexOf(e.key);n>-1&&this.node.select.list.splice(n,1)}}},{key:"unselectAll",value:function(){var t=this;this.data.nodes.forEach((function(e){t.unselectAt(e)}))}},{key:"getNodeDataAt",value:function(t){if(t.type&&("relation"==t.type||"tree"==t.type))return t;if("string"==typeof t){var e=t.split(",");if(1==e.length)return this.data.nodes.find((function(e){return e.key==t}));if(2==e.length)return this.data.edges.find((function(t){return t.key.join()==e.join()}))}}},{key:"_setTreePoints",value:function(t){var e=t.points;"TB"!=this.rankdir&&"BT"!=this.rankdir||(e[0]={x:t.source.x,y:t.source.y+("BT"==this.rankdir?-1:1)*t.source.height/2},e.splice(1,0,{x:t.source.x,y:e.slice(-2,-1)[0].y})),"LR"!=this.rankdir&&"RL"!=this.rankdir||(e[0]={x:t.source.x+("RL"==this.rankdir?-1:1)*t.source.width/2,y:t.source.y},e.splice(1,0,{x:e.slice(-2,-1)[0].x,y:t.source.y})),t.points=e}},{key:"_getLineShape",value:function(t,e){var n=t.points,i={type:"path",pointList:null,path:o},a=n[0],r=n.slice(-1)[0],o="M"+a.x+" "+a.y;return"bezier"==t.shapeType&&(3==n.length&&(o+=",Q"+n[1].x+" "+n[1].y+" "+r.x+" "+r.y),4==n.length&&(o+=",C"+n[1].x+" "+n[1].y+" "+n[2].x+" "+n[2].y+" "+r.x+" "+r.y),n.length>=5)?(i.type="brokenLine",i.pointList=n.map((function(t){return[t.x,t.y]})),i):("brokenLine"==t.shapeType&&v.each(n,(function(t,i){if(i)if(e&&i<n.length-1){var a=n[i-1],r=n[i+1],l=e,s=Math.max(Math.abs(a.x-t.x)/2,Math.abs(a.y-t.y)/2),u=Math.max(Math.abs(r.x-t.x)/2,Math.abs(r.y-t.y)/2);if(l=v.min([l,s,u]),t.x==a.x&&t.y==a.y||t.x==r.x&&t.y==r.y||Math.atan2(t.y-a.y,t.x-a.x)==Math.atan2(r.y-t.y,r.x-t.x))return;var d=function(e){var n=Math.atan2(e.y-t.y,e.x-t.x);return{x:t.x+l*Math.cos(n),y:t.y+l*Math.sin(n)}},h=d(a),f=d(r);o+=",L"+h.x+" "+h.y+",Q"+t.x+" "+t.y+" "+f.x+" "+f.y}else o+=",L"+t.x+" "+t.y})),i.path=o,i)}},{key:"_checkHtml",value:function(t){return/<[^>]+>/g.test(t)}},{key:"_getContent",value:function(t){var e,n=this,i=this.node.content.field;if(this._isField(i)&&(e=t[i]),n.node.content.format&&v.isFunction(n.node.content.format))e=n.node.content.format.apply(this,[e,t]);else{var a=n.app.getComponent({name:"coord"}).getFieldConfig(i);a&&(e=a.getFormatValue(e))}return e}},{key:"_isField",value:function(t){return~this.dataFrame.fields.indexOf(t)}},{key:"_initContentAndGetSize",value:function(t){var e=this,n=t.ctype;return e._isField(n)&&(n=t.rowData[n]),!n&&(n="canvas"),"canvas"==n?e._getEleAndsetCanvasSize(t):"html"==n?e._getEleAndsetHtmlSize(t):void 0}},{key:"_getEleAndsetCanvasSize",value:function(t){var e=this,n=this;return new Promise((function(i){var a,r=t.content,o=t.rowData.width,l=t.rowData.height,s={fillStyle:n.getProp(n.node.content.fontColor,t),textAlign:n.getProp(n.node.content.textAlign,t),textBaseline:n.getProp(n.node.content.textBaseline,t)},u="content_label_"+t.key,h=n.nodesContentSp.getChildById(u);h?(h.resetText(r),v.extend(h.context,s)):((h=new d.default.Display.Text(r,{id:u,context:s})).context.visible=!1,v.isArray(t.key)||n.nodesContentSp.addChild(h)),e.node.content.init&&"function"==typeof e.node.content.init&&(a=e.node.content.init(t,h)),a&&"function"==typeof a.then?a.then((function(){o||(o=h.getTextWidth()+n.getProp(n.node.padding,t)*n.status.transform.scale*2),l||(l=h.getTextHeight()+n.getProp(n.node.padding,t)*n.status.transform.scale*2),i({contentElement:h,width:o,height:l})})):(o||(o=h.getTextWidth()+n.getProp(n.node.padding,t)*n.status.transform.scale*2),l||(l=h.getTextHeight()+n.getProp(n.node.padding,t)*n.status.transform.scale*2),i({contentElement:h,width:o,height:l}))}))}},{key:"_getEleAndsetHtmlSize",value:function(t){var e=this,n=this;return new Promise((function(i){var a,r=t.content,o=t.rowData.width,l=t.rowData.height,s="__content_label_"+t.key,u=e.domContainer.getElementsByClassName(s);u.length?u=u[0]:((u=document.createElement("div")).className="chartx_relation_node "+s,u.style.cssText+="; position:absolute;visibility:hidden;",e.domContainer.appendChild(u)),u.style.cssText+="; color:"+n.getProp(n.node.content.fontColor,t)+";",u.style.cssText+="; text-align:"+n.getProp(n.node.content.textAlign,t)+";",u.style.cssText+="; vertical-align:"+n.getProp(n.node.content.textBaseline,t)+";",u.innerHTML=r,e.node.content.init&&"function"==typeof e.node.content.init&&(a=e.node.content.init(t,u)),a&&"function"==typeof a.then?a.then((function(t){o||(o=u.offsetWidth),l||(l=u.offsetHeight),i({contentElement:u,width:o,height:l})})):(o||(o=u.offsetWidth),l||(l=u.offsetHeight),i({contentElement:u,width:o,height:l}))}))}},{key:"getNodesAt",value:function(){}},{key:"getProp",value:function(t,e){var n=t;return this._isField(t)?n=e.rowData[t]:(v.isArray(t)&&(n=t[e.iNode]),v.isFunction(t)&&(n=t.apply(this,[e]))),n}}],[{key:"defaultProps",value:function(){return{field:{detail:"key字段设置",documentation:"",default:null},childrenField:{detail:"树结构数据的关联字段",documentation:"如果是树结构的关联数据，不是行列式，那么就通过这个字段来建立父子关系",default:"children"},rankdir:{detail:"布局方向",default:null},node:{detail:"单个节点的配置",propertys:{shapeType:{detail:"节点图形，支持rect,diamond",default:"rect"},maxWidth:{detail:"节点最大的width",default:200},cursor:{detail:"节点的鼠标样式",default:"pointer"},width:{detail:"内容的width",default:null},height:{detail:"内容的height",default:null},radius:{detail:"圆角角度，对rect生效",default:6},includedAngle:{detail:"shapeType为diamond(菱形)的时候生效,x方向的夹角",default:60},fillStyle:{detail:"节点背景色",default:"#ffffff"},lineWidth:{detail:"描边宽度",default:1},strokeStyle:{detail:"描边颜色",default:"#e5e5e5"},shadow:{detail:"阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},select:{detail:"选中效果",propertys:{enabled:{detail:"是否开启选中",default:!1},list:{detail:"选中的node.key的集合,外部传入可以选中",default:[]},triggerEventType:{detail:"触发事件",default:"click,tap"},shadow:{detail:"选中效果的阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},fillStyle:{detail:"hover节点背景色",default:"#ffffff"},lineWidth:{detail:"hover描边宽度",default:1},strokeStyle:{detail:"hover描边颜色",default:"#e5e5e5"},onbefore:{detail:"执行select处理函数的前处理函数，返回false则取消执行select",default:null},onend:{detail:"执行select处理函数的后处理函数",default:null}}},focus:{detail:"hover效果",propertys:{enabled:{detail:"是否开启hover效果",default:!1},shadow:{detail:"选中效果的阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},fillStyle:{detail:"hover节点背景色",default:"#ffffff"},lineWidth:{detail:"hover描边宽度",default:1},strokeStyle:{detail:"hover描边颜色",default:"#e5e5e5"}}},padding:{detail:"node节点容器到内容的边距,节点内容是canvas的时候生效，dom节点不生效",default:10},content:{detail:"节点内容配置",propertys:{field:{detail:"内容字段",documentation:"默认content字段",default:"content"},fontColor:{detail:"内容文本颜色",default:"#666"},format:{detail:"内容格式化处理函数",default:null},textAlign:{detail:"textAlign",default:"center"},textBaseline:{detail:"textBaseline",default:"middle"},init:{detail:"内容节点的初始化完成回调",documentation:"在节点内容配置为需要异步完成的时候，比如节点内容配置为一个magix的view",default:null}}}}},line:{detail:"两个节点连线配置",propertys:{isTree:{detail:"是否树结构的连线",documentation:"非树结构启用该配置可能会有意想不到的惊喜，慎用",default:!1},inflectionRadius:{detail:"树状连线的拐点圆角半径",default:0},shapeType:{detail:"连线的图形样式 brokenLine or bezier",default:"bezier"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"连线的颜色",default:"#e5e5e5"},lineType:{detail:"连线样式（虚线等）",default:"solid"},arrow:{detail:"连线箭头配置",propertys:{enabled:{detail:"是否开启arrow设置",default:!0},offsetX:{detail:"x方向偏移",default:0},offsetY:{detail:"y方向偏移",default:0}}},edgeLabel:{detail:"连线上面的label配置",propertys:{enabled:{detail:"是否开启label设置",default:!0},fontColor:{detail:"文本颜色",default:"#ccc"},fontSize:{detail:"文本大小",default:12},offset:{detail:"label的位置，函数，参数是整个edge对象",default:null}}},icon:{detail:"连线上面的操作icon",propertys:{enabled:{detail:"是否开启线上的icon设置",default:!1},charCode:{detail:"iconfont上面对应的unicode中&#x后面的字符",default:null},lineWidth:{detail:"icon描边线宽",default:1},strokeStyle:{detail:"icon的描边颜色",default:"#e5e5e5"},fontColor:{detail:"icon的颜色",default:"#e5e5e5"},fontFamily:{detail:"font-face的font-family设置",default:"iconfont"},fontSize:{detail:"icon的字体大小",default:14},offset:{detail:"icon的位置，函数，参数是整个edge对象",default:null},offsetX:{detail:"在计算出offset后的X再次便宜量",default:1},offsetY:{detail:"在计算出offset后的Y再次便宜量",default:2},background:{detail:"icon的背景颜色，背景为圆形",default:"#fff"}}},cursor:"default"}},layout:{detail:"采用的布局引擎,比如dagre",default:"dagre"},layoutOpts:{detail:"布局引擎对应的配置,dagre详见dagre的官方wiki",propertys:{}},status:{detail:"一些开关配置",propertys:{transform:{detail:"是否启动拖拽缩放整个画布",propertys:{fitView:{detail:"自动缩放",default:""},enabled:{detail:"是否开启",default:!0},scale:{detail:"缩放值",default:1},scaleOrigin:{detail:"缩放原点",default:{x:0,y:0}},wheelAction:{detail:"滚轮触屏滑动触发的行为，可选有scale和offset，默认offset",default:"offset"}}}}}}}}]),i}(h.default);h.default.registerComponent(A,"graphs","relation");var P=A;e.default=P}));e(Af);var Pf=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Af),h=i(_n),f=i(En);function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var p=u.default._,g=u.default.event,y=(u.default.Shapes.Rect,u.default.Shapes.Diamond,u.default.Shapes.Path,u.default.Shapes.Circle),v=(u.default.Shapes.Arrow,function(t){(0,o.default)(i,t);var e=c(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="tree",o.shrinked=[],p.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o}return(0,a.default)(i,[{key:"_initData",value:function(t){var e=this;return new Promise((function(n){if(t&&t.nodes&&t.edges)n(t);else{var i={nodes:[],edges:[],size:{width:0,height:0}},a=e.app._data;(0,Si.checkDataIsJson)(a,e.field,e.childrenField)?(e.jsonData=(0,Si.jsonToArrayForRelation)(a,e,e.childrenField),e.dataFrame=e.app.dataFrame=(0,h.default)(e.jsonData,e)):e.jsonData=(0,Si.arrayToTreeJsonForRelation)(JSON.parse(JSON.stringify(e.app.dataFrame.jsonOrg)),e);!function t(n,a){n.forEach((function(n){var r=n[e.field],o=e._getContent(n),l=e._getDefNode();if(Object.assign(l,{type:"tree",iNode:n.__index__,rowData:n,key:r,content:o,ctype:e._checkHtml(o)?"html":"canvas"}),l.shapeType=e.getProp(e.node.shapeType,l),Object.assign(l,e.layoutOpts.node),i.nodes.push(l),a){var s=[a[e.field],n[e.field]],u=e._getDefNode(),d={};d[e.field]=s.join(",");var h=e.dataFrame.getRowDataOf(d);if(h&&h.length){var f=h[0],c=e._getContent(f);Object.assign(u,{type:"tree",iNode:f.__index__,rowData:f,key:s,content:c,ctype:e._checkHtml(c)?"html":"canvas"}),u.shapeType=e.getProp(e.line.shapeType,u),Object.assign(u,e.layoutOpts.edge),i.edges.push(u)}}n.children&&-1==e.shrinked.indexOf(r)&&t(n.children,n)}))}(e.jsonData),e._initAllDataSize(i).then((function(t){n(t)}))}}))}},{key:"_drawNodes",value:function(){var t=this,e=this;p.each(this.data.nodes,(function(n){if(t._drawNode(n),t.node.shrink.enabled&&n.rowData.children&&n.rowData.children.length){var i=n.key+"_shrink_icon",a=n.key+"_shrink_icon_back",r=t.node.shrink.openCharCode;-1==t.shrinked.indexOf(n.key)&&(r=t.node.shrink.closeCharCode);var o=String.fromCharCode(parseInt(t.getProp(r,n),16)),l=t.getProp(t.node.shrink.fontSize,n),s=t.getProp(t.node.shrink.fontColor,n),d=t.getProp(t.node.shrink.fontFamily,n),h=t.getProp(t.node.shrink.offsetX,n),c=t.getProp(t.node.shrink.offsetY,n),p=t.getProp(t.node.shrink.tipsContent,n),v=t.getProp(t.node.shrink.background,n),x=t.getProp(t.node.shrink.lineWidth,n),_=t.getProp(t.node.shrink.strokeStyle,n),m=t.labelsSp.getChildById(i),b=t.labelsSp.getChildById(a),w=parseInt(n.x+n.width/2+h),k=parseInt(n.y+c),S={x:w,y:k+1,fontSize:l,fontFamily:d,fillStyle:s,textAlign:"center",textBaseline:"middle",cursor:"pointer"},A={x:w,y:k,r:parseInt(.5*l)+2,fillStyle:v,strokeStyle:_,lineWidth:x};m?(m.resetText(o),Object.assign(m.context,S),Object.assign(b.context,A)):(m=new u.default.Display.Text(o,{id:i,context:S}),b=new y({id:a,context:A}),t.labelsSp.addChild(b),t.labelsSp.addChild(m),m._shrinkIconBack=b,m.on(g.types.get(),(function(i){var a=t.node.shrink;if(i.eventInfo={trigger:a,tipsContent:p,nodes:[]},b.context&&("mousedown"==i.type&&(b.context.r+=1),"mouseup"==i.type&&(b.context.r-=1)),t.node.shrink.triggerEventType.indexOf(i.type)>-1){if(-1==t.shrinked.indexOf(n.key))t.shrinked.push(n.key);else for(var r=0,o=t.shrinked.length;r<o;r++)t.shrinked[r]==n.key&&(t.shrinked.splice(r,1),r--,o--);var l=new f.default(e,{origin:n.key});t.app.resetData(null,l)}t.app.fire(i.type,i)}))),m.nodeData=n,n.shrinkIcon=m,n.shrinkIconBack=b}}))}},{key:"_destroy",value:function(t){if(t.shapeElement&&t.shapeElement.destroy(),t.contentElement.destroy?t.contentElement.destroy():this.domContainer.removeChild(t.contentElement),t.pathElement&&t.pathElement.destroy(),t.labelElement&&t.labelElement.destroy(),t.arrowElement&&t.arrowElement.destroy(),t.edgeIconElement&&t.edgeIconElement.destroy(),t.edgeIconBack&&t.edgeIconBack.destroy(),t.shrinkIcon&&t.shrinkIcon.destroy(),t.shrinkIconBack&&t.shrinkIconBack.destroy(),Array.isArray(t.key)){var e=t.source;this.data.edges.find((function(t){return t.key[0]==e.key}))||(e.shrinkIcon&&e.shrinkIcon.destroy(),e.shrinkIconBack&&e.shrinkIconBack.destroy())}}}],[{key:"defaultProps",value:function(){return{field:{detail:"key字段设置",documentation:"",default:null},node:{detail:"单个节点的配置",propertys:{shrink:{detail:"树状图是否有节点收缩按钮",propertys:{enabled:{detail:"是否开启",default:!0},triggerEventType:{detail:"触发事件",default:"click,tap"},openCharCode:{detail:"点击后触发展开的icon chartCode，当前状态为收缩",default:""},closeCharCode:{detail:"点击后触发收缩的icon chartCode，当前状态为展开",default:""},fontSize:{detail:"icon字号大小",default:12},fontColor:{detail:"icon字体颜色",default:"#666"},fontFamily:{detail:"icon在css中的fontFamily",default:"iconfont"},tipsContent:{detail:"鼠标移动到收缩icon上面的tips内容",default:""},offsetX:{detail:"x方向偏移量",default:10},offsetY:{detail:"y方向偏移量",default:1},background:{detail:"icon的 背景色",default:"#fff"},lineWidth:{detail:"边框大小",default:1},strokeStyle:{detail:"描边颜色",default:"#667894"}}}}}}}}]),i}(d.default));d.default.registerComponent(v,"graphs","tree");var x=v;e.default=x}));e(Pf);var Cf=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(mn),a=i(hn),r=i(fn),o=i(yn),l=i(pn),s=i(vn),u=i(xn),d=i(ln),h=i(Gn),f=i(Ai);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}var g=d.default._,y=d.default.event,v=d.default.Shapes.Rect,x=d.default.Shapes.Diamond,_=(d.default.Shapes.Line,d.default.Shapes.Path),m=d.default.Shapes.BrokenLine,b=d.default.Shapes.Circle,w=d.default.Shapes.Arrow,k=function(t){(0,l.default)(i,t);var e=p(i);function i(t,n,r){var l;return(0,a.default)(this,i),(l=e.call(this,t,n)).type="relation",g.extend(!0,(0,o.default)(l),(0,bn.getDefaultProps)(i.defaultProps()),t),l.domContainer=n.canvax.domView,l.induce=null,l.init(r),l}return(0,r.default)(i,[{key:"init",value:function(t){this._initInduce(),this.nodesSp=new d.default.Display.Sprite({id:"nodesSp"}),this.nodesContentSp=new d.default.Display.Sprite({id:"nodesContentSp"}),this.edgesSp=new d.default.Display.Sprite({id:"edgesSp"}),this.arrowsSp=new d.default.Display.Sprite({id:"arrowsSp"}),this.labelsSp=new d.default.Display.Sprite({id:"labelsSp"}),this.graphsSp=new d.default.Display.Sprite({id:"graphsSp"}),this.graphsView=new d.default.Display.Sprite({id:"graphsView"}),this.graphsSp.addChild(this.edgesSp),this.graphsSp.addChild(this.nodesSp),this.graphsSp.addChild(this.nodesContentSp),this.graphsSp.addChild(this.arrowsSp),this.graphsSp.addChild(this.labelsSp),this.graphsView.addChild(this.graphsSp),this.sprite.addChild(this.graphsView),t.zoom?(this.preGraphsSpPosition=t.graphsSpPosition,this.zoom=t.zoom,this.offset()):this.zoom=new f.default}},{key:"getDefNode",value:function(){var t=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){(0,n.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({type:"relation",iNode:0,rowData:null,key:"",content:"",ctype:"canvas",contentElement:null,width:null,height:null,boundingClientWidth:0,x:null,y:null,shapeType:null,focused:!1,selected:!1},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return t}},{key:"checkNodeSizeForShapeType",value:function(t){if("diamond"==t.shapeType){var e=this.node.includedAngle/2*Math.PI/180,n=t.boundingClientWidth,i=t.height;t._innerBound={width:n,height:i};var a=n+i/Math.tan(e),r=i+n*Math.tan(e);t.boundingClientWidth=a,t.height=r}}},{key:"_initInduce",value:function(){var t=this;this.induce=new v({id:"induce",context:{width:0,height:0,fillStyle:"#000000",globalAlpha:0}}),this.sprite.addChild(this.induce);var e=!1,n=null,i=0;this.induce.on(y.types.get(),(function(a){if(t.status.transform.enabled){var r=t.app.getComponent({name:"contextmenu"});if(!r||!r.isShow){a.preventDefault();var o=a.target.localToGlobal(a.point,t.sprite);if("mousedown"==a.type&&(t.induce.toFront(),e=!0,t.app.canvax.domView&&(t.app.canvax.domView.style.cursor="move"),t.zoom.mouseMoveTo(o)),"mouseup"!=a.type&&"mouseout"!=a.type||(t.induce.toBack(),e=!1,t.app.canvax.domView&&(t.app.canvax.domView.style.cursor="")),"mousemove"==a.type&&e){var l=t.zoom.move(o),s=l.x,u=l.y;t.graphsView.context.x=parseInt(s),t.graphsView.context.y=parseInt(u)}"wheel"==a.type&&(Math.abs(a.deltaY)>Math.abs(i)&&(i=a.deltaY),n||(n=setTimeout((function(){if("offset"==t.status.transform.wheelAction){var e={x:2*-a.deltaX,y:2*-a.deltaY},r=parseInt(t.graphsView.context.x+t.graphsSp.context.x+t.data.viewPort.maxLeft+e.x+t.app.padding.left);r<0&&(e.x=parseInt(e.x-r));var l=parseInt(t.graphsView.context.x+t.graphsSp.context.x+t.data.viewPort.maxRight+e.x+t.app.padding.right);l>=t.app.width&&(e.x=parseInt(e.x-(l-t.app.width)));var s=parseInt(t.graphsView.context.y+t.graphsSp.context.y+t.data.viewPort.maxTop+e.y+t.app.padding.top);s<0&&(e.y=parseInt(e.y-s));var u=parseInt(t.graphsView.context.y+t.graphsSp.context.y+t.data.viewPort.maxBottom+e.y+t.app.padding.bottom);u>=t.app.height&&(e.y=parseInt(e.y-(u-t.app.height)));var d=t.zoom.offset(e),h=d.x,f=d.y;t.graphsView.context.x=h,t.graphsView.context.y=f}if("scale"==t.status.transform.wheelAction){var c=t.zoom.wheel(a,o),p=c.scale,g=c.x,y=c.y;t.graphsView.context.x=g,t.graphsView.context.y=y,t.graphsView.context.scaleX=p,t.graphsView.context.scaleY=p,t.status.transform.scale=p}n=null,i=0}),32)))}}a.eventInfo={trigger:t,iNode:-1},t.app.fire(a.type,a)}))}},{key:"_resetData",value:function(t,e){var n=this,i=this;return this._preData=this.data,new Promise((function(a){n.initData(t,e).then((function(t){n.data=t,n.layoutData();var r=n._preData&&n._preData.nodes||[],o=n._preData&&n._preData.edges||[];if(g.each(r,(function(t){var e=g.find(i.data.nodes,(function(e){return t.key==e.key}));e?(e.focused=t.focused,e.selected=t.selected,e.ctype==t.ctype&&(e.contentElement=t.contentElement)):i._destroy(t)})),g.each(o,(function(t){g.find(i.data.edges,(function(e){return t.key.join("_")==e.key.join("_")}))||i._destroy(t)})),n.widget(),e){var l=e.origin||(e.params||{}).origin;if(null!=l){var s=g.find(r,(function(t){return t.key==l})),u=g.find(n.data.nodes,(function(t){return t.key==l}));if(s&&u){var d={x:parseInt(s.x)-parseInt(u.x),y:parseInt(s.y)-parseInt(u.y)},h=n.zoom.offset(d),f=h.x,c=h.y;i.graphsView.context.x=parseInt(f),i.graphsView.context.y=parseInt(c)}}}a()}))}))}},{key:"_destroy",value:function(t){}},{key:"_drawEdges",value:function(){var t=this;g.each(this.data.edges,(function(e){var n=t._getLineShape(e,t.line.inflectionRadius),i=e.key.join("_"),a=n.type,r=n.path,o=n.pointList,l="path"==a?_:m,s=t.getProp(t.line.lineWidth,e),u=t.getProp(t.line.strokeStyle,e),h=t.getProp(t.line.lineType,e),f=t.getProp(t.line.cursor,e),c="edge_"+i,p=t.edgesSp.getChildById(c);if(p)"path"==a&&(p.context.path=r),"brokenLine"==a&&(p.context.pointList=o),p.context.lineWidth=s,p.context.strokeStyle=u,p.context.lineType=h;else{var g={lineWidth:s,strokeStyle:u,lineType:h,cursor:f};"path"==a&&(g.path=r),"brokenLine"==a&&(g.pointList=o),(p=new l({id:c,context:g})).on(y.types.get(),(function(e){var n=this.nodeData;n.__no_value=!0,e.eventInfo={trigger:t.line,nodes:[n]},t.app.fire(e.type,e)})),t.edgesSp.addChild(p)}e.pathElement=p,p.nodeData=e;var v=e.points.slice(-2,-1)[0];"bezier"==t.line.shapeType&&("TB"!=t.rankdir&&"BT"!=t.rankdir||(v.x+=(e.source.x-e.target.x)/20),"LR"!=t.rankdir&&"RL"!=t.rankdir||(v.y+=(e.source.y-e.target.y)/20));var x="label_"+i;if(t.getProp(t.line.edgeLabel.enabled,e)){var k=t.getProp(t.node.content.textAlign,e),S=t.getProp(t.node.content.textBaseline,e),A=t.getProp(t.line.edgeLabel.fontSize,e),P=t.getProp(t.line.edgeLabel.fontColor,e),C=t.getProp(t.line.icon.offset,e);C||(C={x:e.x,y:e.y});var D=t.labelsSp.getChildById(x);D?(D.resetText(e.content),D.context.x=C.x,D.context.y=C.y,D.context.fontSize=A,D.context.fillStyle=P,D.context.textAlign=k,D.context.textBaseline=S):((D=new d.default.Display.Text(e.content,{id:x,context:{x:C.x,y:C.y,fontSize:A,fillStyle:P,textAlign:k,textBaseline:S}})).on(y.types.get(),(function(e){var n=this.nodeData;n.__no_value=!0,e.eventInfo={trigger:t.line,nodes:[n]},t.app.fire(e.type,e)})),t.labelsSp.addChild(D)),e.labelElement=D,D.nodeData=e}if(t.getProp(t.line.icon.enabled,e)){var O=t.getProp(t.line.icon.charCode,e),T=String.fromCharCode(parseInt(O,16));if(""!=O){var M=t.getProp(t.line.icon.lineWidth,e),E=t.getProp(t.line.icon.strokeStyle,e),R=t.getProp(t.line.icon.fontFamily,e),I=t.getProp(t.line.icon.fontSize,e),L=t.getProp(t.line.icon.fontColor,e),F=t.getProp(t.line.icon.background,e),N="center",B="middle",j=t.getProp(t.line.icon.offset,e),z=t.getProp(t.line.icon.offsetX,e),W=t.getProp(t.line.icon.offsetY,e);j||(j={x:parseInt(e.x)+z,y:parseInt(e.y)+W});var V={x:j.x,y:j.y-1,r:parseInt(.5*I)+2,fillStyle:F,strokeStyle:E,lineWidth:M},G="edge_item_icon_back_"+i,H=t.labelsSp.getChildById(G);H?Object.assign(H.context,V):(H=new b({id:G,context:V}),t.labelsSp.addChild(H)),e.edgeIconBack=H,H.nodeData=e;var Y="edge_item_icon_"+i,X=t.labelsSp.getChildById(Y);X?(X.resetText(T),X.context.x=j.x,X.context.y=j.y,X.context.fontSize=I,X.context.fillStyle=L,X.context.textAlign=N,X.context.textBaseline=B,X.context.fontFamily=R):((X=new d.default.Display.Text(T,{id:Y,context:{x:j.x,y:j.y,fillStyle:L,cursor:"pointer",fontSize:I,textAlign:N,textBaseline:B,fontFamily:R}})).on(y.types.get(),(function(e){var n=this.nodeData;n.__no_value=!0;var i=t.line;t.line.icon["on"+e.type]&&(i=t.line.icon),e.eventInfo={trigger:i,nodes:[n]},t.app.fire(e.type,e)})),t.labelsSp.addChild(X)),e.edgeIconElement=X,X.nodeData=e}}if(t.line.arrow.enabled){var U="arrow_"+i,q=t.arrowsSp.getChildById(U);q?(q.context.x=t.line.arrow.offsetX,q.context.y=t.line.arrow.offsetY,q.context.fillStyle=u,q.context.control.x=v.x,q.context.control.y=v.y,q.context.point=e.points.slice(-1)[0],q.context.strokeStyle=u,q.context.fillStyle=u):(q=new w({id:U,context:{x:t.line.arrow.offsetX,y:t.line.arrow.offsetY,control:v,point:e.points.slice(-1)[0],strokeStyle:u,fillStyle:u}}),t.arrowsSp.addChild(q)),e.arrowElement=q}}))}},{key:"_drawNode",value:function(t){var e=this,n=v,i="node_"+t.key,a=e.node.cursor,r=e._getNodeStyle(t),o=r.lineWidth,l=r.fillStyle,s=r.strokeStyle,u=r.radius,d=r.shadowOffsetX,h=r.shadowOffsetY,f=r.shadowBlur,c=r.shadowColor,p={x:parseInt(t.x)-parseInt(t.boundingClientWidth/2),y:parseInt(t.y)-parseInt(t.height/2),width:t.boundingClientWidth,height:t.height,cursor:a,lineWidth:o,fillStyle:l,strokeStyle:s,radius:u,shadowOffsetX:d,shadowOffsetY:h,shadowBlur:f,shadowColor:c};"diamond"==t.shapeType&&(n=x,p={x:parseInt(t.x),y:parseInt(t.y),cursor:a,innerRect:t._innerBound,lineWidth:o,fillStyle:l,strokeStyle:s,shadowOffsetX:d,shadowOffsetY:h,shadowBlur:f,shadowColor:c});var _=e.nodesSp.getChildById(i);_?(g.extend(_.context,p),_.nodeData=t,_.fire("transform")):(_=new n({id:i,hoverClone:!1,context:p}),e.nodesSp.addChild(_),_.on(y.types.get(),(function(t){var n=this.nodeData;if(n.__no_value=!0,t.eventInfo={trigger:e.node,nodes:[n]},e.node.focus.enabled&&("mouseover"==t.type&&e.focusAt(this.nodeData),"mouseout"==t.type&&e.unfocusAt(this.nodeData)),e.node.select.enabled&&e.node.select.triggerEventType.indexOf(t.type)>-1){var i=e.node.select.onbefore,a=e.node.select.onend;(!i||"function"==typeof i&&!1!==i.apply(e,[this.nodeData,t]))&&(this.nodeData.selected?e.unselectAt(this.nodeData):e.selectAt(this.nodeData),a&&"function"==typeof a&&a.apply(e,[this.nodeData,t]))}e.app.fire(t.type,t)})),_.nodeData=t),t.shapeElement=_,e.node.select.list.indexOf(t.key)>-1&&e.selectAt(t),"canvas"==t.ctype&&(t.contentElement.context.visible=!0),_.on("transform",(function(){var t=this.nodeData;if("canvas"==t.ctype)t.contentElement.context.x=parseInt(t.x-t.boundingClientWidth/2+e.node.padding+(t.preIconCharCode?20:0)),t.contentElement.context.y=parseInt(t.y);else if("html"==t.ctype){var n="undefined"!=typeof window?window.devicePixelRatio:1,i=_.worldTransform.clone();i=i.scale(1/n,1/n),t.contentElement.style.transform="matrix("+i.toArray().join()+")",t.contentElement.style.transformOrigin="left top","diamond"==t.shapeType&&(t.contentElement.style.left=-parseInt((t.boundingClientWidth-t._innerBound.width)/2*e.status.transform.scale)+"px",t.contentElement.style.top=-parseInt(t.height/2*e.status.transform.scale)+"px"),t.contentElement.style.visibility="visible"}}))}},{key:"_getNodeStyle",value:function(t,e){var n=this,i=g.flatten([n.getProp(n.node.radius,t)]),a=n.node;return"select"==e&&(a=n.node.select),"focus"==e&&(a=n.node.focus),{lineWidth:n.getProp(a.lineWidth,t),fillStyle:n.getProp(a.fillStyle,t),strokeStyle:n.getProp(a.strokeStyle,t),radius:i,shadowOffsetX:n.getProp(a.shadow.shadowOffsetX,t),shadowOffsetY:n.getProp(a.shadow.shadowOffsetY,t),shadowBlur:n.getProp(a.shadow.shadowBlur,t),shadowColor:n.getProp(a.shadow.shadowColor,t)}}},{key:"_setNodeStyle",value:function(t,e){var n=this._getNodeStyle(t,e),i=n.lineWidth,a=n.fillStyle,r=n.strokeStyle,o=n.shadowOffsetX,l=n.shadowOffsetY,s=n.shadowBlur,u=n.shadowColor;if(t.shapeElement&&t.shapeElement.context){var d=t.shapeElement.context;d.lineWidth=i,d.fillStyle=a,d.strokeStyle=r,d.shadowOffsetX=o,d.shadowOffsetY=l,d.shadowBlur=s,d.shadowColor=u}}},{key:"offset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},e=this.zoom.offset(t),n=e.x,i=e.y;this.graphsView.context.x=parseInt(n),this.graphsView.context.y=parseInt(i)}},{key:"setNodeToCenter",value:function(t){var e=this.getNodeDataAt(t);if(e){var n=e.shapeElement.localToGlobal(),i={x:this.app.width/2-e.width/2,y:this.app.height/2-e.height/2},a={x:parseInt(i.x-n.x),y:parseInt(i.y-n.y)};this.offset(a)}}},{key:"focusAt",value:function(t){var e=this.getNodeDataAt(t);e&&(!e.selected&&this._setNodeStyle(e,"focus"),e.focused=!0)}},{key:"unfocusAt",value:function(t){var e=this.getNodeDataAt(t);e&&(!e.selected&&this._setNodeStyle(e),e.focused=!1)}},{key:"selectAt",value:function(t){var e=this.getNodeDataAt(t);e&&(this._setNodeStyle(e,"select"),e.selected=!0,-1==this.node.select.list.indexOf(e.key)&&this.node.select.list.push(e.key))}},{key:"selectAll",value:function(){var t=this;this.data.nodes.forEach((function(e){t.selectAt(e)}))}},{key:"unselectAt",value:function(t){var e=this.getNodeDataAt(t);if(e){e.focused?this._setNodeStyle(e,"focus"):this._setNodeStyle(e),e.selected=!1;var n=this.node.select.list.indexOf(e.key);n>-1&&this.node.select.list.splice(n,1)}}},{key:"unselectAll",value:function(){var t=this;this.data.nodes.forEach((function(e){t.unselectAt(e)})),this.node.select.list=[]}},{key:"getNodeDataAt",value:function(t){if(t.type&&("relation"==t.type||"tree"==t.type))return t;if("string"==typeof t){var e=t.split(",");if(1==e.length)return this.data.nodes.find((function(e){return e.key==t}));if(2==e.length)return this.data.edges.find((function(t){return t.key.join()==e.join()}))}}},{key:"_getLineShape",value:function(t,e){var n=t.points,i={type:"path",pointList:null,path:r},a=n.splice(0,1)[0],r="M"+a.x+" "+a.y,o=n[0];r+=",L"+o.x+" "+o.y;var l=n.slice(-1)[0];if("bezier"==t.shapeType&&(3==n.length&&(r+=",Q"+n[1].x+" "+n[1].y+" "+l.x+" "+l.y),4==n.length&&(r+=",C"+n[1].x+" "+n[1].y+" "+n[2].x+" "+n[2].y+" "+l.x+" "+l.y),n.length>=5))return i.type="brokenLine",i.pointList=n.map((function(t){return[t.x,t.y]})),i;if("brokenLine"==t.shapeType&&(3==n.length&&n.splice(1,0,{x:n[1].x,y:o.y}),g.each(n,(function(t,i){if(i)if(e&&i<n.length-1){var a=n[i-1],o=n[i+1],l=e,s=Math.max(Math.abs(a.x-t.x)/2,Math.abs(a.y-t.y)/2),u=Math.max(Math.abs(o.x-t.x)/2,Math.abs(o.y-t.y)/2);if(l=g.min([l,s,u]),t.x==a.x&&t.y==a.y||t.x==o.x&&t.y==o.y||Math.atan2(t.y-a.y,t.x-a.x)==Math.atan2(o.y-t.y,o.x-t.x))return;var d=function(e){var n=Math.atan2(e.y-t.y,e.x-t.x);return{x:t.x+l*Math.cos(n),y:t.y+l*Math.sin(n)}},h=d(a),f=d(o);r+=",L"+h.x+" "+h.y+",Q"+t.x+" "+t.y+" "+f.x+" "+f.y}else r+=",L"+t.x+" "+t.y}))),"underLine"==t.target.shapeType){var s=t.target.rowData._node.boundingClientWidth,u=parseInt(t.target.x)+parseInt(s/2);r+=",L"+u+" "+(parseInt(t.target.y)+parseInt(t.target.height/2))}return i.path=r,i}},{key:"_checkHtml",value:function(t){return/<[^>]+>/g.test(t)}},{key:"_getContent",value:function(t){var e,n=this,i=this.node.content.field;if(this._isField(i)&&(e=t[i]),n.node.content.format&&g.isFunction(n.node.content.format))e=n.node.content.format.apply(this,[e,t]);else{var a=n.app.getComponent({name:"coord"}).getFieldConfig(i);a&&(e=a.getFormatValue(e))}return e}},{key:"_isField",value:function(t){return~this.dataFrame.fields.indexOf(t)}},{key:"_getEleAndsetCanvasSize",value:function(t){var e=this,n=this;return new Promise((function(i){var a=t.content,r=n.getProp(n.node.width,t);!r&&t.width&&(r=t.width);var o=n.getProp(n.node.height,t);!o&&t.height&&(o=t.height);var l=n.getProp(n.node.content.fontColor,t);t.rowData.fontColor&&(l=t.rowData.fontColor),t.rowData.style&&t.rowData.style.fontColor&&(l=t.rowData.style.fontColor);var s,u={fillStyle:l,textAlign:n.getProp(n.node.content.textAlign,t),textBaseline:n.getProp(n.node.content.textBaseline,t),fontSize:n.getProp(n.node.content.fontSize,t)},h="content_label_"+t.key,f=t.contentElement||n.nodesContentSp.getChildById(h);f?(f.resetText(a),g.extend(f.context,u)):((f=new d.default.Display.Text(a,{id:h,context:u})).context.visible=!1,g.isArray(t.key)||n.nodesContentSp.addChild(f)),e.node.content.init&&"function"==typeof e.node.content.init&&(s=e.node.content.init(t,f));var c=function(){r||(r=f.getTextWidth()+n.getProp(n.node.padding,t)*n.status.transform.scale*2),o||(o=f.getTextHeight()+n.getProp(n.node.padding,t)*n.status.transform.scale*2),i({contentElement:f,width:parseInt(r),height:parseInt(o)})};s&&"function"==typeof s.then?s.then((function(){c()})):c()}))}},{key:"_getEleAndsetHtmlSize",value:function(t){var e=this,n=this;return new Promise((function(i){var a=t.content,r=n.getProp(n.node.width,t);!r&&n.node.rowData&&t.rowData.width&&(r=t.rowData.width);var o=n.getProp(n.node.height,t);!o&&n.node.rowData&&t.rowData.height&&(o=t.rowData.height);var l,s="__content_label_"+t.key,u=t.contentElement||e.domContainer.getElementsByClassName(s)[0];u||((u=document.createElement("div")).className="chartx_relation_node "+s,u.style.cssText+="; position:absolute;visibility:hidden;",e.domContainer.appendChild(u)),u.style.cssText+="; color:"+n.getProp(n.node.content.fontColor,t)+";",u.style.cssText+="; text-align:"+n.getProp(n.node.content.textAlign,t)+";",u.style.cssText+="; vertical-align:"+n.getProp(n.node.content.textBaseline,t)+";",u.innerHTML=a,e.node.content.init&&"function"==typeof e.node.content.init&&(l=e.node.content.init(t,u));var d=function(){r||(r=u.offsetWidth),o||(o=u.offsetHeight),i({contentElement:u,width:parseInt(r),height:parseInt(o)})};l&&"function"==typeof l.then?l.then((function(t){d()})):d()}))}},{key:"getNodesAt",value:function(){}},{key:"getProp",value:function(t,e){var n=t;return this._isField(t)?n=e.rowData[t]:(g.isArray(t)&&(n=t[e.iNode]),g.isFunction(t)&&(n=t.apply(this,Array.prototype.slice.call(arguments).slice(1)))),n}}],[{key:"defaultProps",value:function(){return{field:{detail:"key字段设置",documentation:"",default:null},rankdir:{detail:"布局方向",default:null},ranksep:{detail:"排与排之间的距离",default:40},nodesep:{detail:"同级node之间的距离",default:20},node:{detail:"单个节点的配置",propertys:{shapeType:{detail:"节点图形，支持rect,diamond,underLine(adc用)",default:"rect"},maxWidth:{detail:"节点最大的width",default:200},cursor:{detail:"节点的鼠标样式",default:"pointer"},width:{detail:"节点的width,默认null（系统自动计算）, 也可以是个function，用户来计算每一个节点的width",default:null},height:{detail:"节点的height,默认null（系统自动计算）, 也可以是个function，用户来计算每一个节点的height",default:null},radius:{detail:"圆角角度，对rect生效",default:4},includedAngle:{detail:"shapeType为 diamond (菱形)的时候生效,x方向的夹角",default:60},fillStyle:{detail:"节点背景色",default:"#ffffff"},lineWidth:{detail:"描边宽度",default:1},strokeStyle:{detail:"描边颜色",default:"#e5e5e5"},shadow:{detail:"阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},select:{detail:"选中效果",propertys:{enabled:{detail:"是否开启选中",default:!1},list:{detail:"选中的node.key的集合,外部传入可以选中",default:[]},triggerEventType:{detail:"触发事件",default:"click,tap"},shadow:{detail:"选中效果的阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},fillStyle:{detail:"hover节点背景色",default:"#ffffff"},lineWidth:{detail:"hover描边宽度",default:1},strokeStyle:{detail:"hover描边颜色",default:"#e5e5e5"},onbefore:{detail:"执行select处理函数的前处理函数，返回false则取消执行select",default:null},onend:{detail:"执行select处理函数的后处理函数",default:null},content:{detail:"选中后节点内容配置",propertys:{fontColor:{detail:"内容文本颜色",default:"#666"},fontSize:{detail:"内容文本大小（在canvas格式下有效）",default:14},format:{detail:"内容格式化处理函数",default:null}}}}},focus:{detail:"hover效果",propertys:{enabled:{detail:"是否开启hover效果",default:!1},shadow:{detail:"选中效果的阴影设置",propertys:{shadowOffsetX:{detail:"x偏移量",default:0},shadowOffsetY:{detail:"y偏移量",default:0},shadowBlur:{detail:"阴影模糊值",default:0},shadowColor:{detail:"阴影颜色",default:"#000000"}}},fillStyle:{detail:"hover节点背景色",default:"#ffffff"},content:{detail:"hover后节点内容配置",propertys:{fontColor:{detail:"内容文本颜色",default:"#666"},fontSize:{detail:"内容文本大小（在canvas格式下有效）",default:14},format:{detail:"内容格式化处理函数",default:null}}},lineWidth:{detail:"hover描边宽度",default:1},strokeStyle:{detail:"hover描边颜色",default:"#e5e5e5"}}},padding:{detail:"node节点容器到内容的边距,节点内容是canvas的时候生效，dom节点不生效",default:10},content:{detail:"节点内容配置",propertys:{field:{detail:"内容字段",documentation:"默认content字段",default:"content"},fontColor:{detail:"内容文本颜色",default:"#666"},fontSize:{detail:"内容文本大小（在canvas格式下有效）",default:14},format:{detail:"内容格式化处理函数",default:null},textAlign:{detail:"textAlign",default:"center"},textBaseline:{detail:"textBaseline",default:"middle"},init:{detail:"内容节点的初始化完成回调",documentation:"在节点内容配置为需要异步完成的时候，比如节点内容配置为一个magix的view",default:null}}}}},line:{detail:"两个节点连线配置",propertys:{isTree:{detail:"是否树结构的连线",documentation:"非树结构启用该配置可能会有意想不到的惊喜，慎用",default:!1},inflectionRadius:{detail:"树状连线的拐点圆角半径",default:0},shapeType:{detail:"连线的图形样式 brokenLine or bezier",default:"bezier"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"连线的颜色",default:"#e5e5e5"},lineType:{detail:"连线样式（虚线等）",default:"solid"},arrow:{detail:"连线箭头配置",propertys:{enabled:{detail:"是否开启arrow设置",default:!0},offsetX:{detail:"x方向偏移",default:0},offsetY:{detail:"y方向偏移",default:0}}},edgeLabel:{detail:"连线上面的label配置",propertys:{enabled:{detail:"是否开启label设置",default:!0},fontColor:{detail:"文本颜色",default:"#ccc"},fontSize:{detail:"文本大小",default:12},offset:{detail:"label的位置，函数，参数是整个edge对象",default:null}}},icon:{detail:"连线上面的操作icon",propertys:{enabled:{detail:"是否开启线上的icon设置",default:!1},charCode:{detail:"iconfont上面对应的unicode中&#x后面的字符",default:null},lineWidth:{detail:"icon描边线宽",default:1},strokeStyle:{detail:"icon的描边颜色",default:"#e5e5e5"},fontColor:{detail:"icon的颜色",default:"#e5e5e5"},fontFamily:{detail:"font-face的font-family设置",default:"iconfont"},fontSize:{detail:"icon的字体大小",default:14},offset:{detail:"icon的位置，函数，参数是整个edge对象",default:null},offsetX:{detail:"在计算出offset后的X再次便宜量",default:1},offsetY:{detail:"在计算出offset后的Y再次便宜量",default:2},background:{detail:"icon的背景颜色，背景为圆形",default:"#fff"}}},cursor:"default"}},status:{detail:"一些开关配置",propertys:{transform:{detail:"是否启动拖拽缩放整个画布",propertys:{fitView:{detail:"自动缩放",default:""},enabled:{detail:"是否开启",default:!0},scale:{detail:"缩放值",default:1},scaleOrigin:{detail:"缩放原点",default:{x:0,y:0}},wheelAction:{detail:"滚轮触屏滑动触发的行为，可选有scale和offset，默认offset",default:"offset"}}}}}}}}]),i}(h.default),S=k;e.default=S}));function Df(t,e){return t.parent===e.parent?1:2}function Of(t,e){return t+e.x}function Tf(t,e){return Math.max(t,e.y)}function Mf(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;--i>=0;)e+=n[i].value;else e=1;t.value=e}function Ef(t,e){var n,i,a,r,o,l=new Ff(t),s=+t.value&&(l.value=t.value),u=[l];for(null==e&&(e=Rf);n=u.pop();)if(s&&(n.value=+n.data.value),(a=e(n.data))&&(o=a.length))for(n.children=new Array(o),r=o-1;r>=0;--r)u.push(i=n.children[r]=new Ff(a[r])),i.parent=n,i.depth=n.depth+1;return l.eachBefore(Lf)}function Rf(t){return t.children}function If(t){t.data=t.data.data}function Lf(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Ff(t){this.data=t,this.depth=this.height=0,this.parent=null}e(Cf),Ff.prototype=Ef.prototype={constructor:Ff,count:function(){return this.eachAfter(Mf)},each:function(t){var e,n,i,a,r=this,o=[r];do{for(e=o.reverse(),o=[];r=e.pop();)if(t(r),n=r.children)for(i=0,a=n.length;i<a;++i)o.push(n[i])}while(o.length);return this},eachAfter:function(t){for(var e,n,i,a=this,r=[a],o=[];a=r.pop();)if(o.push(a),e=a.children)for(n=0,i=e.length;n<i;++n)r.push(e[n]);for(;a=o.pop();)t(a);return this},eachBefore:function(t){for(var e,n,i=this,a=[i];i=a.pop();)if(t(i),e=i.children)for(n=e.length-1;n>=0;--n)a.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,i=e.children,a=i&&i.length;--a>=0;)n+=i[a].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),a=null;t=n.pop(),e=i.pop();for(;t===e;)a=t,t=n.pop(),e=i.pop();return a}(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var a=i.length;t!==n;)i.splice(a,0,t),t=t.parent;return i},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Ef(this).eachBefore(If)}};var Nf=Array.prototype.slice;function Bf(t){for(var e,n,i=0,a=(t=function(t){for(var e,n,i=t.length;i;)n=Math.random()*i--|0,e=t[i],t[i]=t[n],t[n]=e;return t}(Nf.call(t))).length,r=[];i<a;)e=t[i],n&&Wf(n,e)?++i:(n=Gf(r=jf(r,e)),i=0);return n}function jf(t,e){var n,i;if(Vf(e,t))return[e];for(n=0;n<t.length;++n)if(zf(e,t[n])&&Vf(Hf(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(zf(Hf(t[n],t[i]),e)&&zf(Hf(t[n],e),t[i])&&zf(Hf(t[i],e),t[n])&&Vf(Yf(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}function zf(t,e){var n=t.r-e.r,i=e.x-t.x,a=e.y-t.y;return n<0||n*n<i*i+a*a}function Wf(t,e){var n=t.r-e.r+1e-6,i=e.x-t.x,a=e.y-t.y;return n>0&&n*n>i*i+a*a}function Vf(t,e){for(var n=0;n<e.length;++n)if(!Wf(t,e[n]))return!1;return!0}function Gf(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return Hf(t[0],t[1]);case 3:return Yf(t[0],t[1],t[2])}}function Hf(t,e){var n=t.x,i=t.y,a=t.r,r=e.x,o=e.y,l=e.r,s=r-n,u=o-i,d=l-a,h=Math.sqrt(s*s+u*u);return{x:(n+r+s/h*d)/2,y:(i+o+u/h*d)/2,r:(h+a+l)/2}}function Yf(t,e,n){var i=t.x,a=t.y,r=t.r,o=e.x,l=e.y,s=e.r,u=n.x,d=n.y,h=n.r,f=i-o,c=i-u,p=a-l,g=a-d,y=s-r,v=h-r,x=i*i+a*a-r*r,_=x-o*o-l*l+s*s,m=x-u*u-d*d+h*h,b=c*p-f*g,w=(p*m-g*_)/(2*b)-i,k=(g*y-p*v)/b,S=(c*_-f*m)/(2*b)-a,A=(f*v-c*y)/b,P=k*k+A*A-1,C=2*(r+w*k+S*A),D=w*w+S*S-r*r,O=-(P?(C+Math.sqrt(C*C-4*P*D))/(2*P):D/C);return{x:i+w+k*O,y:a+S+A*O,r:O}}function Xf(t,e,n){var i=t.x,a=t.y,r=e.r+n.r,o=t.r+n.r,l=e.x-i,s=e.y-a,u=l*l+s*s;if(u){var d=.5+((o*=o)-(r*=r))/(2*u),h=Math.sqrt(Math.max(0,2*r*(o+u)-(o-=u)*o-r*r))/(2*u);n.x=i+d*l+h*s,n.y=a+d*s-h*l}else n.x=i+o,n.y=a}function Uf(t,e){var n=e.x-t.x,i=e.y-t.y,a=t.r+e.r;return a*a-1e-6>n*n+i*i}function qf(t){var e=t._,n=t.next._,i=e.r+n.r,a=(e.x*n.r+n.x*e.r)/i,r=(e.y*n.r+n.y*e.r)/i;return a*a+r*r}function $f(t){this._=t,this.next=null,this.previous=null}function Jf(t){if(!(a=t.length))return 0;var e,n,i,a,r,o,l,s,u,d,h;if((e=t[0]).x=0,e.y=0,!(a>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(a>2))return e.r+n.r;Xf(n,e,i=t[2]),e=new $f(e),n=new $f(n),i=new $f(i),e.next=i.previous=n,n.next=e.previous=i,i.next=n.previous=e;t:for(l=3;l<a;++l){Xf(e._,n._,i=t[l]),i=new $f(i),s=n.next,u=e.previous,d=n._.r,h=e._.r;do{if(d<=h){if(Uf(s._,i._)){n=s,e.next=n,n.previous=e,--l;continue t}d+=s._.r,s=s.next}else{if(Uf(u._,i._)){(e=u).next=n,n.previous=e,--l;continue t}h+=u._.r,u=u.previous}}while(s!==u.next);for(i.previous=e,i.next=n,e.next=n.previous=n=i,r=qf(e);(i=i.next)!==n;)(o=qf(i))<r&&(e=i,r=o);n=e.next}for(e=[n._],i=n;(i=i.next)!==n;)e.push(i._);for(i=Bf(e),l=0;l<a;++l)(e=t[l]).x-=i.x,e.y-=i.y;return i.r}function Zf(t){if("function"!=typeof t)throw new Error;return t}function Qf(){return 0}function Kf(t){return function(){return t}}function tc(t){return Math.sqrt(t.value)}function ec(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function nc(t,e){return function(n){if(i=n.children){var i,a,r,o=i.length,l=t(n)*e||0;if(l)for(a=0;a<o;++a)i[a].r+=l;if(r=Jf(i),l)for(a=0;a<o;++a)i[a].r-=l;n.r=r+l}}}function ic(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function ac(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function rc(t,e,n,i,a){for(var r,o=t.children,l=-1,s=o.length,u=t.value&&(i-e)/t.value;++l<s;)(r=o[l]).y0=n,r.y1=a,r.x0=e,r.x1=e+=r.value*u}var oc={depth:-1},lc={};function sc(t){return t.id}function uc(t){return t.parentId}function dc(t,e){return t.parent===e.parent?1:2}function hc(t){var e=t.children;return e?e[0]:t.t}function fc(t){var e=t.children;return e?e[e.length-1]:t.t}function cc(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function pc(t,e,n){return t.a.parent===e.parent?t.a:n}function gc(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function yc(t,e,n,i,a){for(var r,o=t.children,l=-1,s=o.length,u=t.value&&(a-n)/t.value;++l<s;)(r=o[l]).x0=e,r.x1=i,r.y0=n,r.y1=n+=r.value*u}gc.prototype=Object.create(Ff.prototype);var vc=(1+Math.sqrt(5))/2;function xc(t,e,n,i,a,r){for(var o,l,s,u,d,h,f,c,p,g,y,v=[],x=e.children,_=0,m=0,b=x.length,w=e.value;_<b;){s=a-n,u=r-i;do{d=x[m++].value}while(!d&&m<b);for(h=f=d,y=d*d*(g=Math.max(u/s,s/u)/(w*t)),p=Math.max(f/y,y/h);m<b;++m){if(d+=l=x[m].value,l<h&&(h=l),l>f&&(f=l),y=d*d*g,(c=Math.max(f/y,y/h))>p){d-=l;break}p=c}v.push(o={value:d,dice:s<u,children:x.slice(_,m)}),o.dice?rc(o,n,i,a,w?i+=u*d/w:r):yc(o,n,i,w?n+=s*d/w:a,r),w-=d,_=m}return v}var _c=function t(e){function n(t,n,i,a,r){xc(e,t,n,i,a,r)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(vc);var mc=function t(e){function n(t,n,i,a,r){if((o=t._squarify)&&o.ratio===e)for(var o,l,s,u,d,h=-1,f=o.length,c=t.value;++h<f;){for(s=(l=o[h]).children,u=l.value=0,d=s.length;u<d;++u)l.value+=s[u].value;l.dice?rc(l,n,i,a,i+=(r-i)*l.value/c):yc(l,n,i,n+=(a-n)*l.value/c,r),c-=l.value}else t._squarify=o=xc(e,t,n,i,a,r),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(vc),bc=Object.freeze({__proto__:null,cluster:function(){var t=Df,e=1,n=1,i=!1;function a(a){var r,o=0;a.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(Of,0)/t.length}(n),e.y=function(t){return 1+t.reduce(Tf,0)}(n)):(e.x=r?o+=t(e,r):0,e.y=0,r=e)}));var l=function(t){for(var e;e=t.children;)t=e[0];return t}(a),s=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(a),u=l.x-t(l,s)/2,d=s.x+t(s,l)/2;return a.eachAfter(i?function(t){t.x=(t.x-a.x)*e,t.y=(a.y-t.y)*n}:function(t){t.x=(t.x-u)/(d-u)*e,t.y=(1-(a.y?t.y/a.y:1))*n})}return a.separation=function(e){return arguments.length?(t=e,a):t},a.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],a):i?null:[e,n]},a.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],a):i?[e,n]:null},a},hierarchy:Ef,pack:function(){var t=null,e=1,n=1,i=Qf;function a(a){return a.x=e/2,a.y=n/2,t?a.eachBefore(ec(t)).eachAfter(nc(i,.5)).eachBefore(ic(1)):a.eachBefore(ec(tc)).eachAfter(nc(Qf,1)).eachAfter(nc(i,a.r/Math.min(e,n))).eachBefore(ic(Math.min(e,n)/(2*a.r))),a}return a.radius=function(e){return arguments.length?(t=null==(n=e)?null:Zf(n),a):t;var n},a.size=function(t){return arguments.length?(e=+t[0],n=+t[1],a):[e,n]},a.padding=function(t){return arguments.length?(i="function"==typeof t?t:Kf(+t),a):i},a},packSiblings:function(t){return Jf(t),t},packEnclose:Bf,partition:function(){var t=1,e=1,n=0,i=!1;function a(a){var r=a.height+1;return a.x0=a.y0=n,a.x1=t,a.y1=e/r,a.eachBefore(function(t,e){return function(i){i.children&&rc(i,i.x0,t*(i.depth+1)/e,i.x1,t*(i.depth+2)/e);var a=i.x0,r=i.y0,o=i.x1-n,l=i.y1-n;o<a&&(a=o=(a+o)/2),l<r&&(r=l=(r+l)/2),i.x0=a,i.y0=r,i.x1=o,i.y1=l}}(e,r)),i&&a.eachBefore(ac),a}return a.round=function(t){return arguments.length?(i=!!t,a):i},a.size=function(n){return arguments.length?(t=+n[0],e=+n[1],a):[t,e]},a.padding=function(t){return arguments.length?(n=+t,a):n},a},stratify:function(){var t=sc,e=uc;function n(n){var i,a,r,o,l,s,u,d=n.length,h=new Array(d),f={};for(a=0;a<d;++a)i=n[a],l=h[a]=new Ff(i),null!=(s=t(i,a,n))&&(s+="")&&(f[u="$"+(l.id=s)]=u in f?lc:l);for(a=0;a<d;++a)if(l=h[a],null!=(s=e(n[a],a,n))&&(s+="")){if(!(o=f["$"+s]))throw new Error("missing: "+s);if(o===lc)throw new Error("ambiguous: "+s);o.children?o.children.push(l):o.children=[l],l.parent=o}else{if(r)throw new Error("multiple roots");r=l}if(!r)throw new Error("no root");if(r.parent=oc,r.eachBefore((function(t){t.depth=t.parent.depth+1,--d})).eachBefore(Lf),r.parent=null,d>0)throw new Error("cycle");return r}return n.id=function(e){return arguments.length?(t=Zf(e),n):t},n.parentId=function(t){return arguments.length?(e=Zf(t),n):e},n},tree:function(){var t=dc,e=1,n=1,i=null;function a(a){var s=function(t){for(var e,n,i,a,r,o=new gc(t,0),l=[o];e=l.pop();)if(i=e._.children)for(e.children=new Array(r=i.length),a=r-1;a>=0;--a)l.push(n=e.children[a]=new gc(i[a],a)),n.parent=e;return(o.parent=new gc(null,0)).children=[o],o}(a);if(s.eachAfter(r),s.parent.m=-s.z,s.eachBefore(o),i)a.eachBefore(l);else{var u=a,d=a,h=a;a.eachBefore((function(t){t.x<u.x&&(u=t),t.x>d.x&&(d=t),t.depth>h.depth&&(h=t)}));var f=u===d?1:t(u,d)/2,c=f-u.x,p=e/(d.x+f+c),g=n/(h.depth||1);a.eachBefore((function(t){t.x=(t.x+c)*p,t.y=t.depth*g}))}return a}function r(e){var n=e.children,i=e.parent.children,a=e.i?i[e.i-1]:null;if(n){!function(t){for(var e,n=0,i=0,a=t.children,r=a.length;--r>=0;)(e=a[r]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(e);var r=(n[0].z+n[n.length-1].z)/2;a?(e.z=a.z+t(e._,a._),e.m=e.z-r):e.z=r}else a&&(e.z=a.z+t(e._,a._));e.parent.A=function(e,n,i){if(n){for(var a,r=e,o=e,l=n,s=r.parent.children[0],u=r.m,d=o.m,h=l.m,f=s.m;l=fc(l),r=hc(r),l&&r;)s=hc(s),(o=fc(o)).a=e,(a=l.z+h-r.z-u+t(l._,r._))>0&&(cc(pc(l,e,i),e,a),u+=a,d+=a),h+=l.m,u+=r.m,f+=s.m,d+=o.m;l&&!fc(o)&&(o.t=l,o.m+=h-d),r&&!hc(s)&&(s.t=r,s.m+=u-f,i=e)}return i}(e,a,e.parent.A||i[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function l(t){t.x*=e,t.y=t.depth*n}return a.separation=function(e){return arguments.length?(t=e,a):t},a.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],a):i?null:[e,n]},a.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],a):i?[e,n]:null},a},treemap:function(){var t=_c,e=!1,n=1,i=1,a=[0],r=Qf,o=Qf,l=Qf,s=Qf,u=Qf;function d(t){return t.x0=t.y0=0,t.x1=n,t.y1=i,t.eachBefore(h),a=[0],e&&t.eachBefore(ac),t}function h(e){var n=a[e.depth],i=e.x0+n,d=e.y0+n,h=e.x1-n,f=e.y1-n;h<i&&(i=h=(i+h)/2),f<d&&(d=f=(d+f)/2),e.x0=i,e.y0=d,e.x1=h,e.y1=f,e.children&&(n=a[e.depth+1]=r(e)/2,i+=u(e)-n,d+=o(e)-n,(h-=l(e)-n)<i&&(i=h=(i+h)/2),(f-=s(e)-n)<d&&(d=f=(d+f)/2),t(e,i,d,h,f))}return d.round=function(t){return arguments.length?(e=!!t,d):e},d.size=function(t){return arguments.length?(n=+t[0],i=+t[1],d):[n,i]},d.tile=function(e){return arguments.length?(t=Zf(e),d):t},d.padding=function(t){return arguments.length?d.paddingInner(t).paddingOuter(t):d.paddingInner()},d.paddingInner=function(t){return arguments.length?(r="function"==typeof t?t:Kf(+t),d):r},d.paddingOuter=function(t){return arguments.length?d.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):d.paddingTop()},d.paddingTop=function(t){return arguments.length?(o="function"==typeof t?t:Kf(+t),d):o},d.paddingRight=function(t){return arguments.length?(l="function"==typeof t?t:Kf(+t),d):l},d.paddingBottom=function(t){return arguments.length?(s="function"==typeof t?t:Kf(+t),d):s},d.paddingLeft=function(t){return arguments.length?(u="function"==typeof t?t:Kf(+t),d):u},d},treemapBinary:function(t,e,n,i,a){var r,o,l=t.children,s=l.length,u=new Array(s+1);for(u[0]=o=r=0;r<s;++r)u[r+1]=o+=l[r].value;!function t(e,n,i,a,r,o,s){if(e>=n-1){var d=l[e];return d.x0=a,d.y0=r,d.x1=o,void(d.y1=s)}var h=u[e],f=i/2+h,c=e+1,p=n-1;for(;c<p;){var g=c+p>>>1;u[g]<f?c=g+1:p=g}f-u[c-1]<u[c]-f&&e+1<c&&--c;var y=u[c]-h,v=i-y;if(o-a>s-r){var x=(a*v+o*y)/i;t(e,c,y,a,r,x,s),t(c,n,v,x,r,o,s)}else{var _=(r*v+s*y)/i;t(e,c,y,a,r,o,_),t(c,n,v,a,_,o,s)}}(0,s,t.value,e,n,i,a)},treemapDice:rc,treemapSlice:yc,treemapSliceDice:function(t,e,n,i,a){(1&t.depth?yc:rc)(t,e,n,i,a)},treemapSquarify:_c,treemapResquarify:mc}),wc=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=Object.assign({},h,t);function n(t){var n=e[t];return"function"==typeof n?n:function(){return n}}function i(t){var e,i,h,p=u((e=s(),i=n("nodeSize"),h=n("spacing"),function(t){(0,l.default)(n,t);var e=d(n);function n(t){var i;return(0,r.default)(this,n),i=e.call(this,t),Object.assign((0,a.default)(i),{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:(0,a.default)(i),lExtRelX:0,lThr:null,rExt:(0,a.default)(i),rExtRelX:0,rThr:null}),i}return(0,o.default)(n,[{key:"size",get:function(){return i(this.data)}},{key:"spacing",value:function(t){return h(this.data,t.data)}},{key:"x",get:function(){return this.data.x},set:function(t){this.data.x=t}},{key:"y",get:function(){return this.data.y},set:function(t){this.data.y=t}},{key:"update",value:function(){return f(this),c(this),this}}]),n}(e)),t,(function(t){return t.children}));return p.update(),p.data}function s(){var t=n("nodeSize"),e=n("spacing");return function(n){(0,l.default)(a,n);var i=d(a);function a(t){return(0,r.default)(this,a),i.call(this,t)}return(0,o.default)(a,[{key:"copy",value:function(){var t=u(this.constructor,this,(function(t){return t.children}));return t.each((function(t){return t.data=t.data.data})),t}},{key:"size",get:function(){return t(this)}},{key:"spacing",value:function(t){return e(this,t)}},{key:"nodes",get:function(){return this.descendants()}},{key:"xSize",get:function(){return this.size[0]}},{key:"ySize",get:function(){return this.size[1]}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.ySize}},{key:"left",get:function(){return this.x-this.xSize/2}},{key:"right",get:function(){return this.x+this.xSize/2}},{key:"root",get:function(){var t=this.ancestors();return t[t.length-1]}},{key:"numChildren",get:function(){return this.hasChildren?this.children.length:0}},{key:"hasChildren",get:function(){return!this.noChildren}},{key:"noChildren",get:function(){return null===this.children}},{key:"firstChild",get:function(){return this.hasChildren?this.children[0]:null}},{key:"lastChild",get:function(){return this.hasChildren?this.children[this.numChildren-1]:null}},{key:"extents",get:function(){return(this.children||[]).reduce((function(t,e){return a.maxExtents(t,e.extents)}),this.nodeExtents)}},{key:"nodeExtents",get:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}],[{key:"maxExtents",value:function(t,e){return{top:Math.min(t.top,e.top),bottom:Math.max(t.bottom,e.bottom),left:Math.min(t.left,e.left),right:Math.max(t.right,e.right)}}}]),a}(bc.hierarchy.prototype.constructor)}function u(t,e,n){return function e(i,a){var r=new t(i);Object.assign(r,{parent:a,depth:null===a?0:a.depth+1,height:0,length:1});var o=n(i)||[];return r.children=0===o.length?null:o.map((function(t){return e(t,r)})),r.children&&Object.assign(r,r.children.reduce((function(t,e){return{height:Math.max(t.height,e.height+1),length:t.length+e.length}}),r)),r}(e,null)}return Object.assign(i,{nodeSize:function(t){return arguments.length?(e.nodeSize=t,i):e.nodeSize},spacing:function(t){return arguments.length?(e.spacing=t,i):e.spacing},children:function(t){return arguments.length?(e.children=t,i):e.children},hierarchy:function(t,n){var i=void 0===n?e.children:n;return u(s(),t,i)},dump:function(t){var e=n("nodeSize");return function t(n){return function(i){var a=n+"  ",r=n+"    ",o=i.x,l=i.y,s=e(i),u=i.children||[],d=0===u.length?" ":",".concat(a,"children: [").concat(r).concat(u.map(t(r)).join(r)).concat(a,"],").concat(n);return"{ size: [".concat(s.join(", "),"],").concat(a,"x: ").concat(o,", y: ").concat(l).concat(d,"},")}}("\n")(t)}}),i};var n=i(Wn),a=i(yn),r=i(hn),o=i(fn),l=i(pn),s=i(vn),u=i(xn);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}var h=Object.freeze({children:function(t){return t.children},nodeSize:function(t){return t.data.size},spacing:0});var f=function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.y=i,(e.children||[]).reduce((function(i,a){var r=(0,n.default)(i,2),o=r[0],l=r[1];t(a,e.y+e.ySize);var s=(0===o?a.lExt:a.rExt).bottom;return 0!==o&&g(e,o,l),[o+1,k(s,o,l)]}),[0,null]),p(e),w(e),e},c=function t(e,n,i){void 0===n&&(n=-e.relX-e.prelim,i=0);var a=n+e.relX;return e.relX=a+e.prelim-i,e.prelim=0,e.x=i+e.relX,(e.children||[]).forEach((function(n){return t(n,a,e.x)})),e},p=function(t){(t.children||[]).reduce((function(t,e){var i=(0,n.default)(t,2),a=i[0],r=i[1],o=a+e.shift,l=r+o+e.change;return e.relX+=l,[o,l]}),[0,0])},g=function(t,e,n){for(var i=t.children[e-1],a=t.children[e],r=i,o=i.relX,l=a,s=a.relX,u=!0;r&&l;){r.bottom>n.lowY&&(n=n.next);var d=o+r.prelim-(s+l.prelim)+r.xSize/2+l.xSize/2+r.spacing(l);(d>0||d<0&&u)&&(s+=d,y(a,d),v(t,e,n.index,d)),u=!1;var h=r.bottom,f=l.bottom;h<=f&&(r=_(r))&&(o+=r.relX),h>=f&&(l=x(l))&&(s+=l.relX)}!r&&l?m(t,e,l,s):r&&!l&&b(t,e,r,o)},y=function(t,e){t.relX+=e,t.lExtRelX+=e,t.rExtRelX+=e},v=function(t,e,n,i){var a=t.children[e],r=e-n;if(r>1){var o=i/r;t.children[n+1].shift+=o,a.shift-=o,a.change-=i-o}},x=function(t){return t.hasChildren?t.firstChild:t.lThr},_=function(t){return t.hasChildren?t.lastChild:t.rThr},m=function(t,e,n,i){var a=t.firstChild,r=a.lExt,o=t.children[e];r.lThr=n;var l=i-n.relX-a.lExtRelX;r.relX+=l,r.prelim-=l,a.lExt=o.lExt,a.lExtRelX=o.lExtRelX},b=function(t,e,n,i){var a=t.children[e],r=a.rExt,o=t.children[e-1];r.rThr=n;var l=i-n.relX-a.rExtRelX;r.relX+=l,r.prelim-=l,a.rExt=o.rExt,a.rExtRelX=o.rExtRelX},w=function(t){if(t.hasChildren){var e=t.firstChild,n=t.lastChild,i=(e.prelim+e.relX-e.xSize/2+n.relX+n.prelim+n.xSize/2)/2;Object.assign(t,{prelim:i,lExt:e.lExt,lExtRelX:e.lExtRelX,rExt:n.rExt,rExtRelX:n.rExtRelX})}},k=function(t,e,n){for(;null!==n&&t>=n.lowY;)n=n.next;return{lowY:t,index:e,next:n}}}));e(wc);var kc=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Cf),h=i(En),f=i(wc);function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var p=u.default._,g=u.default.event,y=u.default.Shapes.Circle,v=(u.default.Shapes.Rect,["collapsed","style","content"]),x=function(t){(0,o.default)(i,t);var e=c(i);function i(t,a,o){var l;return(0,n.default)(this,i),(l=e.call(this,t,a,o)).type="compacttree",p.extend(!0,(0,r.default)(l),(0,bn.getDefaultProps)(i.defaultProps()),t),l}return(0,a.default)(i,[{key:"draw",value:function(t){var e=this;!t&&(t={}),p.extend(!0,this,t),this.initData(t.data).then((function(t){e.data=t,e.layoutData(),e.widget(),e.induce.context.width=e.width,e.induce.context.height=e.height,e.sprite.context.x=parseInt(e.origin.x),e.sprite.context.y=parseInt(e.origin.y),e.preGraphsSpPosition?e.graphsSpPosition={x:e.preGraphsSpPosition.x,y:e.preGraphsSpPosition.y}:e.graphsSpPosition={x:Math.max((e.width-e.data.size.width)/2,e.app.padding.left),y:e.height/2},e.graphsSp.context.x=e.graphsSpPosition.x,e.graphsSp.context.y=e.graphsSpPosition.y,e.fire("complete")}))}},{key:"resetData",value:function(t,e){var n=this;this._resetData(t,e).then((function(){n.fire("complete")}))}},{key:"widget",value:function(){this._drawEdges(),this._drawNodes()}},{key:"initData",value:function(t,e){var n=this;return new Promise((function(e){if(t&&t.nodes&&t.edges)e(t);else{var i={nodes:[],edges:[],size:{width:0,height:0},treeOriginData:null,treeData:null,nodesLength:0},a=n.app._data;i.treeOriginData=a,Array.isArray(a)&&(i.treeOriginData=n.arrayToTreeJsonForRelation(n.app.dataFrame.jsonOrg,n));(new Date).getTime();Object.assign(i,n._filterTreeData(i.treeOriginData));(new Date).getTime();n._initAllDataSize(i).then((function(){e(i)}))}}))}},{key:"_filterTreeData",value:function(t){var e,n=this,i=1,a=this.node.collapse.field,r=this.childrenField,o=[],l=[],s=function t(e,s,u,d,h){if(e){var f;Object.assign(h,{depth:u||0,parent:s,rowInd:d});var c=h[r]||[];if(Object.assign(h,e),h.__originData=e,h[r]=[],"hidden"==(null==h||null===(f=h.style)||void 0===f?void 0:f.visible))return;var p=n._getContent(h);h._node&&p!=h._node.content&&(h._node=null,delete h._node,h.style||(h.style={width:0,height:0}),e.style&&(!e.style||e.style.width&&e.style.height)||(h.style.width=0,h.style.height=0));var g=n.getDefNode({type:"tree"});Object.assign(g,{iNode:o.length,rowData:h,key:h[n.field],content:p,ctype:n._checkHtml(p)?"html":"canvas",width:0,height:0,depth:u||0}),g.shapeType=n.getProp(n.node.shapeType,g),g.preIconCharCode=n.getProp(n.node.preIcon.charCode,g),g.icons=n.getProp(n.node.icons,g)||[],Array.isArray(g.icons)||(g.icons=[g.icons]),g.icons.forEach((function(t){var e=Object.assign({},n.node.iconsDefault,t);e.charCode=n.getProp(t.charCode,g),Object.assign(t,e)})),o.push(g),h._node=g,h[a]||(e[r]||[]).forEach((function(e,a){var o=c.find((function(t){return t[n.field]==e[n.field]}))||{},s=t(e,h,u+1,a,o);if(s){h[r].push(s),i++;var d=n.getDefNode({type:"tree"});Object.assign(d,{isTree:!0,iNode:l.length,rowData:{},key:[h[n.field],s[n.field]],content:"",ctype:n._checkHtml("")?"html":"canvas",source:h._node,target:s._node,sourceTreeData:h,targetTreeData:s}),d.shapeType=n.getProp(n.line.shapeType,d),l.push(d)}}))}return h}(t,null,0,0,(null===(e=this.data)||void 0===e?void 0:e.treeData)||{});return{treeData:s,nodesLength:i,nodes:o,edges:l}}},{key:"_syncToOrigin",value:function(t){for(var e in t)v.indexOf(e)>-1&&(t.__originData[e]=t[e])}},{key:"_eachTreeDataHandle",value:function(t,e){var n=this;e&&e(t),(t[this.childrenField]||[]).forEach((function(t){n._eachTreeDataHandle(t,e)}))}},{key:"_initAllDataSize",value:function(t){var e=this,n=t.treeData,i=t.nodesLength,a=0;return new Promise((function(r){e._eachTreeDataHandle(n,(function(n){e._setSize(n).then((function(){e._setNodeBoundingClientWidth(n),e.checkNodeSizeForShapeType(n._node),++a==i&&r(t)}))}))}))}},{key:"_setNodeBoundingClientWidth",value:function(t){var e=t._node,n=e.width||0;"diamond"!=e.shapeType&&e.depth&&t.__originData[this.childrenField]&&t.__originData[this.childrenField].length&&(n+=20),e.preIconCharCode&&(n+=20),e.icons&&e.icons.length&&(n+=20*e.icons.length),e.boundingClientWidth=n}},{key:"_setSize",value:function(t){var e=this;return new Promise((function(n){var i=t._node,a=t.width||t.style&&t.style.width||e.getProp(e.node.width,t),r=t.height||t.style&&t.style.height||e.getProp(e.node.height,t);if(a&&r){var o={width:a,height:r,contentElement:i.contentElement};return p.extend(i,o),void n(o)}e._initcontentElementAndSize(t).then((function(t){p.extend(i,t),n(t)}))}))}},{key:"_initcontentElementAndSize",value:function(t){var e=this;return new Promise((function(n){var i,a=t._node,r=a.ctype;e._isField(r)&&(r=a.rowData[r]),!r&&(r="canvas"),"canvas"==r&&(i=e._getEleAndsetCanvasSize),"html"==r&&(i=e._getEleAndsetHtmlSize),i.apply(e,[a]).then((function(i){p.extend(a,i),t.style||(t.style={}),t.style.width=a.width,t.style.height=a.height,e._syncToOrigin(t),n(i)}))}))}},{key:"layoutData",value:function(){p.isFunction(this.layout)?this.layout(this.data):this.treeLayout(this.data)}},{key:"treeLayout",value:function(t){var e,n,i=this,a=this.childrenField,r="LR"==this.rankdir||"RL"==this.rankdir,o=((new Date).getTime(),this.nodesep),l=this.ranksep,s=(0,f.default)({spacing:o,nodeSize:function(t){var e=t.data._node.height||0,n=t.data._node.boundingClientWidth||0;return r?[e,n+l]:[n,e+l]},children:function(t){return t[a]}}),u=s.hierarchy(t.treeData),d=s(u),h=0,c=0,p=0,g=0,y=0,v=0,x=0,_=0,m=[];d.each((function(t){if(r){var e=t.x;t.x=t.y,t.y=e}t.x<=h&&(y=t.x+t.data._node.boundingClientWidth),h=Math.min(h,t.x),t.x+t.data._node.boundingClientWidth>=p&&(v=t.x),p=Math.max(p,t.x+t.data._node.boundingClientWidth),t.y<=c&&(_=t.y+t.data._node.height),c=Math.min(c,t.y),t.y+t.data._node.height+l>=g&&(x=t.y),g=Math.max(g,t.y+t.data._node.height+l),t.data._node.x=t.x+t.data._node.boundingClientWidth/2,t.data._node.y=t.y+t.data._node.height/2,t.data._node.depth=t.depth,m.push(t.data._node)})),e=p-h,n=g-c-l,t.edges.forEach((function(t){i.getEdgePoints(t)})),Object.assign(t,{nodes:m,size:{width:e,height:n},extents:{left:h,top:c,right:p,bottom:g},viewPort:{maxRight:y,maxLeft:v,maxTop:x,maxBottom:_}})}},{key:"getEdgePoints",value:function(t){var e=[],n={x:parseInt(t.source.x+t.source.boundingClientWidth/2),y:parseInt(t.source.y)};t.source.depth||(n.x=parseInt(t.source.x)),"underLine"==t.source.shapeType&&(n.y=parseInt(t.source.y+t.source.height/2)),e.push(n);var i={x:n.x+10,y:n.y};e.push(i);var a={x:parseInt(t.target.x-t.target.boundingClientWidth/2),y:parseInt(t.target.y)};return"underLine"==t.target.shapeType&&(a.y=parseInt(t.target.y+t.target.height/2)),e.push({x:i.x+parseInt((a.x-i.x)/2),y:a.y}),e.push(a),t.points=e,e}},{key:"_drawNodes",value:function(){var t=this,e=this;p.each(this.data.nodes,(function(n){var i=n.rowData[t.field];t._initcontentElementAndSize(n.rowData).then((function(){!function(){if(t._drawNode(n),n.depth&&t.node.collapse.enabled){var a=i+"_collapse_icon",r=i+"_collapse_icon_back";if(n.rowData[t.childrenField]&&n.rowData.__originData[t.childrenField]&&n.rowData.__originData[t.childrenField].length){var o=t.node.collapse.openCharCode;n.rowData.collapsed||(o=t.node.collapse.closeCharCode);var l=String.fromCharCode(parseInt(t.getProp(o,n),16)),s=t.getProp(t.node.collapse.fontSize,n),d=t.getProp(t.node.collapse.fontColor,n),f=t.getProp(t.node.collapse.fontFamily,n),c=t.getProp(t.node.collapse.offsetX,n),p=t.getProp(t.node.collapse.offsetY,n),v=t.getProp(t.node.collapse.background,n),x=t.getProp(t.node.collapse.lineWidth,n),_=t.getProp(t.node.collapse.strokeStyle,n),m=t.labelsSp.getChildById(a),b=t.labelsSp.getChildById(r),w=parseInt(n.x+n.boundingClientWidth/2+c-t.node.padding-s/4);"diamond"==n.shapeType&&(w+=t.node.padding+1*s+1);var k=parseInt(n.y+p),S={x:w,y:k+1,fontSize:s,fontFamily:f,fillStyle:d,textAlign:"center",textBaseline:"middle",cursor:"pointer"},A={x:w,y:k,r:parseInt(.5*s)+2,fillStyle:v,strokeStyle:_,lineWidth:x};if(m)m.resetText(l),Object.assign(m.context,S),Object.assign(b.context,A);else{m=new u.default.Display.Text(l,{id:a,context:S}),b=new y({id:r,context:A}),t.labelsSp.addChild(b),t.labelsSp.addChild(m),m._collapseIconBack=b;var P=t;m.on(g.types.get(),(function(t){var e=P.node.collapse;if(t.eventInfo={trigger:e,tipsContent:P.node.collapse.tipsContent,nodes:[n]},b.context&&("mousedown"==t.type&&(b.context.r+=1),"mouseup"==t.type&&(b.context.r-=1)),P.node.collapse.triggerEventType.indexOf(t.type)>-1){this.nodeData.rowData.collapsed=!this.nodeData.rowData.collapsed,P._syncToOrigin(this.nodeData.rowData);var a=new h.default(P,{origin:i});P.app.resetData(null,a)}P.app.fire(t.type,t)}))}m.nodeData=n,n.collapseIcon=m,n.collapseIconBack=b}else{var C=t.labelsSp.getChildById(a);C&&C.destroy();var D=t.labelsSp.getChildById(r);D&&D.destroy()}}var O=function(t,i){return{iconText:String.fromCharCode(parseInt(i,16)),fontSize:e.getProp(t.fontSize,n,i),fontColor:e.getProp(t.fontColor,n,i),fontFamily:e.getProp(t.fontFamily,n,i),offsetX:e.getProp(t.offsetX,n,i),offsetY:e.getProp(t.offsetY,n,i),tipsContent:t.tipsContent}};if(n.preIconCharCode){var T=i+"_pre_icon",M=O(t.node.preIcon,n.preIconCharCode),E=M.iconText,R=M.fontSize,I=M.fontColor,L=M.fontFamily,F=M.offsetX,N=M.offsetY,B=(M.tipsContent,{x:parseInt(n.x-n.boundingClientWidth/2+t.node.padding+F),y:parseInt(n.y+N)+1,fontSize:R,fontFamily:L,fillStyle:I,textAlign:"left",textBaseline:"middle",cursor:"pointer"}),j=t.labelsSp.getChildById(T);j?(j.resetText(E),Object.assign(j.context,B)):(j=new u.default.Display.Text(E,{id:T,context:B}),t.labelsSp.addChild(j)),n.preIconEl=j}else n.preIconEl&&(n.preIconEl.destroy(),delete n.preIconEl);if(n.icons&&n.icons.length){var z=i+"_icons_sp",W=t.labelsSp.getChildById(z);W&&W.destroy(),W=new u.default.Display.Sprite({id:z}),t.labelsSp.addChild(W),n.icons.forEach((function(i,a){var r=O(i,i.charCode),o=r.iconText,l=r.fontSize,s=r.fontColor,d=r.fontFamily,h=r.offsetX,f=r.offsetY,c=r.tipsContent,p={x:parseInt(n.x-n.boundingClientWidth/2+n.width+h+(n.preIconEl?20:0)-t.node.padding/2)+20*a,y:parseInt(n.y+f)+1,fontSize:l,fontFamily:d,fillStyle:s,textAlign:"left",textBaseline:"middle",cursor:"pointer"},y=new u.default.Display.Text(o,{context:p});W.addChild(y),y.on(g.types.get(),(function(t){var a=i;t.eventInfo={trigger:a,tipsContent:c,nodes:[n]},this.context&&("mouseover"==t.type&&(this.context.fontSize+=1),"mouseout"==t.type&&(this.context.fontSize-=1)),e.app.fire(t.type,t)}))})),n.iconsSp=W}else n.iconsSp&&(n.iconsSp.destroy(),delete n.iconsSp)}()}))}))}},{key:"_destroy",value:function(t){var e=this;if(t.shapeElement&&t.shapeElement.destroy(),t.contentElement&&(t.contentElement.destroy?t.contentElement.destroy():this.domContainer.removeChild(t.contentElement)),t.pathElement&&t.pathElement.destroy(),t.labelElement&&t.labelElement.destroy(),t.arrowElement&&t.arrowElement.destroy(),t.edgeIconElement&&t.edgeIconElement.destroy(),t.edgeIconBack&&t.edgeIconBack.destroy(),t.collapseIcon&&t.collapseIcon.destroy(),t.collapseIconBack&&t.collapseIconBack.destroy(),t.preIconEl&&t.preIconEl.destroy(),t.iconsSp&&t.iconsSp.destroy(),Array.isArray(t[this.field])){var n=t.source;this.data.edges.find((function(t){return t[e.field][0]==n[e.field]}))||(n.collapseIcon&&n.collapseIcon.destroy(),n.collapseIconBack&&n.collapseIconBack.destroy())}}},{key:"arrayToTreeJsonForRelation",value:function(t){var e=this,n={},i={};p.each(t,(function(t){var a=t[e.field]+"";1==a.split(",").length?n[a]=t:i[a]=t}));var a=[];p.each(n,(function(t,e){var n=!0;p.each(i,(function(t,i){if((i+="").split(",")[1]==e)return n=!1,!1})),n&&(a.push(t),t.__inRelation=!0)}));return function t(a){p.each(a,(function(a){if(!a.__cycle){var r=a[e.field];p.each(i,(function(t,i){if((i+="").split(",")[0]==r){var o=n[i.split(",")[1]];o&&(a[e.childrenField]||(a[e.childrenField]=[]),p.find(a[e.childrenField],(function(t){return t[e.field]==o[e.field]}))||a[e.childrenField].push(o),o.__inRelation&&(o.__cycle=!0))}})),a[e.childrenField]&&a[e.childrenField].length&&t(a[e.childrenField])}}))}(a),a.length?a[0]:null}}],[{key:"defaultProps",value:function(){return{childrenField:{detail:"树结构数据的关联字段",documentation:"如果是树结构的关联数据，不是行列式，那么就通过这个字段来建立父子关系",default:"children"},rankdir:{detail:"布局方向",default:"LR"},layout:{detail:"紧凑的树布局方案， 也可以设置为一个function，自定义布局算法",default:"tree"},layoutOpts:{detail:"布局引擎对应的配置",propertys:{}},ranksep:{detail:"排与排之间的距离",default:40},nodesep:{detail:"同级node之间的距离",default:20},node:{detail:"单个节点的配置",propertys:{content:{detail:" 内容配置",propertys:{textAlign:{detail:"左右对齐方式",default:"left"}}},collapse:{detail:"树状图是否有节点收缩按钮",propertys:{enabled:{detail:"是否开启",default:!0},field:{detail:"用来记录collapsed是否折叠的字段，在节点的数据上",default:"collapsed"},triggerEventType:{detail:"触发事件",default:"click,tap"},openCharCode:{detail:"点击后触发展开的icon chartCode，当前状态为收缩",default:""},closeCharCode:{detail:"点击后触发收缩的icon chartCode，当前状态为展开",default:""},fontSize:{detail:"icon字号大小",default:10},fontColor:{detail:"icon字体颜色",default:"#666"},fontFamily:{detail:"icon在css中的fontFamily",default:"iconfont"},tipsContent:{detail:"鼠标移动到收缩icon上面的tips内容",default:""},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0},background:{detail:"icon的 背景色",default:"#fff"},lineWidth:{detail:"边框大小",default:1},strokeStyle:{detail:"描边颜色",default:"#667894"}}},preIcon:{detail:"内容前面的一个icon，主要用来描这个node的类型",propertys:{charCode:{detail:"icon的iconfont字符串",default:""},fontSize:{detail:"icon字号大小",default:18},fontColor:{detail:"icon字体颜色",default:"#666"},fontFamily:{detail:"icon在css中的fontFamily",default:"iconfont"},tipsContent:{detail:"鼠标移动到收缩icon上面的tips内容",default:""},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0}}},icons:{detail:"相对于preIcon，跟在label后面的一组icon",default:[]},iconsDefault:{detail:"内容后面的一组icon，是个数组， 支持函数返回一组icon，单个icon的格式和preIcon保持一致",propertys:{charCode:{detail:"icon的iconfont字符串",default:""},fontSize:{detail:"icon字号大小",default:12},fontColor:{detail:"icon字体颜色",default:"#666"},fontFamily:{detail:"icon在css中的fontFamily",default:"iconfont"},tipsContent:{detail:"鼠标移动到收缩icon上面的tips内容",default:""},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0}}}}},line:{detail:"连线配置",propertys:{arrow:{detail:"箭头配置",propertys:{enabled:{detail:"是否显示",default:!1}}},edgeLabel:{detail:"连线文本",propertys:{enabled:{detail:"是否要连线的文本",default:!1}}},icon:{detail:"连线上的icon",propertys:{enabled:{detail:"是否要连线上的icon",default:!1}}}}}}}}]),i}(d.default);d.default.registerComponent(x,"graphs","compacttree");var _=x;e.default=_}));function Sc(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var a,r,o,l,s,u,d,h,f,c=t._root,p={data:i},g=t._x0,y=t._y0,v=t._x1,x=t._y1;if(!c)return t._root=p,t;for(;c.length;)if((u=e>=(r=(g+v)/2))?g=r:v=r,(d=n>=(o=(y+x)/2))?y=o:x=o,a=c,!(c=c[h=d<<1|u]))return a[h]=p,t;if(l=+t._x.call(null,c.data),s=+t._y.call(null,c.data),e===l&&n===s)return p.next=c,a?a[h]=p:t._root=p,t;do{a=a?a[h]=new Array(4):t._root=new Array(4),(u=e>=(r=(g+v)/2))?g=r:v=r,(d=n>=(o=(y+x)/2))?y=o:x=o}while((h=d<<1|u)==(f=(s>=o)<<1|l>=r));return a[f]=c,a[h]=p,t}function Ac(t,e,n,i,a){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=a}function Pc(t){return t[0]}function Cc(t){return t[1]}function Dc(t,e,n){var i=new Oc(null==e?Pc:e,null==n?Cc:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function Oc(t,e,n,i,a,r){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=a,this._y1=r,this._root=void 0}function Tc(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}e(kc);var Mc=Dc.prototype=Oc.prototype;function Ec(t){return function(){return t}}function Rc(t){return 1e-6*(t()-.5)}function Ic(t){return t.x+t.vx}function Lc(t){return t.y+t.vy}function Fc(t){return t.index}function Nc(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}Mc.copy=function(){var t,e,n=new Oc(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=Tc(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var a=0;a<4;++a)(e=i.source[a])&&(e.length?t.push({source:e,target:i.target[a]=new Array(4)}):i.target[a]=Tc(e));return n},Mc.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Sc(this.cover(e,n),e,n,t)},Mc.addAll=function(t){var e,n,i,a,r=t.length,o=new Array(r),l=new Array(r),s=1/0,u=1/0,d=-1/0,h=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(o[n]=i,l[n]=a,i<s&&(s=i),i>d&&(d=i),a<u&&(u=a),a>h&&(h=a));if(s>d||u>h)return this;for(this.cover(s,u).cover(d,h),n=0;n<r;++n)Sc(this,o[n],l[n],t[n]);return this},Mc.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,a=this._x1,r=this._y1;if(isNaN(n))a=(n=Math.floor(t))+1,r=(i=Math.floor(e))+1;else{for(var o,l,s=a-n||1,u=this._root;n>t||t>=a||i>e||e>=r;)switch(l=(e<i)<<1|t<n,(o=new Array(4))[l]=u,u=o,s*=2,l){case 0:a=n+s,r=i+s;break;case 1:n=a-s,r=i+s;break;case 2:a=n+s,i=r-s;break;case 3:n=a-s,i=r-s}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=i,this._x1=a,this._y1=r,this},Mc.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Mc.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Mc.find=function(t,e,n){var i,a,r,o,l,s,u,d=this._x0,h=this._y0,f=this._x1,c=this._y1,p=[],g=this._root;for(g&&p.push(new Ac(g,d,h,f,c)),null==n?n=1/0:(d=t-n,h=e-n,f=t+n,c=e+n,n*=n);s=p.pop();)if(!(!(g=s.node)||(a=s.x0)>f||(r=s.y0)>c||(o=s.x1)<d||(l=s.y1)<h))if(g.length){var y=(a+o)/2,v=(r+l)/2;p.push(new Ac(g[3],y,v,o,l),new Ac(g[2],a,v,y,l),new Ac(g[1],y,r,o,v),new Ac(g[0],a,r,y,v)),(u=(e>=v)<<1|t>=y)&&(s=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=s)}else{var x=t-+this._x.call(null,g.data),_=e-+this._y.call(null,g.data),m=x*x+_*_;if(m<n){var b=Math.sqrt(n=m);d=t-b,h=e-b,f=t+b,c=e+b,i=g.data}}return i},Mc.remove=function(t){if(isNaN(r=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,i,a,r,o,l,s,u,d,h,f,c=this._root,p=this._x0,g=this._y0,y=this._x1,v=this._y1;if(!c)return this;if(c.length)for(;;){if((u=r>=(l=(p+y)/2))?p=l:y=l,(d=o>=(s=(g+v)/2))?g=s:v=s,e=c,!(c=c[h=d<<1|u]))return this;if(!c.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;c.data!==t;)if(i=c,!(c=c.next))return this;return(a=c.next)&&delete c.next,i?(a?i.next=a:delete i.next,this):e?(a?e[h]=a:delete e[h],(c=e[0]||e[1]||e[2]||e[3])&&c===(e[3]||e[2]||e[1]||e[0])&&!c.length&&(n?n[f]=c:this._root=c),this):(this._root=a,this)},Mc.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Mc.root=function(){return this._root},Mc.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Mc.visit=function(t){var e,n,i,a,r,o,l=[],s=this._root;for(s&&l.push(new Ac(s,this._x0,this._y0,this._x1,this._y1));e=l.pop();)if(!t(s=e.node,i=e.x0,a=e.y0,r=e.x1,o=e.y1)&&s.length){var u=(i+r)/2,d=(a+o)/2;(n=s[3])&&l.push(new Ac(n,u,d,r,o)),(n=s[2])&&l.push(new Ac(n,i,d,u,o)),(n=s[1])&&l.push(new Ac(n,u,a,r,d)),(n=s[0])&&l.push(new Ac(n,i,a,u,d))}return this},Mc.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new Ac(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var a=e.node;if(a.length){var r,o=e.x0,l=e.y0,s=e.x1,u=e.y1,d=(o+s)/2,h=(l+u)/2;(r=a[0])&&n.push(new Ac(r,o,l,d,h)),(r=a[1])&&n.push(new Ac(r,d,l,s,h)),(r=a[2])&&n.push(new Ac(r,o,h,d,u)),(r=a[3])&&n.push(new Ac(r,d,h,s,u))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Mc.x=function(t){return arguments.length?(this._x=t,this):this._x},Mc.y=function(t){return arguments.length?(this._y=t,this):this._y};var Bc={value:()=>{}};function jc(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new zc(i)}function zc(t){this._=t}function Wc(t,e){for(var n,i=0,a=t.length;i<a;++i)if((n=t[i]).name===e)return n.value}function Vc(t,e,n){for(var i=0,a=t.length;i<a;++i)if(t[i].name===e){t[i]=Bc,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}zc.prototype=jc.prototype={constructor:zc,on:function(t,e){var n,i=this._,a=function(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}(t+"",i),r=-1,o=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++r<o;)if(n=(t=a[r]).type)i[n]=Vc(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Vc(i[n],t.name,null);return this}for(;++r<o;)if((n=(t=a[r]).type)&&(n=Wc(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new zc(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,a=new Array(n),r=0;r<n;++r)a[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=0,n=(i=this._[t]).length;r<n;++r)i[r].value.apply(e,a)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],a=0,r=i.length;a<r;++a)i[a].value.apply(e,n)}};var Gc,Hc,Yc=0,Xc=0,Uc=0,qc=1e3,$c=0,Jc=0,Zc=0,Qc="object"==typeof performance&&performance.now?performance:Date,Kc="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function tp(){return Jc||(Kc(ep),Jc=Qc.now()+Zc)}function ep(){Jc=0}function np(){this._call=this._time=this._next=null}function ip(t,e,n){var i=new np;return i.restart(t,e,n),i}function ap(){Jc=($c=Qc.now())+Zc,Yc=Xc=0;try{!function(){tp(),++Yc;for(var t,e=Gc;e;)(t=Jc-e._time)>=0&&e._call.call(null,t),e=e._next;--Yc}()}finally{Yc=0,function(){var t,e,n=Gc,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Gc=e);Hc=t,op(i)}(),Jc=0}}function rp(){var t=Qc.now(),e=t-$c;e>qc&&(Zc-=e,$c=t)}function op(t){Yc||(Xc&&(Xc=clearTimeout(Xc)),t-Jc>24?(t<1/0&&(Xc=setTimeout(ap,t-Qc.now()-Zc)),Uc&&(Uc=clearInterval(Uc))):(Uc||($c=Qc.now(),Uc=setInterval(rp,qc)),Yc=1,Kc(ap)))}np.prototype=ip.prototype={constructor:np,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?tp():+n)+(null==e?0:+e),this._next||Hc===this||(Hc?Hc._next=this:Gc=this,Hc=this),this._call=t,this._time=n,op()},stop:function(){this._call&&(this._call=null,this._time=1/0,op())}};const lp=1664525,sp=1013904223,up=4294967296;function dp(t){return t.x}function hp(t){return t.y}var fp=Math.PI*(3-Math.sqrt(5));var cp=Object.freeze({__proto__:null,forceCenter:function(t,e){var n,i=1;function a(){var a,r,o=n.length,l=0,s=0;for(a=0;a<o;++a)l+=(r=n[a]).x,s+=r.y;for(l=(l/o-t)*i,s=(s/o-e)*i,a=0;a<o;++a)(r=n[a]).x-=l,r.y-=s}return null==t&&(t=0),null==e&&(e=0),a.initialize=function(t){n=t},a.x=function(e){return arguments.length?(t=+e,a):t},a.y=function(t){return arguments.length?(e=+t,a):e},a.strength=function(t){return arguments.length?(i=+t,a):i},a},forceCollide:function(t){var e,n,i,a=1,r=1;function o(){for(var t,o,s,u,d,h,f,c=e.length,p=0;p<r;++p)for(o=Dc(e,Ic,Lc).visitAfter(l),t=0;t<c;++t)s=e[t],h=n[s.index],f=h*h,u=s.x+s.vx,d=s.y+s.vy,o.visit(g);function g(t,e,n,r,o){var l=t.data,c=t.r,p=h+c;if(!l)return e>u+p||r<u-p||n>d+p||o<d-p;if(l.index>s.index){var g=u-l.x-l.vx,y=d-l.y-l.vy,v=g*g+y*y;v<p*p&&(0===g&&(v+=(g=Rc(i))*g),0===y&&(v+=(y=Rc(i))*y),v=(p-(v=Math.sqrt(v)))/v*a,s.vx+=(g*=v)*(p=(c*=c)/(f+c)),s.vy+=(y*=v)*p,l.vx-=g*(p=1-p),l.vy-=y*p)}}}function l(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function s(){if(e){var i,a,r=e.length;for(n=new Array(r),i=0;i<r;++i)a=e[i],n[a.index]=+t(a,i,e)}}return"function"!=typeof t&&(t=Ec(null==t?1:+t)),o.initialize=function(t,n){e=t,i=n,s()},o.iterations=function(t){return arguments.length?(r=+t,o):r},o.strength=function(t){return arguments.length?(a=+t,o):a},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:Ec(+e),s(),o):t},o},forceLink:function(t){var e,n,i,a,r,o,l=Fc,s=function(t){return 1/Math.min(a[t.source.index],a[t.target.index])},u=Ec(30),d=1;function h(i){for(var a=0,l=t.length;a<d;++a)for(var s,u,h,f,c,p,g,y=0;y<l;++y)u=(s=t[y]).source,f=(h=s.target).x+h.vx-u.x-u.vx||Rc(o),c=h.y+h.vy-u.y-u.vy||Rc(o),f*=p=((p=Math.sqrt(f*f+c*c))-n[y])/p*i*e[y],c*=p,h.vx-=f*(g=r[y]),h.vy-=c*g,u.vx+=f*(g=1-g),u.vy+=c*g}function f(){if(i){var o,s,u=i.length,d=t.length,h=new Map(i.map(((t,e)=>[l(t,e,i),t])));for(o=0,a=new Array(u);o<d;++o)(s=t[o]).index=o,"object"!=typeof s.source&&(s.source=Nc(h,s.source)),"object"!=typeof s.target&&(s.target=Nc(h,s.target)),a[s.source.index]=(a[s.source.index]||0)+1,a[s.target.index]=(a[s.target.index]||0)+1;for(o=0,r=new Array(d);o<d;++o)s=t[o],r[o]=a[s.source.index]/(a[s.source.index]+a[s.target.index]);e=new Array(d),c(),n=new Array(d),p()}}function c(){if(i)for(var n=0,a=t.length;n<a;++n)e[n]=+s(t[n],n,t)}function p(){if(i)for(var e=0,a=t.length;e<a;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){i=t,o=e,f()},h.links=function(e){return arguments.length?(t=e,f(),h):t},h.id=function(t){return arguments.length?(l=t,h):l},h.iterations=function(t){return arguments.length?(d=+t,h):d},h.strength=function(t){return arguments.length?(s="function"==typeof t?t:Ec(+t),c(),h):s},h.distance=function(t){return arguments.length?(u="function"==typeof t?t:Ec(+t),p(),h):u},h},forceManyBody:function(){var t,e,n,i,a,r=Ec(-30),o=1,l=1/0,s=.81;function u(n){var a,r=t.length,o=Dc(t,dp,hp).visitAfter(h);for(i=n,a=0;a<r;++a)e=t[a],o.visit(f)}function d(){if(t){var e,n,i=t.length;for(a=new Array(i),e=0;e<i;++e)n=t[e],a[n.index]=+r(n,e,t)}}function h(t){var e,n,i,r,o,l=0,s=0;if(t.length){for(i=r=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(l+=e.value,s+=n,i+=n*e.x,r+=n*e.y);t.x=i/s,t.y=r/s}else{(e=t).x=e.data.x,e.y=e.data.y;do{l+=a[e.data.index]}while(e=e.next)}t.value=l}function f(t,r,u,d){if(!t.value)return!0;var h=t.x-e.x,f=t.y-e.y,c=d-r,p=h*h+f*f;if(c*c/s<p)return p<l&&(0===h&&(p+=(h=Rc(n))*h),0===f&&(p+=(f=Rc(n))*f),p<o&&(p=Math.sqrt(o*p)),e.vx+=h*t.value*i/p,e.vy+=f*t.value*i/p),!0;if(!(t.length||p>=l)){(t.data!==e||t.next)&&(0===h&&(p+=(h=Rc(n))*h),0===f&&(p+=(f=Rc(n))*f),p<o&&(p=Math.sqrt(o*p)));do{t.data!==e&&(c=a[t.data.index]*i/p,e.vx+=h*c,e.vy+=f*c)}while(t=t.next)}}return u.initialize=function(e,i){t=e,n=i,d()},u.strength=function(t){return arguments.length?(r="function"==typeof t?t:Ec(+t),d(),u):r},u.distanceMin=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.distanceMax=function(t){return arguments.length?(l=t*t,u):Math.sqrt(l)},u.theta=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u},forceRadial:function(t,e,n){var i,a,r,o=Ec(.1);function l(t){for(var o=0,l=i.length;o<l;++o){var s=i[o],u=s.x-e||1e-6,d=s.y-n||1e-6,h=Math.sqrt(u*u+d*d),f=(r[o]-h)*a[o]*t/h;s.vx+=u*f,s.vy+=d*f}}function s(){if(i){var e,n=i.length;for(a=new Array(n),r=new Array(n),e=0;e<n;++e)r[e]=+t(i[e],e,i),a[e]=isNaN(r[e])?0:+o(i[e],e,i)}}return"function"!=typeof t&&(t=Ec(+t)),null==e&&(e=0),null==n&&(n=0),l.initialize=function(t){i=t,s()},l.strength=function(t){return arguments.length?(o="function"==typeof t?t:Ec(+t),s(),l):o},l.radius=function(e){return arguments.length?(t="function"==typeof e?e:Ec(+e),s(),l):t},l.x=function(t){return arguments.length?(e=+t,l):e},l.y=function(t){return arguments.length?(n=+t,l):n},l},forceSimulation:function(t){var e,n=1,i=.001,a=1-Math.pow(i,1/300),r=0,o=.6,l=new Map,s=ip(h),u=jc("tick","end"),d=function(){let t=1;return()=>(t=(lp*t+sp)%up)/up}();function h(){f(),u.call("tick",e),n<i&&(s.stop(),u.call("end",e))}function f(i){var s,u,d=t.length;void 0===i&&(i=1);for(var h=0;h<i;++h)for(n+=(r-n)*a,l.forEach((function(t){t(n)})),s=0;s<d;++s)null==(u=t[s]).fx?u.x+=u.vx*=o:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=o:(u.y=u.fy,u.vy=0);return e}function c(){for(var e,n=0,i=t.length;n<i;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var a=10*Math.sqrt(.5+n),r=n*fp;e.x=a*Math.cos(r),e.y=a*Math.sin(r)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,d),e}return null==t&&(t=[]),c(),e={tick:f,restart:function(){return s.restart(h),e},stop:function(){return s.stop(),e},nodes:function(n){return arguments.length?(t=n,c(),l.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(a=+t,e):+a},alphaTarget:function(t){return arguments.length?(r=+t,e):r},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(d=t,l.forEach(p),e):d},force:function(t,n){return arguments.length>1?(null==n?l.delete(t):l.set(t,p(n)),e):l.get(t)},find:function(e,n,i){var a,r,o,l,s,u=0,d=t.length;for(null==i?i=1/0:i*=i,u=0;u<d;++u)(o=(a=e-(l=t[u]).x)*a+(r=n-l.y)*r)<i&&(s=l,i=o);return s},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}},forceX:function(t){var e,n,i,a=Ec(.1);function r(t){for(var a,r=0,o=e.length;r<o;++r)(a=e[r]).vx+=(i[r]-a.x)*n[r]*t}function o(){if(e){var r,o=e.length;for(n=new Array(o),i=new Array(o),r=0;r<o;++r)n[r]=isNaN(i[r]=+t(e[r],r,e))?0:+a(e[r],r,e)}}return"function"!=typeof t&&(t=Ec(null==t?0:+t)),r.initialize=function(t){e=t,o()},r.strength=function(t){return arguments.length?(a="function"==typeof t?t:Ec(+t),o(),r):a},r.x=function(e){return arguments.length?(t="function"==typeof e?e:Ec(+e),o(),r):t},r},forceY:function(t){var e,n,i,a=Ec(.1);function r(t){for(var a,r=0,o=e.length;r<o;++r)(a=e[r]).vy+=(i[r]-a.y)*n[r]*t}function o(){if(e){var r,o=e.length;for(n=new Array(o),i=new Array(o),r=0;r<o;++r)n[r]=isNaN(i[r]=+t(e[r],r,e))?0:+a(e[r],r,e)}}return"function"!=typeof t&&(t=Ec(null==t?0:+t)),r.initialize=function(t){e=t,o()},r.strength=function(t){return arguments.length?(a="function"==typeof t?t:Ec(+t),o(),r):a},r.y=function(e){return arguments.length?(t="function"==typeof e?e:Ec(+e),o(),r):t},r}}),pp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Gn),h=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==gn(t)&&"function"!=typeof t)return{default:t};var n=f(e);if(n&&n.has(t))return n.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if("default"!==r&&Object.prototype.hasOwnProperty.call(t,r)){var o=a?Object.getOwnPropertyDescriptor(t,r):null;o&&(o.get||o.set)?Object.defineProperty(i,r,o):i[r]=t[r]}i.default=t,n&&n.set(t,i);return i}(cp);function f(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(f=function(t){return t?n:e})(t)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var p=u.default._,g=u.default.event,y=u.default.Shapes.Circle,v=u.default.Display.Text,x=u.default.Shapes.Line,_=function(t){(0,o.default)(i,t);var e=c(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="force",p.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){this.nodesSp=new u.default.Display.Sprite({id:"nodesSp"}),this.edgesSp=new u.default.Display.Sprite({id:"edgesSp"}),this.graphsSp=new u.default.Display.Sprite({id:"graphsSp"}),this.graphsSp.addChild(this.edgesSp),this.graphsSp.addChild(this.nodesSp),this.sprite.addChild(this.graphsSp)}},{key:"draw",value:function(t){!t&&(t={}),p.extend(!0,this,t),this.data=t.data||this._initData(),this.widget(),this.fire("complete")}},{key:"_initData",value:function(){for(var t=this,e={nodes:[],edges:[],size:{width:this.app.width,height:this.app.height}},n={},i=0,a=0,r=0,o=0,l=0;l<this.dataFrame.length;l++){var s=this.dataFrame.getRowDataAt(l),d=p.flatten([(s[this.keyField]+"").split(",")]),h=this._getContent(s),f=1==d.length?d[0]:d,c=s[this.field],g=new u.default.Display.Sprite({id:"nodeSp_"+f});this.graphsSp.addChild(g);var y={type:"force",field:this.field,iNode:l,rowData:s,key:f,value:c,label:h,element:g,width:null,height:null,x:null,y:null,shapeType:null,source:null,target:null};1==d.length?(y.shapeType=this.getProp(this.node.shapeType,y),e.nodes.push(y),n[y.key]=y,null!=c&&(i=Math.min(i,c),a=Math.max(a,c))):(y.shapeType="line",e.edges.push(y),null!=c&&(r=Math.min(r,c),o=Math.max(o,c)))}return this.nodeValMin=i,this.nodeValMax=a,this.lineValMin=r,this.lineValMax=o,e.nodes.forEach((function(e){e.radius=t.node.radius?t.getProp(t.node.radius,e):t._getNodeRadius(e),e.width=e.height=2*e.radius})),e.edges.forEach((function(e){var i=e.key;e.source=n[i[0]],e.target=n[i[1]],e.distance=t.line.distance?t.getProp(t.node.distance,e):t._getLineDistance(e)})),e}},{key:"_getNodeRadius",value:function(t){var e=t.value,n=this.node.radiusMin;return e&&(n+=(this.node.radiusMax-this.node.radiusMin)/(this.nodeValMax-this.nodeValMin)*e),parseInt(n)}},{key:"_getLineDistance",value:function(t){var e=t.value,n=this.line.distanceMin;return e&&(n+=(this.line.distanceMax-this.line.distanceMin)/(this.lineValMax-this.lineValMin)*e),parseInt(n)}},{key:"widget",value:function(){var t=this,e=this,n=this.keyField,i=this.field,a=this.data.edges.map((function(t){return{source:t.source[n],target:t.target[n],value:t.rowData[i],nodeData:t}})),r=this.data.nodes.map((function(t){var e=Object.create(t);return e.id=t.key,e.nodeData=t,e})),o=this.data.size,l=o.width,s=o.height,u=h.forceSimulation(r).force("link",h.forceLink(a).id((function(t){return t.id})).distance((function(t,e,n){var i=t.nodeData.distance,a=t.source.nodeData.radius+t.target.nodeData.radius;return Math.max(i,a)}))).force("charge",h.forceManyBody().distanceMin(this.line.distanceMin).distanceMax(this.line.distanceMax).strength(this.node.strength)).force("center",h.forceCenter(l/2,s/2)).force("collide",h.forceCollide().radius((function(t,e,n){return t.nodeData.radius}))).force("x",h.forceX()).force("y",h.forceY()).alpha(.5);r.forEach((function(t){var n=e.getProp(e.node.fillStyle,t.nodeData),i=e.getProp(e.node.strokeStyle,t.nodeData),a=e.getProp(e.node.lineWidth,t.nodeData),r=e.getProp(e.node.nodeAlpha,t.nodeData);t.nodeData.fillStyle=n;var o=t.nodeData.radius,l=new y({context:{r:o,fillStyle:n,strokeStyle:i,lineWidth:a,globalAlpha:r,cursor:"pointer"}});t.nodeData.element.addChild(l),l.nodeData=t.nodeData,l.on(g.types.get(),(function(t){t.eventInfo={trigger:"this.node",nodes:[this.nodeData]},e.app.fire(t.type,t)}));var s=e.getProp(e.label.fontSize,t.nodeData),u=e.getProp(e.label.fontColor,t.nodeData),d=e.getProp(e.label.textBaseline,t.nodeData),h=e.getProp(e.label.textAlign,t.nodeData),f=new v(t.nodeData.label,{context:{fontSize:s,fillStyle:u,textBaseline:d,textAlign:h,globalAlpha:.7}});t.nodeData.element.addChild(f)})),a.forEach((function(n){var i=e.getProp(e.line.lineWidth,n.nodeData),a=e.getProp(e.line.strokeStyle,n.nodeData),r=e.getProp(e.line.lineType,n.nodeData),o=e.getProp(e.line.lineAlpha,n.nodeData);n.nodeData.strokeStyle=a;var l=new x({context:{lineWidth:i,strokeStyle:a,lineType:r,start:{x:0,y:0},end:{x:0,y:0},globalAlpha:o}});t.edgesSp.addChild(l),n.line=l})),u.on("tick",(function(){u.alpha()<=.05?u.stop():(r.forEach((function(t){var e=t.nodeData.element.context;e&&(e.x=t.x,e.y=t.y)})),a.forEach((function(t){var e=t.line.context;e&&(e.start.x=t.source.x,e.start.y=t.source.y,e.end.x=t.target.x,e.end.y=t.target.y)})))}))}},{key:"_checkHtml",value:function(t){return/<[^>]+>/g.test(t)}},{key:"_getContent",value:function(t){var e,n=this;if(this._isField(this.label.field)&&(e=t[this.label.field]),n.label.format)p.isFunction(n.label.format)&&(e=n.label.format.apply(this,[e,t]));else{var i=n.app.getComponent({name:"coord"}).getFieldConfig(n.keyField);i&&(e=i.getFormatValue(e))}return e}},{key:"_isField",value:function(t){return~this.dataFrame.fields.indexOf(t)}},{key:"getNodesAt",value:function(){}},{key:"getProp",value:function(t,e){var n=t;return this._isField(t)&&e.rowData?n=e.rowData[t]:(p.isArray(t)&&(n=t[e.iNode]),p.isFunction(t)&&(n=t.apply(this,[e]))),n}}],[{key:"defaultProps",value:function(){return{keyField:{detail:"key字段",default:""},field:{detail:"value字段，node，link都公用这个字段",default:""},node:{detail:"单个节点的配置",propertys:{shapeType:{detail:"节点图形",default:"circle"},radiusMin:{detail:"最小节点半径",default:6},radiusMax:{detail:"最大节点半径",default:30},radius:{detail:"节点半径",default:null},fillStyle:{detail:"节点背景色",default:"#acdf7d"},strokeStyle:{detail:"描边颜色",default:"#e5e5e5"},lineWidth:{detail:"描边线宽",default:0},nodeAlpha:{detail:"节点透明度",default:1},strength:{detail:"节点之间作用力",default:-300}}},line:{detail:"两个节点连线配置",propertys:{lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"连线的颜色",default:"#e5e5e5"},lineType:{detail:"连线样式（虚线等）",default:"solid"},lineAlpha:{detail:"连线透明度",default:.6},distanceMin:{detail:"最小连线距离",default:30},distanceMax:{detail:"最大连线距离",default:200},distance:{detail:"连线距离",default:null},arrow:{detail:"是否有箭头",default:!0}}},label:{detail:"节点内容配置",propertys:{field:{detail:"内容字段",default:"label"},fontColor:{detail:"内容文本颜色",default:"#666"},format:{detail:"内容格式化处理函数",default:null},textAlign:{detail:"textAlign",default:"center"},textBaseline:{detail:"textBaseline",default:"middle"}}}}}},{key:"polyfill",value:function(t){return t.valueField&&(t.field=t.valueField,delete t.valueField),t}}]),i}(d.default);d.default.registerComponent(_,"graphs","force");var m=_;e.default=m}));e(pp);var gp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];a.xmin=360,a.xmax=-360,a.ymin=180,a.ymax=-180;for(var n,i,r=t.features,o=0,l=r.length;o<l;o++)if(!((i=r[o]).properties.name&&e.indexOf(i.properties.name)>-1||i.properties.adcode&&e.indexOf(i.properties.adcode)>-1))switch(i.type){case"Feature":a[i.geometry.type](i.geometry.coordinates);break;case"GeometryCollection":for(var s=0,u=(n=i.geometries).length;s<u;s++)a[n[s].type](n[s].coordinates)}return t.srcSize={left:1*a.xmin.toFixed(4),top:1*a.ymin.toFixed(4),width:1*(a.xmax-a.xmin).toFixed(4),height:1*(a.ymax-a.ymin).toFixed(4)},t}var i={formatPoint:function(t){return[(t[0]<-168.5&&t[1]>63.8?t[0]+360:t[0])+168.5,90-t[1]]},makePoint:function(t){var e=this,n=e.formatPoint(t);return e._bbox.xmin>t[0]&&(e._bbox.xmin=t[0]),e._bbox.xmax<t[0]&&(e._bbox.xmax=t[0]),e._bbox.ymin>t[1]&&(e._bbox.ymin=t[1]),e._bbox.ymax<t[1]&&(e._bbox.ymax=t[1]),[(n[0]-i.offset.x)*i.scale.x+i.offset.left,(n[1]-i.offset.y)*i.scale.y+i.offset.top]},Point:function(t){return(t=this.makePoint(t)).join(",")},LineString:function(t){for(var e,n="",a=0,r=t.length;a<r;a++)a%1&&r>0||(e=i.makePoint(t[a]),n=0===a?"M"+e.join(","):n+"L"+e.join(","));return n},Polygon:function(t){for(var e="",n=0,a=t.length;n<a;n++)e=e+i.LineString(t[n])+"z";return e},MultiPoint:function(t){for(var e=[],n=0,a=t.length;n<a;n++)e.push(i.Point(t[n]));return e},MultiLineString:function(t){for(var e="",n=0,a=t.length;n<a;n++)e+=i.LineString(t[n]);return e},MultiPolygon:function(t){for(var e="",n=0,a=t.length;n<a;n++)e+=i.Polygon(t[n]);return e}},a={formatPoint:i.formatPoint,makePoint:function(t){var e=this,n=e.formatPoint(t),i=n[0],a=n[1];e.xmin>i&&(e.xmin=i),e.xmax<i&&(e.xmax=i),e.ymin>a&&(e.ymin=a),e.ymax<a&&(e.ymax=a)},Point:function(t){this.makePoint(t)},LineString:function(t){for(var e=0,n=t.length;e<n;e++)e%1&&n>0||this.makePoint(t[e])},Polygon:function(t){for(var e=0,n=t.length;e<n;e++)this.LineString(t[e])},MultiPoint:function(t){for(var e=0,n=t.length;e<n;e++)this.Point(t[e])},MultiLineString:function(t){for(var e=0,n=t.length;e<n;e++)this.LineString(t[e])},MultiPolygon:function(t){for(var e=0,n=t.length;e<n;e++)this.Polygon(t[e])}};var r={getBbox:function(t,e){return t.srcSize||n(t,e),t.srcSize},geoJson2Path:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];i.scale=null,i.offset=null,t.srcSize||n(t,a),e.offset={x:t.srcSize.left,y:t.srcSize.top,left:e.OffsetLeft||0,top:e.OffsetTop||0},i.scale=e.scale,i.offset=e.offset;for(var r,o,l,s,u,d,h=t.features,f=[],c=0,p=h.length;c<p;c++)if(!((l=h[c]).properties.name&&a.indexOf(l.properties.name)>-1||l.properties.adcode&&a.indexOf(l.properties.adcode)>-1))if("Feature"==l.type)v(l.geometry,l);else if("GeometryCollection"==l.type)for(var g=0,y=(r=l.geometries).length;g<y;g++)v(o=r[g],o);function v(t,e){s=t.type,u=t.coordinates,i._bbox={xmin:360,xmax:-360,ymin:180,ymax:-180},d=i[s](u),f.push({path:d,cp:e.properties.cp?i.makePoint(e.properties.cp):i.makePoint([(i._bbox.xmin+i._bbox.xmax)/2,(i._bbox.ymin+i._bbox.ymax)/2]),properties:e.properties,adcode:e.properties.adcode})}return f},pos2geo:function(t,e){var n,i;return e instanceof Array?(n=1*e[0],i=1*e[1]):(n=1*e.x,i=1*e.y),[n=(n=n/t.scale.x+t.offset.x-168.5)>180?n-360:n,i=90-(i/t.scale.y+t.offset.y)]},geo2pos:function(t,e){return i.offset=t.offset,i.scale=t.scale,e instanceof Array?i.makePoint([1*e[0],1*e[1]]):i.makePoint([1*e.x,1*e.y])}};e.default=r}));e(gp);var yp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t.json=s(t.json);var i=a(t,e,n);return i};var n=i(gp);var a=function(t,e,i){var a,l=[],s=t.bbox||n.default.getBbox(t.json,i),u=r(s,e,.75),d=t.lastTransform||{scale:{}};u.left!=d.left||u.top!=d.top||u.scale.x!=d.scale.x||u.scale.y!=d.scale.y?(a=n.default.geoJson2Path(t.json,u,i),d=ln._.clone(u)):(u=t.transform,a=t.pathArray),t.bbox=s,t.transform=u,t.lastTransform=d,t.pathArray=a;for(var h=[u.left,u.top],f=0,c=a.length;f<c;f++)l.push(o(t,a[f],h,s));return l},r=function(t,e,n){var i=e.width,a=e.height,r=t.width,o=t.height,l=i/n/r,s=a/o;return l>s?i=r*(l=s*n):(l=(s=l)*n,a=o*s),{left:0,top:0,width:i,height:a,baseScale:1,scale:{x:l,y:s}}},o=function(t,e,n,i){var a,r=e.properties.name,o=[0,0];return e.cp?a=[e.cp[0]+o[0],e.cp[1]+o[1]]:((a=l(t,[i.left+i.width/2,i.top+i.height/2]))[0]+=o[0],a[1]+=o[1]),e.name=r,e.position=n,e.textX=a[0],e.textY=a[1],e},l=function(t,e){return t.transform?n.default.geo2pos(t.transform,e):null},s=function(t){if(!t.UTF8Encoding)return t;for(var e=t.features,n=0;n<e.length;n++)for(var i=e[n],a=i.geometry.coordinates,r=i.geometry.encodeOffsets,o=0;o<a.length;o++){var l=a[o];if("Polygon"===i.geometry.type)a[o]=u(l,r[o]);else if("MultiPolygon"===i.geometry.type)for(var s=0;s<l.length;s++){var d=l[s];l[s]=u(d,r[o][s])}}return t.UTF8Encoding=!1,t},u=function(t,e){for(var n=[],i=e[0],a=e[1],r=0;r<t.length;r+=2){var o=t.charCodeAt(r)-64,l=t.charCodeAt(r+1)-64;o=o>>1^-(1&o),l=l>>1^-(1&l),i=o+=i,a=l+=a,n.push([o/1024,l/1024])}return n}}));e(yp);var vp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(Gn),h=i(yp),f=i(Ai);function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var p=u.default._,g=u.default.event,y=(u.default.Display.Text,u.default.Shapes.Path),v=u.default.Shapes.Rect,x=function(t){(0,o.default)(i,t);var e=c(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).type="map",o.maxValue=0,o.dataOrg=[],o.data=[],p.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.node.maxFillStyle||(o.node.maxFillStyle=o.app.getTheme(0)),o.node.beginFillStyle&&o.node.endFillStyle&&(o._gradientColors=(0,Vn.gradient)(o.node.endFillStyle,o.node.beginFillStyle)),o.init(),o}return(0,a.default)(i,[{key:"init",value:function(){this._pathsp=new u.default.Display.Sprite({id:"nodePathSp"}),this._textsp=new u.default.Display.Sprite({id:"textsp"}),this._marksp=new u.default.Display.Sprite({id:"markSp"}),this.mapGraphs=new u.default.Display.Sprite({id:"mapGraphs"}),this._initInduce(),this.mapGraphs.addChild(this._pathsp),this.mapGraphs.addChild(this._textsp),this.mapGraphs.addChild(this._marksp),this.sprite.addChild(this.mapGraphs),this._initZoom()}},{key:"_initZoom",value:function(){this.zoom=new f.default({scale:this.status.transform.scale,scaleMin:this.status.transform.statusMin,scaleMax:this.status.transform.statusMax});var t=this,e=!1,n=t.app.canvax.domView?t.app.canvax.domView.style.cursor:"default",i=null,a=0;this.sprite.on(g.types.get(),(function(r){if(t.status.transform.enabled){r.preventDefault();var o=r.target.localToGlobal(r.point,t.sprite);if("mousedown"==r.type&&(e=!0,t.app.canvax.domView&&(t.app.canvax.domView.style.cursor="move"),t.zoom.mouseMoveTo(o)),"mouseup"!=r.type&&"mouseout"!=r.type||(e=!1,t.app.canvax.domView&&(t.app.canvax.domView.style.cursor=n)),"mousemove"==r.type&&e){var l=t.zoom.move(o),s=l.x,u=l.y;t.mapGraphs.context.x=s,t.mapGraphs.context.y=u}"wheel"==r.type&&(Math.abs(r.deltaY)>Math.abs(a)&&(a=r.deltaY),i||(i=setTimeout((function(){var e=t.zoom.wheel(r,o),n=e.scale,l=e.x,s=e.y;t.mapGraphs.context.x=l,t.mapGraphs.context.y=s,t.mapGraphs.context.scaleX=n,t.mapGraphs.context.scaleY=n,t.status.transform.scale=n,i=null,a=0}),32)))}}))}},{key:"_initInduce",value:function(){var t=this;this._include=new v({context:{x:this.app.padding.left,y:this.app.padding.top,width:this.width,height:this.height,fillStyle:"rgba(0,0,0,0)"}}),this._include.on(g.types.get(),(function(e){e.eventInfo={trigger:t,nodes:[]},t.app.fire(e.type,e)})),this.sprite.addChild(this._include)}},{key:"draw",value:function(t){var e=this;!t&&(t={}),p.extend(!0,this,t);var n=this.dataFrame.getFieldData(this.valueField);this.maxValue=p.max(n),this.minValue=p.min(n),this.getGeoData().then((function(t){if(t){var n={x:e.app.padding.left,y:e.app.padding.top,width:e.width,height:e.height};e._widget(t,n)}})),this._include.context.width=this.width,this._include.context.height=this.height,this.fire("complete")}},{key:"_widget",value:function(t,e){var n=this,i=[];return(0,h.default)(t,e,this.specialArea).forEach((function(a){var r=n.dataFrame.getRowDataOf({adcode:a[n.field]});r.length&&(a.rowData=r[0]);var o={x:e.x+(e.width-t.transform.width)/2,y:e.y+(e.height-t.transform.height)/2,path:a.path},l=new y({id:"path_"+a[n.field],hoverClone:!1,context:o});l.nodeData=a,l.geoData=t,a.nodeElement=l,n._setNodeStyle(l),a.color=l.context.fillStyle,n.node.drawBegin.bind(n)(a),n._pathsp.addChild(l),n.node.drawEnd.bind(n)(a),l.context&&i.push(l);var s=n;l.context&&l.context.fillStyle&&n.node.fillAlpha&&!a.pointerEventsNone&&l.context&&(l.context.cursor="pointer",l.on(g.types.get(),(function(t){t.eventInfo={trigger:s.node,nodes:[this.nodeData]},"mouseover"==t.type&&s.focusAt(this.nodeData[s.field]),"mouseout"==t.type&&s.unfocusAt(this.nodeData[s.field]),s.app.fire(t.type,t)})))})),i}},{key:"_setNodeStyle",value:function(t,e){var n=t.nodeData;if(t){var i=t.context,a=i.fillStyle,r=i.fillAlpha,o=i.strokeStyle,l=i.strokeAlpha,s=i.lineWidth,u=i.lineType;t._default={fillStyle:a,fillAlpha:r,strokeStyle:o,strokeAlpha:l,lineWidth:s,lineType:u};var d=this.node[e];e||(d=this.node);var h=this._getProp(d,"fillStyle",n)||a,f=this._getProp(d,"fillAlpha",n)||r,c=this._getProp(d,"strokeStyle",n)||o,p=this._getProp(d,"strokeAlpha",n)||l,g=this._getProp(d,"lineWidth",n)||s,y=this._getProp(d,"lineType",n)||u;t.context.fillStyle=h,t.context.fillAlpha=f,t.context.strokeStyle=c,t.context.strokeAlpha=p,t.context.lineWidth=g,t.context.lineType=y}}},{key:"focusAt",value:function(t){if(this.node.focus.enabled){var e=this._pathsp.getChildById("path_"+t),n=e.nodeData;n.selected||(this._setNodeStyle(e,"focus"),n.focused=!0)}}},{key:"unfocusAt",value:function(t){if(this.node.focus.enabled){var e=this._pathsp.getChildById("path_"+t),n=e.nodeData;n.selected||(this._setNodeStyle(e),n.focused=!1)}}},{key:"selectAt",value:function(t){if(this.node.select.enabled){var e=this._pathsp.getChildById("path_"+t),n=e.nodeData;this._setNodeStyle(e,"select"),n.selected=!0}}},{key:"unselectAt",value:function(t){if(this.node.select.enabled){var e=this._pathsp.getChildById("path_"+t),n=e.nodeData;this._setNodeStyle(e),n.selected=!1,n.focused&&this.focusAt(t)}}},{key:"drawChildren",value:function(t){var e=this;return new Promise((function(n){e.getGeoData({mapAdcode:t}).then((function(i){if(i){var a=e._pathsp.getChildById("path_"+t),r=a.getBound(),o=a.localToGlobal(r);r.x=o.x,r.y=o.y,n(e._widget(i,r))}}))}))}},{key:"getGeoData",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return new Promise((function(n,i){if(null!==e.mapAdcode||e.geoJsonUrl){var a=e.geoJsonUrl||t.adcodeUrlTempl.replace(new RegExp("\\{adcode\\}","gm"),e.mapAdcode);t.app.__geoDataMap||(t.app.__geoDataMap={}),t.app.__geoDataMap[a]?n(t.app.__geoDataMap[a]):fetch(a).then((function(e){e.ok?e.json().then((function(e){var i=t.geoJsonFilter(e);t.app.__geoDataMap[a]={json:i||e},n(t.app.__geoDataMap[a])})):n(null)})).catch((function(t){i(t)}))}else e.geoJson&&n({json:e.geoJson})}))}},{key:"_getProp",value:function(t,e,n){var i,a=t[e];if(i=p.isFunction(a)?a.apply(this,[n,this.dataFrame]):a,"fillStyle"==e){var r=n.rowData;if(r)if(void 0!==r[e])i=r[e];else{var o=r[this.valueField];if(!isNaN(o)&&""!=o){var l=this.node.minFillAlpha+(this.node.fillAlpha-this.node.minFillAlpha)/(this.maxValue-this.minValue)*(o-this.minValue);if(this._gradientColors)return this._gradientColors[100-parseInt(100*l)];i=(0,Vn.colorRgba)(this.node.maxFillStyle,parseFloat(l.toFixed(2))),i=(0,Vn.rgba2rgb)(i)}}}return i}}],[{key:"defaultProps",value:function(){return{field:{detail:"数据中的adcode字段",default:"adcode",documentation:"数据中的adcode字段，用来对应上地图中的某个区块的adcode，从而找到这个区块对应的这一条数据"},valueField:{detail:"数据中的值字段",default:"value",documentation:"作为field字段的补充，通过field字段找到数据后，用来从数据中取值"},mapAdcode:{detail:"当前绘制的地图adcode",default:null},adcodeUrlTempl:{detail:"adcode的url模板",default:"//geo.datav.aliyun.com/areas_v2/bound/{adcode}_full.json",documentation:"如果是是配置的adcode，那么和他对应的url模板"},geoJson:{detail:"要绘制的geoJson数据",default:null},geoJsonUrl:{detail:"要绘制的geoJson的url",default:null},geoJsonFilter:{detail:"geoJson的二次过滤处理",default:function(t){return t}},specialArea:{detail:"要排除掉不绘制的数据集合，可以是adcode，也可以是name",default:[]},node:{detail:"单个元素图形配置",propertys:{drawBegin:{detail:"开始绘制的钩子函数",default:function(){}},drawEnd:{detail:"开始绘制的钩子函数",default:function(){}},fillStyle:{detail:"单个区块背景色",default:null},fillAlpha:{detail:"单个区块透明度",default:1},maxFillStyle:{detail:"单个区块数据最大对应的颜色",default:null},maxFillAlpha:{detail:"单个区块最大透明度",default:1},minFillAlpha:{detail:"单个区块最小透明度",default:.4},beginFillStyle:{detail:"区域颜色的起始色",documentation:"设置区域颜色的另外一个方案，两个颜色确定一个区间的结束色",default:null},endFillStyle:{detail:"区域颜色的结束色",documentation:"设置区域颜色的另外一个方案，两个颜色确定一个区间的结束色",default:null},strokeStyle:{detail:"单个区块描边颜色",default:"#ccc"},strokeAlpha:{detail:"单个区块描边透明度",default:1},lineWidth:{detail:"单个区块描边线宽",default:1},lineType:{detail:"区块描边样式",default:"solid"},focus:{detail:"单个区块hover态设置",propertys:{enabled:{detail:"是否开启",default:!0},fillStyle:{detail:"hover态单个区块背景色",default:null},fillAlpha:{detail:"hover态单个区块透明度",default:1},strokeStyle:{detail:"hover态单个区块描边颜色",default:null},strokeAlpha:{detail:"hover态单个区块描边透明度",default:1},lineWidth:{detail:"hover态单个区块描边线宽",default:1},lineType:{detail:"hover态区块描边样式",default:null}}},select:{detail:"单个区块选中态设置",propertys:{enabled:{detail:"是否开启",default:!1},fillStyle:{detail:"选中态单个区块背景色",default:null},fillAlpha:{detail:"选中态单个区块透明度",default:1},strokeStyle:{detail:"选中态单个区块描边颜色",default:null},strokeAlpha:{detail:"选中态单个区块描边颜色",default:1},lineWidth:{detail:"选中态单个区块描边线宽",default:1},lineType:{detail:"选中态区块描边样式",default:null}}}}},label:{detail:"文本配置",propertys:{enabled:{detail:"是否开启文本",default:!0},textAlign:{detail:"文本布局位置(left,center,right)",default:"center"},textBaseline:{detail:"文本基线对齐方式",default:"middle"},format:{detail:"文本格式化处理函数",default:null},fontSize:{detail:"文本字体大小",default:12},fontColor:{detail:"文本颜色",default:"#666",documentation:"align为center的时候的颜色，align为其他属性时候取node的颜色"}}},status:{detail:"一些开关配置",propertys:{transform:{detail:"是否启动拖拽缩放整个画布",propertys:{fitView:{detail:"自动缩放",default:""},enabled:{detail:"是否开启",default:!0},scale:{detail:"缩放值",default:1},scaleMin:{detail:"缩放最小值",default:1},scaleMax:{detail:"缩放最大值",default:10},scaleOrigin:{detail:"缩放原点",default:{x:0,y:0}}}}}}}}}]),i}(d.default);d.default.registerComponent(x,"graphs","map");var _=x;e.default=_}));e(vp);var xp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln),h=i(En);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var c=d.default._,p=d.default.event,g=d.default.Shapes.Circle,y=d.default.Shapes.Rect,v=function(t){(0,o.default)(i,t);var e=f(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="legend",c.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.data=o._getLegendData(t),!t.direction&&t.position&&("left"==o.position||"right"==o.position?o.direction="v":o.direction="h"),o.sprite=new d.default.Display.Sprite({id:"LegendSprite",context:{x:o.pos.x,y:o.pos.y}}),o.app.stage.addChild(o.sprite),o.widget(),o.layout(),o}return(0,a.default)(i,[{key:"_getLegendData",value:function(t){var e=t.data;return e?c.each(e,(function(t,e){t.enabled=!0,t.ind=e})):e=this.app.getLegendData(),e||[]}},{key:"layout",value:function(){var t,e=this.app,n=this.width+this.margin.left+this.margin.right,i=this.height+this.margin.top+this.margin.bottom,a=e.padding.left,r=e.padding.top;return"right"==this.position&&(a=e.width-e.padding.right-n),"bottom"==this.position&&(r=e.height-e.padding.bottom-i+this.icon.height/2),"left"==this.position||"right"==this.position?(e.padding[this.position]+=n,t=n,e.height-e.padding.top-e.padding.bottom):"top"!=this.position&&"bottom"!=this.position||(e.padding[this.position]+=i,t=e.width-e.padding.right-e.padding.left,i),"center"==this.textAlign&&(a+=t/2-this.width/2),"right"==this.textAlign&&(a+=t-this.width),this.pos={x:a,y:r},this.pos}},{key:"draw",value:function(){var t=this.app.getComponent({name:"coord"});t&&"rect"==t.type&&("left"!=this.textAlign||"top"!=this.position&&"bottom"!=this.position||(this.pos.x=t.getSizeAndOrigin().origin.x+this.icon.radius)),this.setPosition()}},{key:"widget",value:function(){var t=this,e=this.app.width-this.app.padding.left-this.app.padding.right,n=this.app.height-this.app.padding.top-this.app.padding.bottom,i=0,a=0,r=0,o=0,l=0,s=1,u=!1;c.each(this.data,(function(f,g){if(!u){var y=t._getIconNodeEl(f,g);y.on(p.types.get(),(function(t){}));var v=f.name;t.label.format&&(v=t.label.format(f.name,f));var x=new d.default.Display.Text(v,{id:"legend_field_txt_"+g,context:{x:t.icon.radius+3,y:t.icon.height/3,textAlign:t.label.textAlign,textBaseline:t.label.textBaseline,fillStyle:t.label.fontColor,cursor:t.label.cursor}});x.on(p.types.get(),(function(t){}));var _=x.getTextWidth()+2*t.icon.radius+20;i=Math.max(i,_);var m={height:t.icon.height};if("v"==t.direction){if(l+t.icon.height>n){if(o>.3*e)return void(u=!0);o+=i,l=0}m.x=o,m.y=l,l+=t.icon.height,r=Math.max(r,l)}else{if(o+_>e){if(t.icon.height*(s+1)>.3*n)return void(u=!0);o=0,s++}m.x=o,m.y=t.icon.height*(s-1),o+=_,a=Math.max(a,o)}var b=new d.default.Display.Sprite({id:"legend_field_"+g,context:m});b.addChild(y),b.addChild(x),b.context.width=_,t.sprite.addChild(b),b.on(p.types.get(),(function(e){if(t.triggerEventType.indexOf(e.type)>-1&&t.activeEnabled){if(1==c.filter(t.data,(function(t){return t.enabled})).length&&f.enabled)return;f.enabled=!f.enabled,y.context.fillStyle=f.enabled?f.color||"#999":"#ccc",f.enabled?t.app.show(f.field,new h.default(this,f)):t.app.hide(f.field,new h.default(this,f))}t.tipsEnabled&&("mouseover"!=e.type&&"mousemove"!=e.type||(e.eventInfo=t._getInfoHandler(e,f)),"mouseout"==e.type&&delete e.eventInfo,t.app.fire(e.type,e))}))}})),"h"==this.direction?(t.width=t.sprite.context.width=a,t.height=t.sprite.context.height=t.icon.height*s):(t.width=t.sprite.context.width=o+i,t.height=t.sprite.context.height=r)}},{key:"_getIconNodeEl",value:function(t,e){var n=t.enabled?t.color||"#999":"#ccc";if(this.icon.fillStyle){var i=this._getProp(this.icon.fillStyle,t);i&&(n=i)}return"line"==t.type?new y({id:"legend_field_icon_"+e,context:{x:-this.icon.radius,y:this.icon.height/3-1,fillStyle:n,width:2*this.icon.radius,height:2,cursor:"pointer"}}):"bar"==t.type?new y({id:"legend_field_icon_"+e,context:{x:-this.icon.radius,y:this.icon.height/3-this.icon.radius,fillStyle:n,width:2*this.icon.radius,height:2*this.icon.radius,radius:[3,3,3,3],cursor:"pointer"}}):new g({id:"legend_field_icon_"+e,context:{x:0,y:this.icon.height/3,fillStyle:n,r:this.icon.radius,cursor:"pointer"}})}},{key:"_getInfoHandler",value:function(t,e){return{type:"legend",triggerType:"legend",trigger:"this",tipsEnabled:this.tipsEnabled,nodes:[{name:e.name,fillStyle:e.color}]}}},{key:"_getProp",value:function(t,e){var n=t;return c.isArray(t)&&(n=t[e.ind]),c.isFunction(t)&&(n=t.apply(this,[e])),n}}],[{key:"defaultProps",value:function(){return{data:{detail:"图例数据",default:[],documentation:'                    数据结构为：{name: "uv", color: "#ff8533", field: "" ...}                    如果手动传入数据只需要前面这三个 enabled: true, ind: 0                    外部只需要传field和fillStyle就行了                    '},position:{detail:"图例位置",documentation:"图例所在的方向top,right,bottom,left",default:"top"},direction:{detail:"图例布局方向",default:"h",documentation:"横向 top,bottom --\x3e h left,right -- >v"},textAlign:{detail:"水平方向的对其，默认居左对其",default:"left",documentation:"可选left，center，right"},verticalAlign:{detail:"垂直方向的对其方式，默认居中（待实现）",default:"middle",documentation:"可选top，middle，bottom"},icon:{detail:"图标设置",propertys:{height:{detail:"高",default:26},width:{detail:"图标宽",default:"auto"},shapeType:{detail:"图标的图形类型，目前只实现了圆形",default:"circle"},radius:{detail:"图标（circle）半径",default:5},lineWidth:{detail:"图标描边宽度",default:1},fillStyle:{detail:"图标颜色，一般会从data里面取，这里是默认色",default:null}}},label:{detail:"文本配置",propertys:{textAlign:{detail:"水平对齐方式",default:"left"},textBaseline:{detail:"文本基线对齐方式",default:"middle"},fontColor:{detail:"文本颜色",default:"#333333"},cursor:{detail:"鼠标样式",default:"pointer"},format:{detail:"文本格式化处理函数",default:null}}},triggerEventType:{detail:"触发事件",default:"click,tap"},activeEnabled:{detail:"是否启动图例的交互事件",default:!0},tipsEnabled:{detail:"是否开启图例的tips",default:!1}}}}]),i}(u.default);u.default.registerComponent(v,"legend");var x=v;e.default=x}));e(xp);var _p=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(ki),a=i(hn),r=i(fn),o=i(yn),l=i(pn),s=i(vn),u=i(xn),d=i(wn),h=i(ln),f=i(En);function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}var p=h.default._,g=h.default.Shapes.Line,y=h.default.Shapes.Rect,v=h.default.Shapes.Polygon,x=function(t){(0,l.default)(i,t);var e=c(i);function i(t,n){var r;if((0,a.default)(this,i),(r=e.call(this,t,n)).name="dataZoom",r._cloneChart=null,r.count=1,r.dataLen=1,r.axisLayoutType=null,r.dragIng=function(){},r.dragEnd=function(){},r.disPart={},r._preRange=null,r._btnLeft=null,r._btnRight=null,r._underline=null,r.sprite=new h.default.Display.Sprite({id:"dataZoom",context:{x:r.pos.x,y:r.pos.y}}),r.sprite.noSkip=!0,r.dataZoomBg=new h.default.Display.Sprite({id:"dataZoomBg"}),r.dataZoomBtns=new h.default.Display.Sprite({id:"dataZoomBtns"}),r.sprite.addChild(r.dataZoomBg),r.sprite.addChild(r.dataZoomBtns),n.stage.addChild(r.sprite),"left"==t.position||"right"==t.position){var l=t.width,s=t.height;t.height=l,t.width=s,void 0===t.width&&delete t.width,void 0===t.height&&delete t.height}return p.extend(!0,(0,o.default)(r),(0,bn.getDefaultProps)(i.defaultProps()),t),"margin"in t||("bottom"==r.position&&(r.margin.top=10),"top"==r.position&&(r.margin.bottom=10)),r.axis=null,r.layout(),r}return(0,r.default)(i,[{key:"layout",value:function(){var t=this.app;"bottom"==this.position&&(this.pos.y=t.height-(this.height+t.padding.bottom+this.margin.bottom),t.padding.bottom+=this.height+this.margin.top+this.margin.bottom),"top"==this.position&&(this.pos.y=t.padding.top+this.margin.top,t.padding.top+=this.height+this.margin.top+this.margin.bottom),"left"==this.position&&(this.pos.x=-(this.width-this.height)/2+t.padding.left+this.margin.left,this.pos.y=t.height-t.padding.bottom-this.margin.bottom-this.width/2-this.height/2,t.padding.left+=this.height+this.margin.left+this.margin.right),"right"==this.position&&(this.pos.x=-(this.width-this.height)/2+t.padding.left+this.margin.left,this.pos.y=t.height-t.padding.bottom-this.margin.bottom-this.width/2-this.height/2,t.padding.right+=this.height+this.margin.left+this.margin.right)}},{key:"_getCloneChart",value:function(){var t=this,e=this.app,n=e.getCoord(),i=e.constructor,a=e.el.cloneNode();a.innerHTML="",a.id=e.el.id+"_currclone",a.style.position="absolute",a.style.width=this.width+"px",a.style.height=this.btnHeight+"px",a.style.top="-10000px",document.body.appendChild(a);var r=[];p.each(e.getComponents({name:"graphs"}),(function(i){var a=i.enabledField||i.field;if(p.flatten([a]).length){var o=p.extend(!0,{},i._opt);o.field=a;var l={};"bar"==i.type&&(l={node:{}},t.graphStyle&&(l.node.fillStyle=t.graphStyle)),"line"==i.type&&(l={line:{lineWidth:1},node:{enabled:!1},area:{}},t.graphStyle&&(l.line.strokeStyle=t.graphStyle,l.area.fillStyle=t.graphStyle));var s=n.height||e.el.offsetHeight,u=t.btnHeight/s||1;"scat"==i.type&&(l={node:{radiusScale:u}},t.graphStyle),r.push(p.extend(!0,o,l,{label:{enabled:!1},animation:!1}))}}));var o={coord:Object.assign({},e._opt.coord),graphs:r};o.coord.horizontal&&delete o.coord.horizontal,o.coord.enabled=!1,o.coord.padding=0;var l=new i(a,e._data,o,e.componentModules,e.otherOptions);return l.draw(),{thumbChart:l,cloneEl:a}}},{key:"_setDataZoomOpt",value:function(){var t=this.app,e=t.getComponent({name:"coord"}).getSizeAndOrigin(),i=this,a=e.width;"left"!=this.position&&"right"!=this.position||(a=e.height||150),p.extend(!0,this,{width:this.width||parseInt(a),pos:{x:this.pos.x||e.origin.x},dragIng:function(e){var a;"proportion"==i.axisLayoutType?(a=new f.default(i,{min:e.start,max:e.end}),t.dataFrame.filters["datazoom"+i.__cid]=function(t){if(i.dragIngDataFilter)return i.dragIngDataFilter.apply(i,[t,e]);var a=t[Array.isArray(i.axis.field)?i.axis.field[0]:i.axis.field],r=Math.min.apply(Math,(0,n.default)(i.axis.dataSection)),o=Math.max.apply(Math,(0,n.default)(i.axis.dataSection)),l=i.width,s=r+(o-r)*(e.start/l),u=r+(o-r)*(e.end/l);return a>=s&&a<=u}):(a=new f.default(i,{left:t.dataFrame.range.start-e.start,right:e.end-t.dataFrame.range.end}),p.extend(t.dataFrame.range,e)),t.resetData(null,a),t.fire("dataZoomDragIng")},dragEnd:function(){t.updateChecked&&t.updateChecked(),t.fire("dataZoomDragEnd")}})}},{key:"draw",value:function(){this._setDataZoomOpt(),this._cloneChart=this._getCloneChart();var t=this._cloneChart.thumbChart.getComponent({name:"coord"}),e=t._xAxis;if(this.axis=e,"left"==this.position&&(this.axis=t._yAxisLeft),"right"==this.position&&(this.axis=t._yAxisRight),this.axisLayoutType=this.axis.layoutType,this._computeAttrs(),this.widget(),this._setLines(),this.setMiniGroupsMap(),this.setPosition(),"left"==this.position||"right"==this.position){var n=this.app.getComponent({name:"coord"})._xAxis.height;this.sprite.context.rotation=-90,this.sprite.context.rotateOrigin={x:this.width/2,y:this.height/2},this.sprite.context.y-=n,this._opt.width||(this.sprite.context.y-=this.width/2,this.sprite.context.x-=this.width/2)}}},{key:"destroy",value:function(){this.sprite.destroy()}},{key:"reset",value:function(t){!t&&(t={});var e=this.count,n=this.range.start,i=this.range.end;t&&p.extend(!0,this,t),this._cloneChart=this._getCloneChart(),this._computeAttrs(t),(e!=this.count||t.range&&(t.range.start!=n||t.range.end!=i))&&(this.widget(),this._setLines()),this.setMiniGroupsMap()}},{key:"_computeAttrs",value:function(){var t=this._cloneChart.thumbChart;switch(this.dataLen=t.dataFrame.length,this.axisLayoutType){case"rule":this.count=this.dataLen-1;break;case"peak":this.count=this.dataLen;break;case"proportion":this.count=this.width}(!this._opt.range||this._opt.range&&!this._opt.range.max||this.range.max>this.count)&&(this.range.max=this.count-1),(!this._opt.range||this._opt.range&&!this._opt.range.end||this.range.end>this.dataLen-1)&&(this.range.end=this.dataLen-1,"proportion"==this.axisLayoutType&&(this.range.end=this.count-1)),this.disPart=this._getDisPart(),this.btnHeight=this.height-this.btnOut}},{key:"_getDisPart",value:function(){var t=this,e=Math.max(parseInt(t.range.min/2/t.count*t.width),23),n=parseInt((t.range.max+1)/t.count*t.width);return"peak"==this.axisLayoutType&&(e=Math.max(parseInt(t.range.min/t.count*t.width),23)),"proportion"==this.axisLayoutType&&(n=t.width),{min:e,max:n}}},{key:"_getRangeEnd",value:function(t){return void 0===t&&(t=this.range.end),"peak"==this.axisLayoutType&&(t+=1),"proportion"==this.axisLayoutType&&(t+=1),t}},{key:"widget",value:function(){var t=this,e=function(){t._setLines.apply(t,arguments)};if(t.bg.enabled){var n=t.bg.fillStyle;if(n&&n.lineargradient&&n.lineargradient.length){var i=t.ctx.createLinearGradient(0,t.btnHeight,t.width,t.btnHeight);p.each(n.lineargradient,(function(t){i.addColorStop(t.position,t.color)})),n=i}n||"triangle"!=t.shapeType||(n="#e6e6e6");var a={x:0,y:0,width:t.width,height:t.btnHeight,lineWidth:t.bg.lineWidth,strokeStyle:t.bg.strokeStyle,fillStyle:n,fillAlpha:t.bg.glpha},r={x:0,y:0,pointList:[[0,t.btnHeight],[t.width,t.btnHeight],[t.width,0]],lineWidth:t.bg.lineWidth,strokeStyle:t.bg.strokeStyle,fillStyle:n,globalAlpha:t.bg.glpha};t._bgElement?t._bgElement.animate(a,{onUpdate:e}):("rect"==t.shapeType?t._bgElement=new y({context:a}):t._bgElement=new v({context:r}),t.dataZoomBg.addChild(t._bgElement))}if(t.underline.enabled){var o={start:{x:t.range.start/t.count*t.width+t.btnWidth/2,y:t.btnHeight},end:{x:t._getRangeEnd()/t.count*t.width-t.btnWidth/2,y:t.btnHeight},lineWidth:t.underline.lineWidth,strokeStyle:t.underline.strokeStyle||t.color};t._underline?t._underline.animate(o,{onUpdate:e}):(t._underline=t._addLine(o),t.dataZoomBg.addChild(t._underline))}var l={x:t.range.start/t.count*t.width,y:-t.btnOut/2+1,width:t.btnWidth,height:t.btnHeight+t.btnOut,fillStyle:t.left.fillStyle||t.color,cursor:t.left.eventEnabled&&"move"};t._btnLeft?t._btnLeft.animate(l,{onUpdate:e}):(t._btnLeft=new y({id:"btnLeft",dragEnabled:t.left.eventEnabled,hoverClone:!1,context:l}),t._btnLeft.on("draging",(function(){this.context.y=-t.btnOut/2+1,this.context.x<0&&(this.context.x=0),this.context.x>t._btnRight.context.x-t.btnWidth&&(this.context.x=t._btnRight.context.x-t.btnWidth),t._btnRight.context.x+t.btnWidth-this.context.x>t.disPart.max&&(this.context.x=t._btnRight.context.x+t.btnWidth-t.disPart.max-1),t._btnRight.context.x+t.btnWidth-this.context.x<t.disPart.min&&(this.context.x=t._btnRight.context.x+t.btnWidth-t.disPart.min),"rect"==t.shapeType&&(t._rangeElement.context.width=t._btnRight.context.x-this.context.x-t.btnWidth,t._rangeElement.context.x=this.context.x+t.btnWidth),"triangle"==t.shapeType&&(t._rangeElement.context.pointList=t._getRangeTrianglePoints()),t._setRange()})),t._btnLeft.on("dragend",(function(){t.dragEnd(t.range)})),this.dataZoomBtns.addChild(this._btnLeft));var s={x:t._getRangeEnd()/t.count*t.width-t.btnWidth+1,y:-t.btnOut/2+1,width:t.btnWidth,height:t.btnHeight+t.btnOut,fillStyle:t.right.fillStyle||t.color,cursor:t.right.eventEnabled&&"move"};t._btnRight?t._btnRight.animate(s,{onUpdate:e}):(t._btnRight=new y({id:"btnRight",dragEnabled:t.right.eventEnabled,hoverClone:!1,context:s}),t._btnRight.on("draging",(function(){this.context.y=-t.btnOut/2+1,this.context.x>t.width-t.btnWidth&&(this.context.x=t.width-t.btnWidth+1),this.context.x+t.btnWidth-t._btnLeft.context.x>t.disPart.max&&(this.context.x=t.disPart.max-(t.btnWidth-t._btnLeft.context.x)+1),this.context.x+t.btnWidth-t._btnLeft.context.x<t.disPart.min&&(this.context.x=t.disPart.min-t.btnWidth+t._btnLeft.context.x),"rect"==t.shapeType&&(t._rangeElement.context.width=this.context.x-t._btnLeft.context.x-t.btnWidth,t._rangeElement.context.x=t._btnLeft.context.x+t.btnWidth),"triangle"==t.shapeType&&(t._rangeElement.context.pointList=t._getRangeTrianglePoints()),t._setRange()})),t._btnRight.on("dragend",(function(){t.dragEnd(t.range)})),this.dataZoomBtns.addChild(this._btnRight));var u=s.x-l.x+t.btnWidth,d=this.btnHeight-1,f=l.x,c=t.range.fillStyle;if(c&&c.lineargradient&&c.lineargradient.length){var g=t.ctx.createLinearGradient(0,t.btnHeight,t.width,t.btnHeight);p.each(c.lineargradient,(function(t){g.addColorStop(t.position,t.color)})),c=g}var x={x:f,y:1,width:u,height:d,fillStyle:c,fillAlpha:t.range.alpha,cursor:"move"},_={x:f,y:1,pointList:t._getRangeTrianglePoints(),fillStyle:c,fillAlpha:t.range.alpha,cursor:"move"};this._rangeElement?this._rangeElement.animate(x,{onUpdate:e}):("rect"==this.shapeType?(this._rangeElement=new y({id:"btnRange",dragEnabled:!0,hoverClone:!1,context:x}),this._rangeElement.on("draging",(function(){this.context.y=1,this.context.x<0&&(this.context.x=0),this.context.x>t.width-this.context.width&&(this.context.x=t.width-this.context.width),t._btnLeft.context.x=this.context.x,t._btnRight.context.x=this.context.x+this.context.width-t.btnWidth,t._setRange("btnRange")})),this._rangeElement.on("dragend",(function(){t.dragEnd(t.range)}))):this._rangeElement=new v({id:"btnRange",context:_}),this.dataZoomBtns.addChild(this._rangeElement,0)),this.linesLeft||(this.linesLeft=new h.default.Display.Sprite({id:"linesLeft"}),this.left.eventEnabled&&this._addLines({sprite:this.linesLeft}),this.dataZoomBtns.addChild(this.linesLeft)),this.linesRight||(this.linesRight=new h.default.Display.Sprite({id:"linesRight"}),this.right.eventEnabled&&this._addLines({sprite:this.linesRight}),this.dataZoomBtns.addChild(this.linesRight)),this.linesCenter||"rect"!=this.shapeType||(this.linesCenter=new h.default.Display.Sprite({id:"linesCenter"}),this._addLines({count:3,sprite:this.linesCenter,strokeStyle:this.color}),this.dataZoomBtns.addChild(this.linesCenter))}},{key:"_getRangeTrianglePoints",value:function(){var t=this._btnLeft.context,e=this._btnRight.context,n=t.x,i=e.x-t.x+this.btnWidth,a=this.btnHeight-1,r=this.width;return[[n,a],[n+i,a],[n+i,a*(1-(n+i)/r)],[n,a*(1-n/r)]]}},{key:"_setRange",value:function(t){var e=this,n=e._getRangeEnd(),i=n-e.range.start,a=e._btnLeft.context.x/e.width*e.count,r=(e._btnRight.context.x+e.btnWidth)/e.width*e.count;"peak"==this.axisLayoutType?(a=Math.round(a),r=Math.round(r)):(this.axisLayoutType,a=parseInt(a),r=parseInt(r)),"btnRange"==t&&r-a!=i&&(r=a+i),a==e.range.start&&r==n||(e.range.start=a,"peak"==e.axisLayoutType&&(r-=1),e.range.end=r,e.dragIng(e.range)),e._setLines()}},{key:"_setRange_bak",value:function(t){var e=this,n=e._preRange?e._preRange.start:0,i=e._preRange?e._preRange.end:0,a=e._preRange?i-e._preRange.start:0,r=e._btnLeft.context.x/e.width*e.count,o=(e._btnRight.context.x+e.btnWidth)/e.width*e.count;"peak"==this.axisLayoutType?(r=Math.round(r),o=Math.round(o)):(this.axisLayoutType,r=parseInt(r),o=parseInt(o)),"btnRange"==t&&e._preRange&&o-r!=a&&(o=r+a),e._preRange&&r==n&&o==i||(e.range.start=r,"peak"==e.axisLayoutType&&(o-=1),e.range.end=o,e.dragIng(e.range),e._preRange=Object.assign({},e.range)),e._setLines()}},{key:"_setLines",value:function(){var t=this,e=this.linesLeft,n=this.linesRight,i=this._btnLeft,a=this._btnRight;if(e.context.x=i.context.x+(i.context.width-e.context.width)/2,e.context.y=i.context.y+(i.context.height-e.context.height)/2,n.context.x=a.context.x+(a.context.width-n.context.width)/2,n.context.y=a.context.y+(a.context.height-n.context.height)/2,"rect"==t.shapeType){var r=this.linesCenter,o=this._rangeElement;r.context.x=o.context.x+(o.context.width-r.context.width)/2,r.context.y=o.context.y+(o.context.height-r.context.height)/2}t.underline.enabled&&(t._underline.context.start.x=e.context.x+t.btnWidth/2,t._underline.context.end.x=n.context.x+t.btnWidth/2)}},{key:"_addLines",value:function(t){var e,n=t.count||2,i=t.sprite,a=t.dis||2;for(e=0;e<n;e++)i.addChild(this._addLine({x:e*a,strokeStyle:t.strokeStyle||""}));i.context.width=e*a-1,i.context.height=6}},{key:"_addLine",value:function(t){var e=t||{};return new g({id:e.id||"",context:{x:e.x||0,y:e.y||0,start:{x:e.start?e.start.x:0,y:e.start?e.start.y:0},end:{x:e.end?e.end.x:0,y:e.end?e.end.y:6},lineWidth:e.lineWidth||1,strokeStyle:e.strokeStyle||"#ffffff"}})}},{key:"setMiniGroupsMap",value:function(){if("triangle"!=this.shapeType){this.__graphssp&&this.__graphssp.destroy();var t=this._cloneChart.thumbChart.graphsSprite;t.setEventEnable(!1);var e=this._cloneChart.thumbChart.getComponent({name:"coord"});t.id=t.id+"_datazoomthumbChartbg",t.context.x=-e.origin.x,t.context.scaleY=this.btnHeight/e.height,t.context.scaleX=this.width/e.width,t.context.globalAlpha=this.graphAlpha,this.dataZoomBg.addChild(t,0),this.__graphssp=t,this._cloneChart.thumbChart.destroy(),this._cloneChart.cloneEl.parentNode.removeChild(this._cloneChart.cloneEl)}}}],[{key:"defaultProps",value:function(){return{position:{detail:"位置，默认bottom,其他可选left,right,top",default:"bottom"},height:{detail:"高",default:24},width:{detail:"宽",default:0},color:{detail:"拖拽轴的主题颜色，比如其他按钮如果没有单独设置颜色，就继承该值",default:"#809fff"},shapeType:{detail:"背景的图形形状,可选rect，triangle",default:"rect"},range:{detail:"范围设置",propertys:{start:{detail:"开始位置",default:0},end:{detail:"结束位置，默认为null，表示到最后",default:null},max:{detail:"最多可以选择多大的数据区间",default:null},min:{detail:"最少可以选择多大的数据区间",default:1},eventEnabled:{detail:"是否响应事件",default:!0},fillStyle:{detail:"填充色",default:"#000000"},alpha:{detail:"透明度",default:.015}}},left:{detail:"左边按钮",propertys:{eventEnabled:{detail:"是否响应事件",default:!0},fillStyle:{detail:"颜色，默认取组件.color",default:""}}},right:{detail:"右边按钮",propertys:{eventEnabled:{detail:"是否响应事件",default:!0},fillStyle:{detail:"颜色，默认取组件.color",default:""}}},bg:{detail:"背景设置",propertys:{enabled:{detail:"是否开启",default:!0},fillStyle:{detail:"填充色",default:""},alpha:{detail:"透明度",default:.5},strokeStyle:{detail:"边框色",default:"#e6e6e6"},lineWidth:{detail:"线宽",default:1}}},graphAlpha:{detail:"图形的透明度",default:.6},graphStyle:{detail:"图形的颜色",default:"#dddddd"},underline:{detail:"underline",propertys:{enabled:{detail:"是否开启",default:!0},strokeStyle:{detail:"线条色",default:null},lineWidth:{detail:"线宽",default:2}}},btnOut:{detail:"left,right按钮突出的大小",default:4},btnHeight:{detail:"left,right按钮高",default:20,documentation:"left,right按钮的高，不在left，right下面，统一在这个属性里， 以为要强制保持一致"},btnWidth:{detail:"left,right按钮的宽",default:9,documentation:"left,right按钮的宽，不在left，right下面，统一在这个属性里， 以为要强制保持一致"}}}}]),i}(d.default);d.default.registerComponent(x,"dataZoom");var _=x;e.default=_}));e(_p);var mp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default._,c=d.default.Shapes.BrokenLine,p=d.default.Display.Sprite,g=d.default.Display.Text,y=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="markLine",o._yAxis=null,o.line={y:0,list:[]},o._txt=null,o._line=null,o.sprite=new p,o.app.graphsSprite.addChild(o.sprite),f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o}return(0,a.default)(i,[{key:"draw",value:function(){this._calculateProps(),this.setPosition(),this.widget()}},{key:"_calculateProps",value:function(){var t=this._opt,e=t.markTo,n=this.app.getComponent({name:"coord"});if(!e||-1!=f.indexOf(this.app.dataFrame.fields,e)){var i,a=n._yAxis[0];e&&f.each(n._yAxis,(function(t,n){var i=f.flatten([t.field]);f.indexOf(i,e)>=0&&(a=t)})),t.yAxisAlign&&(a=n._yAxis["left"==t.yAxisAlign?0:1]),i=void 0!==t.y&&null!==t.y?Number(t.y):void 0!==t.yVal&&null!==t.yVal?Number(t.yVal):function(){var t=this.app.dataFrame.getFieldData(e),n=0;return f.each(t,(function(t){Number(t)&&(n+=t)})),n/t.length},isNaN(i)||a.addValToSection(i);var r="#777",o=n.getFieldConfig(e);o&&(r=o.color);var l=t.line&&t.line.strokeStyle||r,s=t.label&&t.label.fontColor||r;this._yAxis=a,this.width=n.width,this.height=n.height,this.yVal=i,this.pos={x:n.origin.x,y:n.origin.y},this.line.list=[[0,0],[this.width,0]],this.label.fontColor=s,l&&(this.line.strokeStyle=l)}}},{key:"widget",value:function(){var t=this,e=this._getYPos(),n=new c({id:"line",context:{y:e,pointList:t.line.list,strokeStyle:t.line.strokeStyle,lineWidth:t.line.lineWidth,lineType:t.line.lineType}});if(t.sprite.addChild(n),t._line=n,t.label.enabled){var i={fillStyle:t.label.fontColor,fontSize:t.label.fontSize},a=new g(t._getLabel(),{context:i});this._txt=a,t.sprite.addChild(a),t._setTxtPos(e)}this.line.y=e}},{key:"reset",value:function(t){t&&f.extend(!0,this,t);var e=this,n=this._getYPos();n!=this.line.y&&this._line.animate({y:n},{duration:300,onUpdate:function(t){e.label.enabled&&(e._txt.resetText(e._getLabel()),e._setTxtPos(t.y))}}),this._line.context.strokeStyle=this.line.strokeStyle,this.line.y=n}},{key:"_setTxtPos",value:function(t){var e=this,n=e._txt;if(!this._yAxis)return 0;"left"==this._yAxis.align?n.context.x=5:n.context.x=this.width-n.getTextWidth()-5,f.isNumber(e.label.y)?n.context.y=e.label.y:n.context.y=t-n.getTextHeight()}},{key:"_getYVal",value:function(t){var e=t=t||this.yVal;return f.isFunction(t)&&(e=t.apply(this)),e}},{key:"_getYPos",value:function(){return this._opt.yPixel?-this._opt.yPixel:this._yAxis?-this._yAxis.getPosOfVal(this._getYVal()):0}},{key:"_getLabel",value:function(){var t=this._getYVal();return f.isFunction(this.label.format)?this.label.format(t,this):f.isString(this.label.text)?this.label.text:t}}],[{key:"defaultProps",value:function(){return{markTo:{detail:"标准哪个目标字段",default:null},yVal:{detail:"组件的值",default:0,documentation:"可能是个function，均值计算就是个function"},yPixel:{detail:"组件指定的具体y像素值",default:0},line:{detail:"线的配置",propertys:{strokeStyle:{detail:"线的颜色",default:"#999999"},lineWidth:{detail:"线宽",default:1},lineType:{detail:"线样式",default:"dashed"}}},label:{detail:"文本",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本字体颜色",default:"#666"},fontSize:{detail:"文本字体大小",default:12},text:{detail:"文本内容",default:null},format:{detail:"文本格式化函数",default:null}}}}}}]),i}(u.default);u.default.registerComponent(y,"markLine");var v=y;e.default=v}));e(mp);var bp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(gn),a=i(hn),r=i(fn),o=i(yn),l=i(pn),s=i(vn),u=i(xn),d=i(wn),h=i(ln);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,u.default)(t);if(e){var a=(0,u.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,s.default)(this,n)}}var c=h.default._,p=h.default.Shapes.Rect,g=h.default.Shapes.Line,y=function(t){(0,l.default)(i,t);var e=f(i);function i(t,n){var r;(0,a.default)(this,i),(r=e.call(this,t,n)).name="tips",r.cW=0,r.cH=0,r.dW=0,r.dH=0,r._tipDom=null,r._tipsPointer=null,r.eventInfo=null,r.sprite=null,r.sprite=new h.default.Display.Sprite({id:"TipSprite"}),r.app.stage.addChild(r.sprite);var l=(0,o.default)(r);return r.sprite.on("destroy",(function(){l._removeContent()})),c.extend(!0,(0,o.default)(r),(0,bn.getDefaultProps)(i.defaultProps()),t),r.tipDomContainer=null,document&&(r.containerIsBody?r.tipDomContainer=document.body:r.tipDomContainer=r.app.canvax.domView),r}return(0,r.default)(i,[{key:"show",value:function(t){var e=this;if(this.enabled){if(t.eventInfo){this.eventInfo=t.eventInfo;var n=t.target.getStage();n?(this.cW=n.context.width,this.cH=n.context.height):"canvax"==t.target.type&&(this.cW=t.target.width,this.cH=t.target.height),this._setContent(t).then((function(n){n?(e._setPosition(t),e.sprite.toFront()):e._hideDialogTips(t)}))}else this._hideDialogTips(t);this._tipsPointerShow(t),this.onshow.apply(this,[t])}}},{key:"move",value:function(t){var e=this;if(this.enabled){if(t.eventInfo)this.eventInfo=t.eventInfo,this._setContent(t).then((function(n){n?e._setPosition(t):e._hideDialogTips()}));this._tipsPointerMove(t),this.onmove.apply(this,[t])}}},{key:"hide",value:function(t){this._hide(t),this.onhide.apply(this,[t])}},{key:"_hide",value:function(t){this.enabled&&(this._hideDialogTips(t),this._tipsPointerHide(t))}},{key:"_hideDialogTips",value:function(){this.eventInfo&&(this.eventInfo=null,this.sprite.removeAllChildren(),this._removeContent())}},{key:"_setPosition",value:function(t){if(this.enabled&&this._tipDom){var e,n,i=this.app.canvax.el.getBoundingClientRect(),a=i.x||i.left,r=i.y||i.top;if(this.containerIsBody){var o=t.target.localToGlobal(t.point);e=this._checkX(o.x+a+this.offsetX),n=this._checkY(o.y+r+this.offsetY)}else e=this._checkX(t.offsetX+a+this.offsetX),n=this._checkY(t.offsetY+r+this.offsetY),e-=a,n-=r;this._tipDom.style.cssText+=";visibility:visible;left:"+e+"px;top:"+n+"px;","left"==this.positionOfPoint&&(this._tipDom.style.left=this._checkX(t.x-this.offsetX-this._tipDom.offsetWidth)+"px")}}},{key:"_creatTipDom",value:function(t){if(document)return this._tipDom=document.createElement("div"),this._tipDom.className="chart-tips",this._tipDom.style.cssText+="; border-radius:"+this.borderRadius+"px;background:"+this.fillStyle+";border:1px solid "+this.strokeStyle+";visibility:hidden;position:"+(this.containerIsBody?"fixed":"absolute")+";z-index:99999999;enabled:inline-block;*enabled:inline;*zoom:1;padding:6px;color:"+this.fontColor+";line-height:1.5",this._tipDom.style.cssText+="; box-shadow:1px 1px 3px "+this.strokeStyle+";",this._tipDom.style.cssText+="; border:none;white-space:nowrap;word-wrap:normal;",this._tipDom.style.cssText+="; text-align:left;pointer-events:none;",this._tipDom.style.cssText+="; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;",this.tipDomContainer&&this.tipDomContainer.appendChild(this._tipDom),this._tipDom}},{key:"_removeContent",value:function(){this._tipDom&&(this.tipDomContainer&&this.tipDomContainer.removeChild(this._tipDom),this._tipDom=null)}},{key:"_setContent",value:function(t){var e=this;return new Promise((function(n){var i=e._getContent(t);i||0===i?(e._tipDom||(e._tipDom=e._creatTipDom(t)),e._tipDom&&(i.then?i.then((function(t){e._tipDom.innerHTML=t,e.dW=e._tipDom.offsetWidth,e.dH=e._tipDom.offsetHeight,n(t)})):(e._tipDom.innerHTML=i,e.dW=e._tipDom.offsetWidth,e.dH=e._tipDom.offsetHeight,n(i)))):n("")}))}},{key:"_getContent",value:function(t){var e="";return t.eventInfo.tipsContent&&(e=c.isFunction(t.eventInfo.tipsContent)?t.eventInfo.tipsContent(t.eventInfo,t):t.eventInfo.tipsContent),e||(e=this.content?c.isFunction(this.content)?this.content(t.eventInfo,t):this.content:this._getDefaultContent(t.eventInfo)),e}},{key:"_getDefaultContent",value:function(t){var e=this.app.getComponent({name:"coord"}),i="";if(!t.nodes.length)return i;var a=!1;return t.nodes.length&&(i+="<table >",void 0!==t.title&&null!==t.title&&""!==t.title&&(i+="<tr><td colspan='2' style='text-align:left;padding-left:3px;'>",i+="<span style='font-size:12px;padding:4px;color:#333;'>"+t.title+"</span>",i+="</td></tr>",a=!0),c.each(t.nodes,(function(r,o){var l,s,u=r.color||r.fillStyle||r.strokeStyle,d=e.getFieldConfig(r.field);if(l=r.name||r.label||(d||{}).name||r.content||r.field||"",i+="<tr>","object"==(0,n.default)(r.value)){if(r.value&&r.value.x){var h=e.getFieldConfig(t.xAxis.field),f=h&&h.name||t.xAxis.field,c=h?h.getFormatValue(r.value.x):r.value.x;i+="<td style='padding:0px 6px;'>"+f+"：<span style='color:"+u+"'>"+c+"</span></td>",a=!0}r.value&&r.value.y&&(s=d?d.getFormatValue(r.value.y):r.value.y,i+="<td style='padding:0px 6px;'>"+l+"：<span style='color:"+u+"'>"+s+"</span></td>",a=!0)}else{s=d?d.getFormatValue(r.value):r.value;var p=r.value||0===r.value;p||r.__no_value||(u="#ddd",s="--"),r.__no__name||(i+="<td style='padding:0px 6px;color:"+(p||r.__no_value?"#a0a0a0;":"#ddd")+"'>"+l+"</td>",a=!0),r.__no_value||(i+="<td style='padding:0px 6px;font-weight:bold;'>",i+="<span style='color:"+u+"'>"+s+"</span>",r.subValue&&(i+="<span style='padding-left:6px;font-weight:normal;'>"+r.subValue+"</span>",a=!0),i+="</td>")}i+="</tr>"})),i+="</table>"),a||(i=""),i}},{key:"_checkX",value:function(t){var e=this.dW+2,n=document.documentElement.clientWidth;return t<0?t=0:t+e>n&&(t=n-e),t}},{key:"_checkY",value:function(t){var e=this.dH+2,n=document.documentElement.clientHeight;return t<0?t=0:t+e>n&&(t=n-e),t}},{key:"_tipsPointerShow",value:function(t){var e=this;if(t.eventInfo&&t.eventInfo.xAxis){var n=this.app.getComponent({name:"coord"});if(n&&"rect"==n.type&&this.pointer){t.eventInfo.nodes.forEach((function(t){"bar"==t.type&&(e.pointer="region")}));var i=this._tipsPointer,a=n.origin.y-n.height,r=0;if("line"==this.pointer&&(r=n.origin.x+t.eventInfo.xAxis.x),"region"==this.pointer){var o=n._xAxis.getCellLengthOfPos(t.eventInfo.xAxis.x);r=n.origin.x+t.eventInfo.xAxis.x-o/2,t.eventInfo.xAxis.ind<0&&(r=n.origin.x)}if(i)this.pointerAnim&&"proportion"!=n._xAxis.layoutType?(i.__animation&&i.__animation.stop(),i.__animation=i.animate({x:r,y:a},{duration:200})):(i.context.x=r,i.context.y=a);else{if("line"==this.pointer&&(i=new g({context:{x:r,y:a,start:{x:0,y:0},end:{x:0,y:n.height},lineWidth:this.pointerLineWidth,strokeStyle:this.pointerColor}})),"region"==this.pointer){var l=n._xAxis.getCellLengthOfPos(r);i=new p({context:{width:l,height:n.height,x:r,y:a,fillStyle:this.pointerColor,globalAlpha:this.pointerRegionAlpha}})}this.app.graphsSprite.addChild(i,0),this._tipsPointer=i}}}}},{key:"_tipsPointerHide",value:function(t){if(t.eventInfo&&t.eventInfo.xAxis){var e=this.app.getComponent({name:"coord"});e&&"rect"==e.type&&this.pointer&&this._tipsPointer&&(this._tipsPointer.destroy(),this._tipsPointer=null)}}},{key:"_tipsPointerMove",value:function(t){if(t.eventInfo&&t.eventInfo.xAxis){var e=this.app.getComponent({name:"coord"});if(e&&"rect"==e.type&&this.pointer&&this._tipsPointer){var n=this._tipsPointer,i=e.origin.x+t.eventInfo.xAxis.x;if("region"==this.pointer){var a=e._xAxis.getCellLengthOfPos(t.eventInfo.xAxis.x);i=e.origin.x+t.eventInfo.xAxis.x-a/2,t.eventInfo.xAxis.ind<0&&(i=e.origin.x)}var r=e.origin.y-e.height;i!=n.__targetX&&(this.pointerAnim&&"proportion"!=e._xAxis.layoutType?(n.__animation&&n.__animation.stop(),n.__targetX=i,n.__animation=n.animate({x:i,y:r},{duration:200,onComplete:function(){delete n.__targetX,delete n.__animation}})):(n.context.x=i,n.context.y=r))}}}}],[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启Tips",default:!0},content:{detail:"自定义tips的内容（html）",default:null},containerIsBody:{detail:"tips的html内容是否放到body下面，默认true，false则放到图表自身的容器内",default:!0},borderRadius:{detail:"tips的边框圆角半径",default:5},strokeStyle:{detail:"tips边框颜色",default:"#ccc"},fillStyle:{detail:"tips背景色",default:"rgba(255,255,255,0.95)"},fontColor:{detail:"tips文本颜色",default:"#999999"},positionOfPoint:{detail:"tips在触发点的位置，默认在右侧",default:"right"},offsetX:{detail:"tips内容到鼠标位置的偏移量x",default:10},offsetY:{detail:"tips内容到鼠标位置的偏移量y",default:10},positionInRange:{detail:"tip的浮层是否限定在画布区域(废弃)",default:!1},pointer:{detail:"触发tips的时候的指针样式",default:"line",documentation:'tips的指针,默认为直线，可选为："line" | "region"(柱状图中一般用region)'},pointerColor:{detail:"tips指针样式的颜色",default:"#ccc"},pointerLineWidth:{detail:"pointer为line的时候，设置指针line的线宽，默认1.5",default:1},pointerRegionAlpha:{detail:"pointer为region的时候，设置指针region的透明度",default:.38},pointerAnim:{detail:"tips移动的时候，指针是否开启动画",default:!0},linkageName:{detail:"tips的多图表联动，相同的图表会执行事件联动，这个属性注意要保证y轴的width是一致的",default:null},onshow:{detail:"show的时候的事件",default:function(){}},onmove:{detail:"move的时候的事件",default:function(){}},onhide:{detail:"hide的时候的事件",default:function(){}}}}}]),i}(d.default);d.default.registerComponent(y,"tips");var v=y;e.default=v}));e(bp);var wp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default._,c=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;(0,n.default)(this,i),(o=e.call(this,t,a)).name="contextmenu",o.cW=0,o.cH=0,o.dW=0,o.dH=0,o._tipDom=null,o._tipsPointer=null,o.eventInfo=null,o.sprite=null,o.sprite=new d.default.Display.Sprite({id:"contextMenuSprite"}),o.app.stage.addChild(o.sprite);var l=(0,r.default)(o);return o.sprite.on("destroy",(function(){l._removeContent()})),o.isShow=!1,f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.tipDomContainer=document?document.body:null,o}return(0,a.default)(i,[{key:"show",value:function(t){if(this.enabled){if(t.eventInfo){this.eventInfo=t.eventInfo;var e=t.target.getStage();e?(this.cW=e.context.width,this.cH=e.context.height):"canvax"==t.target.type&&(this.cW=t.target.width,this.cH=t.target.height),this._setContent(t)?(this._setPosition(t),this.sprite.toFront()):this._hideDialogMenus(t)}else this._hideDialogMenus(t);this.onshow.apply(this,[t]),this.isShow=!0}}},{key:"hide",value:function(t){this.enabled&&(this._hideDialogMenus(t),this.onhide.apply(this,[t]),this.isShow=!1)}},{key:"_hideDialogMenus",value:function(){this.eventInfo&&(this.eventInfo=null,this.sprite.removeAllChildren(),this._removeContent())}},{key:"_setPosition",value:function(t){if(this.enabled&&this._tipDom){var e,n,i=this.app.canvax.el.getBoundingClientRect(),a=i.x||i.left,r=i.y||i.top;if(this.containerIsBody){var o=t.target.localToGlobal(t.point);e=this._checkX(o.x+a+this.offsetX),n=this._checkY(o.y+r+this.offsetY)}else e=this._checkX(t.offsetX+a+this.offsetX),n=this._checkY(t.offsetY+r+this.offsetY),e-=a,n-=r;this._tipDom.style.cssText+=";visibility:visible;left:"+e+"px;top:"+n+"px;","left"==this.positionOfPoint&&(this._tipDom.style.left=this._checkX(t.x-this.offsetX-this._tipDom.offsetWidth)+"px")}}},{key:"_creatMenuDom",value:function(t){var e=this;if(document)return this._tipDom=document.createElement("div"),this._tipDom.className="context-menu-tips",this._tipDom.style.cssText+="; border-radius:"+this.borderRadius+"px;background:"+this.fillStyle+";border:1px solid "+this.strokeStyle+";visibility:hidden;position:"+(this.containerIsBody?"fixed":"absolute")+";z-index:99999999;enabled:inline-block;*enabled:inline;*zoom:1;color:"+this.fontColor+";line-height:1.5",this._tipDom.style.cssText+="; box-shadow:1px 1px 3px "+this.strokeStyle+";",this._tipDom.style.cssText+="; border:none;white-space:nowrap;word-wrap:normal;",this._tipDom.style.cssText+="; text-align:left;",this._tipDom.style.cssText+="; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;",this._tipDom.onclick=function(){e.hide()},this.tipDomContainer&&this.tipDomContainer.appendChild(this._tipDom),this._tipDom}},{key:"_removeContent",value:function(){this._tipDom&&(this.tipDomContainer&&this.tipDomContainer.removeChild(this._tipDom),this._tipDom=null)}},{key:"_setContent",value:function(t){var e=this._getContent(t);if(e||0===e)return this._tipDom||(this._tipDom=this._creatMenuDom(t)),this._tipDom&&(this._tipDom.innerHTML=e,this.dW=this._tipDom.offsetWidth,this.dH=this._tipDom.offsetHeight),e}},{key:"_getContent",value:function(t){return this.content?f.isFunction(this.content)?this.content(t.eventInfo,t):this.content:""}},{key:"_checkX",value:function(t){var e=this.dW+2,n=document.documentElement.clientWidth;return t<0?t=0:t+e>n&&(t=n-e),t}},{key:"_checkY",value:function(t){var e=this.dH+2,n=document.documentElement.clientHeight;return t<0?t=0:t+e>n&&(t=n-e),t}}],[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启右键菜单",default:!0},content:{detail:"自定义tips的内容（html）",default:null},containerIsBody:{detail:"tips的html内容是否放到body下面，默认true，false则放到图表自身的容器内",default:!0},borderRadius:{detail:"tips的边框圆角半径",default:5},strokeStyle:{detail:"tips边框颜色",default:"#ccc"},fillStyle:{detail:"tips背景色",default:"rgba(255,255,255,0.95)"},fontColor:{detail:"tips文本颜色",default:"#999999"},positionOfPoint:{detail:"tips在触发点的位置，默认在右侧",default:"right"},offsetX:{detail:"tips内容到鼠标位置的偏移量x",default:10},offsetY:{detail:"tips内容到鼠标位置的偏移量y",default:10},onshow:{detail:"show的时候的事件",default:function(){}},onmove:{detail:"move的时候的事件",default:function(){}},onhide:{detail:"hide的时候的事件",default:function(){}}}}}]),i}(u.default);u.default.registerComponent(c,"contextmenu");var p=c;e.default=p}));e(wp);var kp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default.Shapes.Line,c=d.default._,p=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="barTgi",o.data=null,o.barDatas=null,o._yAxis=null,o.sprite=null,o.pos={x:0,y:0},c.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o._yAxis=o.app.getComponent({name:"coord"})._yAxis["left"==o.yAxisAlign?0:1],o.sprite=new d.default.Display.Sprite,o.app.graphsSprite.addChild(o.sprite),o}return(0,a.default)(i,[{key:"reset",value:function(t){c.extend(!0,this,t),this.barDatas=null,this.data=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var t=this,e=this.app.getComponent({name:"coord"});this.pos={x:e.origin.x,y:e.origin.y},this.setPosition(),c.each(t.app.getComponents({name:"graphs"}),(function(e){if("bar"==e.type&&e.data[t.barField])return t.barDatas=e.data[t.barField],!1})),this.data=c.flatten(t.app.dataFrame.getDataOrg(t.field)),this.barDatas&&c.each(this.data,(function(e,n){var i=-t._yAxis.getPosOfVal(e),a=t.barDatas[n],r=new f({context:{start:{x:a.x,y:i},end:{x:a.x+a.width,y:i},lineWidth:2,strokeStyle:t._getProp(t.line.strokeStyle,e,n)}});t.sprite.addChild(r)}))}},{key:"_getProp",value:function(t,e,n){var i=t;return c.isFunction(t)&&(i=t.apply(this,[e,n])),i}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},barField:{detail:"这个bartgi组件对应的bar Graph 的field",default:null},yAxisAlign:{detail:"这个bartgi组件回到到哪个y轴",default:"left"},standardVal:{detail:"tgi标准线",default:100},line:{detail:"bar对应的tgi线配置",propertys:{lineWidth:{detail:"线宽",default:3},strokeStyle:{detail:"线颜色",default:function(t){return t>=this.standardVal?"#43cbb5":"#ff6060"}}}}}}}]),i}(u.default);u.default.registerComponent(p,"barTgi");var g=p;e.default=g}));e(kp);var Sp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default._,c=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="barGuide",o.data=null,o.barDatas=null,o._yAxis=null,o.sprite=null,f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o._yAxis=o.app.getComponent({name:"coord"})._yAxis["left"==o.yAxisAlign?0:1],o.sprite=new d.default.Display.Sprite,o.app.graphsSprite.addChild(o.sprite),o}return(0,a.default)(i,[{key:"reset",value:function(t){f.extend(!0,this,t),this.barDatas=null,this.data=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var t=this,e=this.app.getComponent({name:"coord"});this.pos={x:e.origin.x,y:e.origin.y},this.setPosition(),f.each(t.app.getComponents({name:"graphs"}),(function(e){if("bar"==e.type&&e.data[t.barField])return t.barDatas=e.data[t.barField],!1})),this.data=f.flatten(t.app.dataFrame.getDataOrg(t.field)),this.barDatas&&f.each(this.data,(function(e,n){var i=-t._yAxis.getPosOfVal(e),a=t.barDatas[n],r=new d.default.Shapes.Circle({context:{x:a.x+a.width/2,y:i,r:t.node.radius,fillStyle:t.node.fillStyle,strokeStyle:t.node.strokeStyle,lineWidth:t.node.lineWidth}}),o=e;f.isFunction(t.label.format)&&(o=t.label.format(e,a));var l=new d.default.Display.Text(o,{context:{x:a.x+a.width/2,y:i-t.node.radius-1,fillStyle:t.label.fontColor,lineWidth:t.label.lineWidth,strokeStyle:t.label.strokeStyle,fontSize:t.label.fontSize,textAlign:t.label.textAlign,textBaseline:t.label.verticalAlign}});t.sprite.addChild(r),t.sprite.addChild(l)}))}},{key:"_getProp",value:function(t,e,n){var i=t;return f.isFunction(t)&&(i=t.apply(this,[e,n])),i}}],[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},barField:{detail:"这个guide对应的bar Graph 的field",default:null},yAxisAlign:{detail:"这个guide组件回到到哪个y轴",default:"left"},node:{detail:"单个节点配置",propertys:{shapeType:{detail:"节点绘制的图形类型",default:"circle"},lineWidth:{detail:"图表描边线宽",default:3},radius:{detail:"图形半径",default:6},fillStyle:{detail:"填充色",default:"#19dea1"},strokeStyle:{detail:"描边色",default:"#fff"}}},label:{detail:"文本配置",propertys:{fontSize:{detail:"字体大小",default:12},fontColor:{detail:"字体颜色",default:"#19dea1"},verticalAlign:{detail:"垂直对齐方式",default:"bottom"},textAlign:{detail:"水平对齐方式",default:"center"},strokeStyle:{detail:"文本描边颜色",default:"#fff"},lineWidth:{detail:"文本描边线宽",default:0},format:{detail:"文本格式处理函数",default:null}}}}}}]),i}(u.default);u.default.registerComponent(c,"barGuide");var p=c;e.default=p}));e(Sp);var Ap=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(pn),o=i(vn),l=i(xn),s=i(wn);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,l.default)(t);if(e){var a=(0,l.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,o.default)(this,n)}}var d=function(t){(0,r.default)(i,t);var e=u(i);function i(t,a){var r;return(0,n.default)(this,i),(r=e.call(this,t,a)).name="theme",r.colors=t||[],r}return(0,a.default)(i,[{key:"set",value:function(t){return this.colors=t,this.colors}},{key:"get",value:function(t){var e=this.colors;return ln._.isArray(e)||(e=[e]),e}},{key:"mergeTo",value:function(t){t||(t=[]);for(var e=0,n=this.colors.length;e<n;e++)t[e]?t[e]=this.colors[e]:t.push(this.colors[e]);return t}}]),i}(s.default);s.default.registerComponent(d,"theme");var h=d;e.default=h}));e(Ap);var Pp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(ln),d=i(wn);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=u.default._,c=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="waterMark",o.width=o.app.width,o.height=o.app.height,f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.spripte=new u.default.Display.Sprite({id:"watermark"}),o.app.stage.addChild(o.spripte),o.draw(),o}return(0,a.default)(i,[{key:"draw",value:function(){for(var t=new u.default.Display.Text(this.text,{context:{fontSize:this.fontSize,fillStyle:this.fontColor}}),e=t.getTextWidth(),n=t.getTextHeight(),i=parseInt(this.height/(5*n))+1,a=parseInt(this.width/(1.5*e))+1,r=0;r<i;r++)for(var o=0;o<a;o++){var l=new u.default.Display.Text(this.text,{context:{rotation:this.rotation,fontSize:this.fontSize,fillStyle:this.fontColor,globalAlpha:this.alpha}});l.context.x=1.5*e*o+.25*e,l.context.y=5*n*r,this.spripte.addChild(l)}}}],[{key:"defaultProps",value:function(){return{text:{detail:"水印内容",default:"chartx"},fontSize:{detail:"字体大小",default:20},fontColor:{detail:"水印颜色",default:"#cccccc"},alpha:{detail:"水印透明度",default:.2},rotation:{detail:"水印旋转角度",default:45}}}}]),i}(d.default);d.default.registerComponent(c,"waterMark");var p=c;e.default=p}));e(Pp);var Cp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default._,c=d.default.Shapes.Line,p=d.default.Shapes.Rect,g=d.default.Shapes.Arrow,y=d.default.Display.Text,v=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="cross",f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o._yAxis=o.app.getComponent({name:"coord"})._yAxis["left"==o.yAxisAlign?0:1],o.sprite=new d.default.Display.Sprite,o.app.graphsSprite.addChild(o.sprite,0),o}return(0,a.default)(i,[{key:"draw",value:function(){this._widget()}},{key:"reset",value:function(t){t&&f.extend(!0,this,t),this._widget()}},{key:"_widget",value:function(){var t=this,e=this.app.getComponent({name:"coord"});this.pos={x:e.origin.x,y:e.origin.y},this.setPosition();var n=e.width,i=e.height,a=this.aimPoint.xVal,r=0;r=null==a||null==a?parseInt(n/2):e._xAxis.getPosOfVal(a);var o=this.aimPoint.yVal,l=0;l=null==a||null==a?parseInt(i/2):e._yAxis[0].getPosOfVal(o);for(var s=0;s<4;s++){var u=0,d=0,h=0,f=0,v=void 0,x={},_={};switch(s){case 0:h=n-r,f=i-l,u=r,v="rightTop",x={x:n-8,y:(d=-i)+4,textAlign:"right",textBaseline:"top"},_={x:n,y:d};break;case 1:h=r,f=i-l,v="leftTop",x={x:(u=0)+8,y:(d=-i)+4,textAlign:"left",textBaseline:"top"},_={x:u,y:d};break;case 2:h=r,f=l,u=0,d=-l,v="leftBottom",x={x:8,y:-4,textAlign:"left",textBaseline:"bottom"},_={x:0,y:0};break;case 3:h=n-r,f=l,u=r,d=-l,v="rightBottom",x={x:n-8,y:-4,textAlign:"right",textBaseline:"bottom"},_={x:n,y:0}}var m=this.quadrant[v],b={width:h,height:f,x:u,y:d,fillStyle:m.fillStyle,fillAlpha:m.fillAlpha},w="_quadrant_"+s;this[w]?Object.assign(this[w].context,b):(this[w]=new p({id:w,context:b}),t.sprite.addChild(this[w]));var k=!0;h&&f&&m.label.text||(k=!1),x.fillStyle=m.label.fontColor,x.fontSize=m.label.fontSize,x.visible=k;var S="_quadrant_text"+s;switch(this[S]?Object.assign(this[S].context,x):(this[S]=new y(m.label.text,{id:S,context:x}),t.sprite.addChild(this[S])),_.fillStyle=m.label.fillStyle,_.fillAlpha=m.label.fillAlpha,_.visible=k,Object.assign(_,{width:this[S].getTextWidth()+16,height:this[S].getTextHeight()+8}),s){case 0:_.x=_.x-_.width;break;case 1:break;case 2:_.y=_.y-_.height;break;case 3:_.x=_.x-_.width,_.y=_.y-_.height}var A="_quadrant_text_background_"+s;this[A]?Object.assign(this[A].context,_):(this[A]=new p({id:A,context:_}),t.sprite.addChild(this[A]),this[A].toBack(1))}var P={start:{x:0,y:-l},end:{x:n,y:-l},strokeStyle:t.line.strokeStyle,lineWidth:t.line.lineWidth,lineType:t.line.lineType};t._hLineElement?(t._hLineElement.context.start.y=P.start.y,t._hLineElement.context.end.y=P.end.y):(t._hLineElement=new c({context:P}),t.sprite.addChild(t._hLineElement));var C={x:0,y:0,control:{x:P.end.x-10,y:P.end.y},point:{x:P.end.x,y:P.end.y},strokeStyle:P.strokeStyle,fillStyle:P.strokeStyle};t._hLineElementArrow?(Object.assign(t._hLineElementArrow.context.control,C.control),Object.assign(t._hLineElementArrow.context.point,C.point)):(t._hLineElementArrow=new g({id:"_hArrow",context:C}),t.sprite.addChild(t._hLineElementArrow)),["begin","end"].forEach((function(e){var i={x:"begin"==e?4:n-4,y:-l-4,fillStyle:t.line.hLabel[e].fontColor,fontSize:t.line.hLabel[e].fontSize,textAlign:"begin"==e?"left":"right",textBaseline:"bottom"},a=t["_hLineLabel"+e+"Ctx"];a?Object.assign(a.context,i):(a=t["_hLineLabel"+e+"Ctx"]=new y(t.line.hLabel[e].text,{context:i}),t.sprite.addChild(a))}));var D={start:{x:r,y:0},end:{x:r,y:-i},strokeStyle:t.line.strokeStyle,lineWidth:t.line.lineWidth,lineType:t.line.lineType};t._vLineElement?(t._vLineElement.context.start.x=D.start.x,t._vLineElement.context.end.x=D.end.x):(t._vLineElement=new c({context:D}),t.sprite.addChild(t._vLineElement));var O={x:0,y:0,control:{x:D.end.x,y:D.end.y+10},point:{x:D.end.x,y:D.end.y},strokeStyle:D.strokeStyle,fillStyle:D.strokeStyle};t._vLineElementArrow?(Object.assign(t._vLineElementArrow.context.control,O.control),Object.assign(t._vLineElementArrow.context.point,O.point)):(t._vLineElementArrow=new g({id:"_vArrow",context:O}),t.sprite.addChild(t._vLineElementArrow)),["begin","end"].forEach((function(e){var n={x:r-4,y:"begin"==e?-4:4-i,fillStyle:t.line.vLabel[e].fontColor,fontSize:t.line.vLabel[e].fontSize,textAlign:"right",textBaseline:"begin"==e?"bottom":"top"},a=t["_vLineLabel"+e+"Ctx"];a?Object.assign(a.context,n):(a=t["_vLineLabel"+e+"Ctx"]=new y(t.line.vLabel[e].text,{context:n}),t.sprite.addChild(a))}))}}],[{key:"defaultProps",value:function(){return{aimPoint:{detail:"准心位置",propertys:{xVal:{detail:"准心x轴value",default:null},yVal:{detail:"准心y轴value",default:null}}},line:{detail:"线配置",propertys:{strokeStyle:{detail:"线颜色",default:"#cccccc"},lineWidth:{detail:"线宽",default:1},lineType:{detail:"线样式类型",default:"solid"},showArrow:{detail:"是否显示箭头",default:!0},vLabel:{detail:"纵向线方向的label",propertys:{begin:{detail:"开始点label",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"文本大小",default:12}}},end:{detail:"结束点label",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"文本大小",default:12}}}}},hLabel:{detail:"横向线方向的label",propertys:{begin:{detail:"开始点label",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"文本大小",default:12}}},end:{detail:"结束点label",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"文本大小",default:12}}}}}}},quadrant:{detail:"4象限设置",propertys:{rightTop:{detail:"第一象限",propertys:{fillStyle:{detail:"象限区块背景色",default:"#fff"},fillAlpha:{detail:"象限区块背透明度",default:.1},label:{detail:"象限文本设置",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#666"},fontSize:{detail:"文本字体大小",default:14},fillStyle:{detail:"文本矩形背景色",default:"#e9e9f8"},fillAlpha:{detail:"文本矩形背景透明度",default:.5}}}}},leftTop:{detail:"第二象限",propertys:{fillStyle:{detail:"象限区块背景色",default:"#fff"},fillAlpha:{detail:"象限区块背透明度",default:.1},label:{detail:"象限文本设置",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#666"},fontSize:{detail:"文本字体大小",default:14},fillStyle:{detail:"文本矩形背景色",default:"#e9e9f8"},fillAlpha:{detail:"文本矩形背景透明度",default:.5}}}}},leftBottom:{detail:"第三象限",propertys:{fillStyle:{detail:"象限区块背景色",default:"#fff"},fillAlpha:{detail:"象限区块背透明度",default:.1},label:{detail:"象限文本设置",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#666"},fontSize:{detail:"文本字体大小",default:14},fillStyle:{detail:"文本矩形背景色",default:"#e9e9f8"},fillAlpha:{detail:"文本矩形背景透明度",default:.5}}}}},rightBottom:{detail:"第四象限",propertys:{fillStyle:{detail:"象限区块背景色",default:"#fff"},fillAlpha:{detail:"象限区块背透明度",default:.1},label:{detail:"象限文本设置",propertys:{text:{detail:"文本内容",default:""},fontColor:{detail:"文本颜色",default:"#666"},fontSize:{detail:"文本字体大小",default:14},fillStyle:{detail:"文本矩形背景色",default:"#e9e9f8"},fillAlpha:{detail:"文本矩形背景透明度",default:.5}}}}}}}}}}]),i}(u.default);u.default.registerComponent(v,"cross");var x=v;e.default=x}));e(Cp);var Dp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default._,c=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="lineSchedu",f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.lineDatas=null,o.sprite=new d.default.Display.Sprite,o.app.graphsSprite.addChild(o.sprite),o}return(0,a.default)(i,[{key:"reset",value:function(t){f.extend(!0,this,t),this.lineDatas=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var t=this,e=this.app.getComponent({name:"coord"});this.pos={x:e.origin.x,y:e.origin.y},this.setPosition();var n=t.app.getComponent({name:"graphs",type:"line",field:t.lineField});t.lineDatas=n.data[t.lineField].data;var i=this.app.getComponent({name:"coord"}).getAxis({type:"xAxis"}).getIndexOfVal(this.time);if(-1!=i){var a=this.lineDatas[i];if(null!=a.y){var r=t._getNodeY(a,e),o=a.x,l=new d.default.Display.Sprite({context:{x:o-20}});this.sprite.addChild(l);var s=0,u=new d.default.Display.Text(t.time,{context:{fillStyle:this.timeFontColor||this.style,fontSize:this.timeFontSize}});l.addChild(u),s=u.getTextHeight();var h=u.getTextWidth(),c=new d.default.Display.Text(f.flatten([t.list]).join("\n"),{context:{y:s,fillStyle:this.listFontColor||this.style,fontSize:this.listFontSize}});l.addChild(c),s+=c.getTextHeight(),(h=Math.max(h,c.getTextWidth()))+o-20>e.width+t.app.padding.right&&(l.context.x=e.width+t.app.padding.right,u.context.textAlign="right",c.context.textAlign="right");var p=0;"online"==t.status?(p=r-(this.radius+3)-s,Math.abs(p)>e.origin.y&&(p=-e.origin.y,r=-(e.origin.y-(this.radius+3)-s))):(p=r+(this.radius+3))+s>0&&(p=-s,r=-(this.radius+3)-s),l.context.y=p;var g=new d.default.Shapes.BrokenLine({context:{pointList:[[o,r],[o,a.y]],strokeStyle:t.style,lineWidth:t.lineWidth}});t.sprite.addChild(g);var y=new d.default.Shapes.Circle({context:{x:o,y:r,r:t.radius,fillStyle:t.fillStyle,strokeStyle:t.style,lineWidth:t.lineWidth}});t.sprite.addChild(y)}}}},{key:"_getNodeY",value:function(t,e){var n=this.app.height,i=(e.height,t.y);return"online"==this.status?i-=Math.min(50,.3*(n-Math.abs(i))):i+=Math.min(50,.3*Math.abs(i)),i}}],[{key:"defaultProps",value:function(){return{lineField:{detail:"对应的line字段",default:null},style:{detail:"默认色",default:"#3995ff"},fillStyle:{detail:"节点填充色",default:"#ffffff"},lineWidth:{detail:"线宽",default:2},radius:{detail:"圆点半径",default:6},timeFontSize:{detail:"时间文本大小",default:14},timeFontColor:{detail:"时间文本颜色",default:"#606060"},listFontSize:{detail:"列表信息文本大小",default:12}}}}]),i}(u.default);u.default.registerComponent(c,"lineSchedu");var p=c;e.default=p}));e(Dp);var Op=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default._,c=d.default.event,p=d.default.Shapes.Line,g=d.default.Shapes.Circle,y=d.default.Display.Text,v=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="markcloumn",f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.sprite=new d.default.Display.Sprite,o.app.graphsSprite.addChild(o.sprite),o._line=null,o._lineSp=new d.default.Display.Sprite,o.sprite.addChild(o._lineSp),o.nodes=[],o._nodes=new d.default.Display.Sprite,o.sprite.addChild(o._nodes),o._labels=new d.default.Display.Sprite,o.sprite.addChild(o._labels),o}return(0,a.default)(i,[{key:"draw",value:function(t){!t&&(t={}),this.width=t.width,this.height=t.height,this.origin=t.origin,this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this._widget()}},{key:"reset",value:function(t){t&&f.extend(!0,this,t),this._widget()}},{key:"_widget",value:function(){var t,e=this,n=this.app.getComponent({name:"coord"})._xAxis;if(null!=this.xVal&&(t=n.getNodeInfoOfVal(this.xVal)),null!=this.xPixel&&(t=n.getNodeInfoOfX(this.xPixel)),t){e.nodes=[],e.on("complete",(function(){e._drawLine(t),e._drawNodes(t),e._drawLabels(t)}));var i=0,a=this.app.getGraphs();f.each(a,(function(n){function r(){if(i++,e.markTo&&-1==f.flatten([n.field]).indexOf(e.markTo));else{var r=n.getNodesOfPos(t.x);if(e.markTo){var o=f.find(r,(function(t){return t.field==e.markTo}));o&&(e.nodes=[o])}else e.nodes=e.nodes.concat(r)}i==a.length&&e.fire("complete")}n.inited?r():n.on("complete",(function(){r()}))}))}}},{key:"_drawLine",value:function(t){var e=this;if(e.line.enabled){var n=f.extend(!0,{x:parseInt(t.x),start:{x:0,y:0},end:{x:0,y:-e.height},lineWidth:1,strokeStyle:"#cccccc"},this.line);if(null!=e.line.endY){var i=0;f.isNumber(e.line.endY)&&(i=e.line.endY),"auto"==e.line.endY&&f.each(e.nodes,(function(t){i=Math.min(t.y,i)})),n.end.y=i}this._line?f.extend(this._line.context,n):(this._line=new p({context:n}),this._lineSp.addChild(this._line),this._line.on(c.types.get(),(function(t){t.eventInfo={xAxis:{},nodes:e.nodes},null!=e.xVal&&(t.eventInfo.xAxis.value=e.xVal,t.eventInfo.xAxis.text=e.xVal+"",t.eventInfo.title=e.xVal+""),e.app.fire(t.type,t)})))}}},{key:"_drawNodes",value:function(){var t=this;t.node.enabled&&(t._nodes.removeAllChildren(),f.each(t.nodes,(function(e){var n=f.extend({x:e.x,y:e.y,cursor:"pointer",r:t.node.radius,lineWidth:t.node.lineWidth||e.lineWidth,strokeStyle:t.node.strokeStyle||e.color,fillStyle:t.node.fillStyle||e.fillStyle}),i=new g({context:n});i.nodeData=e,i.on(c.types.get(),(function(n){n.eventInfo={xAxis:{},nodes:[e]},null!=t.xVal&&(n.eventInfo.xAxis.value=t.xVal,n.eventInfo.xAxis.text=t.xVal+"",n.eventInfo.title=t.xVal+""),t.app.fire(n.type,n)})),t._nodes.addChild(i)})))}},{key:"_drawLabels",value:function(){var t=this;t.node.enabled&&(t._labels.removeAllChildren(),f.each(t.nodes,(function(e){var n={x:e.x,y:e.y-t.node.radius-2,fillStyle:t.label.fontColor||e.color,fontSize:t.label.fontSize,textAlign:"center",textBaseline:"bottom"},i=t.label.text;if(f.isFunction(i)&&(i=i.apply(t,[e])),i){var a=new y(i,{context:n});t._labels.addChild(a),a.localToGlobal().x+a.getTextWidth()/2>t.app.width&&(a.context.x=t.app.width-a.getTextWidth()/2-a.parent.localToGlobal().x)}})))}}],[{key:"defaultProps",value:function(){return{xVal:{detail:"x的value值",default:null},xPixel:{detail:"x方向的具体像素值",default:null},markTo:{detail:"标准哪个目标字段，主要用作折线图",documentation:"如果设置了这个字段，那么line的起点将是这个graphs上的node节点",default:null},line:{detail:"线的配置",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"线宽",default:2},strokeStyle:{detail:"线的颜色",default:"#d5d5d5"},lineType:{detail:"线的样式，虚线(dashed)实线(solid)",default:"solid"},startY:{detail:"startY",default:0},endY:{detail:"startY",default:null}}},node:{detail:"数据图形节点",propertys:{enabled:{detail:"是否开启",default:!0},radius:{detail:"节点半径",default:5},fillStyle:{detail:"节点图形的背景色",default:"#ffffff"},strokeStyle:{detail:"节点图形的描边色，默认和line.strokeStyle保持一致",default:null},lineWidth:{detail:"节点图形边宽大小",default:2}}},label:{detail:"文本",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本字体颜色",default:null},fontSize:{detail:"文本字体大小",default:12},text:{detail:"文本内容",documentation:"可以是函数",default:null},format:{detail:"文本格式化函数",default:null}}}}}}]),i}(u.default);u.default.registerComponent(v,"markcloumn");var x=v;e.default=x}));e(Op);var Tp=n((function(t){!function e(n,i,a){var r=function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(!(this instanceof o))return new o(t,e);r(t)?(e=t[1],t=t[0]):"object"==typeof t&&t&&(e=t.y,t=t.x),this.x=o.clean(t||0),this.y=o.clean(e||0)}o.prototype={change:function(t){if("function"==typeof t)this.observers?this.observers.push(t):this.observers=[t];else if(this.observers&&this.observers.length)for(var e=this.observers.length-1;e>=0;e--)this.observers[e](this,t);return this},ignore:function(t){if(this.observers)if(t)for(var e=this.observers,n=e.length;n--;)e[n]===t&&e.splice(n,1);else this.observers=[];return this},set:function(t,e,n){if("number"!=typeof t&&(n=e,e=t.y,t=t.x),this.x===t&&this.y===e)return this;var i=null;return!1!==n&&this.observers&&this.observers.length&&(i=this.clone()),this.x=o.clean(t),this.y=o.clean(e),!1!==n?this.change(i):void 0},zero:function(){return this.set(0,0)},clone:function(){return new this.constructor(this.x,this.y)},negate:function(t){return t?new this.constructor(-this.x,-this.y):this.set(-this.x,-this.y)},add:function(t,e,n){return"number"!=typeof t&&(n=e,r(t)?(e=t[1],t=t[0]):(e=t.y,t=t.x)),t+=this.x,e+=this.y,n?new this.constructor(t,e):this.set(t,e)},subtract:function(t,e,n){return"number"!=typeof t&&(n=e,r(t)?(e=t[1],t=t[0]):(e=t.y,t=t.x)),t=this.x-t,e=this.y-e,n?new this.constructor(t,e):this.set(t,e)},multiply:function(t,e,n){return"number"!=typeof t?(n=e,r(t)?(e=t[1],t=t[0]):(e=t.y,t=t.x)):"number"!=typeof e&&(n=e,e=t),t*=this.x,e*=this.y,n?new this.constructor(t,e):this.set(t,e)},rotate:function(t,e,n){var i,a,r=this.x,o=this.y,l=Math.cos(t),s=Math.sin(t);return i=l*r-(e=e?-1:1)*s*o,a=e*s*r+l*o,n?new this.constructor(i,a):this.set(i,a)},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},lengthSquared:function(){var t=this.x,e=this.y;return t*t+e*e},distance:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},nearest:function(t){for(var e,n=Number.MAX_VALUE,i=null,a=t.length-1;a>=0;a--)(e=this.distance(t[a]))<=n&&(n=e,i=t[a]);return i},normalize:function(t){var e=this.length(),n=e<Number.MIN_VALUE?0:1/e;return t?new this.constructor(this.x*n,this.y*n):this.set(this.x*n,this.y*n)},equal:function(t,e){return"number"!=typeof t&&(r(t)?(e=t[1],t=t[0]):(e=t.y,t=t.x)),o.clean(t)===this.x&&o.clean(e)===this.y},abs:function(t){var e=Math.abs(this.x),n=Math.abs(this.y);return t?new this.constructor(e,n):this.set(e,n)},min:function(t,e){var n=this.x,i=this.y,a=t.x,r=t.y,o=n<a?n:a,l=i<r?i:r;return e?new this.constructor(o,l):this.set(o,l)},max:function(t,e){var n=this.x,i=this.y,a=t.x,r=t.y,o=n>a?n:a,l=i>r?i:r;return e?new this.constructor(o,l):this.set(o,l)},clamp:function(t,e,n){var i=this.min(e,!0).max(t);return n?i:this.set(i.x,i.y)},lerp:function(t,e,n){return this.add(t.subtract(this,!0).multiply(e),n)},skew:function(t){return t?new this.constructor(-this.y,this.x):this.set(-this.y,this.x)},dot:function(t){return o.clean(this.x*t.x+t.y*this.y)},perpDot:function(t){return o.clean(this.x*t.y-this.y*t.x)},angleTo:function(t){return Math.atan2(this.perpDot(t),this.dot(t))},divide:function(t,e,n){if("number"!=typeof t?(n=e,r(t)?(e=t[1],t=t[0]):(e=t.y,t=t.x)):"number"!=typeof e&&(n=e,e=t),0===t||0===e)throw new Error("division by zero");if(isNaN(t)||isNaN(e))throw new Error("NaN detected");return n?new this.constructor(this.x/t,this.y/e):this.set(this.x/t,this.y/e)},isPointOnLine:function(t,e){return(t.y-this.y)*(t.x-e.x)==(t.y-e.y)*(t.x-this.x)},toArray:function(){return[this.x,this.y]},fromArray:function(t){return this.set(t[0],t[1])},toJSON:function(){return{x:this.x,y:this.y}},toString:function(){return"("+this.x+", "+this.y+")"},constructor:o},o.fromArray=function(t,e){return new(e||o)(t[0],t[1])},o.precision=i||8;var l=Math.pow(10,o.precision);return o.clean=n||function(t){if(isNaN(t))throw new Error("NaN detected");if(!isFinite(t))throw new Error("Infinity detected");return Math.round(t)===t?t:Math.round(t*l)/l},o.inject=e,n||(o.fast=e((function(t){return t})),t.exports=o),o}()})),Mp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.lineLine=a,e.lineRect=function(t,e,i){var r=new n.default(i.x,i.y),o=new n.default(i.x,i.yMax),l=new n.default(i.xMax,i.yMax),s=new n.default(i.xMax,i.y);return!!a(t,e,r,o)||(!!a(t,e,o,l)||(!!a(t,e,l,s)||!!a(t,e,s,r)))};var n=i(Tp);function a(t,e,n,i){var a=(i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x),r=(e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x),o=(i.y-n.y)*(e.x-t.x)-(i.x-n.x)*(e.y-t.y);if(0!==o){var l=a/o,s=r/o;if(0<=l&&l<=1&&0<=s&&s<=1)return!0}return!1}}));e(Mp);Mp.lineLine,Mp.lineRect;var Ep=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default._,c=d.default.event,p=d.default.Shapes.BrokenLine,g=d.default.Shapes.Arrow,y=d.default.Display.Text,v=d.default.Shapes.Circle,x=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="relation_backline",f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.pointList=null,o.sprite=new d.default.Display.Sprite,o._line=null,o._arrow=null,o._label=null,o._icon=null,o}return(0,a.default)(i,[{key:"draw",value:function(t){!t&&(t={}),this.width=t.width,this.height=t.height,this.origin=t.origin,this._widget()}},{key:"reset",value:function(t){t&&f.extend(!0,this,t),this._widget()}},{key:"_widget",value:function(){var t=this,e=this.app.getGraphs();if(e.length){var n=e[0];n.on("complete",(function(){t._setPoints(n),t._drawLine(),t._drawArrow(),t._drawIcon(),n.graphsSp.addChild(t.sprite)}))}}},{key:"_setPoints",value:function(t){if(this.line.pointList)this.pointList=this.line.pointList;else{var e,n=this.key,i=t.data.nodes.find((function(t){return t.key==n.split(",")[0]})),a={x:i.x-i.width/2,y:i.y-i.height/2,width:i.width,height:i.height},r=t.data.nodes.find((function(t){return t.key==n.split(",")[1]})),o={x:r.x-r.width/2,y:r.y-r.height/2,width:r.width,height:r.height},l=[a.x+a.width,a.y+a.height/2],s=[a.x+a.width+20,a.y+a.height/2],u=o.x+o.width/2,d=[u,o.y],h=[u,o.y+o.height];e=d;var f,c,p,g,y,v=function(e){var n=s[1]+e,i=0;return t.data.nodes.forEach((function(t){var e=t.x-t.width/2,a=t.y-t.height/2,r={x:e,y:a,xMax:e+t.width,yMax:a+t.height};(0,Mp.lineRect)({x:s[0],y:n},{x:u,y:n},r)&&i++})),i},x=[];if(null==this.line.dissY){c=-(s[1]-(Math.min(o.y,a.y)-6)),x.push({dissY:c,throughNodesNum:v(c),endPoint:d,type:"n"}),o.y-(a.y+a.height)>20&&(c=a.y+a.height+(o.y-(a.y+a.height))/2-s[1],x.push({dissY:c,throughNodesNum:v(c),endPoint:d,type:"down_z"}));var _=h[1];p=Math.max(_,a.y+a.height)+6-s[1],x.push({dissY:p,throughNodesNum:v(p),endPoint:h,type:"u"}),a.y-_>20&&(p=_+(a.y-_)/2-s[1],x.push({dissY:p,throughNodesNum:v(p),endPoint:h,type:"up_z"})),x=x.sort((function(t,e){return t.throughNodesNum-e.throughNodesNum}));var m=[];x.forEach((function(t){t.throughNodesNum==x[0].throughNodesNum&&m.push(t)})),m=m.sort((function(t,e){return Math.abs(t.dissY)-Math.abs(e.dissY)})),f=m[0].dissY,e=m[0].endPoint}else f=this.line.dissY;g=[s[0],s[1]+f],y=[e[0],s[1]+f],this.pointList=[l,s,g,y,e]}}},{key:"_drawLine",value:function(){if(this.line.enabled){var t={pointList:this.pointList,lineWidth:this.line.lineWidth,strokeStyle:this.line.strokeStyle,lineType:this.line.lineType};this._line?f.extend(this._line.context,t):(this._line=new p({context:t}),this.sprite.addChild(this._line))}}},{key:"_drawArrow",value:function(){var t=this.pointList,e=2,n=t[t.length-1],i=t[t.length-2];i[1]<n[1]&&(e=-2);var a=this.line.strokeStyle,r={y:e,control:{x:i[0],y:i[1]},point:{x:n[0],y:n[1]},strokeStyle:a,fillStyle:a};this._arrow?f.extend(!0,this._arrow.context,r):(this._arrow=new g({context:r}),this.sprite.addChild(this._arrow))}},{key:"_drawIcon",value:function(){var t=this;if(this.icon.enabled){var e=this._getProp(this.icon.charCode,this),n=String.fromCharCode(parseInt(e,16));if(""!=e){var i=this.pointList[1],a=this._getProp(this.icon.lineWidth,this),r=this._getProp(this.icon.strokeStyle,this),o=this._getProp(this.icon.fontFamily,this),l=this._getProp(this.icon.fontSize,this),s=this._getProp(this.icon.fontColor,this),u=this._getProp(this.icon.background,this),d="center",h="middle",f=this._getProp(this.icon.offset,this),p=this._getProp(this.icon.offsetX,this),g=this._getProp(this.icon.offsetY,this);f||(f={x:i[0]+p,y:i[1]+g});var x={x:f.x,y:f.y-1,r:parseInt(.5*l)+2,fillStyle:u,strokeStyle:r,lineWidth:a};this._iconBack?Object.assign(this._iconBack.context,x):(this._iconBack=new v({context:x}),this.sprite.addChild(this._iconBack)),this._icon?(this._icon.resetText(n),this._icon.context.x=f.x,this._icon.context.y=f.y,this._icon.context.fontSize=l,this._icon.context.fillStyle=s,this._icon.context.textAlign=d,this._icon.context.textBaseline=h,this._icon.context.fontFamily=o,this._icon.context.lineWidth=a,this._icon.context.strokeStyle=r):(this._icon=new y(n,{context:{x:f.x,y:f.y,fillStyle:s,cursor:"pointer",fontSize:l,textAlign:d,textBaseline:h,fontFamily:o,lineWidth:a,strokeStyle:r}}),this._icon.on(c.types.get(),(function(e){var n=t.line;t.icon["on"+e.type]&&(n=t.icon),e.eventInfo={trigger:n,nodes:[{name:t.key}]},t.app.fire(e.type,e)})),t.sprite.addChild(this._icon))}}}},{key:"_getProp",value:function(t,e){var n=t;return f.isFunction(t)&&(n=t.apply(this,[e])),n}}],[{key:"defaultProps",value:function(){return{key:{detail:"和relation的line保持一致，用逗号分割",default:null},line:{detail:"线的配置",propertys:{enabled:{detail:"是否开启",default:!0},pointList:{detail:"回链线的points",default:null},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线的颜色",default:"#e5e5e5"},lineType:{detail:"线的样式，虚线(dashed)实线(solid)",default:"solid"},dissY:{detail:"拐点和起始节点的距离",default:null}}},icon:{detail:"line上面的icon",propertys:{enabled:{detail:"是否开启线上的icon设置",default:!0},charCode:{detail:"iconfont上面对应的unicode中&#x后面的字符",default:null},lineWidth:{detail:"icon描边线宽",default:1},strokeStyle:{detail:"icon的描边颜色",default:"#e5e5e5"},fontColor:{detail:"icon的颜色",default:"#e5e5e5"},fontFamily:{detail:"font-face的font-family设置",default:"iconfont"},fontSize:{detail:"icon的字体大小",default:14},offset:{detail:"icon的位置，函数，参数是整个edge对象",default:null},offsetX:{detail:"在计算出offset后的X再次便宜量",default:1},offsetY:{detail:"在计算出offset后的Y再次便宜量",default:2},background:{detail:"icon的背景颜色，背景为圆形",default:"#fff"}}}}}}]),i}(u.default);u.default.registerComponent(x,"relation_backline");var _=x;e.default=_}));e(Ep);var Rp=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln);i(En);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default._,c=(d.default.event,function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="title",f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.sprite=new d.default.Display.Sprite({id:"titleSprite",context:{}}),o.app.stage.addChild(o.sprite),o.widget(),o.layout(),o}return(0,a.default)(i,[{key:"widget",value:function(){var t="left";if(this.text){var e=this._getProp(this.textStyle)||{},n=new d.default.Display.Text(this.text,{id:"title_txt",context:{x:this.margin.left,y:this.margin.top,fillStyle:e.fontColor||this.text.fontColor,fontSize:this.text.fontSize,textAlign:t,textBaseline:"bottom"}});for(var i in e)i in n.context&&(n.context[i]=e[i]);this.sprite.addChild(n),this.width+=n.getTextWidth()+6,this.height+=n.getTextHeight(),n.context.y=this.height}if(this.desc){var a=this._getProp(this.descStyle)||{},r=new d.default.Display.Text(this.desc,{id:"title_txt",context:{x:this.width+this.margin.left,y:this.height,fillStyle:a.fontColor||this.text.fontColor,fontSize:this.text.fontSize,textAlign:t,textBaseline:"bottom"}});for(var o in a)o in r.context&&(r.context[o]=a[o]);this.sprite.addChild(r),this.width+=r.getTextWidth(),this.height=Math.max(r.getTextHeight(),this.height),r.context.y=this.height}}},{key:"layout",value:function(){var t=this.app,e=this.height+this.margin.top+this.margin.bottom,n=t.padding.left,i=t.padding.top;return"top-left"==this.position&&(n=t.padding.left),"top-right"==this.position&&(n=t.width-t.padding.right-this.margin.right-this.width),t.padding.top+=e,this.pos={x:n,y:i},this.pos}},{key:"draw",value:function(){var t=this.app.getComponent({name:"coord"});t&&"rect"==t.type&&("top-right"==this.position||(this.pos.x=t.getSizeAndOrigin().origin.x)),this.setPosition()}},{key:"_getProp",value:function(t,e){var n=t;return f.isArray(t)&&(n=t[e.ind]),f.isFunction(t)&&(n=t.apply(this,[e])),n}}],[{key:"defaultProps",value:function(){return{position:{detail:"图例位置",documentation:"默认top-left,可选top-right",default:"top-left"},text:{detail:"标题内容",default:""},textStyle:{detail:"主标题样式",propertys:{fontColor:{detail:"字体颜色",default:"#666"},fontSize:{detail:"字体大小",default:"14"},style:{detail:"样式集合",default:null}}},desc:{detail:"描述内容",default:""},descStyle:{detail:"描述的样式",propertys:{fontColor:{detail:"字体颜色",default:"#999"},fontSize:{detail:"字体大小",default:"12"},style:{detail:"样式集合",default:null}}},margin:{propertys:{bottom:{default:10}}}}}}]),i}(u.default));u.default.registerComponent(c,"title");var p=c;e.default=p}));e(Rp);var Ip=n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(hn),a=i(fn),r=i(yn),o=i(pn),l=i(vn),s=i(xn),u=i(wn),d=i(ln);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=(0,s.default)(t);if(e){var a=(0,s.default)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,l.default)(this,n)}}var f=d.default._,c=d.default.Shapes.Rect,p=function(t){(0,o.default)(i,t);var e=h(i);function i(t,a){var o;return(0,n.default)(this,i),(o=e.call(this,t,a)).name="lineMarkPoint",f.extend(!0,(0,r.default)(o),(0,bn.getDefaultProps)(i.defaultProps()),t),o.lineDatas=null,o.sprite=new d.default.Display.Sprite,o.app.graphsSprite.addChild(o.sprite),o}return(0,a.default)(i,[{key:"reset",value:function(t){f.extend(!0,this,t),this.lineDatas=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var t=this,e=this.app.getComponent({name:"coord"});this.pos={x:e.origin.x,y:e.origin.y},this.setPosition();var n=t.app.getComponent({name:"graphs",type:"line",field:t.lineField});t.lineDatas=n.data[t.lineField].data;var i=this.app.getComponent({name:"coord"}).getAxis({type:"xAxis"}).getIndexOfVal(this.xValue);if(-1!=i){var a=this.lineDatas[i],r=i?this.lineDatas[i-1]:null,o=i==t.lineDatas.length?null:this.lineDatas[i+1];if(null!=a.y){var l=a.x,s=new d.default.Display.Sprite({context:{x:l}});this.sprite.addChild(s);var u=0,h=new d.default.Display.Text(t.label.text,{context:{fillStyle:this.label.fontColor,fontSize:this.label.fontSize,textAlign:"center",textBaseline:"top"}});s.addChild(h),u=h.getTextHeight();var f,p=h.getTextWidth(),g=0;if(this.label.background.enabled){u+=2*(g=this.label.background.padding),p+=2*g,s.context.x-=g,h.context.x+=g,h.context.y+=g;var y=t.label.background.radius;f=new c({context:{x:-p/2+g,width:p,height:u,radius:[y,y,y,y],fillStyle:t.label.background.fillStyle,strokeStyle:t.label.background.strokeStyle,lineWidth:t.label.background.lineWidth}}),s.addChild(f,0)}p/2+l>e.width&&(s.context.x=e.width,h.context.textAlign="right",f&&(f.context.x-=p/2-g)),l-p/2<0&&(s.context.x=0,h.context.textAlign="left",f&&(f.context.x+=p/2-g));var v=t._getNodeYandLinePointList(a,r,o,e,u),x=v.y,_=v.pointList;if(s.context.y=x,t.line.enabled){var m=new d.default.Shapes.BrokenLine({context:{pointList:_,strokeStyle:t.line.strokeStyle,lineWidth:t.line.lineWidth}});t.sprite.addChild(m,0)}}}}},{key:"_getNodeYandLinePointList",value:function(t,e,n,i,a){this.app.height;var r=i.height,o=t.y,l=this.line.enabled?this.line.lineLength:3,s=this.line.lineDis,u="online";"auto"==this.position?((e&&e.y<t.y||n&&n.y<t.y)&&(u="offline"),"online"==u&&Math.abs(o)+l+s+a>r&&(u="offline"),"offline"==u&&Math.abs(o)<l+a+s&&(u="online")):u=this.position;var d=0;d="online"==u?o-l-s-a:o+s+l;var h=[[t.x,d],[t.x,t.y+s]];return"online"==u&&(h=[[t.x,d+a],[t.x,t.y-s]]),{y:d,pointList:h}}}],[{key:"defaultProps",value:function(){return{lineField:{detail:"对应的line字段",default:null},xValue:{detail:"在lineFile字段的折线上对应点的x轴的值",default:null},line:{detail:"line的配置",propertys:{enabled:{detail:"是否要指示线",default:!0},lineWidth:{detail:"线宽",default:2},strokeStyle:{detail:"线颜色",default:"#ccc"},lineLength:{detail:"线的长度，也就是label到line的距离",default:8},lineDis:{detail:"line到折线上面node的距离",default:3}}},label:{detail:"markpoint标注的文本配置",propertys:{text:{detail:"label内容",default:""},fontSize:{detail:"label的文本大小",default:12},fontColor:{detail:"文本颜色",default:"#666"},background:{detail:"label的background配置",propertys:{enabled:{detail:"label是否需要背景",default:!0},fillStyle:{detail:"label的背景颜色",default:"#f5f5f6"},radius:{detail:"label的背景圆角",default:6},strokeStyle:{detail:"label的背景边框颜色",default:"#f5f5f6"},lineWidth:{detail:"背景描边",default:1},padding:{detail:"background和label之间的距离",default:6}}}}},position:{detail:"在线的方向，online（线上边） or offline（线下方），默认自动计算",default:"auto"}}}}]),i}(u.default);u.default.registerComponent(p,"lineMarkPoint");var g=p;e.default=g}));e(Ip);var Lp=e(n((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(dn),a=[];a&&a.length&&n.default.setGlobalTheme(a);var r={version:"1.1.142",options:{}};for(var o in n.default)r[o]=n.default[o];var l=r;e.default=l})));module.exports=Lp;

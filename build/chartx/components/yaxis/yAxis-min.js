define("chartx/components/yaxis/yAxis",["canvax/index","canvax/core/Base","canvax/shape/Line","chartx/utils/tools","chartx/utils/datasection"],function(a,b,c,d,e){var f=function(a,b){this.width=null,this.enabled=1,this.dis=6,this.maxW=0,this.field=[],this.label="",this._label=null,this.line={enabled:1,width:4,lineWidth:1,strokeStyle:"#cccccc"},this.text={fillStyle:"#999",fontSize:12,format:null,rotation:0},this.pos={x:0,y:0},this.place="left",this.biaxial=!1,this.layoutData=[],this.dataSection=[],this.dataSectionGroup=[],this.middleweight=null,this.dataOrg=[],this.sprite=null,this.disYAxisTopLine=6,this.yMaxHeight=0,this.yGraphsHeight=0,this.baseNumber=null,this.basePoint=null,this.maxNumber=null,this.minNumber=null,this.filter=null,this.isH=!1,this.animation=!0,this.resize=!1,this.sort=null,this.init(a,b)};return f.prototype={init:function(b,c){_.deepExtend(this,b),0!=this.text.rotation&&this.text.rotation%90==0&&(this.isH=!0),this._initData(c),this.sprite=new a.Display.Sprite({id:"yAxisSprite"}),this.rulesSprite=new a.Display.Sprite({id:"yRulesSprite"}),this.sprite.addChild(this.rulesSprite)},setX:function(a){this.sprite.context.x=a+("left"==this.place?Math.max(this.maxW,this.width-this.pos.x-this.dis-this.line.width):0),this.pos.x=a},setY:function(a){this.sprite.context.y=a,this.pos.y=a},setAllStyle:function(a){_.each(this.rulesSprite.children,function(b){_.each(b.children,function(b){"text"==b.type?b.context.fillStyle=a:"line"==b.type&&(b.context.strokeStyle=a)})})},reset:function(a,b){this.dataSection=[],this.dataSectionGroup=[],a&&_.deepExtend(this,a),this._initData(b),this._trimYAxis(),this._widget()},_getLabel:function(){var b="";b=_.isArray(this.label)?this.label["left"==this.place?0:1]:this.label,b&&""!=b&&(this._label=new a.Display.Text(b,{context:{fontSize:this.text.fontSize,textAlign:this.place,textBaseline:this.isH?"top":"bottom",fillStyle:this.text.fillStyle,rotation:this.isH?-90:0}}))},draw:function(a){a&&_.deepExtend(this,a),this._getLabel(),this.yGraphsHeight=this.yMaxHeight-this._getYAxisDisLine(),this._label&&(this.isH?this.yGraphsHeight-=this._label.getTextWidth():this.yGraphsHeight-=this._label.getTextHeight(),this._label.context.y=-this.yGraphsHeight-5),this._trimYAxis(),this._widget(),this.setX(this.pos.x),this.setY(this.pos.y),this.resize=!1},getYposFromVal:function(a){for(var b=0,c=this.dataSectionGroup.length,d=this.yGraphsHeight/c,e=0,f=c;f>e;e++){var g=this.dataSectionGroup[e],h=_.min(g),i=_.max(g),j=g[0],k=g.slice(-1)[0];if(a>h&&i>=a||"desc"==this._getSortType()&&a>=h&&i>a){var b=-((a-j)/(k-j)*d+e*d);break}}return b=isNaN(b)?0:parseInt(b)},getValFromYpos:function(a){var b=this.layoutData[0],c=this.layoutData.slice(-1)[0],d=(c.content-b.content)*((a-b.y)/(c.y-b.y))+b.content;return d},_trimYAxis:function(){for(var a=this.dataSection[this.dataSection.length-1],b=[],c=0,d=this.dataSection.length;d>c;c++)b[c]={content:this.dataSection[c],y:this.getYposFromVal(this.dataSection[c])};this.layoutData=b;var e=-(this.baseNumber-this._bottomNumber)/(a-this._bottomNumber)*this.yGraphsHeight;e=isNaN(e)?0:parseInt(e),this.basePoint={content:this.baseNumber,y:e}},_getYAxisDisLine:function(){var a=this.disYAxisTopLine,b=2*a,c=a;return c=a+this.yMaxHeight%this.dataSection.length,c=c>b?b:c},_setDataSection:function(a){var b=[],c=a.org||a.data||a;this.biaxial?"left"==this.place?(b=_.flatten(c[0]),this.field=_.flatten([this.field[0]])):(b=_.flatten(c[1]),this.field=_.flatten([this.field[1]])):b=_.flatten(c);for(var d=0,e=b.length;e>d;d++)b[d]=b[d]||0;return b},_initData:function(a){_.isArray(this.dataSection)&&this.dataSection.length&&_.isArray(this.dataSection[0])&&(this.dataSection=this.dataSection["left"==this.place?0:1]||[]),_.isArray(this.field)||(this.field=[this.field]);var b=this._setDataSection(a);1==b.length&&b.push(2*b[0]),this.dataOrg=a.org||a.data,0==this.dataSection.length&&(this.dataSection=e.section(b,3)),0==this.dataSection.length&&(this.dataSection=[0]),this.dataSectionGroup=[_.clone(this.dataSection)],this._sort(),this._setBottomAndBaseNumber(),this._middleweight()},_sort:function(){if(this.sort){var a=this._getSortType();"desc"==a&&(this.dataSection.reverse(),_.each(this.dataSectionGroup,function(a,b){a.reverse()}),this.dataSectionGroup.reverse())}},_getSortType:function(){var a;return _.isString(this.sort)&&(a=this.sort),_.isArray(this.sort)&&(a=this.sort["left"==this.place?0:1]),a||(a="asc"),a},_setBottomAndBaseNumber:function(){if(this._bottomNumber=this.dataSection[0],null==this.baseNumber){var a=_.min(this.dataSection);this.baseNumber=a>0?a:0}},_middleweight:function(){if(this.middleweight){_.isArray(this.middleweight)||(this.middleweight=[this.middleweight]);for(var a=_.min(this.dataSection),b=_.max(this.dataSection),c=[a],d=[],e=0,f=this.middleweight.length;f>e;e++){var g=a;e>0&&(g=this.middleweight[e-1]);var h=g+parseInt((this.middleweight[e]-g)/2);c.push(h),c.push(this.middleweight[e]),d.push([g,h,this.middleweight[e]])}var i=parseInt(this.middleweight.slice(-1)[0]);c.push(i+parseInt((b-i)/2)),c.push(b),d.push([i,i+parseInt((b-i)/2),b]),this.dataSection=c,this.dataSectionGroup=d,this._sort(),this._setBottomAndBaseNumber()}},resetWidth:function(a){var b=this;b.width=a,b.line.enabled?b.sprite.context.x=a-b.dis-b.line.width:b.sprite.context.x=a-b.dis},_widget:function(){var e=this;if(!e.enabled)return void(e.width=0);var f=this.layoutData;e.maxW=0,e._label&&e.sprite.addChild(e._label);for(var g=0,h=f.length;h>g;g++){var i=f[g],j=0,k=i.y,l=i.content;_.isFunction(e.text.format)&&(l=e.text.format(l,e)),(void 0===l||null===l)&&(l=d.numAddSymbol(i.content));var m="left"==e.place?"right":"left";(90==e.text.rotation||-90==e.text.rotation)&&(m="center",g==f.length-1&&(m="right"));var n=k+(0==g?-3:0)+(g==f.length-1?3:0);(90==e.text.rotation||-90==e.text.rotation)&&(g==f.length-1&&(n=k-2),0==g&&(n=k));var o=this.rulesSprite.getChildAt(g);if(o)o._txt&&(o._txt.context.y!=n&&o._txt.animate({y:n},{duration:500,delay:80*g,id:o._txt.id}),o._txt.resetText(l)),o._line&&o._line.animate({y:k},{duration:500,delay:80*g,id:o._line.id});else{o=new a.Display.Sprite({id:"yNode"+g});var p=new a.Display.Text(l,{id:"yAxis_txt_"+b.getUID(),context:{x:j+("left"==e.place?-5:5),y:n+20,fillStyle:e._getProp(e.text.fillStyle),fontSize:e.text.fontSize,rotation:-Math.abs(this.text.rotation),textAlign:m,textBaseline:"middle",globalAlpha:0}});if(o.addChild(p),o._txt=p,e.maxW=Math.max(e.maxW,p.getTextWidth()),(90==e.text.rotation||-90==e.text.rotation)&&(e.maxW=Math.max(e.maxW,p.getTextHeight())),e.line.enabled){var q=new c({context:{x:0+("left"==e.place?1:-1)*e.dis-2,y:k,xEnd:e.line.width,yEnd:0,lineWidth:e.line.lineWidth,strokeStyle:e._getProp(e.line.strokeStyle)}});o.addChild(q),o._line=q}_.isFunction(e.filter)&&e.filter({layoutData:e.layoutData,index:g,txt:p,line:q}),e.rulesSprite.addChild(o),e.animation&&!e.resize?p.animate({globalAlpha:1,y:p.context.y-20},{duration:500,easing:"Back.Out",delay:80*(g+1),id:p.id}):(p.context.y=p.context.y-20,p.context.globalAlpha=1)}}if(e.rulesSprite.children.length>f.length)for(var h=f.length,r=e.rulesSprite.children.length;r>h;h++)e.rulesSprite.getChildAt(h).remove(),h--,r--;e.maxW+=e.dis,null==e.width&&(e.line.enabled?e.width=e.maxW+e.dis+e.line.width+e.pos.x:e.width=e.maxW+e.dis+e.pos.x)},_getProp:function(a){var b;return _.isFunction(a)&&(b=a.call(this,this)),b||(b="#999"),b}},f});